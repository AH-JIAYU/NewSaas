
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ge,aN as he,r as p,ae as fe,E as u,M as _e,o as ye,a2 as g,al as A,a as i,i as ve,f as l,w as a,a3 as j,c,g as d,t as r,h as o,aM as be,b as h,j as _,A as x,aO as ke,aS as Ie,ai as je,aP as Ce,aQ as Se,aR as Ne,ao as Pe,y as we}from"./index-Ciz6FZao.js";import{_ as Te}from"./index-DInXVQVU.js";import{_ as De}from"./index.vue_vue_type_style_index_0_lang-DwaLMSBt.js";import{_ as ze}from"./index-JzHzYzUR.js";import Le from"./index-afEbXo1k.js";import{a as H}from"./projectManagement_scheduling-CPGgYwC4.js";import"./index-GTmHDAFN.js";import"./clipboard-BtCkCYW2.js";import"./index.vue_vue_type_script_setup_true_lang-DrVbtlxp.js";import"./sortable.esm-C0-Qcoum.js";import"./apiLoading-CkuLQ7p-.js";const xe={class:"fontC-System"},Ee={class:"tableBig oneLine"},Me={class:"copyId tableSmall projectId"},Re={class:"id oneLine"},$e={class:"fontC-System"},Be={class:"fontC-System"},Ge={class:"specifyTheTarget"},Ae={class:"tableBig"},He={class:"id tableSmall",style:{"font-size":"14px"}},Oe=ge({name:"scheduling",__name:"list",setup(Ue){const{format:O}=ke(),{pagination:y,getParams:U,onSizeChange:F,onCurrentChange:V}=he(),Q=p(""),{t}=fe(),k=p(!1),C=p(!1),S=p(),N=p(!1),m=p([]),E=p(),q=p("formSearch-scheduling"),P=p("default"),w=p(!1),T=p([{sotrtable:!0,checked:!0,label:u(()=>t("scheduling.type")),prop:"dispatchType"},{sotrtable:!0,checked:!0,label:u(()=>t("scheduling.projectID")),prop:"projectId"},{sotrtable:!0,checked:!0,label:u(()=>t("scheduling.projectName")),prop:"projectName"},{sotrtable:!0,checked:!0,label:u(()=>t("scheduling.projectPrice")),prop:"moneyPrice"},{sotrtable:!0,checked:!0,label:u(()=>t("scheduling.specifiedPrice")),prop:"doMoneyPrice"},{sotrtable:!0,checked:!0,label:u(()=>t("scheduling.designatedSupplier")),prop:"Supplier"},{sotrtable:!0,checked:!0,label:u(()=>t("scheduling.designatedDepartment")),prop:"group"},{sotrtable:!0,checked:!0,label:u(()=>t("scheduling.creationTime")),prop:"createTime"}]),D=_e({dispatchType:"",projectId:"",projectName:""}),M=p([]);function J(){S.value.showEdit()}function K(n){S.value.showEdit(n)}function W(n){Ie.confirm(`确认删除「${n.projectName}」吗？`,"确认信息").then(()=>{H.delete({projectDispatchId:n.projectDispatchId}).then(s=>{v(),je.success({message:"删除成功",center:!0})})}).catch(()=>{})}function X(n){F(n).then(()=>v())}const I=p();function Y(n){n?I.value=n.projectId:I.value=""}function z(n=1){V(n).then(()=>v())}function Z(){Object.assign(D,{dispatchType:"",projectId:"",projectName:""}),v()}async function v(){try{k.value=!0;const n={...U(),...D},s=await H.list(n);M.value=s.data.getProjectDispatchInfoList,y.value.total=s.data.total,k.value=!1}catch{}finally{k.value=!1}}ye(()=>{T.value.forEach(n=>{n.checked&&m.value.push(n.prop)}),v(),E.value=[{index:1,show:!0,type:"input",modelName:"projectId",placeholder:u(()=>t("scheduling.projectID"))},{index:2,show:!0,type:"input",modelName:"projectName",placeholder:u(()=>t("scheduling.projectName"))},{index:3,show:!0,type:"select",modelName:"dispatchType",placeholder:u(()=>t("scheduling.allTypes")),option:"dispatchType",optionLabel:"label",optionValue:"value"}]});const ee={dispatchType:()=>[{label:u(()=>t("scheduling.assignmentOff")),value:1},{label:u(()=>t("scheduling.specifiedPrice")),value:2}]};return(n,s)=>{const te=ze,ae=g("ElDivider"),b=g("el-button"),oe=De,le=Ce,ne=Se,se=g("el-row"),R=g("el-text"),f=g("el-table-column"),$=g("el-tooltip"),B=Te,G=Ne,ie=g("el-tag"),ce=g("el-empty"),re=g("el-table"),pe=g("ElPagination"),ue=Pe,L=A("auth"),de=A("loading");return i(),ve("div",{class:x({"absolute-container":N.value})},[l(ue,null,{default:a(()=>[l(te,{formSearchList:E.value,formSearchName:q.value,onCurrentChange:z,onOnReset:Z,model:D,formOption:ee},null,8,["formSearchList","formSearchName","model"]),l(ae,{"border-style":"dashed"}),l(se,{gutter:24},{default:a(()=>[l(oe,null,{default:a(()=>[j((i(),c(b,{type:"primary",size:"default",onClick:J},{default:a(()=>[d(r(o(t)("scheduling.add")),1)]),_:1})),[[L,"scheduling-get-addProjectDispatch"]])]),_:1}),l(ne,null,{default:a(()=>[l(b,{size:"default",onClick:s[0]||(s[0]=()=>{})},{default:a(()=>[d(r(o(t)("scheduling.export")),1)]),_:1}),l(le,{border:C.value,"onUpdate:border":s[1]||(s[1]=e=>C.value=e),tableAutoHeight:N.value,"onUpdate:tableAutoHeight":s[2]||(s[2]=e=>N.value=e),checkList:m.value,"onUpdate:checkList":s[3]||(s[3]=e=>m.value=e),columns:T.value,"onUpdate:columns":s[4]||(s[4]=e=>T.value=e),"line-height":P.value,"onUpdate:lineHeight":s[5]||(s[5]=e=>P.value=e),stripe:w.value,"onUpdate:stripe":s[6]||(s[6]=e=>w.value=e),style:{"margin-left":"12px"},onQueryData:z},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),j((i(),c(re,{ref_key:"tableSortRef",ref:Q,style:{"margin-top":"10px"},"row-key":"id",data:M.value,border:C.value,size:P.value,stripe:w.value,"highlight-current-row":"",onCurrentChange:Y},{empty:a(()=>[l(ce,{image:o(be),"image-size":300},null,8,["image"])]),default:a(()=>[m.value.includes("dispatchType")?(i(),c(f,{key:0,"show-overflow-tooltip":"",prop:"dispatchType",align:"left",label:o(t)("scheduling.type")},{default:a(({row:e})=>[h("div",xe,[e.dispatchType===1?(i(),c(R,{key:0,type:"primary",style:{"font-weight":"700"}},{default:a(()=>[d(r(o(t)("scheduling.assignmentOff")),1)]),_:1})):(i(),c(R,{key:1,type:"danger",style:{"font-weight":"700"}},{default:a(()=>[d(r(o(t)("scheduling.specifiedPrice")),1)]),_:1}))])]),_:1},8,["label"])):_("",!0),m.value.includes("projectName")?(i(),c(f,{key:1,"show-overflow-tooltip":"",prop:"projectName",align:"left",label:o(t)("scheduling.project")},{default:a(({row:e})=>[h("div",Ee,r(e.projectName),1)]),_:1},8,["label"])):_("",!0),m.value.includes("projectId")?(i(),c(f,{key:2,"show-overflow-tooltip":"",prop:"projectId",align:"left",label:o(t)("scheduling.projectID"),width:"200"},{default:a(({row:e})=>[h("div",Me,[h("div",Re,[l($,{effect:"dark",content:e.projectId,placement:"top-start"},{default:a(()=>[d(r(e.projectId),1)]),_:2},1032,["content"])]),l(B,{content:e.projectId,class:x({rowCopy:"rowCopy",current:e.projectId===I.value})},null,8,["content","class"])])]),_:1},8,["label"])):_("",!0),m.value.includes("moneyPrice")?(i(),c(f,{key:3,"show-overflow-tooltip":"",prop:"moneyPrice",align:"left",label:o(t)("scheduling.projectPrice")},{default:a(({row:e})=>[h("div",$e,[l(G),d(r(e.moneyPrice||0),1)])]),_:1},8,["label"])):_("",!0),m.value.includes("doMoneyPrice")?(i(),c(f,{key:4,"show-overflow-tooltip":"",prop:"doMoneyPrice",align:"left",label:o(t)("scheduling.specifiedPrice")},{default:a(({row:e})=>[h("div",Be,[l(G),d(r(e.doMoneyPrice||0),1)])]),_:1},8,["label"])):_("",!0),m.value.includes("Supplier")?(i(),c(f,{key:5,"show-overflow-tooltip":"",prop:"groupSupplierId",align:"left",label:o(t)("scheduling.targetAssignment"),width:"400"},{default:a(({row:e})=>[h("div",Ge,[e.dataType==2?(i(),c(b,{key:0,style:{width:"46px","background-color":"#ffac54"},type:"warning",size:"small",class:"p-1"},{default:a(()=>[d(r(e.getGroupSupplierIdNameInfoList.length>1?"×"+e.getGroupSupplierIdNameInfoList.length:o(t)("scheduling.department")),1)]),_:2},1024)):e.dataType===1?(i(),c(b,{key:1,style:{width:"46px"},type:"warning",size:"small",class:"p-1"},{default:a(()=>[d(r(e.getGroupSupplierIdNameInfoList.length>1?"×"+e.getGroupSupplierIdNameInfoList.length:o(t)("scheduling.supplier")),1)]),_:2},1024)):_("",!0),h("b",Ae,r(e.getGroupSupplierIdNameInfoList[0].groupSupplierName),1),h("span",He,r(e.getGroupSupplierIdNameInfoList[0].groupSupplierId),1),l(B,{content:e.getGroupSupplierIdNameInfoList[0].groupSupplierId,class:x({rowCopy:"rowCopy",current:e.projectId===I.value})},null,8,["content","class"])])]),_:1},8,["label"])):_("",!0),m.value.includes("createTime")?(i(),c(f,{key:6,"show-overflow-tooltip":"",prop:"createTime",align:"left",label:o(t)("scheduling.create")},{default:a(({row:e})=>[l($,{content:e.createTime,placement:"top"},{default:a(()=>[l(ie,{effect:"plain",type:"info"},{default:a(()=>[d(r(o(O)(e.createTime)),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1},8,["label"])):_("",!0),l(f,{align:"left",fixed:"right",label:o(t)("scheduling.controls"),width:"170"},{default:a(({row:e})=>[j((i(),c(b,{type:"primary",plain:"",size:"small",onClick:me=>K(e)},{default:a(()=>[d(r(o(t)("scheduling.edit")),1)]),_:2},1032,["onClick"])),[[L,"scheduling-update-updateProjectDispatch"]]),j((i(),c(b,{type:"danger",plain:"",size:"small",onClick:me=>W(e)},{default:a(()=>[d(r(o(t)("scheduling.delete")),1)]),_:2},1032,["onClick"])),[[L,"scheduling-delete-deleteProjectDispatch"]])]),_:1},8,["label"])]),_:1},8,["data","border","size","stripe"])),[[de,k.value]]),l(pe,{"current-page":o(y).page,total:o(y).total,"page-size":o(y).size,"page-sizes":o(y).sizes,layout:o(y).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:X,onCurrentChange:z},null,8,["current-page","total","page-size","page-sizes","layout"]),l(Le,{ref_key:"editRef",ref:S,onFetchData:v},null,512)]),_:1})],2)}}}),tt=we(Oe,[["__scopeId","data-v-ab03af42"]]);export{tt as default};
