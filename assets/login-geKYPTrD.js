
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as ge}from"./index.vue_vue_type_script_setup_true_lang-Cuy0oTAF.js";import{k as K,d as fe,s as _e,Y as ve,Z as be,r as i,b5 as V,aM as ye,b as M,f as l,w as t,l as s,i as e,ak as N,aK as $,t as we,a as f,az as he,aA as xe,L as Ve,o as E,D as h,ax as ke,g as d,aw as P,F as Ce,n as Ee,e as A,j as Z,ai as O,K as Ue,_ as Fe,p as T}from"./index-DokbPgjC.js";import Re from"./index-D4ukEqUu.js";const z={sendCode:_=>K.post("user/sendCode",_),register:_=>K.post("user/register",_)},k=_=>(he("data-v-ee8521a2"),_=_(),xe(),_),Se=k(()=>s("div",{class:"bg-banner"},null,-1)),Ie={id:"login-box"},qe={class:"login-banner"},Le=["src"],Ne=["src"],$e={class:"title-container"},Pe={class:"title"},ze={class:"flex-bar"},Be={class:"sub-link"},De=k(()=>s("span",{class:"text"},"还没有帐号?",-1)),Ke={style:{"margin-top":"20px","margin-bottom":"-20px","text-align":"center"}},Me=k(()=>s("div",{class:"title-container"},[s("h3",{class:"title"},"探索从这里开始! 🚀")],-1)),Ae={class:"sub-link"},Ze=k(()=>s("span",{class:"text"},"已经有帐号?",-1)),Oe=k(()=>s("div",{class:"title-container"},[s("h3",{class:"title"},"忘记密码了? 🔒")],-1)),Te={class:"sub-link"},j=fe({name:"Login",__name:"login",setup(_){var D;const G=we(),Y=Ve(),H=_e(),J=ve(),{t:g}=be(),Q=new URL(""+new URL("login-banner-ZfMZACb6.png",import.meta.url).href,import.meta.url).href,W=new URL(""+new URL("logo-CLz_KCqM.png",import.meta.url).href,import.meta.url).href,X="Fantastic-admin 专业版",v=i("login"),w=i(!1),ee=i(((D=G.query.redirect)==null?void 0:D.toString())??H.settings.home.fullPath),U=i(),u=i({account:V.local.get("login_account")||"",password:"",remember:V.local.has("login_account")}),le=i({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}]});function F(){U.value&&U.value.validate(r=>{r&&(w.value=!0,J.login(u.value).then(()=>{w.value=!1,u.value.remember?V.local.set("login_account",u.value.account):V.local.remove("login_account"),Y.push(ee.value)}).catch(()=>{w.value=!1}))})}const x=i(null),R=i("获取验证码"),S=i(!1),I=i(),n=i({account:"",password:"",email:"",phoneNumber:"",code:"",country:"",type:"phone"}),oe=[{value:"phone",label:"手机号注册"},{value:"email",label:"邮箱注册"}],te=i({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],email:[{required:!0,trigger:"blur",message:"请输入邮箱"}],phoneNumber:[{required:!0,trigger:"blur",message:"请输入手机号码"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}]}),ae=async()=>{console.log("registerForm",n.value.type);const r={type:"register_phone_number",email:n.value.email,phone:n.value.phoneNumber};if(n.value.type==="phone"){const o=await z.sendCode(r);console.log("phone",o)}else{r.type="register_email";const o=await z.sendCode(r);console.log("email",o)}se()},se=()=>{S.value=!0;let r=60;x.value=setInterval(()=>{r>0?(r--,R.value=`请在${r}s后重新获取`):(clearInterval(x.value),R.value="获取验证码",x.value=null,S.value=!1)},1e3)};async function ne(){I.value&&I.value.validate(async r=>{if(r){const{status:o}=await z.register(n.value);o===1&&O.success({message:"注册成功"})}})}const q=i(),b=i({account:V.local.get("login_account"),code:"",newPassword:""}),re=i({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],newPassword:[{required:!0,trigger:"blur",message:"请输入新密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}]});function ie(){O({message:"重置密码仅提供界面演示，无实际功能，需开发者自行扩展",type:"info"}),q.value&&q.value.validate(r=>{})}function B(r){u.value.account=r,u.value.password="123456",F()}return ye(()=>{clearInterval(x.value),x.value=null}),(r,o)=>{const p=Ue,de=ge,c=f("ElInput"),m=f("ElFormItem"),ue=f("ElCheckbox"),C=f("ElLink"),y=f("ElButton"),pe=f("ElDivider"),L=f("ElForm"),me=f("ElOption"),ce=f("ElSelect");return E(),M("div",null,[Se,l(de,{placement:"bottom-end",class:"i18n-selector"},{default:t(()=>[l(p,{name:"i-ri:translate"})]),_:1}),s("div",Ie,[s("div",qe,[s("img",{src:e(W),class:"logo"},null,8,Le),s("img",{src:e(Q),class:"banner"},null,8,Ne)]),N(l(L,{ref_key:"loginFormRef",ref:U,model:e(u),rules:e(le),class:"login-form"},{default:t(()=>[s("div",$e,[s("h3",Pe,"欢迎来到 "+h(e(X))+" ! 👋🏻",1)]),s("div",null,[l(m,{prop:"account"},{default:t(()=>[l(c,{modelValue:e(u).account,"onUpdate:modelValue":o[0]||(o[0]=a=>e(u).account=a),placeholder:e(g)("app.account"),type:"text",tabindex:"1"},{prefix:t(()=>[l(p,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1}),l(m,{prop:"password"},{default:t(()=>[l(c,{modelValue:e(u).password,"onUpdate:modelValue":o[1]||(o[1]=a=>e(u).password=a),type:"password",placeholder:e(g)("app.password"),tabindex:"2",autocomplete:"new-password","show-password":"",onKeyup:ke(F,["enter"])},{prefix:t(()=>[l(p,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1})]),s("div",ze,[l(ue,{modelValue:e(u).remember,"onUpdate:modelValue":o[2]||(o[2]=a=>e(u).remember=a)},{default:t(()=>[d(" 记住我 ")]),_:1},8,["modelValue"]),l(C,{type:"primary",underline:!1,onClick:o[3]||(o[3]=a=>v.value="reset")},{default:t(()=>[d(" 忘记密码了? ")]),_:1})]),l(y,{loading:e(w),type:"primary",size:"large",style:{width:"100%"},onClick:P(F,["prevent"])},{default:t(()=>[d(h(e(g)("app.login")),1)]),_:1},8,["loading"]),s("div",Be,[De,l(C,{type:"primary",underline:!1,onClick:o[4]||(o[4]=a=>v.value="register")},{default:t(()=>[d(" 创建新帐号 ")]),_:1})]),s("div",Ke,[l(pe,null,{default:t(()=>[d("演示账号一键登录")]),_:1}),l(y,{type:"primary",size:"small",plain:"",onClick:o[5]||(o[5]=a=>B("admin"))},{default:t(()=>[d(" admin ")]),_:1}),l(y,{size:"small",plain:"",onClick:o[6]||(o[6]=a=>B("test"))},{default:t(()=>[d(" test ")]),_:1})])]),_:1},8,["model","rules"]),[[$,e(v)==="login"]]),N(l(L,{ref_key:"registerFormRef",ref:I,model:e(n),rules:e(te),class:"login-form","auto-complete":"on"},{default:t(()=>[Me,s("div",null,[l(m,{prop:"account"},{default:t(()=>[l(c,{modelValue:e(n).account,"onUpdate:modelValue":o[7]||(o[7]=a=>e(n).account=a),placeholder:"用户名",tabindex:"1"},{prefix:t(()=>[l(p,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue"])]),_:1}),l(m,{prop:"type"},{default:t(()=>[l(ce,{modelValue:e(n).type,"onUpdate:modelValue":o[8]||(o[8]=a=>e(n).type=a),placeholder:"注册方式",tabindex:"2"},{prefix:t(()=>[l(p,{name:"i-mdi:format-list-bulleted-type"})]),default:t(()=>[(E(),M(Ce,null,Ee(oe,a=>l(me,{label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(n).type==="phone"?(E(),A(m,{key:0,prop:"phoneNumber"},{default:t(()=>[l(c,{modelValue:e(n).phoneNumber,"onUpdate:modelValue":o[9]||(o[9]=a=>e(n).phoneNumber=a),placeholder:"手机号",tabindex:"3"},{prefix:t(()=>[l(p,{name:"i-ant-design:phone-outlined"})]),_:1},8,["modelValue"])]),_:1})):Z("",!0),e(n).type==="email"?(E(),A(m,{key:1,prop:"email"},{default:t(()=>[l(c,{modelValue:e(n).email,"onUpdate:modelValue":o[10]||(o[10]=a=>e(n).email=a),placeholder:"邮箱",tabindex:"3"},{prefix:t(()=>[l(p,{name:"i-mdi:email"})]),_:1},8,["modelValue"])]),_:1})):Z("",!0),l(m,{prop:"code"},{default:t(()=>[l(c,{modelValue:e(n).code,"onUpdate:modelValue":o[11]||(o[11]=a=>e(n).code=a),placeholder:"验证码",tabindex:"2"},{prefix:t(()=>[l(p,{name:"i-ic:baseline-verified-user"})]),append:t(()=>[l(y,{disabled:e(S),onClick:ae},{default:t(()=>[d(h(e(R)),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),l(m,{prop:"password"},{default:t(()=>[l(c,{modelValue:e(n).password,"onUpdate:modelValue":o[12]||(o[12]=a=>e(n).password=a),type:"password",placeholder:"密码",tabindex:"3","show-password":""},{prefix:t(()=>[l(p,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue"])]),_:1})]),l(y,{loading:e(w),type:"primary",size:"large",style:{width:"100%","margin-top":"20px"},onClick:P(ne,["prevent"])},{default:t(()=>[d(" 注册 ")]),_:1},8,["loading"]),s("div",Ae,[Ze,l(C,{type:"primary",underline:!1,onClick:o[13]||(o[13]=a=>v.value="login")},{default:t(()=>[d(" 去登录 ")]),_:1})])]),_:1},8,["model","rules"]),[[$,e(v)==="register"]]),N(l(L,{ref_key:"resetFormRef",ref:q,model:e(b),rules:e(re),class:"login-form"},{default:t(()=>[Oe,s("div",null,[l(m,{prop:"account"},{default:t(()=>[l(c,{modelValue:e(b).account,"onUpdate:modelValue":o[14]||(o[14]=a=>e(b).account=a),placeholder:e(g)("app.account"),type:"text",tabindex:"1"},{prefix:t(()=>[l(p,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1}),l(m,{prop:"code"},{default:t(()=>[l(c,{modelValue:e(b).code,"onUpdate:modelValue":o[15]||(o[15]=a=>e(b).code=a),placeholder:e(g)("app.code"),type:"text",tabindex:"2"},{prefix:t(()=>[l(p,{name:"i-ic:baseline-verified-user"})]),append:t(()=>[l(y,null,{default:t(()=>[d(h(e(g)("app.sendCaptcha")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),l(m,{prop:"newPassword"},{default:t(()=>[l(c,{modelValue:e(b).newPassword,"onUpdate:modelValue":o[16]||(o[16]=a=>e(b).newPassword=a),type:"password",placeholder:e(g)("app.newPassword"),tabindex:"3","show-password":""},{prefix:t(()=>[l(p,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1})]),l(y,{loading:e(w),type:"primary",size:"large",style:{width:"100%","margin-top":"20px"},onClick:P(ie,["prevent"])},{default:t(()=>[d(h(e(g)("app.check")),1)]),_:1},8,["loading"]),s("div",Te,[l(C,{type:"primary",underline:!1,onClick:o[17]||(o[17]=a=>v.value="login")},{default:t(()=>[d(h(e(g)("app.goLogin")),1)]),_:1})])]),_:1},8,["model","rules"]),[[$,e(v)==="reset"]])]),l(Re)])}}});typeof T=="function"&&T(j);const He=Fe(j,[["__scopeId","data-v-ee8521a2"]]);export{He as default};
