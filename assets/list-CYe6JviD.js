
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as pe,r as h,O as me,aO as fe,y as ge,l as ve,G as U,J as _e,b as u,q as be,o,e as I,g as n,w as l,az as N,s as F,F as V,v as $,f as r,h as d,H as _,j as k,aN as he,k as m,t as D,S as ke,N as ye,aQ as Ce,aR as we,ap as Ie,aI as Le,aJ as Be,aq as Ee,R as Se}from"./index-CfmU-pu3.js";import{_ as ze}from"./index-DogEUXOi.js";import{_ as Ne}from"./index.vue_vue_type_style_index_0_lang-CGnh8dKB.js";import{_ as Ve}from"./index.vue_vue_type_script_setup_true_lang-CHTqDO9P.js";import{a as $e}from"./financial_pm_log-Bw8jTjK6.js";import{_ as De}from"./index.vue_vue_type_script_setup_true_lang-BqznVTTY.js";import He from"./index-BwxIghuK.js";import{u as Me}from"./position_manage-Cj-nyQPW.js";import{u as Pe}from"./group_manage-Tk_T_VCH.js";import{u as xe}from"./useTabbar-C6FeXdnQ.js";import"./index-ocDIEdH9.js";import"./position_manage-BUzA0jEE.js";import"./group_manage-DVZxdCnF.js";const Ue=w=>(Le("data-v-5b3ce832"),w=w(),Be(),w),Fe=Ue(()=>D("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Re={class:"copyId tableSmall"},Ae={class:"id oneLine"},Te=pe({name:"financial_pm_log",__name:"list",setup(w){const L=Me(),B=h(),E=Pe(),H=h();me();const{pagination:b,getParams:R,onSizeChange:A,onCurrentChange:T,onSortChange:K}=fe();xe(),ge();const M=h(),P=h(),S=h([{label:"员工ID",prop:"id",sortable:!0,disableCheck:!1,checked:!0},{label:"用户名",prop:"userName",sortable:!0,disableCheck:!1,checked:!0},{label:"姓名",prop:"name",sortable:!0,disableCheck:!1,checked:!0},{label:"所属组",prop:"groupId",sortable:!0,disableCheck:!1,checked:!0},{label:"职位",prop:"positionId",sortable:!0,disableCheck:!1,checked:!0},{label:"待审提成",prop:"pendingBalance",sortable:!0,disableCheck:!1,checked:!0},{label:"可用提成",prop:"availableBalance",sortable:!0,disableCheck:!1,checked:!0}]),e=h({loading:!1,activeName:"myFinancial",tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],formMode:"drawer",formModeProps:{visible:!1,id:""},search:{page:1,limit:10,id:null,userName:"",name:"",positionId:null},batch:{enable:!1,selectionDataList:[]},dataList:[]});ve(async()=>{B.value=await(L==null?void 0:L.getPositionManage())||[],H.value=await(E==null?void 0:E.getGroupManage())||[],v(),e.value.formMode==="router"&&U.on("get-data-list",()=>{v()}),S.value.forEach(i=>{i.checked&&e.value.checkList.push(i.prop)})}),_e(()=>{e.value.formMode==="router"&&U.off("get-data-list")});function v(){try{e.value.loading=!0;const i={...R(),...e.value.search};$e.list(i).then(a=>{e.value.loading=!1,e.value.dataList=a.data.data,b.value.total=+a.data.total})}catch{}finally{e.value.loading=!1}}function O(i){M.value.showEdit(JSON.stringify(i))}function J(i){P.value.showEdit(i)}function j(){Object.assign(e.value.search,{page:1,limit:10,id:null,userName:"",name:"",positionId:null}),v()}function q(i){A(i).then(()=>{e.value.search.limit=i,v()})}function f(i=1){T(i).then(()=>{e.value.search.page=i,v()})}function G({prop:i,order:a}){K(i,a).then(()=>v())}return(i,a)=>{const z=u("ElInput"),y=u("ElFormItem"),Q=u("el-option"),W=u("el-select"),x=ye,C=u("ElButton"),X=u("ElForm"),Y=Ve,Z=u("ElDivider"),ee=Ne,ae=u("el-button"),le=Ce,te=we,ne=u("el-row"),oe=u("el-table-column"),g=u("ElTableColumn"),se=ze,c=u("el-text"),ie=u("el-empty"),re=u("ElTable"),ue=u("ElPagination"),de=Ie,ce=be("loading");return o(),I("div",{class:ke({"absolute-container":e.value.tableAutoHeight})},[n(de,null,{default:l(()=>[n(Y,{"show-toggle":!1},{default:l(({fold:t,toggle:p})=>[n(X,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:l(()=>[n(y,null,{default:l(()=>[n(z,{modelValue:e.value.search.id,"onUpdate:modelValue":a[0]||(a[0]=s=>e.value.search.id=s),placeholder:"员工ID",clearable:"",onKeydown:a[1]||(a[1]=N(s=>f(),["enter"])),onClear:a[2]||(a[2]=s=>f())},null,8,["modelValue"])]),_:1}),n(y,null,{default:l(()=>[n(z,{modelValue:e.value.search.userName,"onUpdate:modelValue":a[3]||(a[3]=s=>e.value.search.userName=s),placeholder:"用户名",clearable:"",onKeydown:a[4]||(a[4]=N(s=>f(),["enter"])),onClear:a[5]||(a[5]=s=>f())},null,8,["modelValue"])]),_:1}),n(y,null,{default:l(()=>[n(z,{modelValue:e.value.search.name,"onUpdate:modelValue":a[6]||(a[6]=s=>e.value.search.name=s),placeholder:"姓名",clearable:"",onKeydown:a[7]||(a[7]=N(s=>f(),["enter"])),onClear:a[8]||(a[8]=s=>f())},null,8,["modelValue"])]),_:1}),F(n(y,null,{default:l(()=>[n(W,{modelValue:e.value.search.positionId,"onUpdate:modelValue":a[9]||(a[9]=s=>e.value.search.positionId=s),"value-key":"",placeholder:"职位",clearable:"",filterable:"",onChange:a[10]||(a[10]=s=>f())},{default:l(()=>[(o(!0),I(V,null,$(B.value,s=>(o(),r(Q,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:2},1536),[[Ee,!t]]),n(y,null,{default:l(()=>[n(C,{type:"primary",onClick:a[11]||(a[11]=s=>f())},{icon:l(()=>[n(x,{name:"i-ep:search"})]),default:l(()=>[d(" 筛选 ")]),_:1}),n(C,{onClick:j},{icon:l(()=>[Fe]),default:l(()=>[d(" 重置 ")]),_:1}),n(C,{link:"",onClick:p},{icon:l(()=>[n(x,{name:t?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:l(()=>[d(" "+_(t?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),n(Z,{"border-style":"dashed"}),n(ne,null,{default:l(()=>[n(ee),n(te,null,{default:l(()=>[n(ae,{size:"default"},{default:l(()=>[d(" 导出 ")]),_:1}),n(le,{border:e.value.border,"onUpdate:border":a[12]||(a[12]=t=>e.value.border=t),tableAutoHeight:e.value.tableAutoHeight,"onUpdate:tableAutoHeight":a[13]||(a[13]=t=>e.value.tableAutoHeight=t),checkList:e.value.checkList,"onUpdate:checkList":a[14]||(a[14]=t=>e.value.checkList=t),columns:S.value,"onUpdate:columns":a[15]||(a[15]=t=>S.value=t),"line-height":e.value.lineHeight,"onUpdate:lineHeight":a[16]||(a[16]=t=>e.value.lineHeight=t),stripe:e.value.stripe,"onUpdate:stripe":a[17]||(a[17]=t=>e.value.stripe=t),style:{"margin-left":"12px"},onQueryData:v},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),F((o(),r(re,{border:e.value.border,size:e.value.lineHeight,stripe:e.value.stripe,class:"my-4",data:e.value.dataList,"highlight-current-row":"",height:"100%",onSortChange:G,onSelectionChange:a[18]||(a[18]=t=>e.value.batch.selectionDataList=t)},{empty:l(()=>[n(ie,{image:k(he),"image-size":300},null,8,["image"])]),default:l(()=>[n(oe,{align:"center",type:"selection"}),e.value.batch.enable?(o(),r(g,{key:0,type:"selection","show-overflow-tooltip":"",align:"center",fixed:""})):m("",!0),e.value.checkList.includes("id")?(o(),r(g,{key:1,"show-overflow-tooltip":"",align:"center",prop:"id",label:"员工ID"},{default:l(({row:t})=>[D("div",Re,[D("div",Ae,"ID: "+_(t.id),1),n(se,{class:"copy",content:t.id},null,8,["content"])])]),_:1})):m("",!0),e.value.checkList.includes("userName")?(o(),r(g,{key:2,"show-overflow-tooltip":"",align:"center",prop:"userName",label:"用户名"},{default:l(({row:t})=>[n(c,{class:"tableBig"},{default:l(()=>[d(_(t.userName?t.userName:"-"),1)]),_:2},1024)]),_:1})):m("",!0),e.value.checkList.includes("name")?(o(),r(g,{key:3,"show-overflow-tooltip":"",align:"center",prop:"name",label:"姓名"},{default:l(({row:t})=>[n(c,{class:"tableBig"},{default:l(()=>[d(_(t.name?t.name:"-"),1)]),_:2},1024)]),_:1})):m("",!0),e.value.checkList.includes("groupId")?(o(),r(g,{key:4,"show-overflow-tooltip":"",align:"center",prop:"groupId",width:"150",label:"所属组"},{default:l(({row:t})=>[t.groupId?(o(),r(c,{key:0},{default:l(()=>[(o(!0),I(V,null,$(H.value,p=>(o(),r(c,null,{default:l(()=>[t.groupId===p.id?(o(),r(c,{key:0},{default:l(()=>[n(c,{class:"tableBig"},{default:l(()=>[d(_(p.name?p.name:"-"),1)]),_:2},1024)]),_:2},1024)):m("",!0)]),_:2},1024))),256))]),_:2},1024)):(o(),r(c,{key:1},{default:l(()=>[d("-")]),_:1}))]),_:1})):m("",!0),e.value.checkList.includes("positionId")?(o(),r(g,{key:5,"show-overflow-tooltip":"",align:"center",prop:"positionId",width:"150",label:"职位"},{default:l(({row:t})=>[(o(!0),I(V,null,$(B.value,p=>(o(),r(c,null,{default:l(()=>[t.positionId===p.id?(o(),r(c,{key:0},{default:l(()=>[n(c,{class:"tableBig"},{default:l(()=>[d(_(p.name?p.name:"-"),1)]),_:2},1024)]),_:2},1024)):m("",!0)]),_:2},1024))),256))]),_:1})):m("",!0),e.value.checkList.includes("pendingBalance")?(o(),r(g,{key:6,"show-overflow-tooltip":"",align:"center",prop:"pendingBalance",label:"待审提成"},{default:l(({row:t})=>[n(c,{class:"tableBig"},{default:l(()=>[d(_(t.pendingBalance?t.pendingBalance:"-"),1)]),_:2},1024)]),_:1})):m("",!0),e.value.checkList.includes("availableBalance")?(o(),r(g,{key:7,"show-overflow-tooltip":"",align:"center",prop:"availableBalance",label:"可用提成"},{default:l(({row:t})=>[n(c,{class:"tableBig"},{default:l(()=>[d(_(t.availableBalance?t.availableBalance:"-"),1)]),_:2},1024)]),_:1})):m("",!0),n(g,{fixed:"right",align:"center",width:"200",label:"操作"},{default:l(({row:t})=>[n(C,{type:"primary",size:"small",plain:"",onClick:p=>J(t)},{default:l(()=>[d(" 财务日志 ")]),_:2},1032,["onClick"]),n(C,{type:"warning",size:"small",plain:"",onClick:p=>O(t)},{default:l(()=>[d(" 加减款 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","size","stripe","data"])),[[ce,e.value.loading]]),n(ue,{"current-page":k(b).page,total:k(b).total,"page-size":k(b).size,"page-sizes":k(b).sizes,layout:k(b).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:q,onCurrentChange:f},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),n(De,{ref_key:"plusMinusPaymentsRef",ref:M,onFetchData:v},null,512),n(He,{ref_key:"financeLogRef",ref:P},null,512)],2)}}}),la=Se(Te,[["__scopeId","data-v-5b3ce832"]]);export{la as default};
