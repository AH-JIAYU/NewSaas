
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{k as A,d as ge,aM as be,r as s,l as ve,a as n,al as he,o as f,b as S,f as e,w as t,am as H,F as D,n as ke,g as o,J as m,e as N,i as g,S as ye,aN as Ce,E as R,O as Se,aO as we,aP as ze,s as Ie,aK as Ee,aL as xe,I as Be,aE as De,_ as Te}from"./index-Bh_VDJMf.js";import{_ as Ue}from"./index.vue_vue_type_style_index_0_lang-IqCAp_e9.js";import{_ as Ve}from"./index.vue_vue_type_script_setup_true_lang-CfGfcJGh.js";import{U as Le}from"./user_supplier-lS8pTkAv.js";import"./user_supplier-wf7XFkH3.js";const T={list:p=>A.post("bill/getTenantSupplierBillList",p),changestatus:p=>A.post("bill/updateTenantSupplierBill",p)},$e=p=>(Ee("data-v-bbc8835b"),p=p(),xe(),p),Me=$e(()=>Be("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Fe=ge({name:"FinanceSupplierSettlementIndex",__name:"list",setup(p){const Y=Le(),{getParams:O,pagination:d,onSizeChange:j,onCurrentChange:q}=be(),J=s(""),U=s(!0);s();const w=s(!1),V=s([]),z=s(!0);s(!1);const I=s("default"),E=s(!1),K=s([]),L=["待收票","待支付","已支付","已拒绝"],Q=Y.payMethod,$=s([{label:"项目ID",prop:"ID",sortable:!0,disableCheck:!0,checked:!0}]),u=s({supplierId:"",billStatus:"",time:[],beginTime:"",endTime:""}),M=s([]);function G(i){K.value=i}function W(){Object.assign(u.value,{supplierId:0,billStatus:0,time:[],beginTime:"",endTime:""})}function X(i){j(i).then(()=>b())}function x(i=1){q(i).then(()=>b())}async function b(){U.value=!0;const i={...O(),...u.value},a=await T.list(i);M.value=a.data.tenantSupplierBillInfoList,d.value.total=a.data.total,U.value=!1}async function k(i,a){a===3?Ce.prompt("请说明拒绝的理由","说明",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/.{2,}/,inputErrorMessage:"请输理由-最少2为字符"}).then(async y=>{(await T.changestatus({id:i,type:a,notes:y.value})).status===1&&R.success({message:"操作成功"}),b()}):((await T.changestatus({id:i,type:a})).status===1&&R.success({message:"操作成功"}),b())}return ve(()=>{b()}),(i,a)=>{const y=n("el-input"),C=n("el-form-item"),Z=n("el-date-picker"),ee=n("el-option"),te=n("el-select"),F=Se,B=n("ElButton"),le=n("ElFormItem"),ae=n("el-form"),ne=Ve,oe=n("ElDivider"),se=Ue,v=n("el-button"),ie=we,ue=ze,P=n("el-row"),_=n("el-col"),c=n("el-table-column"),re=n("ElTableColumn"),pe=n("el-empty"),ce=n("el-table"),me=n("ElPagination"),de=Ie,_e=he("loading");return f(),S("div",{class:ye({"absolute-container":w.value})},[e(de,null,{default:t(()=>[e(ne,{"show-toggle":!1},{default:t(({fold:l,toggle:h})=>[e(ae,{model:u.value,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:t(()=>[e(C,{label:""},{default:t(()=>[e(y,{modelValue:u.value.supplierId,"onUpdate:modelValue":a[0]||(a[0]=r=>u.value.supplierId=r),clearable:"",placeholder:"供应商ID"},null,8,["modelValue"])]),_:1}),H(e(C,null,{default:t(()=>[e(Z,{modelValue:u.value.time,"onUpdate:modelValue":a[1]||(a[1]=r=>u.value.time=r),type:"datetimerange","unlink-panels":"","range-separator":"-","start-placeholder":"创建开始日期","end-placeholder":"创建结束日期","value-format":"YYYY-MM-DD hh:mm:ss",size:"default"},null,8,["modelValue"])]),_:2},1536),[[De,!l]]),e(C,{label:""},{default:t(()=>[e(te,{modelValue:u.value.billStatus,"onUpdate:modelValue":a[2]||(a[2]=r=>u.value.billStatus=r),placeholder:"状态",clearable:"",filterable:""},{default:t(()=>[(f(),S(D,null,ke(L,(r,fe)=>e(ee,{key:r,label:r,value:fe+1},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(le,null,{default:t(()=>[e(B,{type:"primary",onClick:a[3]||(a[3]=r=>x())},{icon:t(()=>[e(F,{name:"i-ep:search"})]),default:t(()=>[o(" 筛选 ")]),_:1}),e(B,{onClick:W},{icon:t(()=>[Me]),default:t(()=>[o(" 重置 ")]),_:1}),e(B,{disabled:"",link:"",onClick:h},{icon:t(()=>[e(F,{name:l?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:t(()=>[o(" "+m(l?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),e(oe,{"border-style":"dashed"}),e(P,{gutter:24},{default:t(()=>[e(se),e(ue,null,{default:t(()=>[e(v,{size:"default",onClick:a[4]||(a[4]=()=>{})},{default:t(()=>[o(" 导出 ")]),_:1}),e(ie,{border:z.value,"onUpdate:border":a[5]||(a[5]=l=>z.value=l),tableAutoHeight:w.value,"onUpdate:tableAutoHeight":a[6]||(a[6]=l=>w.value=l),checkList:V.value,"onUpdate:checkList":a[7]||(a[7]=l=>V.value=l),columns:$.value,"onUpdate:columns":a[8]||(a[8]=l=>$.value=l),"line-height":I.value,"onUpdate:lineHeight":a[9]||(a[9]=l=>I.value=l),stripe:E.value,"onUpdate:stripe":a[10]||(a[10]=l=>E.value=l),style:{"margin-left":"12px"},onQueryData:x},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),H((f(),N(ce,{ref_key:"tableSortRef",ref:J,style:{"margin-top":"10px"},"row-key":"id",data:M.value,border:z.value,size:I.value,stripe:E.value,onSelectionChange:G},{empty:t(()=>[e(pe,{description:"暂无数据"})]),default:t(()=>[e(c,{type:"expand"},{default:t(l=>[e(P,{gutter:20,style:{margin:"10px 0"}},{default:t(()=>[e(_,{span:1}),e(_,{span:3},{default:t(()=>[o(" 付款方式: "+m(g(Q)[l.row.billStatus-1].label),1)]),_:2},1024),e(_,{span:3},{default:t(()=>[o("账户名称: "+m(l.row.accountName),1)]),_:2},1024),e(_,{span:3},{default:t(()=>[o("收款账号: "+m(l.row.collectionAccount),1)]),_:2},1024),e(_,{span:3},{default:t(()=>[o("银行名称: "+m(l.row.bankName),1)]),_:2},1024),e(_,{span:3},{default:t(()=>[o("结算周期: "+m(l.row.settlementCycle),1)]),_:2},1024)]),_:2},1024)]),_:1}),e(c,{prop:"supplierId","show-overflow-tooltip":"",align:"center",label:"供应商ID"}),e(c,{prop:"billAmount","show-overflow-tooltip":"",align:"center",label:"账单日期"}),e(c,{prop:"billAmount","show-overflow-tooltip":"",align:"center",label:"账单金额"}),e(c,{prop:"taxesFees","show-overflow-tooltip":"",align:"center",label:"税费"}),e(c,{prop:"payAmount","show-overflow-tooltip":"",align:"center",label:"实付金额"}),e(re,{align:"center","show-overflow-tooltip":"",prop:"",label:"状态"},{default:t(({row:l})=>[o(m(L[l.billStatus-1]),1)]),_:1}),e(c,{align:"center",label:"操作",width:"170"},{default:t(({row:l})=>[l.billStatus===1?(f(),N(v,{key:0,size:"small",plain:"",type:"primary",onClick:h=>k(l.id,1)},{default:t(()=>[o(" 确认收票 ")]),_:2},1032,["onClick"])):l.billStatus===2?(f(),S(D,{key:1},[e(v,{size:"small",plain:"",onClick:h=>k(l.id,2)},{default:t(()=>[o(" 支付 ")]),_:2},1032,["onClick"]),e(v,{size:"small",plain:"",type:"danger",onClick:h=>k(l.id,3)},{default:t(()=>[o(" 拒绝 ")]),_:2},1032,["onClick"])],64)):(f(),S(D,{key:2},[o("- ")],64)),e(v,{size:"small",plain:"",type:"danger",onClick:h=>k(l.id,3)},{default:t(()=>[o(" 测试 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[_e,!1]]),e(me,{"current-page":g(d).page,total:g(d).total,"page-size":g(d).size,"page-sizes":g(d).sizes,layout:g(d).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:X,onCurrentChange:x},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1})],2)}}}),Ye=Te(Fe,[["__scopeId","data-v-bbc8835b"]]);export{Ye as default};
