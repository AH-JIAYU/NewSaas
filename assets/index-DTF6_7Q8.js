
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as ee}from"./index-C48sCu8v.js";import{d as te,r,M as S,o as ae,a2 as i,a as d,i as p,f as s,w as o,b as u,g as _,h as l,c as h,N as j,O as C,t as O,k as b,j as L,aj as N,aH as le,aI as oe,y as ne}from"./index-BrSnL6vk.js";import{a as se}from"./position_manage-DhUUvwk_.js";import ie from"./index-KCxex1-s.js";import"./index-Cx9rMYbu.js";import"./clipboard-B-psL98e.js";import"./department-DURepy-M.js";import"./configuration_role-DCITzesU.js";import"./tenant_role-B5Gd5RB9.js";import"./configuration_manager-OXMSXlQO.js";const x=v=>(le("data-v-b02315b1"),v=v(),oe(),v),re={key:0,style:{"margin-top":"-2.1875rem"}},de=x(()=>u("span",{class:"project-name"},"项目",-1)),ue={class:"project-content"},ce={style:{display:"flex"}},me={style:{"font-weight":"500"}},pe={style:{"margin-left":"10px"}},fe=x(()=>u("div",{class:"i-ic:round-plus w-1.3em h-1.3em"},null,-1)),_e={style:{display:"flex","justify-content":"space-between","align-items":"center",padding:"0 1rem"}},ve=x(()=>u("div",{class:"i-ic:round-plus w-1.3em h-1.3em"},null,-1)),ge={class:"flex-c"},ye=te({__name:"index",emits:["userData"],setup(v,{expose:R,emit:q}){const f=r(!1),z=r([]);r([]),r();const a=r({type:1,tenantStaffList:[],roleList:[],title:"",project:[],form:{chargeUserId:null,chargeUserName:""}}),I=r("all"),D=r([]),T=S({page:1,limit:10,id:null,name:"",active:null}),U=S({page:1,limit:10,id:"",userName:"",active:null,departmentId:null,positionId:null}),M=S({chargeUserId:[{required:!0,message:"请选择负责人",trigger:"change"}]}),c=r(!1);async function $(n,e,m){a.value.form.chargeUserId=m[0].userId,await F(),a.value.type=1,f.value=!0,z.value=[],a.value.title=e,a.value.invitationType=1,m&&(a.value.project=m)}const H=async n=>{if(n!=="all"){U.positionId=n;const e=await N.list(U);e.data&&(a.value.tenantStaffList=e.data.data)}else{const e=await N.getTenantStaffList();e.data&&(a.value.tenantStaffList=e.data)}},F=async()=>{const n=await N.getTenantStaffList();a.value.tenantStaffList=n.data};function B(){f.value=!1,V.value.resetFields(),Object.assign(a.value,{type:1,tenantStaffList:[],roleList:[],title:"",project:[],form:{chargeUserId:null,chargeUserName:""}}),Object.assign(U,{page:1,limit:10,id:"",userName:"",active:null,departmentId:null,positionId:null}),Object.assign(T,{page:1,limit:10,id:null,name:"",active:null})}const P=q,V=r();function A(){V.value.validate(n=>{if(n){let e="";e=a.value.tenantStaffList.find(w=>w.id===a.value.form.chargeUserId).userName;let k={chargeUserId:a.value.form.chargeUserId,chargeUserName:e,invitationType:a.value.invitationType};B(),P("userData",k)}})}const g=r([]),G=n=>{g.value=n};return ae(async()=>{const n=await se.list(T);n.data&&(D.value=n.data.data)}),R({showEdit:$}),(n,e)=>{const m=i("el-badge"),k=ee,w=i("el-collapse-item"),J=i("el-collapse"),E=i("el-radio-button"),K=i("el-radio-group"),Q=i("el-option"),y=i("el-button"),W=i("el-select"),X=i("el-form-item"),Y=i("ElForm"),Z=i("el-dialog");return d(),p("div",null,[s(Z,{modelValue:l(f),"onUpdate:modelValue":e[6]||(e[6]=t=>b(f)?f.value=t:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:l(a).title,class:"userClass"},{footer:o(()=>[u("div",ge,[s(y,{onClick:B},{default:o(()=>[_(" 取消 ")]),_:1}),s(y,{type:"primary",onClick:A},{default:o(()=>[_(" 确认 ")]),_:1})])]),default:o(()=>[l(a).project.length!=0?(d(),p("div",re,[l(a).project.length>1?(d(),h(J,{key:0,modelValue:l(g),"onUpdate:modelValue":e[0]||(e[0]=t=>b(g)?g.value=t:null),onChange:G},{default:o(()=>[s(w,{name:"1"},{title:o(()=>[de,s(m,{value:l(a).project.length,max:99,class:"item"},null,8,["value"])]),default:o(()=>[u("div",ue,[(d(!0),p(j,null,C(l(a).project,t=>(d(),p("div",{key:t.id},[u("div",ce,[u("span",me,O(t.tenantName),1),u("span",pe,"ID:"+O(t.tenantId),1),s(k,{content:t.tenantId},null,8,["content"])])]))),128))])]),_:1})]),_:1},8,["modelValue"])):L("",!0)])):L("",!0),s(Y,{ref_key:"formRef",ref:V,rules:l(M),model:l(a).form,style:{"margin-top":"0.625rem"}},{default:o(()=>[s(X,{label:"负责人",prop:"chargeUserId"},{default:o(()=>[s(W,{modelValue:l(a).form.chargeUserId,"onUpdate:modelValue":e[4]||(e[4]=t=>l(a).form.chargeUserId=t),"value-key":"",placeholder:"请选择负责人",clearable:"",filterable:""},{header:o(()=>[s(K,{modelValue:l(I),"onUpdate:modelValue":e[1]||(e[1]=t=>b(I)?I.value=t:null),size:"large",style:{"max-width":"34.375rem"},onChange:H},{default:o(()=>[s(E,{label:"全部",value:"all"}),(d(!0),p(j,null,C(l(D),t=>(d(),h(E,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),empty:o(()=>[u("div",_e,[_(" 暂无数据 "),s(y,{type:"primary",link:"",onClick:e[3]||(e[3]=t=>c.value=!0),size:"small"},{default:o(()=>[_(" 快捷新增 "),ve]),_:1})])]),default:o(()=>[(d(!0),p(j,null,C(l(a).tenantStaffList,t=>(d(),h(Q,{key:t.id,label:t.userName,value:t.id},null,8,["label","value"]))),128)),s(y,{class:"buttonClass",onClick:e[2]||(e[2]=t=>c.value=!0),size:"small"},{default:o(()=>[_(" 快捷新增 "),fe]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["rules","model"]),l(c)?(d(),h(ie,{key:1,modelValue:l(c),"onUpdate:modelValue":e[5]||(e[5]=t=>b(c)?c.value=t:null),onSuccess:F},null,8,["modelValue"])):L("",!0)]),_:1},8,["modelValue","title"])])}}}),Le=ne(ye,[["__scopeId","data-v-b02315b1"]]);export{Le as default};
