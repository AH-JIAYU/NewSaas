
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as ke}from"./index-CwhLUGEm.js";import{d as Ce,r as p,ao as we,aN as Ie,k as Ne,a1 as A,a as s,l as xe,o as r,b as _,p as I,f as t,w as n,aC as N,n as D,e as m,D as f,g as c,F as x,q as E,j as k,i as C,an as j,aO as G,E as Ee,L as Se,aP as Ve,P as Le,ap as K}from"./index-DcqAaBhZ.js";import{u as De,a as ze,D as Ue}from"./index-6EkbMU3-.js";import Me from"./index-BsGlxLxq.js";import{u as He}from"./department-CZx5TpIo.js";import"./tenant_role-CBY2cve3.js";import"./configuration_role-BHsutYSu.js";import"./position_manage-QlMqtdlO.js";import"./group_manage-Djhm8EI5.js";import"./department-DWyOnTsN.js";const Pe={class:"absolute-container"},Re={class:"page-main"},Be={class:"custom-tree-node"},Te=["title"],$e={class:"code"},Ae={class:"dictionary-container"},O=Ce({name:"user",__name:"index",setup(je){const F=De(),z=p(),q=ze(),U=p(),J=we(),M=p([]),Q=He(),H=p(),{pagination:v,getParams:W,onSizeChange:X,onCurrentChange:Y,onSortChange:Z}=Ie(),P=p([{label:"项目ID",prop:"projectOrMemberGroupId",sortable:!0,checked:!0},{label:"项目名称",prop:"projectOrMemberGroupName",sortable:!0,checked:!0},{label:"项目IR",prop:"ir",sortable:!0,checked:!0},{label:"项目实际IR",prop:"projectIr",sortable:!0,checked:!0}]),R=p(),B=p(),u=p({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),ee=p(),a=p({loading:!1,tableAutoHeight:!1,border:!0,stripe:!1,lineHeight:"default",checkList:[],search:{catalogueId:"",chineseName:""},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}});async function b(){u.value.loading=!0,a.value.sea=!0,a.value.search.catalogueId="";const o={...u.value.search},l=await j.list(o);a.value.dataList=l.data,v.value.total=l.data.length,u.value.loading=!1}Ne(async()=>{M.value=await J.getCountry(),H.value=await Q.getDepartment(),U.value=await q.getPositionManage(),z.value=await F.getGroupManage(),b()}),A(()=>u.value.search,o=>{R.value.filter(o)});function ae(o,l){return o?l.label.includes(o):!0}function te(o){return new Promise(l=>{G.confirm(`确认${o.active?"禁用":"启用"}「${o.name}」吗？`,"确认信息").then(()=>{u.value.loading=!0,j.edit({id:o.id,account:null,name:null,sex:null,phoneNumber:null,active:!o.active}).then(()=>(Ee.success({message:`${o.active?"禁用":"启用"}成功`,center:!0}),b(),u.value.loading=!1,l(!0))).catch(()=>(u.value.loading=!1,l(!1)))}).catch(()=>l(!1))})}function le(o){v.value.page=1,a.value.search.catalogueId=o.id}A(()=>a.value.search.catalogueId,()=>{g()});async function g(){a.value.loading=!0,{...W(),...a.value.search}}function ne(o){X(o).then(()=>g())}function T(o=1){Y(o).then(()=>g())}function oe({prop:o,order:l}){Z(o,l).then(()=>g())}function ie(o){a.value.dialog.id="",a.value.dialog.visible=!0,a.value.dialog.level=1,o&&(a.value.dialog.parentId=o.id,a.value.dialog.level=Number(o.level)+1)}function re(o){G.confirm(`确认将「${o.name}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{}).catch(()=>{})}function se(o){a.value.row=JSON.stringify(o),a.value.dialog.id=o.id,a.value.dialog.parentId=o.parentId,a.value.dialog.visible=!0}function ue(o){B.value.showEdit(o)}return(o,l)=>{const S=Se,y=s("ElButton"),w=s("ElInput"),de=s("ElTree"),ce=s("ElScrollbar"),pe=s("ElSpace"),V=s("el-button"),$=s("el-col"),me=Ve,ge=s("el-row"),d=s("ElTableColumn"),h=s("el-text"),fe=s("el-tag"),ve=s("ElSwitch"),he=s("el-empty"),_e=s("ElTable"),be=s("ElPagination"),ye=ke,L=xe("loading");return r(),_("div",Pe,[I("div",Re,[t(ye,{"hide-left-side-toggle":""},{leftSide:n(()=>[t(w,{modelValue:u.value.search.chineseName,"onUpdate:modelValue":l[0]||(l[0]=e=>u.value.search.chineseName=e),placeholder:"请输入关键词筛选",clearable:"",class:"search",onKeydown:N(b,["enter"])},{append:n(()=>[t(y,{onClick:b},{default:n(()=>[t(S,{name:"i-ep:search"})]),_:1})]),_:1},8,["modelValue"]),t(ce,{class:"tree"},{default:n(()=>[D((r(),m(de,{ref_key:"dictionaryRef",ref:R,data:u.value.tree,"filter-node-method":ae,"default-expand-all":"",onNodeClick:le},{default:n(({node:e,data:i})=>[I("div",Be,[I("div",{class:"label",title:e.label},f(i.chineseName),9,Te),I("div",$e,f(i.englishName),1)])]),_:1},8,["data","filter-node-method"])),[[L,u.value.loading]])]),_:1})]),default:n(()=>[D((r(),_("div",Ae,[t(pe,null,{default:n(()=>[t(w,{modelValue:a.value.search.chineseName,"onUpdate:modelValue":l[1]||(l[1]=e=>a.value.search.chineseName=e),placeholder:"员工ID",clearable:"",style:{width:"200px"},onKeydown:N(g,["enter"])},null,8,["modelValue"]),t(w,{modelValue:a.value.search.chineseName,"onUpdate:modelValue":l[2]||(l[2]=e=>a.value.search.chineseName=e),placeholder:"用户名",clearable:"",style:{width:"200px"},onKeydown:N(g,["enter"])},null,8,["modelValue"]),t(w,{modelValue:a.value.search.chineseName,"onUpdate:modelValue":l[3]||(l[3]=e=>a.value.search.chineseName=e),placeholder:"状态",clearable:"",style:{width:"200px"},onKeydown:N(g,["enter"])},null,8,["modelValue"]),t(y,{type:"primary",onClick:g},{icon:n(()=>[t(S,{name:"i-ep:search"})]),_:1}),t(y,{onClick:g},{icon:n(()=>[t(S,{name:"i-ep:refresh"})]),_:1})]),_:1}),t(ge,{style:{"margin-bottom":"5px"},gutter:24},{default:n(()=>[t($,{span:10},{default:n(()=>[t(V,{type:"primary",size:"default",onClick:ie},{default:n(()=>[c(" 新增 ")]),_:1}),t(V,{size:"default",onClick:re},{default:n(()=>[c(" 重置密码 ")]),_:1})]),_:1}),t($,{style:{display:"flex","justify-content":"flex-end"},span:14},{default:n(()=>[t(V,{size:"default",onClick:l[4]||(l[4]=()=>{})},{default:n(()=>[c(" 导出 ")]),_:1}),t(me,{border:a.value.border,"onUpdate:border":l[5]||(l[5]=e=>a.value.border=e),tableAutoHeight:a.value.tableAutoHeight,"onUpdate:tableAutoHeight":l[6]||(l[6]=e=>a.value.tableAutoHeight=e),checkList:a.value.checkList,"onUpdate:checkList":l[7]||(l[7]=e=>a.value.checkList=e),columns:P.value,"onUpdate:columns":l[8]||(l[8]=e=>P.value=e),"line-height":a.value.lineHeight,"onUpdate:lineHeight":l[9]||(l[9]=e=>a.value.lineHeight=e),stripe:a.value.stripe,"onUpdate:stripe":l[10]||(l[10]=e=>a.value.stripe=e),style:{"margin-left":"12px"},onQueryData:T},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),D((r(),m(_e,{ref_key:"dictionaryItemRef",ref:ee,data:a.value.dataList,border:a.value.border,size:a.value.lineHeight,stripe:a.value.stripe,"highlight-current-row":"",height:"100%",onSortChange:oe,onSelectionChange:l[11]||(l[11]=e=>a.value.selectionDataList=e),"row-key":"id","default-expand-all":""},{empty:n(()=>[t(he,{description:"暂无数据"})]),default:n(()=>[t(d,{type:"selection",align:"center",fixed:""}),t(d,{align:"center",width:"180",prop:"id",label:"员工ID"}),t(d,{align:"center",width:"150",prop:"userName",label:"用户名"},{default:n(({row:e})=>[t(h,null,{default:n(()=>[c(f(e.userName?e.userName:"-"),1)]),_:2},1024)]),_:1}),t(d,{align:"center",width:"150",prop:"name",label:"姓名"}),t(d,{prop:"country",label:"国家",width:"150",align:"center"},{default:n(({row:e})=>[(r(!0),_(x,null,E(M.value,i=>(r(),_("div",{key:i.id,class:"mx-1"},[i.code===e.country?(r(),m(fe,{key:0,type:"primary",class:"mx-1"},{default:n(()=>[c(f(i.chineseName),1)]),_:2},1024)):k("",!0)]))),128))]),_:1}),t(d,{align:"center",width:"180",prop:"phone",label:"电话号码"},{default:n(({row:e})=>[c(f(e.phone?e.phone:"-"),1)]),_:1}),t(d,{align:"center",width:"180",prop:"email",label:"邮箱"},{default:n(({row:e})=>[c(f(e.email?e.email:"-"),1)]),_:1}),t(d,{align:"center",prop:"departmentId",label:"部门"},{default:n(({row:e})=>[(r(!0),_(x,null,E(H.value,i=>(r(),m(h,null,{default:n(()=>[e.departmentId===i.id?(r(),m(h,{key:0},{default:n(()=>[c(f(i.name?i.name:"-"),1)]),_:2},1024)):k("",!0)]),_:2},1024))),256))]),_:1}),t(d,{align:"center",prop:"positionId",label:"职位"},{default:n(({row:e})=>[(r(!0),_(x,null,E(U.value,i=>(r(),m(h,null,{default:n(()=>[e.positionId===i.id?(r(),m(h,{key:0},{default:n(()=>[c(f(i.name?i.name:"-"),1)]),_:2},1024)):k("",!0)]),_:2},1024))),256))]),_:1}),t(d,{align:"center",prop:"groupId",label:"小组"},{default:n(({row:e})=>[(r(!0),_(x,null,E(z.value,i=>(r(),m(h,null,{default:n(()=>[e.groupId===i.id?(r(),m(h,{key:0},{default:n(()=>[c(f(i.name?i.name:"-"),1)]),_:2},1024)):k("",!0)]),_:2},1024))),256))]),_:1}),t(d,{align:"center",prop:"remark",label:"状态"},{default:n(e=>[t(ve,{modelValue:e.row.active,"onUpdate:modelValue":i=>e.row.active=i,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>te(e.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1}),t(d,{label:"操作",fixed:"right",width:"150",align:"center"},{default:n(e=>[t(y,{type:"primary",size:"small",plain:"",onClick:i=>se(e.row)},{default:n(()=>[c(" 编辑 ")]),_:2},1032,["onClick"]),t(y,{type:"primary",size:"small",plain:"",onClick:i=>ue(e.row)},{default:n(()=>[c(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[L,a.value.loading]]),t(be,{"current-page":C(v).page,total:C(v).total,"page-size":C(v).size,"page-sizes":C(v).sizes,layout:C(v).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:ne,onCurrentChange:T},null,8,["current-page","total","page-size","page-sizes","layout"])])),[[L,u.value.loading]])]),_:1}),a.value.dialog.visible?(r(),m(Ue,{key:0,id:a.value.dialog.id,modelValue:a.value.dialog.visible,"onUpdate:modelValue":l[12]||(l[12]=e=>a.value.dialog.visible=e),"catalogue-id":a.value.search.catalogueId,"parent-id":a.value.dialog.parentId,level:a.value.dialog.level,tree:u.value.tree,dataList:a.value.dataList,row:a.value.row,onSuccess:b},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):k("",!0),t(Me,{ref_key:"detailRef",ref:B},null,512)])])}}});typeof K=="function"&&K(O);const Ze=Le(O,[["__scopeId","data-v-c88ff5f0"]]);export{Ze as default};
