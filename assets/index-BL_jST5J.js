
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as ue}from"./index-Cj--Y3Gl.js";import{d as pe,aN as ve,r as w,n as ge,W as T,a as c,q as me,o as h,b as fe,y as d,f as l,w as o,g as y,az as M,s as E,e as N,z as m,ay as D,ao as P,i as f,aM as _e,j as R,aO as z,E as S,_ as he,aH as ye,aI as be,L as Ce,am as U}from"./index-DOVN-_R9.js";import ke from"./index-B6e7KXEq.js";import Ie from"./index-D27tjIXo.js";import{a as b}from"./tenantDictionary-64WUgHBn.js";const G=C=>(ye("data-v-055f5a40"),C=C(),be(),C),we={class:"absolute-container"},Ee={class:"page-main"},Ne={class:"custom-tree-node"},De=["title"],ze={class:"code"},Se={class:"actions"},Le={class:"dictionary-container"},Ve=G(()=>d("div",{class:"i-ic:round-plus w-1.3em h-1.3em",style:{color:"white"}},null,-1)),xe=[Ve],$e={style:{color:"#333333"}},Be={style:{color:"#333333"}},Te={style:{color:"#333333"}},Me={class:"dictionary-container"},Pe=G(()=>d("div",{class:"empty"},"请在左侧新增或选择一个字典",-1)),Re=[Pe],K=pe({name:"tenantDictionary",__name:"index",setup(C){const{pagination:v,getParams:O,onSizeChange:F,onCurrentChange:J,onSortChange:j}=ve(),L=w(),n=w({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),q=w(),a=w({loading:!1,search:{catalogueId:"",chineseName:""},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}});async function k(){try{n.value.loading=!0,a.value.search.catalogueId="";const e={...n.value.search},t=await b.list(e);n.value.tree=t.data,n.value.loading=!1}catch{}finally{n.value.loading=!1}}ge(()=>{k()}),T(()=>n.value.search,e=>{L.value.filter(e)});function A(e,t){return e?t.label.includes(e):!0}function V(e){n.value.currentData=e,n.value.dialog.parentId=(e==null?void 0:e.id)??"",n.value.dialog.id="",n.value.dialog.visible=!0}function H(e,t){n.value.currentNode=e,n.value.currentData=t,n.value.row=JSON.stringify(t),n.value.dialog.parentId=e.parent.data.id??"",n.value.dialog.id=t.id,n.value.dialog.visible=!0}function W(e,t){z.confirm(`确认删除「${t.chineseName}」吗？`,"确认信息").then(()=>{b.delete(t.id).then(()=>{S.success({message:"删除成功",center:!0});const s=e.parent,_=s.data.children||s.data,u=_.findIndex(I=>I.id===t.id);_.splice(u,1),n.value.tree=[...n.value.tree]})})}function Q(e){v.value.page=1,a.value.search.catalogueId=e.id}T(()=>a.value.search.catalogueId,()=>{r()});async function r(){try{a.value.loading=!0;const e={...O(),...a.value.search},t=await b.itemlist(e);a.value.loading=!1,a.value.dataList=t.data,a.value.dataList.forEach(s=>{s.enableLoading=!1}),v.value.total=t.data.length}catch{}finally{a.value.loading=!1}}function X(e){F(e).then(()=>r())}function Y(e=1){J(e).then(()=>r())}function Z({prop:e,order:t}){j(e,t).then(()=>r())}function x(e){a.value.dialog.id="",a.value.dialog.visible=!0,a.value.dialog.level=1,e&&(a.value.dialog.parentId=e.id,a.value.dialog.level=Number(e.level)+1)}function ee(e){a.value.row=JSON.stringify(e),a.value.dialog.id=e.id,a.value.dialog.parentId=e.parentId,a.value.dialog.visible=!0}function ae(e){z.confirm(`确认删除「${e.chineseName}」吗？`,"确认信息").then(()=>{b.itemdelete([e.id]).then(()=>{r(),S.success({message:"删除成功",center:!0})})}).catch(()=>{})}function te(e){const t=e.map(s=>s.id);z.confirm(`确认删除选中的 ${e.length} 条数据吗？`,"确认信息").then(()=>{b.itemdelete(t).then(()=>{r(),S.success({message:"删除成功",center:!0})})}).catch(()=>{})}return(e,t)=>{const s=c("ElButton"),_=c("ElButtonGroup"),u=he,I=c("ElInput"),le=c("ElTree"),ne=c("ElScrollbar"),ie=c("ElSpace"),g=c("ElTableColumn"),oe=c("el-button"),se=c("el-empty"),de=c("ElTable"),ce=c("ElPagination"),re=ue,$=me("loading");return h(),fe("div",we,[d("div",Ee,[l(re,{"hide-left-side-toggle":""},{leftSide:o(()=>[l(_,{class:"btns"},{default:o(()=>[l(s,{type:"primary",class:"add",onClick:t[0]||(t[0]=i=>V())},{default:o(()=>[y(" 新增字典 ")]),_:1})]),_:1}),l(I,{modelValue:n.value.search.chineseName,"onUpdate:modelValue":t[1]||(t[1]=i=>n.value.search.chineseName=i),placeholder:"请输入关键词筛选字典",clearable:"",class:"search",onKeydown:M(k,["enter"])},{append:o(()=>[l(s,{onClick:k},{default:o(()=>[l(u,{name:"i-ep:search"})]),_:1})]),_:1},8,["modelValue"]),l(ne,{class:"tree"},{default:o(()=>[E((h(),N(le,{ref_key:"dictionaryRef",ref:L,data:n.value.tree,"filter-node-method":A,"default-expand-all":"",onNodeClick:Q},{default:o(({node:i,data:p})=>[d("div",Ne,[d("div",{class:"label",title:i.label},m(p.chineseName),9,De),d("div",ze,m(p.englishName),1),d("div",Se,[l(_,null,{default:o(()=>[l(s,{type:"primary",plain:"",size:"default",onClick:D(B=>V(p),["stop"])},{icon:o(()=>[l(u,{name:"i-ep:plus"})]),_:2},1032,["onClick"]),l(s,{type:"info",plain:"",size:"default",onClick:D(B=>H(i,p),["stop"])},{icon:o(()=>[l(u,{name:"i-ep:edit"})]),_:2},1032,["onClick"]),l(s,{type:"danger",plain:"",size:"default",onClick:D(B=>W(i,p),["stop"])},{icon:o(()=>[l(u,{name:"i-ep:delete"})]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])),[[$,n.value.loading]])]),_:1})]),default:o(()=>[E(d("div",Le,[l(ie,{wrap:""},{default:o(()=>[d("div",{class:"button-bule",onClick:t[2]||(t[2]=i=>x())},xe),l(s,{type:"danger",disabled:!a.value.selectionDataList.length,style:{"background-color":"#FB6868"},onClick:t[3]||(t[3]=i=>te(a.value.selectionDataList))},{icon:o(()=>[l(u,{name:"i-ep:delete"})]),_:1},8,["disabled"]),l(I,{modelValue:a.value.search.chineseName,"onUpdate:modelValue":t[4]||(t[4]=i=>a.value.search.chineseName=i),placeholder:"请输入关键词筛选字典项",clearable:"",style:{width:"200px"},onKeydown:M(r,["enter"])},null,8,["modelValue"]),l(s,{onClick:r},{icon:o(()=>[l(u,{name:"i-ep:search"})]),_:1})]),_:1}),E((h(),N(de,{ref_key:"dictionaryItemRef",ref:q,data:a.value.dataList,stripe:"","highlight-current-row":"",height:"100%",onSortChange:Z,onSelectionChange:t[5]||(t[5]=i=>a.value.selectionDataList=i),"row-key":"id","default-expand-all":""},{empty:o(()=>[l(se,{image:f(_e),"image-size":300},null,8,["image"])]),default:o(()=>[l(g,{type:"selection",align:"left",fixed:""}),l(g,{prop:"chineseName",label:"中文名称"},{default:o(({row:i})=>[d("span",$e,m(i.chineseName),1)]),_:1}),l(g,{prop:"englishName",label:"英文名称"},{default:o(({row:i})=>[d("span",Be,m(i.englishName),1)]),_:1}),l(g,{prop:"remark",label:"备注"},{default:o(({row:i})=>[d("span",Te,m(i.remark),1)]),_:1}),l(g,{label:"键值",align:"left",width:"150"},{default:o(i=>[l(oe,{size:"small",plain:""},{default:o(()=>[y(m(i.row.code),1)]),_:2},1024)]),_:1}),l(g,{label:"操作",width:"250",align:"left"},{default:o(i=>[l(s,{type:"primary",size:"small",plain:"",onClick:p=>x(i.row)},{default:o(()=>[y(" 新增子项 ")]),_:2},1032,["onClick"]),l(s,{type:"warning",size:"small",plain:"",onClick:p=>ee(i.row)},{default:o(()=>[y(" 编辑 ")]),_:2},1032,["onClick"]),l(s,{type:"danger",size:"small",plain:"",onClick:p=>ae(i.row)},{default:o(()=>[y(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,a.value.loading]]),l(ce,{"current-page":f(v).page,total:f(v).total,"page-size":f(v).size,"page-sizes":f(v).sizes,layout:f(v).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:X,onCurrentChange:Y},null,8,["current-page","total","page-size","page-sizes","layout"])],512),[[P,a.value.search.catalogueId]]),E(d("div",Me,Re,512),[[P,!a.value.search.catalogueId]])]),_:1}),n.value.dialog.visible?(h(),N(ke,{key:0,id:n.value.dialog.id,modelValue:n.value.dialog.visible,"onUpdate:modelValue":t[6]||(t[6]=i=>n.value.dialog.visible=i),row:n.value.row,"parent-id":n.value.dialog.parentId,tree:n.value.tree,onGetList:k},null,8,["id","modelValue","row","parent-id","tree"])):R("",!0),a.value.dialog.visible?(h(),N(Ie,{key:1,id:a.value.dialog.id,modelValue:a.value.dialog.visible,"onUpdate:modelValue":t[7]||(t[7]=i=>a.value.dialog.visible=i),"catalogue-id":a.value.search.catalogueId,"parent-id":a.value.dialog.parentId,level:a.value.dialog.level,tree:n.value.tree,dataList:a.value.dataList,row:a.value.row,onSuccess:r},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):R("",!0)])])}}});typeof U=="function"&&U(K);const Je=Ce(K,[["__scopeId","data-v-055f5a40"]]);export{Je as default};
