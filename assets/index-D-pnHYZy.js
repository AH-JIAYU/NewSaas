
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as we,aM as Re,aj as ke,r as m,c as f,$ as M,n as Ce,a as s,q as Ie,o as c,b as O,f as o,w as t,i as e,az as Q,F as je,t as xe,e as u,g as i,A as p,B as C,s as G,aN as Ne,v as B,aH as Se,j as g,O as Le,_ as Te,aP as ze,aQ as De,ao as Ee,aI as Ve,aJ as Fe,M as Ue}from"./index-BsetXtVy.js";import{_ as Be}from"./index.vue_vue_type_style_index_0_lang-Dr4ERv78.js";import{_ as Pe}from"./index.vue_vue_type_script_setup_true_lang-Bhf5-vMq.js";import{q as $e,a as J}from"./index-DsVqp4_1.js";import{u as qe}from"./user_customer-Cfi20glU.js";/* empty css                      */const W=j=>(Ve("data-v-799b71af"),j=j(),Fe(),j),He=W(()=>B("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Ae={style:{"padding-left":"20px"}},Ke=W(()=>B("br",null,null,-1)),Me={class:"tableBig"},Oe=we({name:"preInvestigationRecords",__name:"index",setup(j){const X=qe(),{getParams:Y,pagination:_,onSizeChange:Z,onCurrentChange:ee}=Re(),{t:l}=ke(),x=m(!1),P=m([]);m("");const h=m([]),N=m(!0),S=m(!0),L=m("default"),T=m(!1),te=m();m("formSearch-preInvestigationRecords");const z=m([{prop:"projectId",label:f(()=>l("preRecords.projectID")),sortable:!0,checked:!0},{prop:"projectName",label:f(()=>l("preRecords.projectName")),sortable:!0,checked:!0},{prop:"allocationType",label:f(()=>l("preRecords.allocationType")),sortable:!0,checked:!0},{prop:"passNumber",label:f(()=>l("preRecords.number")),sortable:!0,checked:!0},{prop:"passRate",label:f(()=>l("preRecords.throughRate")),sortable:!0,checked:!0}]),d=M({projectId:"",projectName:"",allocationType:[]}),$=m(),v=M({allocationTypeList:[f(()=>l("preRecords.undistributed")),f(()=>l("preRecords.supplier")),f(()=>l("preRecords.internalStation"))],surveyStatusList:["完成","被甄别","配额满","安全终止","未完成"],viceStatusList:["待审","免审","过IR","时间果断","超时完成","超量完成","审核成功","审核失败","数据冻结","时间段过载","ip不一致","id重复参与","和解"],customerList:[],vipList:[],vipGroupList:[],tenantSupplierList:[],expandedRows:[]});function oe(){d.pageNo=1,I()}function ae(r){Z(r).then(()=>I())}function le(r=1){ee(r).then(()=>I())}async function q(r){const n=v.expandedRows.indexOf(r.id);if(n!==-1?v.expandedRows.splice(n,1):v.expandedRows.push(r.id),!r.children){const k=await J.childList({projectId:r.projectId});r.children=k.data.projectScreenMemberChildInfoList}}function ne(r){$.value.showEdit(r)}const R=f(()=>P.value.filter(n=>!!(n.projectId.includes(d.projectId)||n.projectName.includes(d.projectName)||d.allocationType===n.allocationType)).slice((_.value.page-1)*_.value.size,_.value.page*_.value.size));async function I(){try{x.value=!0;const r={...Y(),...d},{data:n,status:k}=await J.list(r);n&&k===1&&(P.value=n.projectSurveyScreenInfoList,_.value.total=n.projectSurveyScreenInfoList.length),x.value=!1}catch{}finally{x.value=!1}}function re(){Object.assign(d,{projectId:"",projectName:"",allocationType:""}),I()}return Ce(async()=>{v.customerList=await X.getCustomerList(),z.value.forEach(r=>{r.checked&&h.value.push(r.prop)}),I(),te.value=[{index:1,show:!0,type:"input",modelName:"projectId",placeholder:f(()=>l("preRecords.projectID"))},{index:2,show:!0,type:"input",modelName:"projectName",placeholder:f(()=>l("preRecords.projectName"))},{index:3,show:!0,type:"select",modelName:"allocationType",placeholder:f(()=>l("preRecords.allocationType")),option:"allocationType",optionLabel:"label",optionValue:"value",multiple:!0}]}),(r,n)=>{const k=s("ElInput"),D=s("ElFormItem"),se=s("el-option"),ie=s("el-select"),H=Te,E=s("ElButton"),ce=s("ElForm"),pe=Pe,de=s("ElDivider"),ue=Be,A=s("el-button"),me=ze,fe=De,_e=s("el-row"),w=s("el-table-column"),V=s("el-text"),F=s("ElTableColumn"),K=s("el-table"),U=s("el-tag"),ye=s("el-empty"),he=s("ElPagination"),be=Ee,ge=Ie("loading");return c(),O("div",{class:Le({"absolute-container":e(T)})},[o(be,null,{default:t(()=>[o(pe,{"show-toggle":!1},{default:t(({fold:a,toggle:y})=>[o(ce,{model:e(d),size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:t(()=>[o(D,null,{default:t(()=>[o(k,{modelValue:e(d).projectId,"onUpdate:modelValue":n[0]||(n[0]=b=>e(d).projectId=b),placeholder:e(l)("preRecords.projectID"),clearable:"",onKeydown:Q(e(R),["enter"]),onClear:e(R)},null,8,["modelValue","placeholder","onKeydown","onClear"])]),_:1}),o(D,null,{default:t(()=>[o(k,{modelValue:e(d).projectName,"onUpdate:modelValue":n[1]||(n[1]=b=>e(d).projectName=b),placeholder:e(l)("preRecords.projectName"),clearable:"",onKeydown:Q(e(R),["enter"]),onClear:e(R)},null,8,["modelValue","placeholder","onKeydown","onClear"])]),_:1}),o(D,null,{default:t(()=>[o(ie,{modelValue:e(d).allocationType,"onUpdate:modelValue":n[2]||(n[2]=b=>e(d).allocationType=b),"value-key":"",placeholder:e(l)("preRecords.allocationType"),clearable:"",filterable:""},{default:t(()=>[(c(!0),O(je,null,xe(e(v).allocationTypeList,(b,ve)=>(c(),u(se,{key:b,label:b,value:ve+1},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1}),o(D,null,{default:t(()=>[o(E,{type:"primary",onClick:e(R)},{icon:t(()=>[o(H,{name:"i-ep:search"})]),default:t(()=>[i(" "+p(e(l)("preRecords.sift")),1)]),_:1},8,["onClick"]),o(E,{onClick:re},{icon:t(()=>[He]),default:t(()=>[i(" "+p(e(l)("preRecords.reset")),1)]),_:1}),o(E,{link:"",onClick:y},{icon:t(()=>[o(H,{name:a?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:t(()=>[i(" "+p(a?e(l)("preRecords.expand"):e(l)("preRecords.collapse")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),o(de,{"border-style":"dashed"}),o(_e,null,{default:t(()=>[o(ue),o(fe,null,{default:t(()=>[o(A,{size:"default"},{default:t(()=>[i(p(e(l)("preRecords.export")),1)]),_:1}),o(me,{border:e(N),"onUpdate:border":n[3]||(n[3]=a=>C(N)?N.value=a:null),tableAutoHeight:e(T),"onUpdate:tableAutoHeight":n[4]||(n[4]=a=>C(T)?T.value=a:null),checkList:e(h),"onUpdate:checkList":n[5]||(n[5]=a=>C(h)?h.value=a:null),columns:e(z),"onUpdate:columns":n[6]||(n[6]=a=>C(z)?z.value=a:null),"line-height":e(L),"onUpdate:lineHeight":n[7]||(n[7]=a=>C(L)?L.value=a:null),stripe:e(S),"onUpdate:stripe":n[8]||(n[8]=a=>C(S)?S.value=a:null),style:{"margin-left":"12px"},onQueryData:oe},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),G((c(),u(K,{border:e(N),data:e(R),size:e(L),stripe:e(S),"row-key":"id","expand-row-keys":e(v).expandedRows,onExpandChange:q},{empty:t(()=>[o(ye,{image:e(Ne),"image-size":300},null,8,["image"])]),default:t(()=>[o(w,{type:"expand",width:"55"},{default:t(a=>[o(K,{data:a.row.children,"highlight-current-row":"",class:"hide-table-header",border:"",height:"100%"},{default:t(()=>[o(w,{width:"55"}),o(w,{width:"300",prop:"memberChildName",label:"名称+ID",align:"left"},{default:t(y=>[B("div",Ae,[o(V,{class:"fontC-System"},{default:t(()=>[i(p(y.row.memberChildName),1)]),_:2},1024),Ke,G(o(V,{type:"danger",class:"fontC-System"},{default:t(()=>[i("随机id:"+p(y.row.randomIdentityId),1)]),_:2},1536),[[Se,y.row.randomIdentityId]])])]),_:1}),o(F,{prop:"status",label:"状态",align:"left"},{default:t(y=>[y.row.status===1?(c(),u(V,{key:0,type:"success",class:"fontC-System"},{default:t(()=>[i("前置问卷通过")]),_:1})):(c(),u(V,{key:1,type:"danger",class:"fontC-System"},{default:t(()=>[i("前置问卷未通过")]),_:1}))]),_:1}),o(F,{width:"200",align:"left",fixed:"right",label:"操作"},{default:t(y=>[o(E,{type:"primary",size:"small",plain:"",onClick:b=>ne(y.row)},{default:t(()=>[i(" 查看问卷详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:2},1032,["data"])]),_:1}),e(h).includes("projectId")?(c(),u(w,{key:0,width:"300",align:"left",prop:"projectId","show-overflow-tooltip":"",label:e(l)("preRecords.projectID")},null,8,["label"])):g("",!0),e(h).includes("projectName")?(c(),u(w,{key:1,align:"left",prop:"projectName","show-overflow-tooltip":"",label:e(l)("preRecords.projectName")},{default:t(({row:a})=>[B("div",Me,p(a.projectName),1)]),_:1},8,["label"])):g("",!0),e(h).includes("allocationType")?(c(),u(w,{key:2,align:"left","show-overflow-tooltip":"",width:"100",label:e(l)("preRecords.allocationType")},{default:t(({row:a})=>[a.allocationType===1?(c(),u(U,{key:0,effect:"plain",type:"info",class:"mx-1"},{default:t(()=>[i(p(e(l)("preRecords.undistributed")),1)]),_:1})):g("",!0),a.allocationType===2?(c(),u(U,{key:1,effect:"dark",style:{"background-color":"#fb6868",border:"none"},class:"mx-1",type:"primary"},{default:t(()=>[i(p(e(l)("preRecords.supplier")),1)]),_:1})):g("",!0),a.allocationType===3?(c(),u(U,{key:2,effect:"dark",style:{"background-color":"#05c9be",border:"none"},class:"mx-1",type:"warning"},{default:t(()=>[i(p(e(l)("preRecords.internalStation")),1)]),_:1})):g("",!0),a.allocationType===4?(c(),u(U,{key:3,effect:"dark",style:{"background-color":"#ffac54",border:"none"},class:"mx-1",type:"warning"},{default:t(()=>[i(p(e(l)("preRecords.partner")),1)]),_:1})):g("",!0)]),_:1},8,["label"])):g("",!0),e(h).includes("passNumber")?(c(),u(w,{key:3,align:"left","show-overflow-tooltip":"",label:e(l)("preRecords.number")},{default:t(({row:a})=>[i(p(a.passNumber||0)+"/ "+p(a.submitNumber||0),1)]),_:1},8,["label"])):g("",!0),e(h).includes("passRate")?(c(),u(F,{key:4,align:"left","show-overflow-tooltip":"",prop:"passRate",label:e(l)("preRecords.throughRate")},{default:t(({row:a})=>[i(p(a.passRate.toFixed(2)+"%"),1)]),_:1},8,["label"])):g("",!0),o(F,{align:"left","show-overflow-tooltip":"",prop:"",fixed:"right",label:e(l)("preRecords.control"),width:"200"},{default:t(({row:a})=>[o(A,{plain:"",type:"primary",size:"small",onClick:y=>q(a)},{default:t(()=>[i(p(e(v).expandedRows.includes(a.id)?"收起":"展开"),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["border","data","size","stripe","expand-row-keys"])),[[ge,e(x)]]),o(he,{"current-page":e(_).page,total:e(_).total,"page-size":e(_).size,"page-sizes":e(_).sizes,layout:e(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:ae,onCurrentChange:le},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),o($e,{ref_key:"questionnaireDetailsRef",ref:$},null,512)],2)}}}),Ze=Ue(Oe,[["__scopeId","data-v-799b71af"]]);export{Ze as default};
