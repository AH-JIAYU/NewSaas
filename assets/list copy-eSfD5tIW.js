
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as J,v as O,aN as q,r as C,o as K,e as M,m as Q,a3 as r,al as W,b as d,j as X,g as l,w as n,h as c,i as t,c as m,k as p,a4 as Y,aM as Z,B as ee,ai as P,aS as te,_ as ae,ao as oe,aH as ne,aI as le,f as se,z as ie}from"./index-BnVk3aZr.js";import{_ as re}from"./index.vue_vue_type_script_setup_true_lang-Co9SYjj1.js";import de from"./index-BdmeAfwp.js";import{a as b}from"./configuration_homepageSetting-DDxBMS-p.js";import"./index-DHwAUrv9.js";const ce=g=>(ne("data-v-27713cd3"),g=g(),le(),g),ue=ce(()=>se("div",{style:{"font-size":"1.5rem"}},"官网首页模版库",-1)),me=J({name:"TenantTenantHomepageSettingList",__name:"list copy",setup(g){O();const{pagination:f,getParams:k,onSizeChange:z,onCurrentChange:E,onSortChange:w}=q(),y=C(),e=C({loading:!1,tableAutoHeight:!1,formMode:"dialog",formModeProps:{visible:!1,row:"",id:""},search:{title:""},batch:{enable:!1,selectionDataList:[]},dataList:[],controlDataList:[]});function i(){try{e.value.loading=!0;const a={...k(),...e.value.search.title&&{title:e.value.search.title}};b.list(a).then(o=>{e.value.loading=!1,o.data&&o.status===1&&(e.value.controlDataList=o.data.controlData,e.value.controlDataList.forEach(h=>{h.isCommon=!0}),e.value.dataList=o.data.data,e.value.dataList=[...e.value.dataList,...e.value.controlDataList],f.value.total=Number(o.data.total))})}catch{}finally{e.value.loading=!1}}function S(a){z(a).then(()=>i())}function D(a=1){E(a).then(()=>i())}function L({prop:a,order:o}){w(a,o).then(()=>i())}function B(){e.value.formModeProps.id="",e.value.formModeProps.row="",e.value.formModeProps.visible=!0}function x(a){e.value.formModeProps.id=a.id,e.value.formModeProps.row=JSON.stringify(a),e.value.formModeProps.visible=!0}function T(a,o="编辑"){y.value.showEdit(a,o)}async function $(a){(await b.setHomePageTemplate({templateId:a.id})).status===1&&P.success({message:"设置成功",center:!0}),i()}function I(a){te.confirm(`确认删除「${a.title}」吗？`,"确认信息").then(()=>{b.del({id:a.id}).then(o=>{o.status===1&&P.success({message:"删除成功",center:!0}),i()})}).catch(()=>{})}return K(()=>{i(),e.value.formMode==="router"&&M.on("get-data-list",()=>{i()})}),Q(()=>{e.value.formMode==="router"&&M.off("get-data-list")}),(a,o)=>{const h=r("ElDivider"),N=ae,u=r("ElButton"),V=r("ElButtonGroup"),H=r("ElSpace"),_=r("ElTableColumn"),R=r("el-button"),A=r("el-empty"),G=r("ElTable"),U=r("ElPagination"),j=oe,F=W("loading");return d(),X("div",{class:ee({"absolute-container":t(e).tableAutoHeight})},[l(j,null,{default:n(()=>[ue,l(h,{"border-style":"dashed"}),l(H,{wrap:""},{default:n(()=>[l(u,{type:"primary",size:"default",onClick:B},{icon:n(()=>[l(N,{name:"i-ep:plus"})]),default:n(()=>[c(" 新增首页设置 ")]),_:1}),t(e).batch.enable?(d(),m(u,{key:0,size:"default",disabled:!t(e).batch.selectionDataList.length},{default:n(()=>[c(" 单个批量操作按钮 ")]),_:1},8,["disabled"])):p("",!0),t(e).batch.enable?(d(),m(V,{key:1},{default:n(()=>[l(u,{size:"default",disabled:!t(e).batch.selectionDataList.length},{default:n(()=>[c(" 批量操作按钮组1 ")]),_:1},8,["disabled"]),l(u,{size:"default",disabled:!t(e).batch.selectionDataList.length},{default:n(()=>[c(" 批量操作按钮组2 ")]),_:1},8,["disabled"])]),_:1})):p("",!0)]),_:1}),Y((d(),m(G,{class:"my-4",data:t(e).dataList,stripe:"","highlight-current-row":"",height:"100%",onSortChange:L,onSelectionChange:o[0]||(o[0]=s=>t(e).batch.selectionDataList=s)},{empty:n(()=>[l(A,{image:t(Z),"image-size":300},null,8,["image"])]),default:n(()=>[t(e).batch.enable?(d(),m(_,{key:0,type:"selection",align:"left",fixed:""})):p("",!0),l(_,{prop:"title",label:"标题"}),l(_,{prop:"isSet",align:"left",label:"是否使用"},{default:n(({row:s})=>[l(R,{type:s.isSet?"primary":"",size:"small",onClick:v=>$(s)},{default:n(()=>[c("使用 ")]),_:2},1032,["type","onClick"])]),_:1}),l(_,{label:"操作",width:"350",align:"left",fixed:"right"},{default:n(s=>[l(u,{type:"primary",size:"small",plain:"",onClick:v=>T(s.row)},{default:n(()=>[c(" 设计模板 ")]),_:2},1032,["onClick"]),s.row.isCommon?p("",!0):(d(),m(u,{key:0,type:"primary",size:"small",plain:"",onClick:v=>x(s.row)},{default:n(()=>[c(" 编辑标题 ")]),_:2},1032,["onClick"])),!s.row.isSet&&!s.row.isCommon?(d(),m(u,{key:1,type:"danger",size:"small",plain:"",onClick:v=>I(s.row)},{default:n(()=>[c(" 删除 ")]),_:2},1032,["onClick"])):p("",!0)]),_:1})]),_:1},8,["data"])),[[F,t(e).loading]]),l(U,{"current-page":t(f).page,total:t(f).total,"page-size":t(f).size,"page-sizes":t(f).sizes,layout:t(f).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:S,onCurrentChange:D},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),t(e).formMode==="dialog"||t(e).formMode==="drawer"?(d(),m(re,{key:0,id:t(e).formModeProps.id,row:t(e).formModeProps.row,modelValue:t(e).formModeProps.visible,"onUpdate:modelValue":o[1]||(o[1]=s=>t(e).formModeProps.visible=s),mode:t(e).formMode,onSuccess:i},null,8,["id","row","modelValue","mode"])):p("",!0),l(de,{ref_key:"homePageRef",ref:y,onFetchData:i},null,512)],2)}}}),ve=ie(me,[["__scopeId","data-v-27713cd3"]]);export{ve as default};
