
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as he,aH as ke,r as d,a4 as P,G as ye,a as i,al as Se,o as s,b as x,f as e,w as l,F as A,n as Y,e as m,am as F,g as v,I as T,j as b,i as h,R as Le,ak as Ve,N as we,aJ as Ce,aK as Ne,s as Ie,aF as Be,aG as ze,l as Ee,aM as j,_ as Ge}from"./index-B5L6_y5W.js";import{_ as Ue}from"./index.vue_vue_type_style_index_0_lang-BHk6-HW4.js";import{_ as De}from"./index.vue_vue_type_script_setup_true_lang-DaLBVlL_.js";import{_ as xe}from"./index.vue_vue_type_script_setup_true_lang-BlcEYkVy.js";import{s as Fe}from"./apiLoading-CscGKk70.js";import{u as Te,a as q}from"./survey_vip-eRsM251S.js";import{u as Me}from"./survey_vipLevel-DDphKgGd.js";import{u as Re}from"./survey_vipGroup-BwxscXai.js";import"./index.vue_vue_type_script_setup_true_lang-DKytk8wy.js";import"./index.vue_vue_type_script_setup_true_lang-JCYNsOMA.js";import"./otherFunctions_basicDictionary-oE1KF9hr.js";import"./basicDictionary-Ccx2D09q.js";import"./stagedData-41GiWlbY.js";import"./survey_vipGroup-DUGh_zx1.js";const $e=k=>(Be("data-v-3a967eeb"),k=k(),ze(),k),He=$e(()=>Ee("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Pe=he({name:"SurveyVipList",__name:"list",setup(k){const O=Me(),J=Re(),K=Te(),{pagination:_,getParams:Q,onSizeChange:W,onCurrentChange:X}=ke(),w=d(!1),g=P({list:[],vipLevelList:[],vipGroupList:[]}),Z=d(),C=d(),N=d(!0),I=d(!1),B=d("default"),u=d([]),z=d(!1),E=d([{prop:"memberId",label:"会员id",checked:!0,sprtable:!0},{prop:"memberNickname",label:"会员名称",checked:!0,sprtable:!0},{prop:"memberName",label:"会员姓名",checked:!0,sprtable:!0},{prop:"memberLevelName",label:"会员等级",checked:!0,sprtable:!0},{prop:"memberGroupName",label:"会员组",checked:!0,sprtable:!0},{prop:"B2B|B2C",label:"B2B|B2C",checked:!0,sprtable:!0},{prop:"memberStatus",label:"会员状态",checked:!0,sprtable:!0},{prop:"createName",label:"创建人",checked:!0,sprtable:!0},{prop:"createTime",label:"创建日期",checked:!0,sprtable:!0}]),n=P({memberName:"",memberLevelId:"",memberStatus:"",memberGroupId:"",beginTime:"",endTime:"",time:[]});function ee(){C.value.showEdit()}function te(r){C.value.showEdit(r)}async function M(r,a){const G={memberId:a,memberStatus:r},{status:f}=await Fe(q.changestatus(G));f===1&&Ve.success({message:"修改成功"}),K.NickNameList=null,y()}function y(){_.value.page=1,S()}function le(r){W(r).then(()=>S())}function R(r=1){X(r).then(()=>S())}async function S(){w.value=!0;const r={...Q(),...n};n.time&&n.time.length&&(r.beginTime=n.time[0]||"",r.endTime=n.time[1]||"");const a=await q.list(r);g.list=a.data.getMemberInfoList,_.value.total=a.data.total,w.value=!1}function ae(){Object.assign(n,{memberName:"",memberLevelId:"",memberStatus:"",memberGroupId:"",beginTime:"",endTime:"",time:[]}),y()}function oe(r){Z.value=r}return ye(async()=>{E.value.forEach(r=>{r.checked&&u.value.push(r.prop)}),S(),g.vipLevelList=await O.getLevelNameList(),g.vipGroupList=await J.getGroupNameList()}),(r,a)=>{const G=i("el-input"),f=i("el-form-item"),L=i("el-option"),U=i("el-select"),ne=i("el-date-picker"),$=we,D=i("ElButton"),re=i("ElFormItem"),se=i("ElForm"),ie=De,me=i("ElDivider"),V=i("el-button"),ue=Ue,pe=Ce,ce=Ne,de=i("el-row"),p=i("el-table-column"),H=i("ElSwitch"),be=i("el-empty"),ve=i("el-table"),_e=i("ElPagination"),fe=Ie,ge=Se("loading");return s(),x("div",{class:Le({"absolute-container":z.value})},[e(fe,null,{default:l(()=>[e(ie,{"show-toggle":!1},{default:l(({fold:t,toggle:c})=>[e(se,{model:n,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:l(()=>[e(f,{label:""},{default:l(()=>[e(G,{modelValue:n.memberName,"onUpdate:modelValue":a[0]||(a[0]=o=>n.memberName=o),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"会员ID、会员名称、姓名"},null,8,["modelValue"])]),_:1}),e(f,{label:""},{default:l(()=>[e(U,{modelValue:n.memberLevelId,"onUpdate:modelValue":a[1]||(a[1]=o=>n.memberLevelId=o),clearable:"",placeholder:"会员等级"},{default:l(()=>[(s(!0),x(A,null,Y(g.vipLevelList,o=>(s(),m(L,{key:o.memberLevelId,label:o.levelNameOrAdditionRatio,value:o.memberLevelId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(f,{label:""},{default:l(()=>[e(U,{modelValue:n.memberStatus,"onUpdate:modelValue":a[2]||(a[2]=o=>n.memberStatus=o),clearable:"",placeholder:"会员状态"},{default:l(()=>[e(L,{label:"关闭",value:1}),e(L,{label:"开启",value:2})]),_:1},8,["modelValue"])]),_:1}),F(e(f,{label:""},{default:l(()=>[e(U,{modelValue:n.memberGroupId,"onUpdate:modelValue":a[3]||(a[3]=o=>n.memberGroupId=o),clearable:"",placeholder:"所属会员组"},{default:l(()=>[(s(!0),x(A,null,Y(g.vipGroupList,o=>(s(),m(L,{key:o.memberGroupId,label:o.memberGroupName,value:o.memberGroupId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:2},1536),[[j,!t]]),F(e(f,null,{default:l(()=>[e(ne,{modelValue:n.time,"onUpdate:modelValue":a[4]||(a[4]=o=>n.time=o),type:"datetimerange","unlink-panels":"","range-separator":"-","start-placeholder":"创建开始日期","end-placeholder":"创建结束日期","value-format":"YYYY-MM-DD hh:mm:ss",size:"default"},null,8,["modelValue"])]),_:2},1536),[[j,!t]]),e(re,null,{default:l(()=>[e(D,{type:"primary",onClick:a[5]||(a[5]=o=>R())},{icon:l(()=>[e($,{name:"i-ep:search"})]),default:l(()=>[v(" 筛选 ")]),_:1}),e(D,{onClick:ae},{icon:l(()=>[He]),default:l(()=>[v(" 重置 ")]),_:1}),e(D,{link:"",onClick:c},{icon:l(()=>[e($,{name:t?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:l(()=>[v(" "+T(t?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),e(me,{"border-style":"dashed"}),e(de,null,{default:l(()=>[e(ue,null,{default:l(()=>[e(V,{type:"primary",size:"default",onClick:ee},{default:l(()=>[v(" 新增 ")]),_:1})]),_:1}),e(ce,null,{default:l(()=>[e(V,{size:"default"},{default:l(()=>[v(" 导出 ")]),_:1}),e(pe,{border:N.value,"onUpdate:border":a[6]||(a[6]=t=>N.value=t),tableAutoHeight:z.value,"onUpdate:tableAutoHeight":a[7]||(a[7]=t=>z.value=t),checkList:u.value,"onUpdate:checkList":a[8]||(a[8]=t=>u.value=t),columns:E.value,"onUpdate:columns":a[9]||(a[9]=t=>E.value=t),"line-height":B.value,"onUpdate:lineHeight":a[10]||(a[10]=t=>B.value=t),stripe:I.value,"onUpdate:stripe":a[11]||(a[11]=t=>I.value=t),style:{"margin-left":"12px"},onQueryData:y},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),F((s(),m(ve,{border:N.value,data:g.list,size:B.value,stripe:I.value,onSelectionChange:oe},{empty:l(()=>[e(be,{class:"vab-data-empty",description:"暂无数据"})]),default:l(()=>[u.value.includes("memberId")?(s(),m(p,{key:0,align:"center",prop:"memberId","show-overflow-tooltip":"",label:"会员ID"})):b("",!0),u.value.includes("memberNickname")?(s(),m(p,{key:1,align:"center",prop:"memberNickname","show-overflow-tooltip":"",label:"会员名称"})):b("",!0),u.value.includes("memberName")?(s(),m(p,{key:2,align:"center",prop:"memberName","show-overflow-tooltip":"",label:"会员姓名"})):b("",!0),u.value.includes("memberLevelName")?(s(),m(p,{key:3,align:"center",prop:"memberLevelName","show-overflow-tooltip":"",label:"会员等级"})):b("",!0),u.value.includes("memberGroupName")?(s(),m(p,{key:4,align:"center",prop:"memberGroupName","show-overflow-tooltip":"",label:"会员组"})):b("",!0),u.value.includes("B2B|B2C")?(s(),m(p,{key:5,align:"center","show-overflow-tooltip":"",label:"B2B|B2C"},{default:l(({row:t})=>[v(T(t.b2bStatus&&t.b2bStatus===2?"√":"×")+" | "+T(t.b2cStatus&&t.b2cStatus===2?"√":"×"),1)]),_:1})):b("",!0),u.value.includes("memberStatus")?(s(),m(p,{key:6,align:"center","show-overflow-tooltip":"",label:"会员状态"},{default:l(({row:t})=>[t.memberStatus===3?(s(),m(H,{key:0,modelValue:t.memberStatus,"onUpdate:modelValue":c=>t.memberStatus=c,"inline-prompt":"","inactive-value":2,"active-value":3,"inactive-text":"启用","active-text":"待审核",onChange:c=>M(c,t.memberId)},null,8,["modelValue","onUpdate:modelValue","onChange"])):(s(),m(H,{key:1,modelValue:t.memberStatus,"onUpdate:modelValue":c=>t.memberStatus=c,"inline-prompt":"","inactive-value":1,"active-value":2,"inactive-text":"禁用","active-text":"启用",onChange:c=>M(c,t.memberId)},null,8,["modelValue","onUpdate:modelValue","onChange"]))]),_:1})):b("",!0),u.value.includes("createName")?(s(),m(p,{key:7,align:"center",prop:"createName","show-overflow-tooltip":"",label:"创建人"})):b("",!0),u.value.includes("createTime")?(s(),m(p,{key:8,align:"center",prop:"createTime","show-overflow-tooltip":"",label:"创建日期"})):b("",!0),e(p,{align:"center",label:"操作","show-overflow-tooltip":"",width:"180"},{default:l(({row:t})=>[e(V,{size:"small",plain:"",type:"primary",onClick:c=>te(t)},{default:l(()=>[v(" 编辑 ")]),_:2},1032,["onClick"]),e(V,{size:"small",plain:"",type:"primary"},{default:l(()=>[v(" 加减款 ")]),_:1})]),_:1})]),_:1},8,["border","data","size","stripe"])),[[ge,w.value]]),e(_e,{"current-page":h(_).page,total:h(_).total,"page-size":h(_).size,"page-sizes":h(_).sizes,layout:h(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:le,onCurrentChange:R},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e(xe,{ref_key:"editRef",ref:C,onFetchData:y},null,512)],2)}}}),at=Ge(Pe,[["__scopeId","data-v-3a967eeb"]]);export{at as default};
