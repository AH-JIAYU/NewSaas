
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ne,aO as oe,r as s,a4 as le,c as ie,k as se,a as _,p as ce,o as c,b as re,f as l,w as o,g as m,i as t,B as v,q as ue,e as u,aN as pe,s as g,j as p,A as h,O as de,aP as fe,E as _e,aQ as me,aR as be,be as ge,ap as ve,M as he}from"./index-BldWHR0B.js";import{_ as ye}from"./index-DIDwC4VK.js";import{_ as ke}from"./index.vue_vue_type_style_index_0_lang-DoBpcuTP.js";import Ie from"./index-DyjN0ekF.js";import{_ as we}from"./index.vue_vue_type_script_setup_true_lang-uYca2ICn.js";import{c as N}from"./user_cooperation-ColLrKwS.js";import"./index-CC9vZY03.js";const Be={class:"tableBig"},Ce={class:"copyId tableSmall"},Te={class:"id oneLine"},ze={class:"tableBig"},Se={class:"tableBig"},Re={class:"tableBig"},xe={class:"tableBig"},Ee=ne({name:"cooperation",__name:"index",setup(Le){const{pagination:b,getParams:P,onSizeChange:D,onCurrentChange:A}=oe(),y=s(!1),S=s([]),R=s(),x=s(),$=s(),k=s(!1),I=s(!1),w=s(!1),B=s("default"),r=s([]),C=s([{label:"租户id",checked:!0,sortable:!0,prop:"beInvitationTenantId"},{label:"租户名称",checked:!0,sortable:!0,prop:"beInvitationTenantName"},{label:"状态",checked:!0,sortable:!0,prop:"bindStatus"},{label:"价格比例",checked:!0,sortable:!0,prop:"priceRatio"},{label:"待审金额",checked:!0,sortable:!0,prop:"pendBalance"},{label:"可用金额",checked:!0,sortable:!0,prop:"availableBalance"}]);function M(){R.value.showEdit()}function H(n){fe.prompt("是否确认进行解约?","终止合作",{confirmButtonText:"确认",cancelButtonText:"取消",inputPlaceholder:"说明",inputPattern:/^.{0,500}$/,inputErrorMessage:"不能超过500个字符",type:"warning"}).then(async a=>{const{data:{flag:d}}=await N.updateRescindTenant({beInvitationTenantId:n.beInvitationTenantId,remark:a.value});d&&_e({type:"success",message:"已终止合作"}),z()}).catch(()=>{})}function U(n){x.value.showEdit(n)}const F=le({});function V(n){D(n).then(()=>z())}function q(n=1){A(n).then(()=>z())}function T(){b.value.page=1,z()}async function z(){try{y.value=!0;const n={...P(),...F},{data:a}=await N.list(n);S.value=a.tenantBindInfoList,b.value.total=Number(a.total),y.value=!1}catch{}finally{y.value=!1}}function O(n){$.value=n}const Q=ie(()=>{const n=S.value.filter(i=>i.bindStatus===2);let a=S.value.filter(i=>i.bindStatus===4);a=Array.from(new Map(a.map(i=>[i.beInvitationTenantId,i])).values());const d=n.map(i=>i.beInvitationTenantId);return a.forEach(i=>{d.includes(i.beInvitationTenantId)||n.push(i)}),n});return se(()=>{C.value.forEach(n=>{n.checked&&r.value.push(n.prop)}),T()}),(n,a)=>{const d=_("el-button"),i=ke,j=me,G=be,J=_("el-row"),f=_("el-table-column"),E=_("el-text"),K=ye,L=ge,W=_("ElSpace"),X=_("el-empty"),Y=_("el-table"),Z=_("ElPagination"),ee=ve,te=ce("loading");return c(),re("div",{class:de({"absolute-container":t(w)})},[l(ee,null,{default:o(()=>[l(J,null,{default:o(()=>[l(i,null,{default:o(()=>[l(d,{type:"primary",size:"default",onClick:M},{default:o(()=>[m(" 邀约公司 ")]),_:1})]),_:1}),l(G,null,{default:o(()=>[l(d,{size:"default"},{default:o(()=>[m(" 导出 ")]),_:1}),l(j,{border:t(k),"onUpdate:border":a[0]||(a[0]=e=>v(k)?k.value=e:null),tableAutoHeight:t(w),"onUpdate:tableAutoHeight":a[1]||(a[1]=e=>v(w)?w.value=e:null),checkList:t(r),"onUpdate:checkList":a[2]||(a[2]=e=>v(r)?r.value=e:null),columns:t(C),"onUpdate:columns":a[3]||(a[3]=e=>v(C)?C.value=e:null),"line-height":t(B),"onUpdate:lineHeight":a[4]||(a[4]=e=>v(B)?B.value=e:null),stripe:t(I),"onUpdate:stripe":a[5]||(a[5]=e=>v(I)?I.value=e:null),style:{"margin-left":"12px"},onQueryData:T},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),ue((c(),u(Y,{border:t(k),data:t(Q),size:t(B),stripe:t(I),onSelectionChange:O},{empty:o(()=>[l(X,{image:t(pe),"image-size":300},null,8,["image"])]),default:o(()=>[l(f,{align:"left",type:"selection"}),t(r).includes("bindStatus")?(c(),u(f,{key:0,align:"left",prop:"bindStatus","show-overflow-tooltip":"",label:"状态",width:"100"},{default:o(({row:e})=>[g("div",Be,[e.bindStatus===2?(c(),u(E,{key:0,type:"success"},{default:o(()=>[m("合作")]),_:1})):p("",!0),e.bindStatus===4?(c(),u(E,{key:1,type:"danger"},{default:o(()=>[m("解约")]),_:1})):p("",!0)])]),_:1})):p("",!0),t(r).includes("beInvitationTenantId")?(c(),u(f,{key:1,align:"left",prop:"beInvitationTenantId",width:"180","show-overflow-tooltip":"",label:"租户id"},{default:o(({row:e})=>[g("div",Ce,[g("div",Te,"ID: "+h(e.beInvitationTenantId),1),l(K,{class:"copy",content:e.beInvitationTenantId},null,8,["content"])])]),_:1})):p("",!0),t(r).includes("beInvitationTenantName")?(c(),u(f,{key:2,align:"left",prop:"beInvitationTenantName","show-overflow-tooltip":"",label:"租户名称"},{default:o(({row:e})=>[g("div",ze,h(e.beInvitationTenantName),1)]),_:1})):p("",!0),t(r).includes("priceRatio")?(c(),u(f,{key:3,align:"left",prop:"priceRatio","show-overflow-tooltip":"",label:"价格比例"},{default:o(({row:e})=>[g("div",Se,h(e.priceRatio)+" % ",1)]),_:1})):p("",!0),t(r).includes("pendBalance")?(c(),u(f,{key:4,align:"left",prop:"pendBalance","show-overflow-tooltip":"",label:"待审金额"},{default:o(({row:e})=>[g("div",Re,[l(L),m(h(e.pendBalance||0),1)])]),_:1})):p("",!0),t(r).includes("availableBalance")?(c(),u(f,{key:5,align:"left",prop:"availableBalance","show-overflow-tooltip":"",label:"可用金额"},{default:o(({row:e})=>[g("div",xe,[l(L),m(h(e.availableBalance||0),1)])]),_:1})):p("",!0),l(f,{align:"left",fixed:"right",prop:"i",label:"操作",width:"200"},{default:o(({row:e})=>[l(W,null,{default:o(()=>[e.bindStatus===2?(c(),u(d,{key:0,type:"danger",plain:"",size:"small",onClick:ae=>H(e)},{default:o(()=>[m(" 终止合作 ")]),_:2},1032,["onClick"])):p("",!0),l(d,{size:"small",plain:"",type:"primary",onClick:ae=>U(e)},{default:o(()=>[m(" 价格比例 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["border","data","size","stripe"])),[[te,t(y)]]),l(Z,{"current-page":t(b).page,total:t(b).total,"page-size":t(b).size,"page-sizes":t(b).sizes,layout:t(b).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:V,onCurrentChange:q},null,8,["current-page","total","page-size","page-sizes","layout"]),l(Ie,{ref_key:"editRef",ref:R,onFetchData:T},null,512),l(we,{ref_key:"proportionRef",ref:x,onFetchData:T},null,512)]),_:1})],2)}}}),Ue=he(Ee,[["__scopeId","data-v-fd1bc751"]]);export{Ue as default};
