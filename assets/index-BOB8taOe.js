
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Ce,r as s,l as ke,aN as Le,n as Ne,W as Se,a as r,q as Ie,o as i,b as C,y as v,f as o,j as p,w as n,s as He,g as u,i as y,aM as xe,e as c,z as b,N as Ve,F as we,t as ze,p as x,aO as U,E as P,bb as Ee,an as De,aH as Be,aI as Me,L as Ue,am as R}from"./index-BDT0MVn7.js";import{_ as Pe}from"./index-CaKczzxu.js";import{_ as Re}from"./index-CMSj7Ck8.js";import{u as Fe}from"./position_manage-8GPBFtl2.js";import Te from"./index-BBBRqEdS.js";import $e from"./index-CH_-8mTb.js";import"./index-DNgyXV07.js";import"./index.vue_vue_type_script_setup_true_lang-DJpAD9g_.js";import"./sortable.esm-C0-Qcoum.js";import"./position_manage-BjT7MBle.js";import"./department-CapddDQD.js";import"./configuration_role-88unbD_G.js";import"./tenant_role-CGwfN9Ro.js";import"./configuration_manager-fLZ6MxM4.js";import"./department-DJ1vqSnV.js";const Ae=k=>(Be("data-v-909f93b6"),k=k(),Me(),k),Oe={class:"absolute-container"},Ze={class:"page-main"},je={class:"leftTree"},qe={key:0,class:"leftData",span:3},Ge={class:"copyId tableSmall"},Je={class:"id oneLine idFont"},Qe={style:{display:"flex","align-items":"center"}},We={key:0,xmlns:"http://www.w3.org/2000/svg",style:{"margin-top":"2px","margin-right":"7px"},width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},Ke=Ae(()=>v("g",{id:"Group 18384"},[v("circle",{id:"Ellipse 105",cx:"10",cy:"10",r:"10",fill:"#F8BB4F"}),v("path",{id:"ç®¡",d:"M13.9946 9.3605V12.1892H7.43481V12.9031H14.6277V16.4995H13.3481V16.0146H7.43481V16.486H6.15517V9.3605H13.9946ZM7.43481 14.8831H13.3481V13.9133H7.43481V14.8831ZM7.43481 11.1655H12.7419V10.3842H7.43481V11.1655ZM15.8534 7.67677V10.2495H14.6008V8.75436H5.52209V10.2495H4.2694V7.67677H9.48222C9.37446 7.40738 9.25323 7.16492 9.13201 6.9494L10.2635 6.76083L10.0345 6.61266C10.6541 5.80447 11.1121 4.9424 11.3815 4.01298L12.6072 4.28238C12.5264 4.51136 12.4591 4.72688 12.3782 4.9424H16.1228V6.06039H13.9273C14.1428 6.35673 14.3179 6.65307 14.4661 6.92246L13.3346 7.34003C13.1191 6.90899 12.8631 6.47796 12.5668 6.06039H11.8799C11.6509 6.5049 11.3949 6.92246 11.1121 7.29962L10.4655 6.88206C10.5733 7.12451 10.6676 7.39391 10.7753 7.67677H15.8534ZM6.08782 6.06039C5.79149 6.54531 5.46821 7.00328 5.118 7.42085L4 6.72042C4.78125 5.88529 5.33351 4.96934 5.67026 3.99951L6.89601 4.26891C6.81519 4.4979 6.72091 4.72688 6.64009 4.9424H10.0345V6.06039H8.01401C8.25647 6.39714 8.47198 6.72042 8.63362 7.03022L7.46175 7.47473C7.23276 6.98981 6.97683 6.51837 6.6805 6.06039H6.08782Z",fill:"white"})],-1)),Xe=[Ke],F=Ce({name:"user",__name:"index",setup(k){const L=Fe(),V=s(),T=ke(),$=s([]),{pagination:h,getParams:Ye,onSizeChange:A,onCurrentChange:O,onSortChange:Z}=Le(),N=s([{label:"员工ID",prop:"id",sortable:!0,checked:!0},{label:"用户名",prop:"userName",sortable:!0,checked:!0},{label:"电话号码",prop:"phoneNumber",sortable:!0,checked:!0},{label:"邮箱",prop:"email",sortable:!0,checked:!0},{label:"部门",prop:"departmentId",sortable:!0,checked:!0},{label:"角色",prop:"role",sortable:!0,checked:!0},{label:"职位",prop:"positionId",sortable:!0,checked:!0},{label:"小组",prop:"groupId",sortable:!0,checked:!0},{label:"状态",prop:"active",sortable:!0,checked:!0}]),j=[{label:"启用",value:!0},{label:"禁用",value:!1}],q={children:"children",label:"name"},G=s(),w=s(),d=s({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),S=s(),J=s(),e=s({loading:!1,tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],search:{page:1,limit:10,id:"",userName:"",active:null,departmentId:null},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}}),z=s(),Q=s();async function m(){const t={...e.value.search},l=await x.list(t);l.data&&(e.value.dataList=l.data.data,h.value.total=+l.data.total)}const W={activeList:()=>j};Ne(async()=>{z.value=[{index:1,show:!0,type:"input",modelName:"id",placeholder:"员工ID"},{index:2,show:!0,type:"input",modelName:"userName",placeholder:"用户名"},{index:3,show:!0,type:"select",modelName:"active",placeholder:"状态",option:"activeList",optionLabel:"label",optionValue:"value"}];try{d.value.loading=!0,$.value=await T.getCountry(),V.value=await(L==null?void 0:L.getPositionManage())||[],m(),N.value.forEach(t=>{t.checked&&e.value.checkList.push(t.prop)}),d.value.loading=!1}catch{}finally{d.value.loading=!1}}),Se(()=>d.value.search,t=>{G.value.filter(t)});function K(t){return new Promise(l=>{U.confirm(`确认${t.active?"禁用":"启用"}「${t.userName}」吗？`,"确认信息").then(()=>{try{d.value.loading=!0,x.edit({id:t.id,email:t.email,phoneNumber:t.phoneNumber,userName:t.userName,country:t.country,role:t.role,positionId:t.positionId,organizationalStructureId:t.organizationalStructureId,active:!t.active}).then(()=>(P.success({message:`${t.active?"禁用":"启用"}成功`,center:!0}),m(),d.value.loading=!1,l(!0))).catch(()=>(d.value.loading=!1,l(!1)))}catch{}finally{d.value.loading=!1}}).catch(()=>l(!1))})}function X(t){var l;h.value.page=1,(l=t==null?void 0:t.children)!=null&&l.length?(e.value.search.id="",e.value.search.departmentId=t.id,m()):(e.value.search.id=t.id,e.value.search.departmentId="",m())}function Y(t){A(t).then(()=>{e.value.search.limit=t,m()})}function E(t=1){O(t).then(()=>{e.value.search.page=t,m()})}function ee({prop:t,order:l}){Z(t,l).then(()=>m())}function te(t){e.value.dialog.id="",e.value.dialog.visible=!0,e.value.dialog.level=1,t&&(e.value.dialog.parentId=t.id,e.value.dialog.level=Number(t.level)+1)}const ae=t=>{S.value=t[0]};function le(){if(S.value){const{userName:t,id:l}=S.value;U.confirm(`确认将「${t}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{x.reset({id:l}).then(()=>{P.success({message:"重置成功",center:!0}),m()})}).catch(()=>{})}}function ne(t){e.value.row=JSON.stringify(t),e.value.dialog.id=t.id,e.value.dialog.parentId=t.parentId,e.value.dialog.visible=!0}function oe(t){w.value.showEdit(t)}function ie(){Object.assign(e.value.search,{id:"",userName:"",departmentId:null,active:null}),m()}const I=s();function se(t){t?I.value=t.id:I.value=""}const re=s("formSearch-user");return(t,l)=>{const D=r("el-tree"),ue=Re,ce=r("ElDivider"),H=r("el-button"),B=r("el-col"),de=Ee,pe=r("el-row"),f=r("ElTableColumn"),me=r("ElSwitch"),fe=r("el-tooltip"),ge=Pe,g=r("el-text"),M=r("ElButton"),ve=r("el-empty"),he=r("ElTable"),_e=r("ElPagination"),be=De,ye=Ie("loading");return i(),C("div",Oe,[v("div",Ze,[v("div",je,[d.value.tree.length?(i(),C("div",qe,[o(D,{style:{"max-width":"37.5rem","min-height":"45.4375rem",padding:"10px"},data:d.value.tree,ref_key:"treeRef",ref:Q,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,props:q,onNodeClick:X},null,8,["data"])])):p("",!0),o(be,null,{default:n(()=>[o(ue,{formSearchList:z.value,onCurrentChange:E,onOnReset:ie,model:e.value.search,formOption:W,formSearchName:re.value},null,8,["formSearchList","model","formSearchName"]),o(ce,{"border-style":"dashed"}),He((i(),C("div",null,[o(pe,{style:{"margin-bottom":"0.3125rem"},gutter:24},{default:n(()=>[o(B,{style:{"margin-bottom":"1.5625rem"},span:10},{default:n(()=>[o(H,{type:"primary",size:"default",onClick:te},{default:n(()=>[u(" 新增 ")]),_:1}),o(H,{type:"primary",size:"default",onClick:le},{default:n(()=>[u(" 重置密码 ")]),_:1})]),_:1}),o(B,{style:{display:"flex","justify-content":"flex-end"},span:14},{default:n(()=>[o(H,{size:"default",onClick:l[0]||(l[0]=()=>{})},{default:n(()=>[u(" 导出 ")]),_:1}),o(de,{border:e.value.border,"onUpdate:border":l[1]||(l[1]=a=>e.value.border=a),tableAutoHeight:e.value.tableAutoHeight,"onUpdate:tableAutoHeight":l[2]||(l[2]=a=>e.value.tableAutoHeight=a),checkList:e.value.checkList,"onUpdate:checkList":l[3]||(l[3]=a=>e.value.checkList=a),columns:N.value,"onUpdate:columns":l[4]||(l[4]=a=>N.value=a),"line-height":e.value.lineHeight,"onUpdate:lineHeight":l[5]||(l[5]=a=>e.value.lineHeight=a),stripe:e.value.stripe,"onUpdate:stripe":l[6]||(l[6]=a=>e.value.stripe=a),style:{"margin-left":"0.75rem"},onQueryData:m},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),o(he,{ref_key:"userItemRef",ref:J,data:e.value.dataList,border:e.value.border,size:e.value.lineHeight,stripe:e.value.stripe,"highlight-current-row":"",height:"100%",onSortChange:ee,onCurrentChange:se,onSelectionChange:l[7]||(l[7]=a=>e.value.selectionDataList=a),"row-key":"id","default-expand-all":"",onSelect:ae},{empty:n(()=>[o(ve,{image:y(xe),"image-size":300},null,8,["image"])]),default:n(()=>[o(f,{type:"selection",align:"left",fixed:""}),e.value.checkList.includes("active")?(i(),c(f,{key:0,align:"left",prop:"active",label:"状态",width:"84"},{default:n(a=>[o(me,{modelValue:a.row.active,"onUpdate:modelValue":_=>a.row.active=_,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>K(a.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1})):p("",!0),e.value.checkList.includes("id")?(i(),c(f,{key:1,align:"left",width:"280",prop:"id",label:"员工ID"},{default:n(({row:a})=>[v("div",Ge,[v("div",Je,[o(fe,{effect:"dark",content:a.id,placement:"top-start"},{default:n(()=>[u(b(a.id),1)]),_:2},1032,["content"])]),o(ge,{content:a.id,class:Ve({rowCopy:"rowCopy",current:a.id===I.value})},null,8,["content","class"])])]),_:1})):p("",!0),e.value.checkList.includes("userName")?(i(),c(f,{key:2,align:"left",prop:"userName",label:"用户名"},{default:n(({row:a})=>[o(g,{class:"tableBig"},{default:n(()=>[u(b(a.userName?a.userName:"-"),1)]),_:2},1024)]),_:1})):p("",!0),e.value.checkList.includes("phoneNumber")?(i(),c(f,{key:3,align:"left",width:"170",prop:"phone",label:"电话号码"},{default:n(({row:a})=>[o(g,{class:"fontC-System"},{default:n(()=>[u(b(a.phoneNumber?a.phoneNumber:"-"),1)]),_:2},1024)]),_:1})):p("",!0),e.value.checkList.includes("email")?(i(),c(f,{key:4,align:"left",width:"180",prop:"email",label:"邮箱"},{default:n(({row:a})=>[o(g,{class:"fontC-System"},{default:n(()=>[u(b(a.email?a.email:"-"),1)]),_:2},1024)]),_:1})):p("",!0),e.value.checkList.includes("departmentId")?(i(),c(f,{key:5,align:"left",prop:"departmentId",label:"部门"},{default:n(({row:a})=>[v("div",Qe,[a.enableChargePerson===1?(i(),C("svg",We,Xe)):p("",!0),o(g,{class:"fontC-System"},{default:n(()=>[u(b(a.organizationalStructureName?a.organizationalStructureName:"-"),1)]),_:2},1024)])]),_:1})):p("",!0),e.value.checkList.includes("role")?(i(),c(f,{key:6,align:"left",prop:"role",label:"角色"},{default:n(({row:a})=>[o(g,{class:"fontC-System"},{default:n(()=>[u(b(a.role?a.role:"-"),1)]),_:2},1024)]),_:1})):p("",!0),e.value.checkList.includes("positionId")?(i(),c(f,{key:7,align:"left",prop:"positionId",label:"职位"},{default:n(({row:a})=>[a.positionId?(i(),c(g,{key:0,class:"fontC-System"},{default:n(()=>[(i(!0),C(we,null,ze(V.value,_=>(i(),c(g,null,{default:n(()=>[a.positionId===_.id?(i(),c(g,{key:0},{default:n(()=>[u(b(_.name?_.name:"-"),1)]),_:2},1024)):p("",!0)]),_:2},1024))),256))]),_:2},1024)):(i(),c(g,{key:1,class:"fontC-System"},{default:n(()=>[u("-")]),_:1}))]),_:1})):p("",!0),o(f,{label:"操作",fixed:"right",width:"200",align:"left"},{default:n(a=>[o(M,{type:"primary",size:"small",plain:"",onClick:_=>ne(a.row)},{default:n(()=>[u(" 编辑 ")]),_:2},1032,["onClick"]),o(M,{type:"warning",size:"small",plain:"",onClick:_=>oe(a.row)},{default:n(()=>[u(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"]),o(_e,{"current-page":y(h).page,total:y(h).total,"page-size":y(h).size,"page-sizes":y(h).sizes,layout:y(h).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:Y,onCurrentChange:E},null,8,["current-page","total","page-size","page-sizes","layout"])])),[[ye,d.value.loading]])]),_:1})]),e.value.dialog.visible?(i(),c(Te,{key:0,id:e.value.dialog.id,modelValue:e.value.dialog.visible,"onUpdate:modelValue":l[8]||(l[8]=a=>e.value.dialog.visible=a),"catalogue-id":e.value.search.catalogueId,"parent-id":e.value.dialog.parentId,level:e.value.dialog.level,tree:d.value.tree,dataList:e.value.dataList,row:e.value.row,onSuccess:m},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):p("",!0),o($e,{ref_key:"detailRef",ref:w},null,512)])])}}});typeof R=="function"&&R(F);const gt=Ue(F,[["__scopeId","data-v-909f93b6"]]);export{gt as default};
