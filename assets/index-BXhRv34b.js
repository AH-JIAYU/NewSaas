
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as R,aN as W,r as v,a as s,q as X,s as E,o as c,e as m,w as t,f as a,b as I,t as Y,F as Z,i as p,aM as ee,g as i,z as u,j as b,bf as ae,p as te,be as le,aH as oe,aI as ne,y as T,L as se}from"./index--0_6J0jW.js";import{a as ie}from"./financial_pm_log-YeqFcd5L.js";const x=g=>(oe("data-v-ae3b759c"),g=g(),ne(),g),re={key:0,class:"plus color3"},ce=x(()=>T("div",{class:"plusSpan i-majesticons:plus-line w-1em h-1em"},null,-1)),ue={key:1,class:"plus color3"},de=x(()=>T("div",{class:"minusSign i-iconamoon:sign-minus-bold w-1em h-1em"},null,-1)),pe=R({__name:"index",emits:["fetch-data"],setup(g,{expose:D,emit:V}){const{format:L}=ae(),B=V,{pagination:f,getParams:fe,onSizeChange:F,onCurrentChange:N,onSortChange:me}=W(),C=v([]),l=v({loading:!1,activeName:"myFinancial",tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],search:{page:1,limit:10,userId:null,organizationalStructureId:null}}),_=v(!1),z=v();async function j(o){if(o.organizationalStructureId){l.value.search.organizationalStructureId=o.organizationalStructureId,await y();const n=await te.queryNotEnableStaffList({organizationalStructureId:l.value.search.organizationalStructureId});C.value=n.data}_.value=!0}const y=async()=>{try{l.value.loading=!0;const o={...l.value.search},n=await ie.getStaffFinancial(o);z.value=n.data.userList,f.value.total=+n.data.total,l.value.loading=!1}catch{}finally{l.value.loading=!1}};function H(o){F(o).then(()=>{l.value.search.limit=o,y()})}function S(o=1){N(o).then(()=>{l.value.search.page=o,y()})}function P(){B("fetch-data"),Object.assign(l.value.search,{page:1,limit:10,userId:null,organizationalStructureId:null}),_.value=!1}return D({showEdit:j}),(o,n)=>{const M=s("ElDivider"),U=s("el-option"),q=s("el-select"),$=s("ElFormItem"),A=s("ElForm"),d=s("el-text"),r=s("ElTableColumn"),w=s("el-tag"),h=le,O=s("el-tooltip"),G=s("el-empty"),J=s("ElTable"),K=s("ElPagination"),Q=s("el-drawer"),k=X("loading");return E((c(),m(Q,{modelValue:_.value,"onUpdate:modelValue":n[3]||(n[3]=e=>_.value=e),"append-to-body":"","close-on-click-modal":!1,"destroy-on-close":"",draggable:"",size:"70%",title:"财务日志",onClose:P},{default:t(()=>[a(M,{"border-style":"dashed"}),a(A,{model:l.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:t(()=>[a($,null,{default:t(()=>[a(q,{style:{width:"10.5rem"},modelValue:l.value.search.userId,"onUpdate:modelValue":n[0]||(n[0]=e=>l.value.search.userId=e),placeholder:"请选择员工",clearable:"",filterable:"",onChange:n[1]||(n[1]=e=>S())},{default:t(()=>[(c(!0),I(Z,null,Y(C.value,e=>(c(),m(U,{key:e.id,label:e.userName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),E((c(),m(J,{border:l.value.border,size:l.value.lineHeight,stripe:l.value.stripe,class:"my-4",data:z.value,"highlight-current-row":"",onSortChange:o.sortChange,onSelectionChange:n[2]||(n[2]=e=>l.value.batch.selectionDataList=e)},{empty:t(()=>[a(G,{image:p(ee),"image-size":300},null,8,["image"])]),default:t(()=>[a(r,{"show-overflow-tooltip":"",align:"left",prop:"",label:"点击ID"},{default:t(({row:e})=>[a(d,{class:"color3"},{default:t(()=>[i(u(e.clientId?e.clientId:"-"),1)]),_:2},1024)]),_:1}),a(r,{"show-overflow-tooltip":"",align:"left",prop:"projectId",label:"项目ID"},{default:t(({row:e})=>[a(d,{class:"color3"},{default:t(()=>[i(u(e.projectId?e.projectId:"-"),1)]),_:2},1024)]),_:1}),a(r,{"show-overflow-tooltip":"",width:"120",align:"left",prop:"type",label:"类型"},{default:t(({row:e})=>[e.type===1?(c(),m(w,{key:0,type:"warning",effect:"dark"},{default:t(()=>[i("待审余额")]),_:1})):b("",!0),e.type===2?(c(),m(w,{key:1,type:"primary",effect:"dark"},{default:t(()=>[i("可用余额")]),_:1})):b("",!0)]),_:1}),a(r,{"show-overflow-tooltip":"",align:"left",prop:"remark",label:"说明"},{default:t(({row:e})=>[a(d,{class:"mx-1 color3"},{default:t(()=>[i(u(e.remark?e.remark:"-"),1)]),_:2},1024)]),_:1}),a(r,{"show-overflow-tooltip":"",align:"left",prop:"beforeBalance",width:"150",label:"变动前"},{default:t(({row:e})=>[a(h),a(d,{class:"mx-1 color3"},{default:t(()=>[i(u(e.beforeBalance||0),1)]),_:2},1024)]),_:1}),a(r,{"show-overflow-tooltip":"",align:"left",prop:"difference",label:"加减款",width:"120"},{default:t(({row:e})=>[e.operationType===1?(c(),I("p",re,[ce,a(d,null,{default:t(()=>[a(h),i(u(Math.abs(e.difference)),1)]),_:2},1024)])):b("",!0),e.operationType===2?(c(),I("p",ue,[de,a(d,null,{default:t(()=>[a(h),i(u(Math.abs(e.difference)),1)]),_:2},1024)])):b("",!0)]),_:1}),a(r,{"show-overflow-tooltip":"",align:"left",prop:"afterBalance",width:"150",label:"变动后"},{default:t(({row:e})=>[a(h),a(d,{class:"color3"},{default:t(()=>[i(u(e.afterBalance||0),1)]),_:2},1024)]),_:1}),a(r,{"show-overflow-tooltip":"",align:"left",prop:"createTime",label:"时间"},{default:t(({row:e})=>[a(O,{content:e.createTime,placement:"top"},{default:t(()=>[a(w,{effect:"plain",type:"info"},{default:t(()=>[i(u(p(L)(e.createTime)),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1})]),_:1},8,["border","size","stripe","data","onSortChange"])),[[k,l.value.loading]]),a(K,{"current-page":p(f).page,total:p(f).total,"page-size":p(f).size,"page-sizes":p(f).sizes,layout:p(f).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:H,onCurrentChange:S},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1},8,["modelValue"])),[[k,l.value.loading]])}}}),he=se(pe,[["__scopeId","data-v-ae3b759c"]]);export{he as default};
