
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-DM-HONYD.js";import{d as X,O as Y,aO as Z,r as L,k as ee,G as B,J as te,a as d,p as ae,o as c,b as oe,f as t,w as a,q as x,i as o,e as m,j as g,g as s,H as C,az as le,S as ne,E as V,aP as ie,aB as se,ao as re,N as de,R as ce}from"./index-p_p9xnX-.js";import{_ as ue}from"./index.vue_vue_type_script_setup_true_lang-DtzUlgH1.js";import{_ as me}from"./index.vue_vue_type_style_index_0_lang-D4sdzga8.js";import{a as y}from"./configuration_homepageSetting-DtujA5ya.js";import"./index-D3H3uhWx.js";const pe=X({name:"TenantTenantHomepageSettingList",__name:"list",setup(fe){Y();const{pagination:_,getParams:T,onSizeChange:H,onCurrentChange:I,onSortChange:N}=Z(),k=L(),e=L({loading:!1,tableAutoHeight:!1,formMode:"dialog",formModeProps:{visible:!1,row:"",id:""},search:{title:""},batch:{enable:!1,selectionDataList:[]},dataList:[],controlDataList:[]});ee(()=>{u(),e.value.formMode==="router"&&B.on("get-data-list",()=>{u()})}),te(()=>{e.value.formMode==="router"&&B.off("get-data-list")});function u(){try{e.value.loading=!0;const i={...T(),...e.value.search.title&&{title:e.value.search.title}};y.list(i).then(l=>{e.value.loading=!1,e.value.controlDataList=l.data.controlData,e.value.dataList=l.data.data,_.value.total=Number(l.data.total)})}catch{}finally{e.value.loading=!1}}function F(i){H(i).then(()=>u())}function h(i=1){I(i).then(()=>u())}function w({prop:i,order:l}){N(i,l).then(()=>u())}function R(){e.value.formModeProps.id="",e.value.formModeProps.row="",e.value.formModeProps.visible=!0}function G(i){e.value.formModeProps.id=i.id,e.value.formModeProps.row=JSON.stringify(i),e.value.formModeProps.visible=!0}function E(i,l="编辑"){k.value.showEdit(i,l)}async function P(i){(await y.setHomePageTemplate({templateId:i.id})).status===1&&V.success({message:"设置成功",center:!0}),u()}function O(i){ie.confirm(`确认删除「${i.title}」吗？`,"确认信息").then(()=>{y.del({id:i.id}).then(l=>{l.status===1&&V.success({message:"删除成功",center:!0}),u()})}).catch(()=>{})}return(i,l)=>{const z=se,p=d("ElTableColumn"),r=d("ElButton"),S=d("ElTable"),M=re,U=d("ElInput"),D=d("ElFormItem"),v=de,A=d("ElForm"),J=W,K=d("ElDivider"),j=d("ElButtonGroup"),q=d("ElSpace"),Q=d("ElPagination"),$=ae("loading");return c(),oe("div",{class:ne({"absolute-container":o(e).tableAutoHeight})},[t(M,null,{default:a(()=>[t(z,{title:"通用模板"}),x((c(),m(S,{class:"my-4",data:o(e).controlDataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:w,onSelectionChange:l[0]||(l[0]=n=>o(e).batch.selectionDataList=n)},{default:a(()=>[o(e).batch.enable?(c(),m(p,{key:0,type:"selection",align:"center",fixed:""})):g("",!0),t(p,{prop:"title",label:"标题"}),t(p,{prop:"isSet",align:"center",width:"100",label:"是否默认"},{default:a(({row:n})=>[s(C(n.isSet?"是":"否"),1)]),_:1}),t(p,{label:"操作",width:"250",align:"center",fixed:"right"},{default:a(n=>[n.row.isSet?g("",!0):(c(),m(r,{key:0,type:"primary",size:"small",plain:"",onClick:f=>P(n.row)},{default:a(()=>[s(" 设置为主页 ")]),_:2},1032,["onClick"])),t(r,{type:"primary",size:"small",plain:"",onClick:f=>E(n.row,"查看")},{default:a(()=>[s(" 查看 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,o(e).loading]])]),_:1}),t(M,null,{default:a(()=>[t(z,{title:"自定义模板"}),t(J,{"show-toggle":!1},{default:a(({fold:n,toggle:f})=>[t(A,{model:o(e).search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:a(()=>[t(D,{label:"标题"},{default:a(()=>[t(U,{modelValue:o(e).search.title,"onUpdate:modelValue":l[1]||(l[1]=b=>o(e).search.title=b),placeholder:"请输入标题，支持模糊查询",clearable:"",onKeydown:l[2]||(l[2]=le(b=>h(),["enter"])),onClear:l[3]||(l[3]=b=>h())},null,8,["modelValue"])]),_:1}),t(D,null,{default:a(()=>[t(r,{type:"primary",onClick:l[4]||(l[4]=b=>h())},{icon:a(()=>[t(v,{name:"i-ep:search"})]),default:a(()=>[s(" 筛选 ")]),_:1}),t(r,{link:"",disabled:"",onClick:f},{icon:a(()=>[t(v,{name:n?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:a(()=>[s(" "+C(n?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),t(K,{"border-style":"dashed"}),t(q,{wrap:""},{default:a(()=>[t(r,{type:"primary",size:"default",onClick:R},{icon:a(()=>[t(v,{name:"i-ep:plus"})]),default:a(()=>[s(" 新增首页设置 ")]),_:1}),o(e).batch.enable?(c(),m(r,{key:0,size:"default",disabled:!o(e).batch.selectionDataList.length},{default:a(()=>[s(" 单个批量操作按钮 ")]),_:1},8,["disabled"])):g("",!0),o(e).batch.enable?(c(),m(j,{key:1},{default:a(()=>[t(r,{size:"default",disabled:!o(e).batch.selectionDataList.length},{default:a(()=>[s(" 批量操作按钮组1 ")]),_:1},8,["disabled"]),t(r,{size:"default",disabled:!o(e).batch.selectionDataList.length},{default:a(()=>[s(" 批量操作按钮组2 ")]),_:1},8,["disabled"])]),_:1})):g("",!0)]),_:1}),x((c(),m(S,{class:"my-4",data:o(e).dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:w,onSelectionChange:l[5]||(l[5]=n=>o(e).batch.selectionDataList=n)},{default:a(()=>[o(e).batch.enable?(c(),m(p,{key:0,type:"selection",align:"center",fixed:""})):g("",!0),t(p,{prop:"title",label:"标题"}),t(p,{prop:"isSet",align:"center",width:"100",label:"是否默认"},{default:a(({row:n})=>[s(C(n.isSet?"是":"否"),1)]),_:1}),t(p,{label:"操作",width:"350",align:"center",fixed:"right"},{default:a(n=>[n.row.isSet?g("",!0):(c(),m(r,{key:0,type:"primary",size:"small",plain:"",onClick:f=>P(n.row)},{default:a(()=>[s(" 设置为主页 ")]),_:2},1032,["onClick"])),t(r,{type:"primary",size:"small",plain:"",onClick:f=>G(n.row)},{default:a(()=>[s(" 编辑 ")]),_:2},1032,["onClick"]),t(r,{type:"primary",size:"small",plain:"",onClick:f=>E(n.row)},{default:a(()=>[s(" 设计主页 ")]),_:2},1032,["onClick"]),t(r,{type:"danger",size:"small",plain:"",onClick:f=>O(n.row)},{default:a(()=>[s(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,o(e).loading]]),t(Q,{"current-page":o(_).page,total:o(_).total,"page-size":o(_).size,"page-sizes":o(_).sizes,layout:o(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:F,onCurrentChange:h},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),o(e).formMode==="dialog"||o(e).formMode==="drawer"?(c(),m(ue,{key:0,id:o(e).formModeProps.id,row:o(e).formModeProps.row,modelValue:o(e).formModeProps.visible,"onUpdate:modelValue":l[6]||(l[6]=n=>o(e).formModeProps.visible=n),mode:o(e).formMode,onSuccess:u},null,8,["id","row","modelValue","mode"])):g("",!0),t(me,{ref_key:"homePageRef",ref:k,onFetchData:u},null,512)],2)}}}),ye=ce(pe,[["__scopeId","data-v-82c6ced7"]]);export{ye as default};
