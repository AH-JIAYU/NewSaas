
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as ve}from"./index-DovIvvZ2.js";import{d as ge,aN as me,r as N,n as fe,W as M,a as p,q as G,o as d,b as _e,y as c,f as o,w as i,s as r,e as u,g as D,ay as P,z as y,ax as S,aG as R,i as b,aM as he,j as U,aO as z,E as L,_ as ye,aH as be,aI as Ce,L as De,am as K}from"./index-CEuraEPQ.js";import ke from"./index-C-VbCPa3.js";import Ie from"./index-H8Cmz9Nl.js";import{a as k}from"./tenantDictionary-DweDhJo5.js";const O=I=>(be("data-v-85770338"),I=I(),Ce(),I),we={class:"absolute-container"},Ee={class:"page-main"},Ne={class:"custom-tree-node"},Se=["title"],ze={class:"code"},Le={class:"actions"},Ve={class:"dictionary-container"},xe=O(()=>c("div",{class:"i-ic:round-plus w-1.3em h-1.3em",style:{color:"white"}},null,-1)),$e=[xe],Be={style:{color:"#333333"}},Te={style:{color:"#333333"}},Me={style:{color:"#333333"}},Ge={class:"dictionary-container"},Pe=O(()=>c("div",{class:"empty"},"请在左侧新增或选择一个字典",-1)),Re=[Pe],F=ge({name:"tenantDictionary",__name:"index",setup(I){const{pagination:_,getParams:J,onSizeChange:j,onCurrentChange:q,onSortChange:A}=me(),V=N(),l=N({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),H=N(),a=N({loading:!1,search:{catalogueId:"",chineseName:""},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}});async function w(){try{l.value.loading=!0,a.value.search.catalogueId="";const e={...l.value.search},t=await k.list(e);l.value.tree=t.data,l.value.loading=!1}catch{}finally{l.value.loading=!1}}fe(()=>{w()}),M(()=>l.value.search,e=>{V.value.filter(e)});function W(e,t){return e?t.label.includes(e):!0}function x(e){l.value.currentData=e,l.value.dialog.parentId=(e==null?void 0:e.id)??"",l.value.dialog.id="",l.value.dialog.visible=!0}function Q(e,t){l.value.currentNode=e,l.value.currentData=t,l.value.row=JSON.stringify(t),l.value.dialog.parentId=e.parent.data.id??"",l.value.dialog.id=t.id,l.value.dialog.visible=!0}function X(e,t){z.confirm(`确认删除「${t.chineseName}」吗？`,"确认信息").then(()=>{k.delete(t.id).then(()=>{L.success({message:"删除成功",center:!0});const s=e.parent,C=s.data.children||s.data,g=C.findIndex(E=>E.id===t.id);C.splice(g,1),l.value.tree=[...l.value.tree]})})}function Y(e){_.value.page=1,a.value.search.catalogueId=e.id}M(()=>a.value.search.catalogueId,()=>{v()});async function v(){try{a.value.loading=!0;const e={...J(),...a.value.search},t=await k.itemlist(e);a.value.loading=!1,a.value.dataList=t.data,a.value.dataList.forEach(s=>{s.enableLoading=!1}),_.value.total=t.data.length}catch{}finally{a.value.loading=!1}}function Z(e){j(e).then(()=>v())}function ee(e=1){q(e).then(()=>v())}function ae({prop:e,order:t}){A(e,t).then(()=>v())}function $(e){a.value.dialog.id="",a.value.dialog.visible=!0,a.value.dialog.level=1,e&&(a.value.dialog.parentId=e.id,a.value.dialog.level=Number(e.level)+1)}function te(e){a.value.row=JSON.stringify(e),a.value.dialog.id=e.id,a.value.dialog.parentId=e.parentId,a.value.dialog.visible=!0}function le(e){z.confirm(`确认删除「${e.chineseName}」吗？`,"确认信息").then(()=>{k.itemdelete([e.id]).then(()=>{v(),L.success({message:"删除成功",center:!0})})}).catch(()=>{})}function ne(e){const t=e.map(s=>s.id);z.confirm(`确认删除选中的 ${e.length} 条数据吗？`,"确认信息").then(()=>{k.itemdelete(t).then(()=>{v(),L.success({message:"删除成功",center:!0})})}).catch(()=>{})}return(e,t)=>{const s=p("ElButton"),C=p("ElButtonGroup"),g=ye,E=p("ElInput"),ie=p("ElTree"),oe=p("ElScrollbar"),se=p("ElSpace"),h=p("ElTableColumn"),de=p("el-button"),ce=p("el-empty"),re=p("ElTable"),ue=p("ElPagination"),pe=ve,m=G("auth"),B=G("loading");return d(),_e("div",we,[c("div",Ee,[o(pe,{"hide-left-side-toggle":""},{leftSide:i(()=>[o(C,{class:"btns"},{default:i(()=>[r((d(),u(s,{type:"primary",class:"add",onClick:t[0]||(t[0]=n=>x())},{default:i(()=>[D(" 新增字典 ")]),_:1})),[[m,"tenantDictionary-insert-insertDict"]])]),_:1}),o(E,{modelValue:l.value.search.chineseName,"onUpdate:modelValue":t[1]||(t[1]=n=>l.value.search.chineseName=n),placeholder:"请输入关键词筛选字典",clearable:"",class:"search",onKeydown:P(w,["enter"])},{append:i(()=>[o(s,{onClick:w},{default:i(()=>[o(g,{name:"i-ep:search"})]),_:1})]),_:1},8,["modelValue"]),o(oe,{class:"tree"},{default:i(()=>[r((d(),u(ie,{ref_key:"dictionaryRef",ref:V,data:l.value.tree,"filter-node-method":W,"default-expand-all":"",onNodeClick:Y},{default:i(({node:n,data:f})=>[c("div",Ne,[c("div",{class:"label",title:n.label},y(f.chineseName),9,Se),c("div",ze,y(f.englishName),1),c("div",Le,[o(C,null,{default:i(()=>[r((d(),u(s,{type:"primary",plain:"",size:"default",onClick:S(T=>x(f),["stop"])},{icon:i(()=>[o(g,{name:"i-ep:plus"})]),_:2},1032,["onClick"])),[[m,"tenantDictionary-insert-insertDict"]]),r((d(),u(s,{type:"info",plain:"",size:"default",onClick:S(T=>Q(n,f),["stop"])},{icon:i(()=>[o(g,{name:"i-ep:edit"})]),_:2},1032,["onClick"])),[[m,"tenantDictionary-update-updateDictById"]]),r((d(),u(s,{type:"danger",plain:"",size:"default",onClick:S(T=>X(n,f),["stop"])},{icon:i(()=>[o(g,{name:"i-ep:delete"})]),_:2},1032,["onClick"])),[[m,"tenantDictionary-delete-deleteDictById"]])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])),[[B,l.value.loading]])]),_:1})]),default:i(()=>[r(c("div",Ve,[o(se,{wrap:""},{default:i(()=>[c("div",{class:"button-bule",onClick:t[2]||(t[2]=n=>$())},$e),r((d(),u(s,{type:"danger",disabled:!a.value.selectionDataList.length,style:{"background-color":"#FB6868"},onClick:t[3]||(t[3]=n=>ne(a.value.selectionDataList))},{icon:i(()=>[o(g,{name:"i-ep:delete"})]),_:1},8,["disabled"])),[[m,"tenantDictionary-insert-insertDict"]]),o(E,{modelValue:a.value.search.chineseName,"onUpdate:modelValue":t[4]||(t[4]=n=>a.value.search.chineseName=n),placeholder:"请输入关键词筛选字典项",clearable:"",style:{width:"200px"},onKeydown:P(v,["enter"])},null,8,["modelValue"]),o(s,{onClick:v},{icon:i(()=>[o(g,{name:"i-ep:search"})]),_:1})]),_:1}),r((d(),u(re,{ref_key:"dictionaryItemRef",ref:H,data:a.value.dataList,stripe:"","highlight-current-row":"",height:"100%",onSortChange:ae,onSelectionChange:t[5]||(t[5]=n=>a.value.selectionDataList=n),"row-key":"id","default-expand-all":""},{empty:i(()=>[o(ce,{image:b(he),"image-size":300},null,8,["image"])]),default:i(()=>[o(h,{type:"selection",align:"left",fixed:""}),o(h,{prop:"chineseName",label:"中文名称"},{default:i(({row:n})=>[c("span",Be,y(n.chineseName),1)]),_:1}),o(h,{prop:"englishName",label:"英文名称"},{default:i(({row:n})=>[c("span",Te,y(n.englishName),1)]),_:1}),o(h,{prop:"remark",label:"备注"},{default:i(({row:n})=>[c("span",Me,y(n.remark?n.remark:"-"),1)]),_:1}),o(h,{label:"键值",align:"left",width:"150"},{default:i(n=>[o(de,{size:"small",plain:""},{default:i(()=>[D(y(n.row.code),1)]),_:2},1024)]),_:1}),o(h,{label:"操作",width:"250",align:"left"},{default:i(n=>[r((d(),u(s,{type:"primary",size:"small",plain:"",onClick:f=>$(n.row)},{default:i(()=>[D(" 新增子项 ")]),_:2},1032,["onClick"])),[[m,"tenantDictionary-insert-insertDictDataSource"]]),r((d(),u(s,{type:"warning",size:"small",plain:"",onClick:f=>te(n.row)},{default:i(()=>[D(" 编辑 ")]),_:2},1032,["onClick"])),[[m,"tenantDictionary-update-updateDictDataSource"]]),r((d(),u(s,{type:"danger",size:"small",plain:"",onClick:f=>le(n.row)},{default:i(()=>[D(" 删除 ")]),_:2},1032,["onClick"])),[[m,"tenantDictionary-delete-deleteDictDataSource"]])]),_:1})]),_:1},8,["data"])),[[B,a.value.loading]]),o(ue,{"current-page":b(_).page,total:b(_).total,"page-size":b(_).size,"page-sizes":b(_).sizes,layout:b(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:Z,onCurrentChange:ee},null,8,["current-page","total","page-size","page-sizes","layout"])],512),[[R,a.value.search.catalogueId]]),r(c("div",Ge,Re,512),[[R,!a.value.search.catalogueId]])]),_:1}),l.value.dialog.visible?(d(),u(ke,{key:0,id:l.value.dialog.id,modelValue:l.value.dialog.visible,"onUpdate:modelValue":t[6]||(t[6]=n=>l.value.dialog.visible=n),row:l.value.row,"parent-id":l.value.dialog.parentId,tree:l.value.tree,onGetList:w},null,8,["id","modelValue","row","parent-id","tree"])):U("",!0),a.value.dialog.visible?(d(),u(Ie,{key:1,id:a.value.dialog.id,modelValue:a.value.dialog.visible,"onUpdate:modelValue":t[7]||(t[7]=n=>a.value.dialog.visible=n),"catalogue-id":a.value.search.catalogueId,"parent-id":a.value.dialog.parentId,level:a.value.dialog.level,tree:l.value.tree,dataList:a.value.dataList,row:a.value.row,onSuccess:v},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):U("",!0)])])}}});typeof K=="function"&&K(F);const je=De(F,[["__scopeId","data-v-85770338"]]);export{je as default};
