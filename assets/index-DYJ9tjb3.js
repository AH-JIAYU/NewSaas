
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as He,ae as Ne,r as p,ac as Ie,aN as xe,E as $,o as Ve,K as we,a2 as r,al as A,a as i,i as L,b as _,f as o,j as f,w as n,h as g,a3 as C,c as u,g as d,t as h,k as ze,aM as Ee,A as De,aj as E,aS as T,ai as D,aP as Pe,ao as Be,aH as Me,aI as Re,y as Ue,an as F}from"./index-BBQ0m3JZ.js";import{_ as $e}from"./index-DNBY7XPP.js";import{_ as Ae}from"./index-GRhYOswx.js";import{u as Te}from"./position_manage-C1Hge1YC.js";import Fe from"./index-Bt-xjHfI.js";import Ze from"./index-CfIpRasu.js";import{columns as H,formSearchList as je}from"./index-BFibzBXr.js";import"./index-wixKAAHz.js";import"./clipboard-BOEcuUOK.js";import"./index.vue_vue_type_script_setup_true_lang-vAe1u1qL.js";import"./sortable.esm-C0-Qcoum.js";import"./position_manage-fRVrwHNp.js";import"./department-C_TmgSnn.js";import"./configuration_role-BzwREJeM.js";import"./tenant_role-DsyakZuC.js";import"./configuration_manager-TKybNINI.js";const Oe=k=>(Me("data-v-d89b2677"),k=k(),Re(),k),qe={class:"absolute-container"},Ge={class:"page-main"},Je={class:"leftTree"},Ke={key:0,class:"leftData",span:3},Qe={class:"copyId tableSmall"},We={class:"id oneLine idFont"},Xe={style:{display:"flex","align-items":"center"}},Ye={key:0,xmlns:"http://www.w3.org/2000/svg",style:{"margin-top":"2px","margin-right":"7px"},width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},et=Oe(()=>_("g",{id:"Group 18384"},[_("circle",{id:"Ellipse 105",cx:"10",cy:"10",r:"10",fill:"#F8BB4F"}),_("path",{id:"ç®¡",d:"M13.9946 9.3605V12.1892H7.43481V12.9031H14.6277V16.4995H13.3481V16.0146H7.43481V16.486H6.15517V9.3605H13.9946ZM7.43481 14.8831H13.3481V13.9133H7.43481V14.8831ZM7.43481 11.1655H12.7419V10.3842H7.43481V11.1655ZM15.8534 7.67677V10.2495H14.6008V8.75436H5.52209V10.2495H4.2694V7.67677H9.48222C9.37446 7.40738 9.25323 7.16492 9.13201 6.9494L10.2635 6.76083L10.0345 6.61266C10.6541 5.80447 11.1121 4.9424 11.3815 4.01298L12.6072 4.28238C12.5264 4.51136 12.4591 4.72688 12.3782 4.9424H16.1228V6.06039H13.9273C14.1428 6.35673 14.3179 6.65307 14.4661 6.92246L13.3346 7.34003C13.1191 6.90899 12.8631 6.47796 12.5668 6.06039H11.8799C11.6509 6.5049 11.3949 6.92246 11.1121 7.29962L10.4655 6.88206C10.5733 7.12451 10.6676 7.39391 10.7753 7.67677H15.8534ZM6.08782 6.06039C5.79149 6.54531 5.46821 7.00328 5.118 7.42085L4 6.72042C4.78125 5.88529 5.33351 4.96934 5.67026 3.99951L6.89601 4.26891C6.81519 4.4979 6.72091 4.72688 6.64009 4.9424H10.0345V6.06039H8.01401C8.25647 6.39714 8.47198 6.72042 8.63362 7.03022L7.46175 7.47473C7.23276 6.98981 6.97683 6.51837 6.6805 6.06039H6.08782Z",fill:"white"})],-1)),tt=[et],Z=He({name:"user",__name:"index",setup(k){const{t:s}=Ne(),N=Te(),j=p(),O=Ie(),q=p([]),G=p("formSearch-user"),{pagination:y,getParams:at,onSizeChange:J,onCurrentChange:K,onSortChange:Q}=xe(),W=[{label:$(()=>s("common.enable")),value:!0},{label:$(()=>s("common.disable")),value:!1}],X={children:"children",label:"name"},Y=p(),P=p(),c=p({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),I=p(),x=p(),t=p({loading:!1,tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],search:{page:1,limit:10,id:"",userName:"",active:!0,departmentId:null},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}}),ee=p();async function m(){const e={...t.value.search},l=await E.list(e);l.data&&l.status===1&&(t.value.dataList=l.data.data,y.value.total=+l.data.total)}const te={activeList:()=>W};Ve(async()=>{try{c.value.loading=!0,q.value=await O.getCountry(),j.value=await(N==null?void 0:N.getPositionManage())||[],m(),H.forEach(e=>{e.checked&&t.value.checkList.push(e.prop)}),c.value.loading=!1}catch{}finally{c.value.loading=!1}}),we(()=>c.value.search,e=>{Y.value.filter(e)});function ae(e){return new Promise(l=>{T.confirm(`${s("configuration.user.confirmDisable")} ${e.active?s("common.disable"):s("common.enable")}「${e.userName}」${s("configuration.user.question")}`,s("configuration.user.confirmationInformation")).then(()=>{try{c.value.loading=!0,E.edit({id:e.id,email:e.email,phoneNumber:e.phoneNumber,userName:e.userName,country:e.country,role:e.role,positionId:e.positionId,organizationalStructureId:e.organizationalStructureId,active:!e.active}).then(()=>(D.success({message:`${e.active?s("common.disable"):s("common.enable")}${s("common.success")}`,center:!0}),m(),c.value.loading=!1,l(!0))).catch(()=>(c.value.loading=!1,l(!1)))}catch{}finally{c.value.loading=!1}}).catch(()=>l(!1))})}function le(e){var l;y.value.page=1,(l=e==null?void 0:e.children)!=null&&l.length?(t.value.search.id="",t.value.search.departmentId=e.id,m()):(t.value.search.id=e.id,t.value.search.departmentId="",m())}function ne(e){J(e).then(()=>{t.value.search.limit=e,m()})}function B(e=1){K(e).then(()=>{t.value.search.page=e,m()})}function oe({prop:e,order:l}){Q(e,l).then(()=>m())}function ie(e){t.value.dialog.id="",t.value.dialog.visible=!0,t.value.dialog.level=1,e&&(t.value.dialog.parentId=e.id,t.value.dialog.level=Number(e.level)+1)}const se=e=>{e.length>1&&(x.value.clearSelection(),x.value.toggleRowSelection(e[e.length-1])),I.value=e[e.length-1]};function re(){if(I.value){const{userName:e,id:l}=I.value;T.confirm(`确认将「${e}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{E.reset({id:l}).then(()=>{D.success({message:"重置成功",center:!0}),m()})}).catch(()=>{})}else D.warning({message:"请选择用户",center:!0})}function ue(e){t.value.row=JSON.stringify(e),t.value.dialog.id=e.id,t.value.dialog.parentId=e.parentId,t.value.dialog.visible=!0}function ce(e){P.value.showEdit(e)}function de(){Object.assign(t.value.search,{id:"",userName:"",departmentId:null,active:!0}),m()}const V=p();function me(e){e?V.value=e.id:V.value=""}return(e,l)=>{const M=r("el-tree"),pe=Ae,fe=r("ElDivider"),w=r("el-button"),R=r("el-col"),ge=Pe,ve=r("el-row"),v=r("ElTableColumn"),he=r("ElSwitch"),_e=r("el-tooltip"),ye=$e,b=r("el-text"),U=r("ElButton"),be=r("el-empty"),Ce=r("ElTable"),ke=r("ElPagination"),Se=Be,S=A("auth"),Le=A("loading");return i(),L("div",qe,[_("div",Ge,[_("div",Je,[c.value.tree.length?(i(),L("div",Ke,[o(M,{style:{"max-width":"37.5rem","min-height":"45.4375rem",padding:"10px"},data:c.value.tree,ref_key:"treeRef",ref:ee,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,props:X,onNodeClick:le},null,8,["data"])])):f("",!0),o(Se,null,{default:n(()=>[o(pe,{formSearchList:g(je),onCurrentChange:B,onOnReset:de,model:t.value.search,formOption:te,formSearchName:G.value},null,8,["formSearchList","model","formSearchName"]),o(fe,{"border-style":"dashed"}),C((i(),L("div",null,[o(ve,{style:{"margin-bottom":"0.3125rem"},gutter:24},{default:n(()=>[o(R,{style:{"margin-bottom":"1.5625rem"},span:10},{default:n(()=>[C((i(),u(w,{type:"primary",size:"default",onClick:ie},{default:n(()=>[d(h(g(s)("common.new")),1)]),_:1})),[[S,"user-insert-insertStaff"]]),C((i(),u(w,{type:"primary",size:"default",onClick:re},{default:n(()=>[d(h(g(s)("common.resetPassword")),1)]),_:1})),[[S,"user-get-resetPasswordStaff"]])]),_:1}),o(R,{style:{display:"flex","justify-content":"flex-end"},span:14},{default:n(()=>[o(w,{size:"default",onClick:l[0]||(l[0]=()=>{})},{default:n(()=>[d(h(g(s)("common.export")),1)]),_:1}),o(ge,{border:t.value.border,"onUpdate:border":l[1]||(l[1]=a=>t.value.border=a),tableAutoHeight:t.value.tableAutoHeight,"onUpdate:tableAutoHeight":l[2]||(l[2]=a=>t.value.tableAutoHeight=a),checkList:t.value.checkList,"onUpdate:checkList":l[3]||(l[3]=a=>t.value.checkList=a),columns:g(H),"onUpdate:columns":l[4]||(l[4]=a=>ze(H)?H.value=a:null),"line-height":t.value.lineHeight,"onUpdate:lineHeight":l[5]||(l[5]=a=>t.value.lineHeight=a),stripe:t.value.stripe,"onUpdate:stripe":l[6]||(l[6]=a=>t.value.stripe=a),style:{"margin-left":"0.75rem"},onQueryData:m},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),o(Ce,{ref_key:"userItemRef",ref:x,data:t.value.dataList,border:t.value.border,size:t.value.lineHeight,stripe:t.value.stripe,"highlight-current-row":"",height:"100%",onSortChange:oe,onCurrentChange:me,onSelectionChange:l[7]||(l[7]=a=>t.value.selectionDataList=a),"row-key":"id","default-expand-all":"",onSelect:se},{empty:n(()=>[o(be,{image:g(Ee),"image-size":300},null,8,["image"])]),default:n(()=>[o(v,{type:"selection",align:"left",fixed:""}),t.value.checkList.includes("active")?(i(),u(v,{key:0,align:"left",prop:"active",label:"状态",width:"84"},{default:n(a=>[o(he,{modelValue:a.row.active,"onUpdate:modelValue":z=>a.row.active=z,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>ae(a.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1})):f("",!0),t.value.checkList.includes("id")?(i(),u(v,{key:1,align:"left",width:"280",prop:"id",label:"员工ID"},{default:n(({row:a})=>[_("div",Qe,[_("div",We,[o(_e,{effect:"dark",content:a.id,placement:"top-start"},{default:n(()=>[d(h(a.id),1)]),_:2},1032,["content"])]),o(ye,{content:a.id,class:De({rowCopy:"rowCopy",current:a.id===V.value})},null,8,["content","class"])])]),_:1})):f("",!0),t.value.checkList.includes("userName")?(i(),u(v,{key:2,align:"left",prop:"userName",label:"用户名"},{default:n(({row:a})=>[o(b,{class:"tableBig"},{default:n(()=>[d(h(a.userName?a.userName:"-"),1)]),_:2},1024)]),_:1})):f("",!0),t.value.checkList.includes("phoneNumber")?(i(),u(v,{key:3,align:"left",width:"170",prop:"phone",label:"电话号码"},{default:n(({row:a})=>[o(b,{class:"fontC-System"},{default:n(()=>[d(h(a.phoneNumber?a.phoneNumber:"-"),1)]),_:2},1024)]),_:1})):f("",!0),t.value.checkList.includes("email")?(i(),u(v,{key:4,align:"left",width:"180",prop:"email",label:"邮箱"},{default:n(({row:a})=>[o(b,{class:"fontC-System"},{default:n(()=>[d(h(a.email?a.email:"-"),1)]),_:2},1024)]),_:1})):f("",!0),t.value.checkList.includes("departmentId")?(i(),u(v,{key:5,align:"left",prop:"departmentId",label:"部门"},{default:n(({row:a})=>[_("div",Xe,[a.enableChargePerson===1?(i(),L("svg",Ye,tt)):f("",!0),o(b,{class:"fontC-System"},{default:n(()=>[d(h(a.organizationalStructureName?a.organizationalStructureName:"-"),1)]),_:2},1024)])]),_:1})):f("",!0),t.value.checkList.includes("role")?(i(),u(v,{key:6,align:"left",prop:"role",label:"角色"},{default:n(({row:a})=>[o(b,{class:"fontC-System"},{default:n(()=>[d(h(a.role?a.role:"-"),1)]),_:2},1024)]),_:1})):f("",!0),t.value.checkList.includes("positionId")?(i(),u(v,{key:7,align:"left",prop:"positionId",label:"职位"},{default:n(({row:a})=>[o(b,null,{default:n(()=>[d(h(a.positionName?a.positionName:"-"),1)]),_:2},1024)]),_:1})):f("",!0),o(v,{label:"操作",fixed:"right",width:"200",align:"left"},{default:n(a=>[C((i(),u(U,{type:"primary",size:"small",plain:"",onClick:z=>ue(a.row)},{default:n(()=>[d(" 编辑 ")]),_:2},1032,["onClick"])),[[S,"user-update-updateStaff"]]),C((i(),u(U,{type:"warning",size:"small",plain:"",onClick:z=>ce(a.row)},{default:n(()=>[d(" 详情 ")]),_:2},1032,["onClick"])),[[S,"user-get-getStaffList"]])]),_:1})]),_:1},8,["data","border","size","stripe"]),o(ke,{"current-page":g(y).page,total:g(y).total,"page-size":g(y).size,"page-sizes":g(y).sizes,layout:g(y).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:ne,onCurrentChange:B},null,8,["current-page","total","page-size","page-sizes","layout"])])),[[Le,c.value.loading]])]),_:1})]),t.value.dialog.visible?(i(),u(Fe,{key:0,id:t.value.dialog.id,modelValue:t.value.dialog.visible,"onUpdate:modelValue":l[8]||(l[8]=a=>t.value.dialog.visible=a),"catalogue-id":t.value.search.catalogueId,"parent-id":t.value.dialog.parentId,level:t.value.dialog.level,tree:c.value.tree,dataList:t.value.dataList,row:t.value.row,onSuccess:m},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):f("",!0),o(Ze,{ref_key:"detailRef",ref:P},null,512)])])}}});typeof F=="function"&&F(Z);const yt=Ue(Z,[["__scopeId","data-v-d89b2677"]]);export{yt as default};
