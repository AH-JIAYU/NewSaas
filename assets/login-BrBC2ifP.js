
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as Ie}from"./index.vue_vue_type_script_setup_true_lang-DMO_GeF2.js";import{x as le,d as Ue,ao as qe,y as Re,a1 as Pe,a2 as Fe,r as u,aM as w,be as ae,aS as Se,a3 as Ae,b as oe,f as a,w as o,s as d,q as M,ar as O,i as l,z as $e,a as g,aJ as ze,aK as Le,O as Be,E as U,n as De,o as h,I as Ke,am as Ze,g as p,H as k,e as C,aC as te,j as G,aB as j,F as Me,t as Oe,N as Ge,R as je,ap as re}from"./index-Iao0X4w3.js";import He from"./agreement-CQ96hG1U.js";import Je from"./index-CW2uKgx7.js";const A={sendCode:y=>le.post("user/sendCode",y),register:y=>le.post("user/register",y)},q=y=>(ze("data-v-b4c6fc6f"),y=y(),Le(),y),Qe=q(()=>d("div",{class:"bg-banner"},null,-1)),We={id:"login-box"},Xe=q(()=>d("div",{class:"login-banner"},[d("h1",{style:{"font-size":"50px","font-weight":"normal"}},"欢迎"),d("h3",{h1:"",style:{"font-size":"30px","font-weight":"normal"}},"来到租户系统 !")],-1)),Ye={class:"title-container"},el={class:"fx-c"},ll={style:{height:"11.5625rem"}},al={class:"flex-bar",style:{width:"100%",margin:"0"}},ol={class:"flex-bar"},tl={class:"sub-link"},rl=q(()=>d("span",{class:"text"},"还不是会员?",-1)),nl={class:"flex-bar",style:{margin:"0"}},sl={class:"sub-link"},il=q(()=>d("span",{class:"text"},"已经有帐号?",-1)),ul=q(()=>d("div",{class:"title-container"},[d("h3",{class:"title"},"忘记密码了? 🔒")],-1)),dl={class:"sub-link"},ne=Ue({name:"Login",__name:"login",setup(y){var W;const se=qe(),ie=$e(),ue=Be(),de=Re(),pe=Pe(),{t:f}=Fe();new URL(""+new URL("login-banner-ZfMZACb6.png",import.meta.url).href,import.meta.url).href,new URL(""+new URL("logo-CLz_KCqM.png",import.meta.url).href,import.meta.url).href;const v=u("login"),V=u(!1),me=u(((W=ie.query.redirect)==null?void 0:W.toString())??de.settings.home.fullPath),E=u(),_=u("code"),$=u("获取验证码"),z=u(!1),i=u({account:w.local.get("login_account")||"",remember:w.local.has("login_account"),agreeToTheAgreement:!1}),ce=(n,e,s)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(i.value.account)?s():s(new Error("请输入合法手机号"))},ge=(n,e,s)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(i.value.account)?s():s(new Error("请输入合法邮箱"))},R=u({account:[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}],agreeToTheAgreement:[{required:!0,validator:(n,e)=>e===!0,message:"请阅读并勾选协议",trigger:"change"}]}),fe=()=>{i.value.account.includes("@")?R.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"},{validator:ge,trigger:"blur"}]:R.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"},{validator:ce,trigger:"blur"}]};async function ve(){E.value.validateField("account",async n=>{if(n){let e;i.value.account.includes("@")?e={email:i.value.account,type:"login_email"}:e={phone:i.value.account,type:"login_phone_number"};const{status:s}=await A.sendCode(e);s===1&&U.success({message:"已发送"})}}),_e()}const _e=()=>{z.value=!0;let n=60;b.value=setInterval(()=>{n>0?(n--,$.value=`请在${n}s后重新获取`):(clearInterval(b.value),$.value="获取验证码",b.value=null,z.value=!1)},1e3)},L=ae(()=>{E.value&&E.value.validate(n=>{if(n){let e={...i.value};_.value==="password"?e.type=1:i.value.account.includes("@")?e.type=3:e.type=2,V.value=!0,pe.login(e).then(()=>{V.value=!1,i.value.remember?w.local.set("login_account",i.value.account):w.local.remove("login_account"),ue.push(me.value)}).catch(()=>{V.value=!1})}})},3e3),b=u(null),B=u("获取验证码"),D=u(!1),P=u(),H=u([]),r=u({name:"",password:"",email:"",phoneNumber:"",code:"",country:"",type:"phone",agreeToTheAgreement:!1,companyType:"company",companyName:"",legalPersonName:"",taxID:""}),ye=u({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],companyName:[{required:!0,trigger:"blur",message:"请输入公司名称"}],companyType:[{required:!0,trigger:"change",message:"请选择账户类型"}],legalPersonName:[{required:!0,trigger:"blur",message:"请输入法人姓名"}],email:[{required:!0,trigger:"blur",message:"请输入邮箱"},{validator:(n,e,s)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(r.value.email)?s():s(new Error("请输入合法邮箱"))},trigger:"blur"}],phoneNumber:[{required:!0,trigger:"blur",message:"请输入手机号码"},{validator:(n,e,s)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(r.value.phoneNumber)?s():s(new Error("请输入合法手机号"))},trigger:"blur"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],country:[{required:!0,trigger:"change",message:"请选择国家"}],name:[{required:!0,trigger:"blur",message:"请输入用户名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}],isInvitation:[{required:!0,trigger:"blur",message:"请选择合作邀约"}],agreeToTheAgreement:[{required:!0,validator:(n,e)=>e===!0,message:"请阅读并勾选协议",trigger:"blur"}]}),be=async()=>{const n={type:"register_phone_number",email:r.value.email,phone:r.value.phoneNumber};if(r.value.country==="CN"){const{status:e}=await A.sendCode(n);e===1&&U.success({message:"已发送"})}else{n.type="register_email";const{status:e}=await A.sendCode(n);e===1&&U.success({message:"已发送"})}he()},he=()=>{D.value=!0;let n=60;b.value=setInterval(()=>{n>0?(n--,B.value=`请在${n}s后重新获取`):(clearInterval(b.value),B.value="获取验证码",b.value=null,D.value=!1)},1e3)},xe=ae(async()=>{console.log("registerForm.value",r.value),P.value&&P.value.validate(async n=>{if(n){r.value.type=r.value.country==="CN"?"phone":"email",delete r.value.agreeToTheAgreement;const{status:e}=await A.register(r.value);e===1&&(U.success({message:"注册成功"}),v.value="login",_.value="password",De(()=>{i.value.account=r.value.email||r.value.phoneNumber}))}})},3e3),K=u(),x=u({account:w.local.get("login_account"),code:"",newPassword:""}),we=u({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],newPassword:[{required:!0,trigger:"blur",message:"请输入新密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}]});function Ve(){U({message:"重置密码仅提供界面演示，无实际功能，需开发者自行扩展",type:"info"}),K.value&&K.value.validate(n=>{})}Se(()=>{clearInterval(b.value),b.value=null});const J=()=>{R.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"}],E.value.resetFields()};Ae(()=>v.value,async n=>{switch(n){case"login":J(),i.value={account:w.local.get("login_account")||"",remember:w.local.has("login_account")};break;case"register":P.value.resetFields(),r.value={name:"",password:"",email:"",phoneNumber:"",code:"",country:"",type:"phone"};break}n==="register"&&(H.value=await se.getCountry())});const Q=u(),F=n=>{console.log("val",n),Q.value.showEdit(n)};return(n,e)=>{const s=Ge,N=Ie,X=g("el-radio-button"),ke=g("el-radio-group"),T=g("el-button"),c=g("ElInput"),m=g("ElFormItem"),Z=g("ElCheckbox"),S=g("ElLink"),I=g("ElButton"),Ce=g("el-form"),Ee=g("ElOption"),Ne=g("ElSelect"),Y=g("el-option"),Te=g("el-select"),ee=g("ElForm");return h(),oe("div",null,[Qe,a(N,{placement:"bottom-end",class:"i18n-selector"},{default:o(()=>[a(s,{name:"i-ri:translate"})]),_:1}),d("div",We,[Xe,M(a(Ce,{ref_key:"loginFormRef",ref:E,model:l(i),rules:l(R),class:"login-form","validate-on-rule-change":!1},{default:o(()=>[d("div",Ye,[d("div",el,[a(ke,{modelValue:l(_),"onUpdate:modelValue":e[0]||(e[0]=t=>Ke(_)?_.value=t:null),size:"large",onChange:J},{default:o(()=>[a(X,{label:"验证码登录",value:"code"}),a(X,{label:"密码登录",value:"password"})]),_:1},8,["modelValue"])])]),d("div",ll,[a(m,{prop:"account"},{default:o(()=>[a(c,{modelValue:l(i).account,"onUpdate:modelValue":e[1]||(e[1]=t=>l(i).account=t),placeholder:l(f)("app.account"),type:"text",tabindex:"1",onBlur:fe},Ze({prefix:o(()=>[a(s,{name:"i-ri:user-3-fill"})]),_:2},[l(_)==="code"?{name:"append",fn:o(()=>[a(T,{type:"primary",disabled:l(z),onClick:ve},{default:o(()=>[p(k(l($)),1)]),_:1},8,["disabled"])]),key:"0"}:void 0]),1032,["modelValue","placeholder"])]),_:1}),l(_)==="password"?(h(),C(m,{key:0,prop:"password"},{default:o(()=>[a(c,{modelValue:l(i).password,"onUpdate:modelValue":e[2]||(e[2]=t=>l(i).password=t),type:"password",placeholder:l(f)("app.password"),tabindex:"2",autocomplete:"new-password","show-password":"",onKeyup:te(l(L),["enter"])},{prefix:o(()=>[a(s,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue","placeholder","onKeyup"])]),_:1})):G("",!0),l(_)==="code"?(h(),C(m,{key:1,prop:"code"},{default:o(()=>[a(c,{modelValue:l(i).code,"onUpdate:modelValue":e[3]||(e[3]=t=>l(i).code=t),type:"text",placeholder:l(f)("app.captcha"),tabindex:"2",onKeyup:te(l(L),["enter"])},{prefix:o(()=>[a(s,{name:"i-ep:message"})]),_:1},8,["modelValue","placeholder","onKeyup"])]),_:1})):G("",!0),a(m,{prop:"agreeToTheAgreement"},{default:o(()=>[d("div",al,[a(Z,{modelValue:l(i).agreeToTheAgreement,"onUpdate:modelValue":e[6]||(e[6]=t=>l(i).agreeToTheAgreement=t),tabindex:"3"},{default:o(()=>[p(" 我已阅读并同意 "),a(T,{type:"primary",size:"default",link:"",onClick:e[4]||(e[4]=t=>F(1))},{default:o(()=>[p("《会员协议》")]),_:1}),p("和"),a(T,{type:"primary",size:"default",link:"",onClick:e[5]||(e[5]=t=>F(2))},{default:o(()=>[p("《隐私协议》")]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),d("div",ol,[a(Z,{modelValue:l(i).remember,"onUpdate:modelValue":e[7]||(e[7]=t=>l(i).remember=t),tabindex:"4"},{default:o(()=>[p(" 保持登录 ")]),_:1},8,["modelValue"]),l(_)==="password"?(h(),C(S,{key:0,type:"primary",underline:!1,onClick:e[8]||(e[8]=t=>v.value="reset")},{default:o(()=>[p(" 忘记密码了? ")]),_:1})):G("",!0)]),a(I,{loading:l(V),type:"primary",size:"large",style:{width:"100%"},onClick:j(l(L),["prevent"]),tabindex:"5"},{default:o(()=>[p(k(l(f)("app.login")),1)]),_:1},8,["loading","onClick"]),d("div",tl,[rl,a(S,{type:"primary",underline:!1,onClick:e[9]||(e[9]=t=>v.value="register")},{default:o(()=>[p(" 立即注册 ")]),_:1})])]),_:1},8,["model","rules"]),[[O,l(v)==="login"]]),M(a(ee,{ref_key:"registerFormRef",ref:P,model:l(r),rules:l(ye),class:"login-form","auto-complete":"on"},{default:o(()=>[d("div",null,[a(m,{prop:"companyName"},{default:o(()=>[a(c,{modelValue:l(r).companyName,"onUpdate:modelValue":e[10]||(e[10]=t=>l(r).companyName=t),placeholder:"请输入公司名称"},null,8,["modelValue"])]),_:1}),a(m,{prop:"taxID"},{default:o(()=>[a(c,{modelValue:l(r).taxID,"onUpdate:modelValue":e[11]||(e[11]=t=>l(r).taxID=t),placeholder:"请输入公司税号"},null,8,["modelValue"])]),_:1}),a(m,{prop:"legalPersonName"},{default:o(()=>[a(c,{modelValue:l(r).legalPersonName,"onUpdate:modelValue":e[12]||(e[12]=t=>l(r).legalPersonName=t),placeholder:"请输入法人姓名"},null,8,["modelValue"])]),_:1}),a(m,{prop:"name"},{default:o(()=>[a(c,{modelValue:l(r).name,"onUpdate:modelValue":e[13]||(e[13]=t=>l(r).name=t),placeholder:"用户名",tabindex:"1"},{prefix:o(()=>[a(s,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue"])]),_:1}),a(m,{prop:"country"},{default:o(()=>[a(Ne,{modelValue:l(r).country,"onUpdate:modelValue":e[14]||(e[14]=t=>l(r).country=t),placeholder:"国家",clearable:"",filterable:"",tabindex:"2"},{prefix:o(()=>[a(s,{name:"i-mdi:format-list-bulleted-type"})]),default:o(()=>[(h(!0),oe(Me,null,Oe(l(H),t=>(h(),C(Ee,{label:t.chineseName,value:t.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),l(r).country==="CN"?(h(),C(m,{key:0,prop:"phoneNumber"},{default:o(()=>[a(c,{modelValue:l(r).phoneNumber,"onUpdate:modelValue":e[15]||(e[15]=t=>l(r).phoneNumber=t),placeholder:"手机号",tabindex:"3"},{prefix:o(()=>[a(s,{name:"i-ant-design:phone-outlined"})]),_:1},8,["modelValue"])]),_:1})):(h(),C(m,{key:1,prop:"email"},{default:o(()=>[a(c,{modelValue:l(r).email,"onUpdate:modelValue":e[16]||(e[16]=t=>l(r).email=t),placeholder:"邮箱",tabindex:"3"},{prefix:o(()=>[a(s,{name:"i-mdi:email"})]),_:1},8,["modelValue"])]),_:1})),a(m,{prop:"code"},{default:o(()=>[a(c,{modelValue:l(r).code,"onUpdate:modelValue":e[17]||(e[17]=t=>l(r).code=t),placeholder:"验证码",tabindex:"4"},{prefix:o(()=>[a(s,{name:"i-ic:baseline-verified-user"})]),append:o(()=>[a(I,{disabled:l(D),onClick:be},{default:o(()=>[p(k(l(B)),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),a(m,{prop:"password"},{default:o(()=>[a(c,{modelValue:l(r).password,"onUpdate:modelValue":e[18]||(e[18]=t=>l(r).password=t),type:"password",placeholder:"密码",tabindex:"5","show-password":""},{prefix:o(()=>[a(s,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue"])]),_:1}),a(m,{prop:"isInvitation"},{default:o(()=>[a(Te,{modelValue:l(r).isInvitation,"onUpdate:modelValue":e[19]||(e[19]=t=>l(r).isInvitation=t),tabindex:"6",placeholder:"是否开启合作邀约",filterable:""},{prefix:o(()=>[a(s,{name:"i-ant-design:container-outlined"})]),default:o(()=>[a(Y,{label:"开启",value:2}),a(Y,{label:"不开启",value:1})]),_:1},8,["modelValue"])]),_:1}),a(m,{prop:"agreeToTheAgreement"},{default:o(()=>[d("div",nl,[a(Z,{modelValue:l(i).agreeToTheAgreement,"onUpdate:modelValue":e[22]||(e[22]=t=>l(i).agreeToTheAgreement=t),tabindex:"3"},{default:o(()=>[p(" 我已阅读并同意 "),a(T,{type:"primary",size:"default",link:"",onClick:e[20]||(e[20]=t=>F(1))},{default:o(()=>[p("《会员协议》")]),_:1}),p("和"),a(T,{type:"primary",size:"default",link:"",onClick:e[21]||(e[21]=t=>F(2))},{default:o(()=>[p("《隐私协议》")]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),a(I,{tabindex:"7",loading:l(V),type:"primary",size:"large",style:{width:"100%","margin-top":"20px"},onClick:j(l(xe),["prevent"])},{default:o(()=>[p(" 注册 ")]),_:1},8,["loading","onClick"]),d("div",sl,[il,a(S,{type:"primary",underline:!1,onClick:e[23]||(e[23]=t=>v.value="login")},{default:o(()=>[p(" 去登录 ")]),_:1})])]),_:1},8,["model","rules"]),[[O,l(v)==="register"]]),M(a(ee,{ref_key:"resetFormRef",ref:K,model:l(x),rules:l(we),class:"login-form"},{default:o(()=>[ul,d("div",null,[a(m,{prop:"account"},{default:o(()=>[a(c,{modelValue:l(x).account,"onUpdate:modelValue":e[24]||(e[24]=t=>l(x).account=t),placeholder:l(f)("app.account"),type:"text",tabindex:"1"},{prefix:o(()=>[a(s,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1}),a(m,{prop:"code"},{default:o(()=>[a(c,{modelValue:l(x).code,"onUpdate:modelValue":e[25]||(e[25]=t=>l(x).code=t),placeholder:l(f)("app.code"),type:"text",tabindex:"2"},{prefix:o(()=>[a(s,{name:"i-ic:baseline-verified-user"})]),append:o(()=>[a(I,null,{default:o(()=>[p(k(l(f)("app.sendCaptcha")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),a(m,{prop:"newPassword"},{default:o(()=>[a(c,{modelValue:l(x).newPassword,"onUpdate:modelValue":e[26]||(e[26]=t=>l(x).newPassword=t),type:"password",placeholder:l(f)("app.newPassword"),tabindex:"3","show-password":""},{prefix:o(()=>[a(s,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1})]),a(I,{loading:l(V),type:"primary",size:"large",style:{width:"100%","margin-top":"20px"},onClick:j(Ve,["prevent"])},{default:o(()=>[p(k(l(f)("app.check")),1)]),_:1},8,["loading"]),d("div",dl,[a(S,{type:"primary",underline:!1,onClick:e[27]||(e[27]=t=>v.value="login")},{default:o(()=>[p(k(l(f)("app.goLogin")),1)]),_:1})])]),_:1},8,["model","rules"]),[[O,l(v)==="reset"]])]),a(Je),a(He,{ref_key:"agreementRef",ref:Q},null,512)])}}});typeof re=="function"&&re(ne);const _l=je(ne,[["__scopeId","data-v-b4c6fc6f"]]);export{_l as default};
