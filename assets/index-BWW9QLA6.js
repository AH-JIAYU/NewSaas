
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as $,aN as G,r as _,a as n,q as J,s as S,o as h,e as v,w as t,f as a,i as u,aM as K,g as i,z as r,bf as Q,p as R,be as W,aH as X,aI as Y,y as z,L as Z}from"./index-BHfIgYzG.js";import{a as ee}from"./financial_pm_log-DSTEQoy0.js";const I=f=>(X("data-v-3964a58b"),f=f(),Y(),f),ae=I(()=>z("div",{class:"minusSign i-iconamoon:sign-minus-bold w-1em h-1em"},null,-1)),te=I(()=>z("div",{class:"plusSpan i-typcn:plus w-1em h-1em"},null,-1)),le=$({__name:"index",emits:["fetch-data"],setup(f,{expose:C,emit:x}){const{format:E}=Q(),k=x,{pagination:p,getParams:oe,onSizeChange:D,onCurrentChange:T,onSortChange:ne}=G(),B=_([]),l=_({loading:!1,activeName:"myFinancial",tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],search:{page:1,limit:10,userId:null,organizationalStructureId:null}}),g=_(!1),y=_();async function L(o){if(o.organizationalStructureId){l.value.search.organizationalStructureId=o.organizationalStructureId,await b();const s=await R.queryNotEnableStaffList({organizationalStructureId:l.value.search.organizationalStructureId});B.value=s.data}g.value=!0}const b=async()=>{try{l.value.loading=!0;const o={...l.value.search},s=await ee.getStaffFinancial(o);y.value=s.data.userList,p.value.total=+s.data.total,l.value.loading=!1}catch{}finally{l.value.loading=!1}};function N(o){D(o).then(()=>{l.value.search.limit=o,b()})}function V(o=1){T(o).then(()=>{l.value.search.page=o,b()})}function M(){k("fetch-data"),Object.assign(l.value.search,{page:1,limit:10,userId:null,organizationalStructureId:null}),g.value=!1}return C({showEdit:L}),(o,s)=>{const j=n("ElDivider"),F=n("ElForm"),c=n("el-text"),d=n("ElTableColumn"),m=W,H=n("el-tag"),P=n("el-tooltip"),q=n("el-empty"),A=n("ElTable"),U=n("ElPagination"),O=n("el-drawer"),w=J("loading");return S((h(),v(O,{modelValue:g.value,"onUpdate:modelValue":s[1]||(s[1]=e=>g.value=e),"append-to-body":"","close-on-click-modal":!1,"destroy-on-close":"",draggable:"",size:"70%",title:"财务日志",onClose:M},{default:t(()=>[a(j,{"border-style":"dashed"}),a(F,{model:l.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},null,8,["model"]),S((h(),v(A,{border:l.value.border,size:l.value.lineHeight,stripe:l.value.stripe,class:"my-4",data:y.value,"highlight-current-row":"",onSortChange:o.sortChange,onSelectionChange:s[0]||(s[0]=e=>l.value.batch.selectionDataList=e)},{empty:t(()=>[a(q,{image:u(K),"image-size":300},null,8,["image"])]),default:t(()=>[a(d,{"show-overflow-tooltip":"",align:"left",prop:"",label:"点击ID"},{default:t(({row:e})=>[a(c,{class:"color3"},{default:t(()=>[i(r(e.clientId?e.clientId:"-"),1)]),_:2},1024)]),_:1}),a(d,{"show-overflow-tooltip":"",align:"left",prop:"projectId",label:"项目ID"},{default:t(({row:e})=>[a(c,{class:"color3"},{default:t(()=>[i(r(e.projectId?e.projectId:"-"),1)]),_:2},1024)]),_:1}),a(d,{"show-overflow-tooltip":"",align:"left",prop:"remark",label:"业绩"},{default:t(({row:e})=>[a(c,{class:"mx-1 color3"},{default:t(()=>[i(r(e.doMoney?e.doMoney:"-"),1)]),_:2},1024)]),_:1}),a(d,{"show-overflow-tooltip":"",align:"left",prop:"remark",label:"说明"},{default:t(({row:e})=>[a(c,{class:"mx-1 color3"},{default:t(()=>[i(r(e.remark?e.remark:"-"),1)]),_:2},1024)]),_:1}),a(d,{"show-overflow-tooltip":"",align:"left",prop:"beforeBalance",width:"150",label:"变动前"},{default:t(({row:e})=>[a(m),a(c,{class:"mx-1 color3"},{default:t(()=>[i(r(e.beforeBalance||0),1)]),_:2},1024)]),_:1}),a(d,{"show-overflow-tooltip":"",align:"left",prop:"addAndSubtraction",width:"150",label:"提成"},{default:t(({row:e})=>[e.type===2?(h(),v(c,{key:0,type:"",class:"mx-1 color3"},{default:t(()=>[ae,a(m),i(r(Math.abs(e.difference)),1)]),_:2},1024)):(h(),v(c,{key:1,type:"",class:"mx-1 color3"},{default:t(()=>[te,a(m),i(r(Math.abs(e.difference)),1)]),_:2},1024))]),_:1}),a(d,{"show-overflow-tooltip":"",align:"left",prop:"afterBalance",width:"150",label:"变动后"},{default:t(({row:e})=>[a(m),a(c,{class:"color3"},{default:t(()=>[i(r(e.afterBalance||0),1)]),_:2},1024)]),_:1}),a(d,{"show-overflow-tooltip":"",align:"left",prop:"createTime",label:"时间"},{default:t(({row:e})=>[a(P,{content:e.createTime,placement:"top"},{default:t(()=>[a(H,{effect:"plain",type:"info"},{default:t(()=>[i(r(u(E)(e.createTime)),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1})]),_:1},8,["border","size","stripe","data","onSortChange"])),[[w,l.value.loading]]),a(U,{"current-page":u(p).page,total:u(p).total,"page-size":u(p).size,"page-sizes":u(p).sizes,layout:u(p).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:N,onCurrentChange:V},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1},8,["modelValue"])),[[w,l.value.loading]])}}}),re=Z(le,[["__scopeId","data-v-3964a58b"]]);export{re as default};
