
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as P}from"./project_settlement-iEUGFttv.js";import{d as q,r as n,a as s,al as F,o as g,b as H,f as t,w as a,C as r,g as d,am as J,e as j,j as h,E as w,aK as K,aL as M,P as $}from"./index-Deny_hqO.js";const N=v=>(K("data-v-94a76493"),v=v(),M(),v),A={class:"border"},G=N(()=>r("p",{class:"pp"},"项目ID",-1)),Q={class:"neip"},W={class:"border"},X=N(()=>r("p",{class:"pp"},"项目名称",-1)),Y={class:"neip"},Z={class:"shenhe"},ee={class:"beizhu"},le={class:"po"},te={style:{flex:"auto"}},ae=q({name:"ProjectReview",__name:"index",emits:["success"],setup(v,{expose:T,emit:D}){const S=D,V=n(!1),u=n(),e=n({projectId:"",projectName:"",settlementType:"",remark:"",projectSettlementBuilderList:[],po:"",arr:""}),z=n({settlementType:[{required:!0,message:"请选择审核方式",trigger:"change"}],arr:[{required:!0,message:"请输入至少一个ID",trigger:"blur"}]}),_=n(),y=n(!1),i=n(!1);async function B(p){p&&(u.value=JSON.parse(p),e.value.projectId=u.value.projectId,e.value.projectName=u.value.projectName),i.value=!0}async function C(){_.value&&_.value.validate(async p=>{if(p){V.value=!0,delete e.value.projectName,e.value.settlementType===1||e.value.settlementType===2?(e.value.projectSettlementBuilderList=e.value.arr.split(`
`)||[],delete e.value.arr):e.value.projectSettlementBuilderList=[];const{status:l}=await P.review(e.value);l===1?(S("success"),V.value=!1,w.success({message:"操作成功",center:!0}),I()):w.error({message:"操作失败，请联系工作人员",center:!0})}else w({message:"请检查必填项",type:"warning"})})}function I(){_.value.resetFields(),Object.assign(e.value,{projectId:"",projectName:"",settlementType:"",remark:"",projectSettlementBuilderList:[],po:"",arr:""}),e.value.arr=[],i.value=!1}return T({showEdit:B}),(p,l)=>{const m=s("el-input"),b=s("el-row"),c=s("el-radio"),U=s("el-radio-group"),f=s("el-form-item"),k=s("el-col"),L=s("el-checkbox"),R=s("el-form"),x=s("el-button"),E=s("el-drawer"),O=F("loading");return g(),H("div",null,[t(E,{modelValue:i.value,"onUpdate:modelValue":l[9]||(l[9]=o=>i.value=o),title:"项目审核",size:"50%","before-close":I},{footer:a(()=>[r("div",te,[t(x,{type:"primary",onClick:C},{default:a(()=>[d(" 确定 ")]),_:1}),t(x,{onClick:l[8]||(l[8]=o=>i.value=!1)},{default:a(()=>[d(" 取消 ")]),_:1})])]),default:a(()=>[J((g(),j(R,{ref_key:"formRef",ref:_,model:e.value,rules:z.value,"label-width":"174px",inline:!1},{default:a(()=>[t(b,{style:{margin:"0"},gutter:20},{default:a(()=>[r("div",A,[G,r("p",Q,[t(m,{modelValue:u.value.projectId,"onUpdate:modelValue":l[0]||(l[0]=o=>u.value.projectId=o),placeholder:"请输入项目ID",clearable:""},null,8,["modelValue"])])]),r("div",W,[X,r("p",Y,[t(m,{modelValue:u.value.projectName,"onUpdate:modelValue":l[1]||(l[1]=o=>u.value.projectName=o),placeholder:"请输入项目名称",clearable:""},null,8,["modelValue"])])])]),_:1}),r("div",Z,[t(f,{prop:"settlementType",style:{display:"flex","align-items":"center"},label:"审核方式"},{default:a(()=>[t(U,{modelValue:e.value.settlementType,"onUpdate:modelValue":l[2]||(l[2]=o=>e.value.settlementType=o)},{default:a(()=>[t(c,{value:1,size:"large"},{default:a(()=>[d(" 按成功ID ")]),_:1}),t(c,{value:2,size:"large"},{default:a(()=>[d(" 按失败ID ")]),_:1}),t(c,{value:3,size:"large"},{default:a(()=>[d(" 全部通过 ")]),_:1}),t(c,{value:4,size:"large"},{default:a(()=>[d(" 全部失败 ")]),_:1}),t(c,{value:5,size:"large"},{default:a(()=>[d(" 数据冻结 ")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),r("div",ee,[t(f,{label:"备注"},{default:a(()=>[t(m,{class:"custom-input",modelValue:e.value.remark,"onUpdate:modelValue":l[3]||(l[3]=o=>e.value.remark=o),placeholder:"",clearable:""},null,8,["modelValue"])]),_:1})]),r("div",le,[y.value?(g(),j(f,{key:0,label:"结算PO号"},{default:a(()=>[t(m,{modelValue:e.value.po,"onUpdate:modelValue":l[4]||(l[4]=o=>e.value.po=o),class:"custom-input",placeholder:"",clearable:"",onChange:l[5]||(l[5]=()=>{})},null,8,["modelValue"])]),_:1})):h("",!0)]),t(b,{style:{margin:"0"},gutter:20},{default:a(()=>[t(k,{span:20}),t(k,{span:4},{default:a(()=>[t(L,{modelValue:y.value,"onUpdate:modelValue":l[6]||(l[6]=o=>y.value=o),label:"填写结算PO号",size:"large"},null,8,["modelValue"])]),_:1})]),_:1}),e.value.settlementType===1||e.value.settlementType===2?(g(),j(b,{key:0,style:{margin:"0",width:"100%"},gutter:20},{default:a(()=>[t(f,{style:{width:"100%"},prop:"arr"},{default:a(()=>[t(m,{modelValue:e.value.arr,"onUpdate:modelValue":l[7]||(l[7]=o=>e.value.arr=o),placeholder:"请粘贴ID，每行一个,多个请回车换行",type:"textarea",rows:"15"},null,8,["modelValue"])]),_:1})]),_:1})):h("",!0)]),_:1},8,["model","rules"])),[[O,V.value]])]),_:1},8,["modelValue"])])}}}),re=$(ae,[["__scopeId","data-v-94a76493"]]);export{re as default};
