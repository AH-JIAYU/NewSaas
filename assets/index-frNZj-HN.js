
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as te,aK as ae,r as s,a5 as ne,c as oe,k as le,a as b,p as ie,o as r,b as S,f as o,w as l,g as p,i as t,I as g,q as se,e as m,j as d,H as B,S as re,aL as ce,E as ue,aM as pe,aN as de,ba as fe,ap as me,R as _e}from"./index-CWiGh2AJ.js";import{_ as be}from"./index.vue_vue_type_style_index_0_lang-ccIzpN-O.js";import ge from"./index-BQznDGRc.js";import{_ as ve}from"./index.vue_vue_type_script_setup_true_lang-CfDCbCJy.js";import{c as L}from"./user_cooperation-Cc-N7P05.js";const he={key:0},ye={key:1},ke=te({name:"cooperation",__name:"index",setup(we){const{pagination:_,getParams:P,onSizeChange:D,onCurrentChange:N}=ae(),v=s(!1),T=s([]),R=s(),E=s(),$=s(),h=s(!0),y=s(!1),k=s(!1),w=s("default"),c=s([]),I=s([{label:"租户id",checked:!0,sortable:!0,prop:"beInvitationTenantId"},{label:"租户名称",checked:!0,sortable:!0,prop:"beInvitationTenantName"},{label:"状态",checked:!0,sortable:!0,prop:"bindStatus"},{label:"价格比例",checked:!0,sortable:!0,prop:"priceRatio"},{label:"待审金额",checked:!0,sortable:!0,prop:"pendBalance"},{label:"可用金额",checked:!0,sortable:!0,prop:"availableBalance"}]);function A(){R.value.showEdit()}function H(n){ce.prompt("是否确认进行解约?","终止合作",{confirmButtonText:"确认",cancelButtonText:"取消",inputPlaceholder:"说明",inputPattern:/^.{0,500}$/,inputErrorMessage:"不能超过500个字符",type:"warning"}).then(async a=>{const{data:{flag:u}}=await L.updateRescindTenant({beInvitationTenantId:n.beInvitationTenantId,remark:a.value});u&&ue({type:"success",message:"已终止合作"}),z()}).catch(()=>{})}function M(n){E.value.showEdit(n)}const U=ne({});function F(n){D(n).then(()=>z())}function q(n=1){N(n).then(()=>z())}function C(){_.value.page=1,z()}async function z(){try{v.value=!0;const n={...P(),...U},{data:a}=await L.list(n);T.value=a.tenantBindInfoList,_.value.total=Number(a.total),v.value=!1}catch{}finally{v.value=!1}}function V(n){$.value=n}const j=oe(()=>{const n=T.value.filter(i=>i.bindStatus===2);let a=T.value.filter(i=>i.bindStatus===4);a=Array.from(new Map(a.map(i=>[i.beInvitationTenantId,i])).values());const u=n.map(i=>i.beInvitationTenantId);return a.forEach(i=>{u.includes(i.beInvitationTenantId)||n.push(i)}),n});return le(()=>{I.value.forEach(n=>{n.checked&&c.value.push(n.prop)}),C()}),(n,a)=>{const u=b("el-button"),i=be,K=pe,O=de,Q=b("el-row"),f=b("el-table-column"),x=fe,G=b("ElSpace"),J=b("el-empty"),W=b("el-table"),X=b("ElPagination"),Y=me,Z=ie("loading");return r(),S("div",{class:re({"absolute-container":t(k)})},[o(Y,null,{default:l(()=>[o(Q,null,{default:l(()=>[o(i,null,{default:l(()=>[o(u,{type:"primary",size:"default",onClick:A},{default:l(()=>[p(" 邀约公司 ")]),_:1})]),_:1}),o(O,null,{default:l(()=>[o(u,{size:"default"},{default:l(()=>[p(" 导出 ")]),_:1}),o(K,{border:t(h),"onUpdate:border":a[0]||(a[0]=e=>g(h)?h.value=e:null),tableAutoHeight:t(k),"onUpdate:tableAutoHeight":a[1]||(a[1]=e=>g(k)?k.value=e:null),checkList:t(c),"onUpdate:checkList":a[2]||(a[2]=e=>g(c)?c.value=e:null),columns:t(I),"onUpdate:columns":a[3]||(a[3]=e=>g(I)?I.value=e:null),"line-height":t(w),"onUpdate:lineHeight":a[4]||(a[4]=e=>g(w)?w.value=e:null),stripe:t(y),"onUpdate:stripe":a[5]||(a[5]=e=>g(y)?y.value=e:null),style:{"margin-left":"12px"},onQueryData:C},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),se((r(),m(W,{border:t(h),data:t(j),size:t(w),stripe:t(y),onSelectionChange:V},{empty:l(()=>[o(J,{class:"vab-data-empty",description:"暂无数据"})]),default:l(()=>[o(f,{align:"center",type:"selection"}),t(c).includes("beInvitationTenantId")?(r(),m(f,{key:0,align:"center",prop:"beInvitationTenantId",width:"180","show-overflow-tooltip":"",label:"租户id"})):d("",!0),t(c).includes("beInvitationTenantName")?(r(),m(f,{key:1,align:"center",prop:"beInvitationTenantName","show-overflow-tooltip":"",label:"租户名称"})):d("",!0),t(c).includes("bindStatus")?(r(),m(f,{key:2,align:"center",prop:"bindStatus","show-overflow-tooltip":"",label:"状态"},{default:l(({row:e})=>[e.bindStatus===2?(r(),S("span",he," 合作 ")):d("",!0),e.bindStatus===4?(r(),S("span",ye," 解约 ")):d("",!0)]),_:1})):d("",!0),t(c).includes("priceRatio")?(r(),m(f,{key:3,align:"center",prop:"priceRatio","show-overflow-tooltip":"",label:"价格比例"},{default:l(({row:e})=>[p(B(e.priceRatio)+" % ",1)]),_:1})):d("",!0),t(c).includes("pendBalance")?(r(),m(f,{key:4,align:"center",prop:"pendBalance","show-overflow-tooltip":"",label:"待审金额"},{default:l(({row:e})=>[o(x),p(B(e.pendBalance||0),1)]),_:1})):d("",!0),t(c).includes("availableBalance")?(r(),m(f,{key:5,align:"center",prop:"availableBalance","show-overflow-tooltip":"",label:"可用金额"},{default:l(({row:e})=>[o(x),p(B(e.availableBalance||0),1)]),_:1})):d("",!0),o(f,{align:"center",fixed:"right",prop:"i",label:"操作","show-overflow-tooltip":"",width:"350"},{default:l(({row:e})=>[o(G,null,{default:l(()=>[e.bindStatus===2?(r(),m(u,{key:0,type:"primary",plain:"",size:"small",onClick:ee=>H(e)},{default:l(()=>[p(" 终止合作 ")]),_:2},1032,["onClick"])):d("",!0),o(u,{size:"small",plain:"",type:"primary",onClick:ee=>M(e)},{default:l(()=>[p(" 价格比例 ")]),_:2},1032,["onClick"]),o(u,{type:"primary",plain:"",size:"small"},{default:l(()=>[p(" 财务日志 ")]),_:1}),o(u,{type:"primary",plain:"",size:"small"},{default:l(()=>[p(" 加减款 ")]),_:1})]),_:2},1024)]),_:1})]),_:1},8,["border","data","size","stripe"])),[[Z,t(v)]]),o(X,{"current-page":t(_).page,total:t(_).total,"page-size":t(_).size,"page-sizes":t(_).sizes,layout:t(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:F,onCurrentChange:q},null,8,["current-page","total","page-size","page-sizes","layout"]),o(ge,{ref_key:"editRef",ref:R,onFetchData:C},null,512),o(ve,{ref_key:"proportionRef",ref:E,onFetchData:C},null,512)]),_:1})],2)}}}),Be=_e(ke,[["__scopeId","data-v-cab5ac14"]]);export{Be as default};
