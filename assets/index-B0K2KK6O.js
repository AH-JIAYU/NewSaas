
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{E as _e,k as f,d as ye,x as Te,r as _,a4 as Ve,G as Pe,a5 as je,a as s,o as m,e as y,w as l,f as e,b as I,n as w,i as d,F as k,l as p,j as L,g as ve,I as Ie,be as Le,p as z,ak as h,an as F,N as Ce,aF as Ue,aG as xe,_ as we}from"./index-fuY6ctZR.js";import{e as ke}from"./index-C8cHQ_M6.js";import{g as De,z as Se,a as Qe}from"./index-DFJLODe7.js";import{o as D}from"./apiLoading-3YAmOqA8.js";import{u as he}from"./otherFunctions_basicDictionary-D3X8j4Bd.js";import{u as Ee}from"./user_customer-DDO7eHSM.js";const Ne=_e("projectManagementList",()=>({initialTopTabsData:{name:"",projectIdentification:"",clientId:null,countryId:[],doMoneyPrice:null,num:null,minimumDuration:null,ir:null,uidUrl:"",mutualExclusion:2,mutualExclusionId:"",remark:"",isPinned:2,isOnline:2,isProfile:2,isB2b:1,projectType:"",projectRemark:"",isTimeReleases:1,releaseTime:"",descriptionUrl:"",richText:"",addProjectQuotaInfoList:[],timeDifferenceDetection:2,ipDifferenceDetection:2,ipConsistency:2,limitedQuantity:null,preNum:null},initialProblem:{countryId:null,projectProblemCategoryId:null,projectQuotaQuestionType:null,projectProblemId:null,keyValue:"",answerValue:[],projectAnswerId:[]}})),Me=Ne,Re={upload:u=>f.post("project/uploadQiniu",u),detail:u=>f.post("project/getQiniuFileUrl",u),delete:u=>f.post("project/deleteQiniu",u)},E={list:u=>f.post("project/getProjectList",u),detail:u=>f.post("project/getProject",u),create:u=>f.post("project/addProject",u),edit:u=>f.post("project/updateProject",u),getProjectCountryList:u=>f.post("project/getProjectCountryList",u),getProjectCategoryList:u=>f.post("project/getProjectCategoryList",u),getProjectProblemList:u=>f.post("/project/getProjectProblemList",u)},V=u=>(Ue("data-v-77d72a00"),u=u(),xe(),u),qe=V(()=>p("div",{class:"card-header"},[p("span",null,"基本信息")],-1)),ze={class:"fx-c"},Fe=V(()=>p("span",null,"最小分长",-1)),Be={style:{display:"flex","justify-content":"space-between"},class:"card-header"},Oe=V(()=>p("span",null,"描述配额",-1)),Ae={key:0},Ye=V(()=>p("div",{class:"el-upload__text"},"上传",-1)),$e=V(()=>p("div",{class:"el-upload__tip"},"jpg/png单文件大小小于10 mb",-1)),Ge=["src"],He=V(()=>p("div",{class:"card-header"},[p("span",null,"其他设置")],-1)),Je=V(()=>p("div",{class:"card-header"},"配置信息",-1)),Ke=V(()=>p("div",{class:"card-header"},"安全信息",-1)),We=ye({name:"SurveyTopTabs",__name:"index",props:{leftTab:Object,tabIndex:Number},setup(u){const N=he(),B=Ee(),O=Me(),A=Te("validateTopTabs"),o=u,S=_("basicSettings"),M=_(),C=_(!1),i=Ve({initialProblem:{countryId:null,projectProblemCategoryId:null,projectQuotaQuestionType:null,projectProblemId:null,keyValue:"",answerValue:[],projectAnswerId:[]},countryList:[],customerList:[],configurationCountryList:[],projectCategoryList:null,ProjectProblemInfoList:[]}),Y=_({name:[{required:!0,message:"请输入项目名称",trigger:"blur"},{min:2,max:50,message:"内容在2-50个字之间",trigger:"blur"}],projectIdentification:[{required:!0,message:"请输入项目标识",trigger:"blur"},{min:2,max:50,message:"内容在2-50个字之间",trigger:"blur"}],countryId:[{required:!0,message:"请选择所属国家",trigger:"change"}],clientId:[{required:!0,message:"请选择所属客户",trigger:"change"}],uidUrl:[{required:!0,message:"请输入UidUrl",trigger:"blur"}],doMoneyPrice:[{required:!0,message:"请输入原价(美元)",trigger:"blur"}],num:[{required:!0,message:"请输入配额",trigger:"blur"}],ir:[{required:!0,message:"请输入配额",trigger:"blur"}],addProjectQuotaInfoList:[{countryId:[{required:!0,message:"请选择国家",trigger:"change"}]}]});_([{value:"终端",label:"终端"},{value:"性别",label:"性别"},{value:"年龄",label:"年龄"}]),_([4,8]);const $=[De({locale:Qe})];function G(c){o.leftTab.richText=c}function H(){C.value=!C.value}const R=_(""),U=_(!1),J=async(c,a)=>{const{status:b}=await Re.delete({fileName:o.leftTab.descriptionUrl});b===1&&h.success({message:"删除成功",center:!0})},K=(c,a)=>{o.leftTab.descriptionUrl=c.data.qiNiuUrl},W=async(c,a)=>{h.warning({message:"只能上传一个,删除原文件后重新上传",center:!0})},X=c=>{R.value=c.url,U.value=!0},Z=()=>{i.configurationCountryList=null},ee=()=>{i.projectCategoryList=null},le=async c=>{if(c==="configurationInformation"&&!i.configurationCountryList){const a=await D(E.getProjectCountryList({countryIdList:o.leftTab.countryId}));i.configurationCountryList=a.data.getProjectCountryListInfoList,i.initialProblem=F(O.initialProblem),i.initialProblem.projectQuotaQuestionType=a.data.projectQuotaQuestionType}},te=_(),ae=async()=>{if(i.initialProblem.countryId){if(!i.projectCategoryList){const c={countryId:i.initialProblem.countryId,projectQuotaQuestionType:i.initialProblem.projectQuotaQuestionType},a=await D(E.getProjectCategoryList(c));i.projectCategoryList=a.data.getProjectCategoryInfoList}}else h.warning({message:"请先选择国家",center:!0})},oe=async c=>{if(console.log("data.initialProblem",i.initialProblem),c){const{projectProblemCategoryName:a,...b}=i.projectCategoryList.find(n=>n.projectProblemCategoryId===c),r=await D(E.getProjectProblemList(b));i.ProjectProblemInfoList=r.data.getProjectProblemInfoList;for(let n=0;n<i.ProjectProblemInfoList.length;n++){const P=F(i.initialProblem);P.projectProblemId=i.ProjectProblemInfoList[n].id,P.keyValue=i.ProjectProblemInfoList[n].question,o.leftTab.addProjectQuotaInfoList.push(P)}}},ne=async()=>{i.customerList=await B.getCustomerList(),i.countryList=await N.getCountry()};return Pe(async()=>{await D(ne())}),je(()=>{A(M.value)}),(c,a)=>{const b=s("el-input"),r=s("el-form-item"),n=s("el-col"),P=s("el-option"),x=s("el-select"),q=s("ElOption"),re=s("ElSelect"),g=s("el-row"),j=s("el-input-number"),ie=Ce,ue=s("el-tooltip"),se=s("el-checkbox"),v=s("el-card"),de=s("el-button"),ce=s("el-icon"),me=s("el-upload"),pe=s("el-dialog"),T=s("el-switch"),fe=s("el-date-picker"),Q=s("el-tab-pane"),be=s("el-tabs"),ge=s("ElForm");return m(),y(ge,{"label-width":"100px",rules:d(Y),ref_key:"formRef",ref:M,model:o.leftTab},{default:l(()=>[e(be,{modelValue:d(S),"onUpdate:modelValue":a[27]||(a[27]=t=>z(S)?S.value=t:null),onTabChange:le},{default:l(()=>[e(Q,{label:"基础设置",name:"basicSettings"},{default:l(()=>[e(v,{"body-style":""},{header:l(()=>[qe]),default:l(()=>[e(g,{gutter:20},{default:l(()=>[e(n,{span:6},{default:l(()=>[e(r,{label:"项目名称",prop:"name"},{default:l(()=>[e(b,{modelValue:o.leftTab.name,"onUpdate:modelValue":a[0]||(a[0]=t=>o.leftTab.name=t),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:6},{default:l(()=>[e(r,{label:"项目标识",prop:"projectIdentification"},{default:l(()=>[e(b,{clearable:"",modelValue:o.leftTab.projectIdentification,"onUpdate:modelValue":a[1]||(a[1]=t=>o.leftTab.projectIdentification=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:6},{default:l(()=>[e(r,{label:"所属客户",prop:"clientId"},{default:l(()=>[e(x,{placeholder:"Select",modelValue:o.leftTab.clientId,"onUpdate:modelValue":a[2]||(a[2]=t=>o.leftTab.clientId=t)},{default:l(()=>[(m(!0),I(k,null,w(d(i).customerList,t=>(m(),y(P,{key:t.tenantCustomerId,value:t.tenantCustomerId,label:t.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(n,{span:6},{default:l(()=>[e(r,{label:"所属国家",prop:"countryId"},{default:l(()=>[e(re,{modelValue:o.leftTab.countryId,"onUpdate:modelValue":a[3]||(a[3]=t=>o.leftTab.countryId=t),placeholder:"国家",clearable:"",filterable:"",multiple:"","collapse-tags":"",onChange:Z},{default:l(()=>[(m(!0),I(k,null,w(d(i).countryList,t=>(m(),y(q,{label:t.chineseName,value:t.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(g,{gutter:20},{default:l(()=>[e(n,{span:6},{default:l(()=>[e(r,{label:"原价(美元)",prop:"doMoneyPrice"},{default:l(()=>[e(j,{modelValue:o.leftTab.doMoneyPrice,"onUpdate:modelValue":a[4]||(a[4]=t=>o.leftTab.doMoneyPrice=t),min:1,precision:1,step:.1,"controls-position":"right",size:"large"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:6},{default:l(()=>[e(r,{label:"配额",prop:"num"},{default:l(()=>[e(j,{modelValue:o.leftTab.num,"onUpdate:modelValue":a[5]||(a[5]=t=>o.leftTab.num=t),step:1,"step-strictly":"",min:1,max:100,"controls-position":"right",size:"large"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:6},{default:l(()=>[e(r,null,{label:l(()=>[p("div",ze,[e(ue,{content:"这份问卷必须要做到多少分钟",placement:"top"},{default:l(()=>[e(ie,{name:"i-ri:question-line",class:"ms-4"})]),_:1}),Fe])]),default:l(()=>[e(j,{modelValue:o.leftTab.minimumDuration,"onUpdate:modelValue":a[6]||(a[6]=t=>o.leftTab.minimumDuration=t),min:1,step:1,"step-strictly":"","controls-position":"right",size:"large"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:6},{default:l(()=>[e(r,{label:"IR"},{default:l(()=>[e(j,{modelValue:o.leftTab.ir,"onUpdate:modelValue":a[7]||(a[7]=t=>o.leftTab.ir=t),min:1,precision:1,step:.1,max:100,"controls-position":"right",size:"large"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(g,{gutter:20},{default:l(()=>[e(n,{span:12},{default:l(()=>[e(r,{label:"URL",prop:"uidUrl"},{default:l(()=>[e(b,{clearable:"",modelValue:o.leftTab.uidUrl,"onUpdate:modelValue":a[8]||(a[8]=t=>o.leftTab.uidUrl=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:3},{default:l(()=>[e(r,{label:"填写互斥ID"},{default:l(()=>[e(se,{modelValue:o.leftTab.mutualExclusion,"onUpdate:modelValue":a[9]||(a[9]=t=>o.leftTab.mutualExclusion=t),style:{top:"-4px"},size:"large","true-value":1,"false-value":2},null,8,["modelValue"])]),_:1})]),_:1}),o.leftTab.mutualExclusion===1?(m(),y(n,{key:0,span:12},{default:l(()=>[e(r,{label:"互斥ID"},{default:l(()=>[e(b,{clearable:"",modelValue:o.leftTab.mutualExclusionId,"onUpdate:modelValue":a[10]||(a[10]=t=>o.leftTab.mutualExclusionId=t)},null,8,["modelValue"])]),_:1})]),_:1})):L("",!0)]),_:1})]),_:1}),e(v,null,{header:l(()=>[p("div",Be,[Oe,e(de,{type:"primary",link:"",size:"default",onClick:H},{default:l(()=>[ve(Ie(d(C)?"收起":"展开"),1)]),_:1})])]),default:l(()=>[d(C)?(m(),I("div",Ae,[e(r,{label:"上传图片"},{default:l(()=>[e(me,{action:"http://saas-api.surveysaas.com/project/uploadQiniu","list-type":"picture-card",limit:1,"on-preview":X,"on-remove":J,"on-success":K,"on-exceed":W},{tip:l(()=>[$e]),default:l(()=>[e(ce,{class:"el-icon--upload"},{default:l(()=>[e(d(Le))]),_:1}),Ye]),_:1}),e(pe,{modelValue:d(U),"onUpdate:modelValue":a[11]||(a[11]=t=>z(U)?U.value=t:null),style:{"z-index":"1000",transform:"translate(0)",position:"relative"}},{default:l(()=>[p("img",{"w-full":"",src:d(R),alt:"Preview Image"},null,8,Ge)]),_:1},8,["modelValue"])]),_:1}),e(g,{gutter:20},{default:l(()=>[e(n,{span:24},{default:l(()=>[e(r,{label:"项目描述"},{default:l(()=>[e(d(ke),{class:"editor",value:o.leftTab.richText,plugins:$,locale:d(Se),onChange:G},null,8,["value","locale"])]),_:1})]),_:1})]),_:1})])):L("",!0)]),_:1}),e(v,null,{header:l(()=>[He]),default:l(()=>[e(g,{gutter:20},{default:l(()=>[e(n,{span:3},{default:l(()=>[e(r,{label:"置顶"},{default:l(()=>[e(T,{"active-value":1,"inactive-value":2,modelValue:o.leftTab.isPinned,"onUpdate:modelValue":a[12]||(a[12]=t=>o.leftTab.isPinned=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:3},{default:l(()=>[e(r,{label:"在线"},{default:l(()=>[e(T,{"active-value":1,"inactive-value":2,modelValue:o.leftTab.isOnline,"onUpdate:modelValue":a[13]||(a[13]=t=>o.leftTab.isOnline=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:3},{default:l(()=>[e(r,{label:"前置问卷"},{default:l(()=>[e(T,{"active-value":1,"inactive-value":2,modelValue:o.leftTab.isProfile,"onUpdate:modelValue":a[14]||(a[14]=t=>o.leftTab.isProfile=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:3},{default:l(()=>[e(r,{label:"B2B"},{default:l(()=>[e(T,{"active-value":2,"inactive-value":1,modelValue:o.leftTab.isB2b,"onUpdate:modelValue":a[15]||(a[15]=t=>o.leftTab.isB2b=t)},null,8,["modelValue"])]),_:1})]),_:1}),o.leftTab.isB2b===2?(m(),y(n,{key:0,span:6},{default:l(()=>[e(r,{label:"项目类型"},{default:l(()=>[e(x,{modelValue:o.leftTab.projectType,"onUpdate:modelValue":a[16]||(a[16]=t=>o.leftTab.projectType=t)},null,8,["modelValue"])]),_:1})]),_:1})):L("",!0),e(n,{span:3},{default:l(()=>[e(r,{label:"定时发布"},{default:l(()=>[e(T,{"active-value":2,"inactive-value":1,modelValue:o.leftTab.isTimeReleases,"onUpdate:modelValue":a[17]||(a[17]=t=>o.leftTab.isTimeReleases=t)},null,8,["modelValue"])]),_:1})]),_:1}),o.leftTab.isTimeReleases===2?(m(),y(n,{key:1,span:6},{default:l(()=>[e(r,{label:"发布时间"},{default:l(()=>[e(fe,{type:"datetime","value-format":"YYYY-MM-DD hh:mm:ss",modelValue:o.leftTab.releaseTime,"onUpdate:modelValue":a[18]||(a[18]=t=>o.leftTab.releaseTime=t),placeholder:"请选择时间"},null,8,["modelValue"])]),_:1})]),_:1})):L("",!0)]),_:1}),e(g,{gutter:20},{default:l(()=>[e(n,{span:15},{default:l(()=>[e(r,{label:"备注"},{default:l(()=>[e(b,{maxlength:"200","show-word-limit":"",style:{width:"29rem"},type:"textarea",rows:5,modelValue:o.leftTab.remark,"onUpdate:modelValue":a[19]||(a[19]=t=>o.leftTab.remark=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o.leftTab.isProfile===1?(m(),y(Q,{key:0,label:"配置信息",name:"configurationInformation"},{default:l(()=>[e(v,null,{header:l(()=>[Je]),default:l(()=>[e(g,{gutter:20},{default:l(()=>[e(n,{span:6},{default:l(()=>[e(r,{label:"选择国家"},{default:l(()=>[e(x,{modelValue:d(i).initialProblem.countryId,"onUpdate:modelValue":a[20]||(a[20]=t=>d(i).initialProblem.countryId=t),filterable:"",clearable:"",placeholder:"Select",onChange:ee},{default:l(()=>[(m(!0),I(k,null,w(d(i).configurationCountryList,t=>(m(),y(q,{label:t.countryName,value:t.countryId},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(n,{span:6},{default:l(()=>[e(r,{label:"问卷名称"},{default:l(()=>[e(x,{ref_key:"projectProblemRef",ref:te,modelValue:d(i).initialProblem.projectProblemId,"onUpdate:modelValue":a[21]||(a[21]=t=>d(i).initialProblem.projectProblemId=t),clearable:"",placeholder:"Select",onFocus:ae,onChange:oe},{default:l(()=>[(m(!0),I(k,null,w(d(i).projectCategoryList,t=>(m(),y(P,{key:t.projectProblemCategoryId,label:t.projectProblemCategoryName,value:t.projectProblemCategoryId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):L("",!0),e(Q,{label:"安全信息",name:"securityInformation"},{default:l(()=>[e(v,null,{header:l(()=>[Ke]),default:l(()=>[e(g,{gutter:20},{default:l(()=>[e(n,{span:6},{default:l(()=>[e(r,{label:"小时准入量"},{default:l(()=>[e(j,{modelValue:o.leftTab.preNum,"onUpdate:modelValue":a[22]||(a[22]=t=>o.leftTab.preNum=t),min:1,step:1,"step-strictly":"","controls-position":"right",size:"large"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:6},{default:l(()=>[e(r,{label:"小时完成量"},{default:l(()=>[e(j,{modelValue:o.leftTab.limitedQuantity,"onUpdate:modelValue":a[23]||(a[23]=t=>o.leftTab.limitedQuantity=t),min:1,step:1,"step-strictly":"","controls-position":"right",size:"large"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(g,{gutter:20},{default:l(()=>[e(n,{span:4},{default:l(()=>[e(r,{label:"时差检测"},{default:l(()=>[e(T,{modelValue:o.leftTab.timeDifferenceDetection,"onUpdate:modelValue":a[24]||(a[24]=t=>o.leftTab.timeDifferenceDetection=t),"active-value":1,"inactive-value":2},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:4},{default:l(()=>[e(r,{label:"重复IP检测"},{default:l(()=>[e(T,{modelValue:o.leftTab.ipDifferenceDetection,"onUpdate:modelValue":a[25]||(a[25]=t=>o.leftTab.ipDifferenceDetection=t),"active-value":1,"inactive-value":2},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:4},{default:l(()=>[e(r,{label:"IP一致性检测"},{default:l(()=>[e(T,{modelValue:o.leftTab.ipConsistency,"onUpdate:modelValue":a[26]||(a[26]=t=>o.leftTab.ipConsistency=t),"active-value":1,"inactive-value":2},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["rules","model"])}}}),Xe=we(We,[["__scopeId","data-v-77d72a00"]]),nl=Object.freeze(Object.defineProperty({__proto__:null,default:Xe},Symbol.toStringTag,{value:"Module"}));export{Xe as T,E as a,nl as i,Me as u};
