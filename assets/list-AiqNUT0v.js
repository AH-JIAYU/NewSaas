
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Se,r as u,aN as De,a3 as we,k as Ee,a as i,l as xe,n as P,o as n,b as w,f as e,w as t,F,q as H,e as c,ar as ze,g as p,D as E,j as d,i as h,Q as Ve,aO as Ie,E as Re,L as Le,aP as Ue,aQ as $e,aq as Ae,aJ as Ne,aK as Te,p as Be,P as Pe}from"./index-DntGxMRg.js";import{_ as Fe}from"./index.vue_vue_type_script_setup_true_lang-CYf94vqN.js";import{_ as He}from"./index.vue_vue_type_style_index_0_lang-BhZ3tXeU.js";import{_ as Me}from"./index.vue_vue_type_script_setup_true_lang-CAyl2sez.js";import{_ as Oe,a as Q}from"./index.vue_vue_type_script_setup_true_lang-O8P6C4yo.js";import{u as Ye}from"./user_customer-DoTNFGiG.js";import"./user_customer-CABfpEt5.js";const qe=k=>(Ne("data-v-c3523ec6"),k=k(),Te(),k),Qe=qe(()=>Be("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),je=Se({name:"invoice",__name:"list",setup(k){const j=Ye(),y=u([]),{pagination:_,onSizeChange:J,onCurrentChange:K,onSortChange:Je}=De(),G=u(""),M=u([]),x=u(!0),z=u(),V=u(!1),m=u([]),I=u(!0);u(!1);const R=u("default"),L=u(!1),W=u([]),X=[{lable:"未收款",value:1},{lable:"部分收款",value:2},{lable:"已完结",value:3},{lable:"坏账",value:4}],b=u(null),f=u([]),Z=[{lable:"开票日期",value:1},{lable:"收款日期",value:2}],U=u([{label:"客户简称",prop:"tenantCustomerShortName",sortable:!0,disableCheck:!1,checked:!0},{label:"发票编号",prop:"invoiceCode",sortable:!0,disableCheck:!1,checked:!0},{label:"金额",prop:"invoiceAmount",sortable:!0,disableCheck:!1,checked:!0},{label:"手续费(税)",prop:"invoiceTax",sortable:!0,disableCheck:!1,checked:!0},{label:"实收款",prop:"actualReceipts",sortable:!0,disableCheck:!1,checked:!0},{label:"开票日期",prop:"invoiceDate",sortable:!0,disableCheck:!1,checked:!0},{label:"收款日期",prop:"paymentDate",sortable:!0,disableCheck:!1,checked:!0},{label:"状态",prop:"invoiceStatus",sortable:!0,disableCheck:!1,checked:!0},{label:"备注",prop:"remark",sortable:!0,disableCheck:!1,checked:!0}]),r=we({page:1,limit:10,tenantCustomerId:"",invoiceStatus:null,invoiceDateStart:"",invoiceDateEnd:"",paymentDateStart:"",paymentDateEnd:""});function ee(){z.value.showEdit("",y.value)}function te(o){z.value.showEdit(JSON.stringify(o),y.value)}function ae(o){Ie.confirm(`确认删除「${o.tenantCustomerShortName}」这条数据吗？`,"确认信息").then(()=>{Q.delete({id:o.id}).then(()=>{g(),Re.success({message:"删除成功",center:!0})})}).catch(()=>{})}function le(o){W.value=o}function oe(){Object.assign(r,{page:1,limit:10,tenantCustomerId:"",invoiceStatus:null,invoiceDateStart:"",invoiceDateEnd:"",paymentDateStart:"",paymentDateEnd:""}),b.value=null,g()}const ne=o=>{b.value=o,f.value=[],r.invoiceDateStart="",r.invoiceDateEnd="",r.paymentDateStart="",r.paymentDateEnd=""},se=()=>{b.value===1?(r.invoiceDateStart=f.value[0],r.invoiceDateEnd=f.value[1]):(r.paymentDateStart=f.value[0],r.paymentDateEnd=f.value[1])};function ie(o){J(o).then(()=>g())}function $(o=1){K(o).then(()=>g())}async function g(){x.value=!0,y.value=await j.getCustomerList();const{data:o}=await Q.list(r);M.value=o.data,_.value.total=parseInt(o.total)||0,x.value=!1}return Ee(()=>{U.value.forEach(o=>{o.checked&&m.value.push(o.prop)}),g()}),(o,l)=>{const re=i("el-option"),A=i("el-select"),C=i("el-form-item"),O=i("ElOption"),ue=i("el-date-picker"),Y=Le,N=i("ElButton"),ce=i("ElFormItem"),pe=i("el-form"),de=Me,me=i("ElDivider"),S=i("el-button"),ve=He,fe=Ue,_e=$e,be=i("el-row"),v=i("el-table-column"),T=Fe,D=i("el-text"),ge=i("ElTableColumn"),he=i("el-empty"),ke=i("el-table"),ye=i("ElPagination"),Ce=Ae,q=xe("loading");return P((n(),w("div",{class:Ve({"absolute-container":V.value})},[e(Ce,null,{default:t(()=>[e(de,{"show-toggle":!1},{default:t(({fold:a,toggle:B})=>[e(pe,{model:r.select,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:t(()=>[e(C,{label:""},{default:t(()=>[e(A,{modelValue:r.tenantCustomerId,"onUpdate:modelValue":l[0]||(l[0]=s=>r.tenantCustomerId=s),placeholder:"客户简称",clearable:"",filterable:""},{default:t(()=>[(n(!0),w(F,null,H(y.value,s=>(n(),c(re,{key:s.tenantCustomerId,value:s.tenantCustomerId,label:s.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(C,{label:""},{default:t(()=>[e(A,{modelValue:r.invoiceStatus,"onUpdate:modelValue":l[1]||(l[1]=s=>r.invoiceStatus=s),placeholder:"发票状态",clearable:"",filterable:""},{default:t(()=>[(n(),w(F,null,H(X,s=>e(O,{label:s.lable,value:s.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(C,{label:""},{default:t(()=>[e(A,{modelValue:b.value,"onUpdate:modelValue":l[2]||(l[2]=s=>b.value=s),placeholder:"时间类型",clearable:"",filterable:"",onChange:ne},{default:t(()=>[(n(),w(F,null,H(Z,s=>e(O,{label:s.lable,value:s.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),P(e(C,null,{default:t(()=>[e(ue,{modelValue:f.value,"onUpdate:modelValue":l[3]||(l[3]=s=>f.value=s),disabled:!b.value,"value-format":"YYYY-MM-DD hh:mm:ss",type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:"",size:"",onChange:se},null,8,["modelValue","disabled"])]),_:2},1536),[[ze,!a]]),e(ce,null,{default:t(()=>[e(N,{type:"primary",onClick:l[4]||(l[4]=s=>$())},{icon:t(()=>[e(Y,{name:"i-ep:search"})]),default:t(()=>[p(" 筛选 ")]),_:1}),e(N,{onClick:oe},{icon:t(()=>[Qe]),default:t(()=>[p(" 重置 ")]),_:1}),e(N,{link:"",onClick:B},{icon:t(()=>[e(Y,{name:a?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:t(()=>[p(" "+E(a?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),e(me,{"border-style":"dashed"}),e(be,{gutter:24},{default:t(()=>[e(ve,null,{default:t(()=>[e(S,{style:{"margin-right":"10px"},type:"primary",size:"default",onClick:ee},{default:t(()=>[p(" 新增发票 ")]),_:1})]),_:1}),e(_e,null,{default:t(()=>[e(S,{size:"default",onClick:l[5]||(l[5]=()=>{})},{default:t(()=>[p(" 导出 ")]),_:1}),e(fe,{border:I.value,"onUpdate:border":l[6]||(l[6]=a=>I.value=a),tableAutoHeight:V.value,"onUpdate:tableAutoHeight":l[7]||(l[7]=a=>V.value=a),checkList:m.value,"onUpdate:checkList":l[8]||(l[8]=a=>m.value=a),columns:U.value,"onUpdate:columns":l[9]||(l[9]=a=>U.value=a),"line-height":R.value,"onUpdate:lineHeight":l[10]||(l[10]=a=>R.value=a),stripe:L.value,"onUpdate:stripe":l[11]||(l[11]=a=>L.value=a),style:{"margin-left":"12px"},onQueryData:$},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),P((n(),c(ke,{ref_key:"tableSortRef",ref:G,style:{"margin-top":"10px"},"row-key":"id",data:M.value,border:I.value,size:R.value,stripe:L.value,onSelectionChange:le},{empty:t(()=>[e(he,{description:"暂无数据"})]),default:t(()=>[e(v,{align:"center",type:"selection"}),m.value.includes("tenantCustomerShortName")?(n(),c(v,{key:0,prop:"tenantCustomerShortName","show-overflow-tooltip":"",align:"center",label:"客户简称"})):d("",!0),m.value.includes("invoiceCode")?(n(),c(v,{key:1,prop:"invoiceCode","show-overflow-tooltip":"",align:"center",label:"发票编号"})):d("",!0),m.value.includes("invoiceAmount")?(n(),c(v,{key:2,prop:"invoiceAmount","show-overflow-tooltip":"",align:"center",label:"金额"},{default:t(({row:a})=>[e(T),p(E(a.invoiceAmount||0),1)]),_:1})):d("",!0),m.value.includes("invoiceTax")?(n(),c(v,{key:3,prop:"invoiceTax","show-overflow-tooltip":"",align:"center",label:"手续费(税)"},{default:t(({row:a})=>[e(T),p(E(a.invoiceTax||0),1)]),_:1})):d("",!0),m.value.includes("actualReceipts")?(n(),c(v,{key:4,prop:"actualReceipts","show-overflow-tooltip":"",align:"center",label:"实收款"},{default:t(({row:a})=>[e(T),p(E(a.actualReceipts||0),1)]),_:1})):d("",!0),m.value.includes("invoiceDate")?(n(),c(v,{key:5,prop:"invoiceDate","show-overflow-tooltip":"",align:"center",label:"开票日期"})):d("",!0),m.value.includes("paymentDate")?(n(),c(v,{key:6,prop:"paymentDate","show-overflow-tooltip":"",align:"center",label:"收款日期"})):d("",!0),m.value.includes("invoiceStatus")?(n(),c(ge,{key:7,align:"center","show-overflow-tooltip":"",prop:"invoiceStatus",label:"状态"},{default:t(({row:a})=>[a.invoiceStatus===1?(n(),c(D,{key:0,class:"mx-1",type:"info"},{default:t(()=>[p("未收款")]),_:1})):d("",!0),a.invoiceStatus===2?(n(),c(D,{key:1,class:"mx-1",type:"warning"},{default:t(()=>[p("部分收款")]),_:1})):d("",!0),a.invoiceStatus===3?(n(),c(D,{key:2,class:"mx-1",type:"success"},{default:t(()=>[p("已完结")]),_:1})):d("",!0),a.invoiceStatus===4?(n(),c(D,{key:3,class:"mx-1",type:"danger"},{default:t(()=>[p("坏账")]),_:1})):d("",!0)]),_:1})):d("",!0),m.value.includes("remark")?(n(),c(v,{key:8,prop:"remark",align:"center",label:"备注"})):d("",!0),e(v,{align:"center",fixed:"right",label:"操作",width:"170"},{default:t(({row:a})=>[e(S,{size:"small",plain:"",type:"primary",onClick:B=>te(a)},{default:t(()=>[p(" 编辑 ")]),_:2},1032,["onClick"]),e(S,{size:"small",plain:"",type:"danger",onClick:B=>ae(a)},{default:t(()=>[p(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[q,!1]]),e(ye,{"current-page":h(_).page,total:h(_).total,"page-size":h(_).size,"page-sizes":h(_).sizes,layout:h(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:$,onSizeChange:ie},null,8,["current-page","total","page-size","page-sizes","layout"]),e(Oe,{onSuccess:g,ref_key:"editRef",ref:z},null,512)]),_:1})],2)),[[q,x.value]])}}}),at=Pe(je,[["__scopeId","data-v-c3523ec6"]]);export{at as default};
