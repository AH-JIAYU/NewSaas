
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as $,aN as O,r as g,a as r,q as G,s as C,o as m,e as v,w as t,f as a,b as J,t as K,F as Q,i as c,aM as R,g as i,z as u,be as W,p as X,bd as Y,L as Z}from"./index-amV3JGuM.js";import{a as ee}from"./financial_pm_log-DT-tVIzf.js";const ae=$({__name:"index",emits:["fetch-data"],setup(te,{expose:I,emit:S}){const{format:E}=W(),k=S,{pagination:d,getParams:le,onSizeChange:x,onCurrentChange:D,onSortChange:oe}=O(),b=g([]),l=g({loading:!1,activeName:"myFinancial",tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],search:{page:1,limit:10,userId:null,organizationalStructureId:null}}),f=g(!1),w=g();async function T(o){if(o.organizationalStructureId){l.value.search.organizationalStructureId=o.organizationalStructureId,await _();const n=await X.queryNotEnableStaffList({organizationalStructureId:l.value.search.organizationalStructureId});b.value=n.data}f.value=!0}const _=async()=>{try{l.value.loading=!0;const o={...l.value.search},n=await ee.getStaffFinancial(o);w.value=n.data.userList,d.value.total=+n.data.total,l.value.loading=!1}catch{}finally{l.value.loading=!1}};function F(o){x(o).then(()=>{l.value.search.limit=o,_()})}function y(o=1){D(o).then(()=>{l.value.search.page=o,_()})}function L(){k("fetch-data"),Object.assign(l.value.search,{page:1,limit:10,userId:null,organizationalStructureId:null}),f.value=!1}return I({showEdit:T}),(o,n)=>{const N=r("ElDivider"),V=r("el-option"),B=r("el-select"),P=r("ElFormItem"),j=r("ElForm"),p=r("el-text"),s=r("ElTableColumn"),h=Y,M=r("el-tag"),H=r("el-empty"),U=r("ElTable"),q=r("ElPagination"),A=r("el-drawer"),z=G("loading");return C((m(),v(A,{modelValue:f.value,"onUpdate:modelValue":n[3]||(n[3]=e=>f.value=e),"append-to-body":"","close-on-click-modal":!1,"destroy-on-close":"",draggable:"",size:"70%",title:"财务日志",onClose:L},{default:t(()=>[a(N,{"border-style":"dashed"}),a(j,{model:l.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:t(()=>[a(P,null,{default:t(()=>[a(B,{style:{width:"10.5rem"},modelValue:l.value.search.userId,"onUpdate:modelValue":n[0]||(n[0]=e=>l.value.search.userId=e),placeholder:"请选择员工",clearable:"",filterable:"",onChange:n[1]||(n[1]=e=>y())},{default:t(()=>[(m(!0),J(Q,null,K(b.value,e=>(m(),v(V,{key:e.id,label:e.userName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),C((m(),v(U,{border:l.value.border,size:l.value.lineHeight,stripe:l.value.stripe,class:"my-4",data:w.value,"highlight-current-row":"",onSortChange:o.sortChange,onSelectionChange:n[2]||(n[2]=e=>l.value.batch.selectionDataList=e)},{empty:t(()=>[a(H,{image:c(R),"image-size":300},null,8,["image"])]),default:t(()=>[a(s,{"show-overflow-tooltip":"",align:"left",prop:"",label:"点击ID"},{default:t(({row:e})=>[a(p,null,{default:t(()=>[i(u(e.clientId?e.clientId:"-"),1)]),_:2},1024)]),_:1}),a(s,{"show-overflow-tooltip":"",align:"left",prop:"projectId",label:"项目ID"},{default:t(({row:e})=>[a(p,null,{default:t(()=>[i(u(e.projectId?e.projectId:"-"),1)]),_:2},1024)]),_:1}),a(s,{"show-overflow-tooltip":"",align:"left",prop:"",label:"PM"},{default:t(({row:e})=>[a(p,null,{default:t(()=>[i(u(e.userName?e.userName:"-"),1)]),_:2},1024)]),_:1}),a(s,{"show-overflow-tooltip":"",align:"left",prop:"remark",label:"业绩"},{default:t(({row:e})=>[a(p,{class:"mx-1"},{default:t(()=>[i(u(e.doMoney?e.doMoney:"-"),1)]),_:2},1024)]),_:1}),a(s,{"show-overflow-tooltip":"",align:"left",prop:"remark",label:"说明"},{default:t(({row:e})=>[a(p,{class:"mx-1"},{default:t(()=>[i(u(e.remark?e.remark:"-"),1)]),_:2},1024)]),_:1}),a(s,{"show-overflow-tooltip":"",align:"left",prop:"beforeBalance",width:"150",label:"变动前"},{default:t(({row:e})=>[a(h),i(u(e.beforeBalance||0),1)]),_:1}),a(s,{"show-overflow-tooltip":"",align:"left",prop:"addAndSubtraction",width:"150",label:"提成"},{default:t(({row:e})=>[a(h),i(u(e.difference||0),1)]),_:1}),a(s,{"show-overflow-tooltip":"",align:"left",prop:"afterBalance",width:"150",label:"变动后"},{default:t(({row:e})=>[a(h),i(u(e.afterBalance||0),1)]),_:1}),a(s,{"show-overflow-tooltip":"",align:"left",prop:"createTime",label:"时间"},{default:t(({row:e})=>[a(M,{effect:"plain",type:"info"},{default:t(()=>[i(u(c(E)(e.createTime)),1)]),_:2},1024)]),_:1})]),_:1},8,["border","size","stripe","data","onSortChange"])),[[z,l.value.loading]]),a(q,{"current-page":c(d).page,total:c(d).total,"page-size":c(d).size,"page-sizes":c(d).sizes,layout:c(d).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:F,onCurrentChange:y},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1},8,["modelValue"])),[[z,l.value.loading]])}}}),se=Z(ae,[["__scopeId","data-v-9418fbe4"]]);export{se as default};
