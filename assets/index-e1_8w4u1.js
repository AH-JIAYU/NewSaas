
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as fe}from"./index-PsrQrv2j.js";import{k as u,d as he,r as V,aF as ve,B as _e,$ as G,a as m,aj as be,o as I,b as ye,f as a,w as c,g as C,l as b,i as n,D as $,aw as N,ak as R,aK as j,e as S,j as w,E as De,aG as U,ai as z,ar as ke,K as Ce,az as Ee,aA as Le,_ as Ve,p as F}from"./index-CR_Og9_c.js";import Ie from"./index-DitmC41c.js";import xe from"./index-DPBFp5bL.js";import{_ as Se}from"./index.vue_vue_type_script_setup_true_lang-DSron4fx.js";import"./dictionary-eXeT9Fny.js";import"./dictionary-BCEkWDEX.js";const E={list:()=>u.get("tenantDictionary/list",{baseURL:"/mock/"}),detail:s=>u.get("tenantDictionary/detail",{params:{id:s},baseURL:"/mock/"}),create:s=>u.post("tenantDictionary/create",s,{baseURL:"/mock/"}),edit:s=>u.post("tenantDictionary/edit",s,{baseURL:"/mock/"}),delete:s=>u.post("tenantDictionary/delete",{id:s},{baseURL:"/mock/"}),itemList:s=>u.get("tenantDictionary/item/list",{params:s,baseURL:"/mock/"}),itemDetail:s=>u.get("tenantDictionary/item/detail",{params:{id:s},baseURL:"/mock/"}),itemCreate:s=>u.post("tenantDictionary/item/create",s,{baseURL:"/mock/"}),itemEdit:s=>u.post("tenantDictionary/item/edit",s,{baseURL:"/mock/"}),itemDelete:s=>u.post("tenantDictionary/item/delete",{id:s},{baseURL:"/mock/"}),itemChangeEnable:s=>u.post("tenantDictionary/item/change/enable",s,{baseURL:"/mock/"}),get:s=>u.get("tenantDictionary/get",{params:{code:s},baseURL:"/mock/"})},Ue=s=>(Ee("data-v-792f0023"),s=s(),Le(),s),ze={class:"absolute-container"},$e={class:"page-main"},Ne={class:"custom-tree-node"},Re=["title"],we={class:"code"},Be={class:"actions"},Te={class:"dictionary-container"},Pe={class:"dictionary-container"},Me=Ue(()=>b("div",{class:"empty"},"请在左侧新增或选择一个字典",-1)),Ae=[Me],K=he({name:"PagesExampleDictionary",__name:"index",setup(s){const B=V(),i=V({search:"",tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""}}),{pagination:g,getParams:H,onSizeChange:q,onCurrentChange:J,onSortChange:O}=ve();g.value.size=20,g.value.sizes=[20,50,100];const Q=V(),o=V({loading:!1,search:{dictionaryId:"",title:""},dataList:[],selectionDataList:[],dialog:{visible:!1,id:""}});function T(){o.value.search.dictionaryId="",E.list().then(e=>{i.value.tree=e.data})}_e(()=>{T()}),G(()=>i.value.search,e=>{B.value.filter(e)});function W(e,t){return e?t.label.includes(e):!0}function P(e){i.value.currentData=e,i.value.dialog.parentId=(e==null?void 0:e.id)??"",i.value.dialog.id="",i.value.dialog.visible=!0}function X(e,t){i.value.currentNode=e,i.value.currentData=t,i.value.dialog.parentId=e.parent.data.id??"",i.value.dialog.id=t.id,i.value.dialog.visible=!0}function Y(e,t){U.confirm(`确认删除「${t.label}」吗？`,"确认信息").then(()=>{E.delete(t.id).then(()=>{z.success({message:"模拟删除成功",center:!0});const r=e.parent,p=r.data.children||r.data,d=p.findIndex(f=>f.id===t.id);p.splice(d,1),i.value.tree=[...i.value.tree]})})}function Z(e){i.value.currentData?(i.value.currentData.children||(i.value.currentData.children=[]),i.value.currentData.children.push({id:e.id,label:e.label,code:e.code})):i.value.tree.push({id:e.id,label:e.label,code:e.code})}function ee(e,t){if(i.value.currentNode&&i.value.currentData)if((i.value.currentNode.parent.data.id??"")===t)i.value.currentData.label=e.label,i.value.currentData.code=e.code;else{const r=i.value.currentNode.parent,p=r.data.children||r.data,d=p.findIndex(f=>f.id===e.id);if(p[d].label=e.label,p[d].code=e.code,t){const f=(y,x)=>{for(const k in y){if(y[k].id===x)return y[k];if(y[k].children){const h=f(y[k].children,x);if(h)return h}}},D=f(i.value.tree,t);D.children||(D.children=[]),D.children.push(p[d])}else i.value.tree.push(p[d]);p.splice(d,1)}}function te(e){g.value.page=1,o.value.search.dictionaryId=e.id}G(()=>o.value.search.dictionaryId,()=>{v()});function v(){o.value.loading=!0;const e={...H(),dictionary_id:o.value.search.dictionaryId,...o.value.search.title&&{title:o.value.search.title}};E.itemList(e).then(t=>{o.value.loading=!1,o.value.dataList=t.data.list,o.value.dataList.forEach(r=>{r.enableLoading=!1}),g.value.total=t.data.total})}function ae(e){return new Promise(t=>{U.confirm(`确认${e.enable?"禁用":"启用"}「${e.name}」吗？`,"确认信息").then(()=>{e.enableLoading=!0,E.itemChangeEnable({id:e.id,enable:!e.enable}).then(()=>(e.enableLoading=!1,z.success({message:`模拟${e.enable?"禁用":"启用"}成功`,center:!0}),t(!0))).catch(()=>(e.enableLoading=!1,t(!1)))}).catch(()=>t(!1))})}function ie(e){q(e).then(()=>v())}function ne(e=1){J(e).then(()=>v())}function le({prop:e,order:t}){O(e,t).then(()=>v())}function M(){o.value.dialog.id="",o.value.dialog.visible=!0}function oe(e){o.value.dialog.id=e.id,o.value.dialog.visible=!0}function se(e){U.confirm(`确认删除「${e.name}」吗？`,"确认信息").then(()=>{E.itemDelete(e.id).then(()=>{v(),z.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}function ce(e){U.confirm(`确认删除选中的 ${e.length} 条数据吗？`,"确认信息").then(()=>{E.itemDelete(e.map(t=>t.id)).then(()=>{v(),z.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}const L=V(!1);return(e,t)=>{const r=m("ElButton"),p=ke,d=Ce,f=m("ElButtonGroup"),D=m("ElInput"),y=m("ElTree"),x=m("ElScrollbar"),k=m("ElSpace"),h=m("ElTableColumn"),re=m("ElTag"),de=m("ElSwitch"),ue=m("ElTable"),pe=m("ElPagination"),me=fe,ge=be("loading");return I(),ye("div",ze,[a(p,{title:"字典管理",content:"页面数据为 Mock 示例数据，非真实数据。"},{default:c(()=>[a(r,{onClick:t[0]||(t[0]=l=>L.value=!0)},{default:c(()=>[C(" 使用示例 ")]),_:1})]),_:1}),b("div",$e,[a(me,{"hide-left-side-toggle":""},{leftSide:c(()=>[a(f,{class:"btns"},{default:c(()=>[a(r,{type:"primary",class:"add",onClick:t[1]||(t[1]=l=>P())},{default:c(()=>[C(" 新增字典 ")]),_:1}),a(r,{onClick:T},{icon:c(()=>[a(d,{name:"i-ep:refresh"})]),_:1})]),_:1}),a(D,{modelValue:n(i).search,"onUpdate:modelValue":t[2]||(t[2]=l=>n(i).search=l),placeholder:"请输入关键词筛选字典",clearable:"",class:"search"},null,8,["modelValue"]),a(x,{class:"tree"},{default:c(()=>[a(y,{ref_key:"dictionaryRef",ref:B,data:n(i).tree,"filter-node-method":W,"default-expand-all":"",onNodeClick:te},{default:c(({node:l,data:_})=>[b("div",Ne,[b("div",{class:"label",title:l.label},$(l.label),9,Re),b("div",we,$(_.code),1),b("div",Be,[a(f,null,{default:c(()=>[a(r,{type:"primary",plain:"",size:"default",onClick:N(A=>P(_),["stop"])},{icon:c(()=>[a(d,{name:"i-ep:plus"})]),_:2},1032,["onClick"]),a(r,{type:"info",plain:"",size:"default",onClick:N(A=>X(l,_),["stop"])},{icon:c(()=>[a(d,{name:"i-ep:edit"})]),_:2},1032,["onClick"]),a(r,{type:"danger",plain:"",size:"default",onClick:N(A=>Y(l,_),["stop"])},{icon:c(()=>[a(d,{name:"i-ep:delete"})]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])]),_:1})]),default:c(()=>[R(b("div",Te,[a(k,{wrap:""},{default:c(()=>[a(r,{type:"primary",onClick:M},{icon:c(()=>[a(d,{name:"i-ep:plus"})]),_:1}),a(r,{type:"danger",disabled:!n(o).selectionDataList.length,onClick:t[3]||(t[3]=l=>ce(n(o).selectionDataList))},{icon:c(()=>[a(d,{name:"i-ep:delete"})]),_:1},8,["disabled"]),a(D,{modelValue:n(o).search.title,"onUpdate:modelValue":t[4]||(t[4]=l=>n(o).search.title=l),placeholder:"请输入关键词筛选字典项",clearable:"",style:{width:"200px"}},null,8,["modelValue"]),a(r,{onClick:v},{icon:c(()=>[a(d,{name:"i-ep:search"})]),_:1})]),_:1}),R((I(),S(ue,{ref_key:"dictionaryItemRef",ref:Q,data:n(o).dataList,stripe:"","highlight-current-row":"",border:"","row-key":"id",height:"100%",onSortChange:le,onSelectionChange:t[5]||(t[5]=l=>n(o).selectionDataList=l)},{default:c(()=>[a(h,{type:"selection",align:"center",fixed:""}),a(h,{prop:"chineseName",label:"中文"}),a(h,{prop:"englishName",label:"英文"}),a(h,{label:"键值",align:"center",width:"150"},{default:c(l=>[a(re,{type:"info"},{default:c(()=>[C($(l.row.value),1)]),_:2},1024)]),_:1}),a(h,{label:"状态",width:"100",align:"center"},{default:c(l=>[a(de,{modelValue:l.row.enable,"onUpdate:modelValue":_=>l.row.enable=_,loading:l.row.enableLoading,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>ae(l.row)},null,8,["modelValue","onUpdate:modelValue","loading","before-change"])]),_:1}),a(h,{label:"操作",width:"250",align:"center"},{default:c(l=>[a(r,{type:"primary",size:"small",plain:"",onClick:M},{default:c(()=>[C(" 添加子项 ")]),_:1}),a(r,{type:"primary",size:"small",plain:"",onClick:_=>oe(l.row)},{default:c(()=>[C(" 编辑 ")]),_:2},1032,["onClick"]),a(r,{type:"danger",size:"small",plain:"",onClick:_=>se(l.row)},{default:c(()=>[C(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ge,n(o).loading]]),a(pe,{"current-page":n(g).page,total:n(g).total,"page-size":n(g).size,"page-sizes":n(g).sizes,layout:n(g).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:ie,onCurrentChange:ne},null,8,["current-page","total","page-size","page-sizes","layout"])],512),[[j,n(o).search.dictionaryId]]),R(b("div",Pe,Ae,512),[[j,!n(o).search.dictionaryId]])]),_:1}),n(i).dialog.visible?(I(),S(Ie,{key:0,id:n(i).dialog.id,modelValue:n(i).dialog.visible,"onUpdate:modelValue":t[6]||(t[6]=l=>n(i).dialog.visible=l),"parent-id":n(i).dialog.parentId,tree:n(i).tree,onAddNode:Z,onEditNode:ee},null,8,["id","modelValue","parent-id","tree"])):w("",!0),n(o).dialog.visible?(I(),S(xe,{key:1,id:n(o).dialog.id,modelValue:n(o).dialog.visible,"onUpdate:modelValue":t[7]||(t[7]=l=>n(o).dialog.visible=l),"dictionary-id":n(o).search.dictionaryId,tree:n(i).tree,onSuccess:v},null,8,["id","modelValue","dictionary-id","tree"])):w("",!0),n(L)?(I(),S(Se,{key:2,modelValue:n(L),"onUpdate:modelValue":t[8]||(t[8]=l=>De(L)?L.value=l:null)},null,8,["modelValue"])):w("",!0)])])}}});typeof F=="function"&&F(K);const Oe=Ve(K,[["__scopeId","data-v-792f0023"]]);export{Oe as default};
