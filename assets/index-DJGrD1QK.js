
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as P}from"./project_settlement-qk3ncBQl.js";import{d as q,r as n,a as s,an as J,o as y,b as A,f as t,w as a,A as r,g as d,ak as F,e as j,j as x,E as w,aJ as H,aK as K,N as M}from"./index-CJyZF_XX.js";const N=v=>(H("data-v-9250a8d9"),v=v(),K(),v),$={class:"border"},G=N(()=>r("p",{class:"pp"},"项目ID",-1)),Q={class:"neip"},W={class:"border"},X=N(()=>r("p",{class:"pp"},"项目名称",-1)),Y={class:"neip"},Z={class:"shenhe"},ee={class:"beizhu"},le={class:"po"},te={style:{flex:"auto"}},ae=q({name:"ProjectReview",__name:"index",emits:["success"],setup(v,{expose:T,emit:D}){const S=D,_=n(!1),u=n(),e=n({projectId:"",projectName:"",settlementType:"",remark:"",projectSettlementBuilderList:[],po:"",arr:""}),z=n({settlementType:[{required:!0,message:"请选择审核方式",trigger:"change"}],arr:[{required:!0,message:"请输入至少一个ID",trigger:"blur"}]}),f=n(),V=n(!1),i=n(!1);async function B(p){p&&(u.value=JSON.parse(p),e.value.projectId=u.value.projectId,e.value.projectName=u.value.projectName),i.value=!0}async function U(){f.value&&f.value.validate(async p=>{try{if(p){_.value=!0,delete e.value.projectName,e.value.settlementType===1||e.value.settlementType===2?(e.value.projectSettlementBuilderList=e.value.arr.split(`
`)||[],delete e.value.arr):e.value.projectSettlementBuilderList=[];const{status:l}=await P.review(e.value);l===1?(S("success"),_.value=!1,w.success({message:"操作成功",center:!0}),k()):w.error({message:"操作失败，请联系工作人员",center:!0})}else w({message:"请检查必填项",type:"warning"})}catch{}finally{_.value=!1}})}function k(){f.value.resetFields(),Object.assign(e.value,{projectId:"",projectName:"",settlementType:"",remark:"",projectSettlementBuilderList:[],po:"",arr:""}),e.value.arr=[],i.value=!1}return T({showEdit:B}),(p,l)=>{const m=s("el-input"),b=s("el-row"),c=s("el-radio"),C=s("el-radio-group"),g=s("el-form-item"),I=s("el-col"),R=s("el-checkbox"),E=s("el-form"),h=s("el-button"),L=s("el-drawer"),O=J("loading");return y(),A("div",null,[t(L,{modelValue:i.value,"onUpdate:modelValue":l[9]||(l[9]=o=>i.value=o),title:"项目审核",size:"50%","before-close":k},{footer:a(()=>[r("div",te,[t(h,{type:"primary",onClick:U},{default:a(()=>[d(" 确定 ")]),_:1}),t(h,{onClick:l[8]||(l[8]=o=>i.value=!1)},{default:a(()=>[d(" 取消 ")]),_:1})])]),default:a(()=>[F((y(),j(E,{ref_key:"formRef",ref:f,model:e.value,rules:z.value,"label-width":"174px",inline:!1},{default:a(()=>[t(b,{style:{margin:"0"},gutter:20},{default:a(()=>[r("div",$,[G,r("p",Q,[t(m,{modelValue:u.value.projectId,"onUpdate:modelValue":l[0]||(l[0]=o=>u.value.projectId=o),placeholder:"请输入项目ID",disabled:"",clearable:""},null,8,["modelValue"])])]),r("div",W,[X,r("p",Y,[t(m,{modelValue:u.value.projectName,"onUpdate:modelValue":l[1]||(l[1]=o=>u.value.projectName=o),disabled:"",placeholder:"请输入项目名称",clearable:""},null,8,["modelValue"])])])]),_:1}),r("div",Z,[t(g,{prop:"settlementType",style:{display:"flex","align-items":"center"},label:"审核方式"},{default:a(()=>[t(C,{modelValue:e.value.settlementType,"onUpdate:modelValue":l[2]||(l[2]=o=>e.value.settlementType=o)},{default:a(()=>[t(c,{value:1,size:"large"},{default:a(()=>[d(" 按成功ID ")]),_:1}),t(c,{value:2,size:"large"},{default:a(()=>[d(" 按失败ID ")]),_:1}),t(c,{value:3,size:"large"},{default:a(()=>[d(" 全部通过 ")]),_:1}),t(c,{value:4,size:"large"},{default:a(()=>[d(" 全部失败 ")]),_:1}),t(c,{value:5,size:"large"},{default:a(()=>[d(" 数据冻结 ")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),r("div",ee,[t(g,{label:"备注"},{default:a(()=>[t(m,{class:"custom-input",modelValue:e.value.remark,"onUpdate:modelValue":l[3]||(l[3]=o=>e.value.remark=o),placeholder:"",clearable:""},null,8,["modelValue"])]),_:1})]),r("div",le,[V.value?(y(),j(g,{key:0,label:"结算PO号"},{default:a(()=>[t(m,{modelValue:e.value.po,"onUpdate:modelValue":l[4]||(l[4]=o=>e.value.po=o),class:"custom-input",placeholder:"",clearable:"",onChange:l[5]||(l[5]=()=>{})},null,8,["modelValue"])]),_:1})):x("",!0)]),t(b,{style:{margin:"0"},gutter:20},{default:a(()=>[t(I,{span:20}),t(I,{span:4},{default:a(()=>[t(R,{modelValue:V.value,"onUpdate:modelValue":l[6]||(l[6]=o=>V.value=o),label:"填写结算PO号",size:"large"},null,8,["modelValue"])]),_:1})]),_:1}),e.value.settlementType===1||e.value.settlementType===2?(y(),j(b,{key:0,style:{margin:"0",width:"100%"},gutter:20},{default:a(()=>[t(g,{style:{width:"100%"},prop:"arr"},{default:a(()=>[t(m,{modelValue:e.value.arr,"onUpdate:modelValue":l[7]||(l[7]=o=>e.value.arr=o),placeholder:"请粘贴ID，每行一个,多个请回车换行",type:"textarea",rows:"15"},null,8,["modelValue"])]),_:1})]),_:1})):x("",!0)]),_:1},8,["model","rules"])),[[O,_.value]])]),_:1},8,["modelValue"])])}}}),re=M(ae,[["__scopeId","data-v-9250a8d9"]]);export{re as default};
