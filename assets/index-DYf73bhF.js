
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{u as ee,v as le}from"./index-BxN2cQNN.js";import{d as ae,l as te,ab as oe,r as c,Z as q,$ as se,n as ne,a as i,q as de,o as p,b as E,s as re,i as a,e as h,w as l,f as e,b9 as ue,F as K,t as z,y as m,g as C,A as ie,aH as me,aI as ce,L as pe}from"./index-Co6Y74Lw.js";import{u as fe}from"./survey_vipGroup-CEzxunvC.js";import{a as ve}from"./survey_vip_department-D5-O9niP.js";import"./apiLoading-Daq0bPpE.js";import"./survey_vipGroup-X6s6avDm.js";const k=_=>(me("data-v-906c8c69"),_=_(),ce(),_),be=k(()=>m("div",{class:"card-header"},[m("span",null,"基本信息")],-1)),_e=k(()=>m("div",{class:"i-ic:round-plus w-1.3em h-1.3em"},null,-1)),ge={style:{display:"flex","justify-content":"space-between","align-items":"center",padding:"0 1rem"}},ye=k(()=>m("div",{class:"i-ic:round-plus w-1.3em h-1.3em"},null,-1)),Ve=k(()=>m("div",{class:"card-header"},[m("span",null,"权限信息")],-1)),he=k(()=>m("div",{class:"card-header"},[m("div",{class:"leftTitle"}," 部门信息 ")],-1)),ke=ae({__name:"index",props:{leftTab:Object,tabIndex:Number},setup(_){const G=te(),D=ee();fe();const j=oe("validateTopTabs"),F=_,L=c(!1),b=c(),f=c([]),I=c([]),w=c("basicSettings"),T=c(),x=q({vipLevelList:[],vipGroupList:[],countryList:[]}),Z={children:"children",label:"name"},v=q({memberNickname:[{required:!0,message:"请输入会员昵称",trigger:"blur"},{min:2,max:50,message:"内容在2-50个字之间",trigger:"blur"}],memberLevelId:[{required:!0,message:"请选择会员等级",trigger:"change"}],subordinateCountryId:[{required:!0,message:"请选择区域",trigger:"change"}]}),$=(d,s,u)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(o.value.memberPhone)?u():u(new Error("请输入合法手机号"))},H=(d,s,u)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(o.value.emailAddress)?u():u(new Error("请输入合法邮箱"))},A=d=>{d&&(o.value.countryType=d==="343"?1:2,d==="343"?(v.emailAddress&&delete v.emailAddress,v.memberPhone=[{required:!0,message:"请输入手机号码",trigger:"blur"},{validator:$,trigger:"blur"}]):(v.memberPhone&&delete v.memberPhone,v.emailAddress=[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:H,trigger:"blur"}]))},O=(d,s)=>{s?(b.value.getCheckedKeys().forEach(y=>{y!==d.id&&b.value.setChecked(y,!1)}),f.value=[d.id]):f.value=f.value.filter(g=>g!==d.id),f.value=b.value.getCheckedKeys(!1);const u=b.value.getCheckedKeys(),n=b.value.getHalfCheckedKeys(),r=u.concat(n);o.value.memberGroupId=r[0]},U=async()=>{x.vipLevelList=await D.getLevelNameList()},M=async()=>{await U();const d=await ve.list({name:""});d.data&&(I.value=d.data),x.countryList=await G.getCountry()},P=c(null),o=c(F.leftTab);f.value=[],o.value.memberGroupId&&f.value.push(o.value.memberGroupId),se(()=>{j(P.value)});const B=()=>{T.value.showEdit()};return ne(async()=>{try{L.value=!0,await M(),A(o.value.subordinateCountryId),L.value=!1}catch{}finally{L.value=!1}}),(d,s)=>{const u=i("el-input"),n=i("el-form-item"),r=i("el-col"),g=i("el-option"),y=i("el-select"),R=i("el-button"),S=i("el-row"),N=i("el-card"),V=i("el-switch"),Q=i("el-tree"),J=i("el-text"),W=i("el-tab-pane"),X=i("el-tabs"),Y=de("loading");return p(),E("div",null,[re((p(),h(X,{modelValue:a(w),"onUpdate:modelValue":s[11]||(s[11]=t=>ie(w)?w.value=t:null)},{default:l(()=>[e(W,{label:"会员信息",name:"basicSettings"},{default:l(()=>[e(a(ue),{ref_key:"formRef",ref:P,model:a(o),rules:a(v),"label-width":"100px","validate-on-rule-change":!1},{default:l(()=>[e(N,{class:"box-card"},{header:l(()=>[be]),default:l(()=>[e(S,{gutter:24},{default:l(()=>[e(r,{span:8},{default:l(()=>[e(n,{label:"会员名称",prop:"memberNickname"},{default:l(()=>[e(u,{modelValue:a(o).memberNickname,"onUpdate:modelValue":s[0]||(s[0]=t=>a(o).memberNickname=t),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:8},{default:l(()=>[e(n,{label:"所属区域",prop:"subordinateCountryId"},{default:l(()=>[e(y,{clearable:"",filterable:"",modelValue:a(o).subordinateCountryId,"onUpdate:modelValue":s[1]||(s[1]=t=>a(o).subordinateCountryId=t),onChange:A},{default:l(()=>[(p(!0),E(K,null,z(a(x).countryList,t=>(p(),h(g,{key:t.id,value:t.id,label:t.chineseName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(r,{span:8},{default:l(()=>[e(n,{label:"会员姓名"},{default:l(()=>[e(u,{clearable:"",modelValue:a(o).memberName,"onUpdate:modelValue":s[2]||(s[2]=t=>a(o).memberName=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:8},{default:l(()=>[e(n,{label:"手机号码",prop:"memberPhone"},{default:l(()=>[e(u,{clearable:"",modelValue:a(o).memberPhone,"onUpdate:modelValue":s[3]||(s[3]=t=>a(o).memberPhone=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:8},{default:l(()=>[e(n,{label:"电子邮箱",prop:"emailAddress"},{default:l(()=>[e(u,{clearable:"",modelValue:a(o).emailAddress,"onUpdate:modelValue":s[4]||(s[4]=t=>a(o).emailAddress=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:8},{default:l(()=>[e(n,{label:"初始密码"},{default:l(()=>[e(u,{clearable:"",value:"123456",disabled:""})]),_:1})]),_:1}),e(r,{span:8},{default:l(()=>[e(n,{label:"会员等级",prop:"memberLevelId"},{default:l(()=>[e(y,{clearable:"",filterable:"",modelValue:a(o).memberLevelId,"onUpdate:modelValue":s[5]||(s[5]=t=>a(o).memberLevelId=t)},{empty:l(()=>[m("div",ge,[C(" 暂无数据 "),e(R,{type:"primary",link:"",onClick:B,size:"small"},{default:l(()=>[C(" 快捷新增 "),ye]),_:1})])]),default:l(()=>[(p(!0),E(K,null,z(a(x).vipLevelList,t=>(p(),h(g,{key:t.memberLevelId,value:t.memberLevelId,label:t.levelNameOrAdditionRatio},null,8,["value","label"]))),128)),e(R,{onClick:B,size:"small",class:"buttonClass"},{default:l(()=>[C(" 快捷新增 "),_e]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(N,{class:"box-card"},{header:l(()=>[Ve]),default:l(()=>[e(S,{gutter:20},{default:l(()=>[e(r,{span:4},{default:l(()=>[e(n,{label:"会员状态"},{default:l(()=>[e(V,{"active-value":2,"inactive-value":1,modelValue:a(o).memberStatus,"onUpdate:modelValue":s[6]||(s[6]=t=>a(o).memberStatus=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:4},{default:l(()=>[e(n,{label:"B2B"},{default:l(()=>[e(V,{"active-value":2,"inactive-value":1,modelValue:a(o).b2bStatus,"onUpdate:modelValue":s[7]||(s[7]=t=>a(o).b2bStatus=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:4},{default:l(()=>[e(n,{label:"B2C"},{default:l(()=>[e(V,{"active-value":2,"inactive-value":1,modelValue:a(o).b2cStatus,"onUpdate:modelValue":s[8]||(s[8]=t=>a(o).b2cStatus=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:5},{default:l(()=>[e(n,{label:"免审"},{default:l(()=>[e(V,{"active-value":2,"inactive-value":1,modelValue:a(o).exemptionTrial,"onUpdate:modelValue":s[9]||(s[9]=t=>a(o).exemptionTrial=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:4},{default:l(()=>[e(n,{label:"随机身份"},{default:l(()=>[e(V,{"active-value":2,"inactive-value":1,modelValue:a(o).randomStatus,"onUpdate:modelValue":s[10]||(s[10]=t=>a(o).randomStatus=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(N,{class:"box-card"},{header:l(()=>[he]),default:l(()=>[e(S,{gutter:24},{default:l(()=>[e(n,{label:"分配部门:"},{default:l(()=>[a(I).length>0?(p(),h(Q,{key:0,style:{"max-width":"600px"},ref_key:"treeRef",ref:b,data:a(I),"show-checkbox":"","check-strictly":"","node-key":"id","default-expanded-keys":[],"default-checked-keys":a(f),"default-expand-all":"",props:Z,onCheckChange:O},null,8,["data","default-checked-keys"])):(p(),h(J,{key:1},{default:l(()=>[C("暂无数据")]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["modelValue"])),[[Y,a(L)]]),e(le,{ref_key:"EditRef",ref:T,onQueryData:U},null,512)])}}}),Ne=pe(ke,[["__scopeId","data-v-906c8c69"]]);export{Ne as default};
