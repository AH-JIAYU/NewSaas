
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Ue,aN as De,r as c,a5 as Qe,l as Re,b as r,q as Fe,o as i,e as ee,g as t,w as o,j as n,s as D,az as Pe,h as m,H as b,I as S,f as d,k as p,t as f,S as Q,F as je,v as Te,E as te,aO as Be,p as He,N as Me,aP as qe,aQ as Ke,bb as Oe,ap as Je,aI as Ge,aJ as We,aq as q,R as Xe}from"./index-Ch_t1wnJ.js";import{_ as Ye}from"./index-ehTuwwyN.js";import{_ as Ze}from"./index.vue_vue_type_style_index_0_lang-tj1dU9Fq.js";import{_ as et}from"./index.vue_vue_type_script_setup_true_lang-WglbtpEF.js";import{_ as tt}from"./index.vue_vue_type_script_setup_true_lang-BCFrRiMk.js";import ot from"./index-CmkWaXKB.js";import nt from"./index-CH14bd2K.js";import at from"./index-CIfxcJ4l.js";import{s as oe}from"./apiLoading-DyaEYmQL.js";import{u as lt}from"./user_customer-BwhD2fIR.js";import{a as K}from"./user_customer-B4PigaPU.js";import"./index-BHChwjQY.js";import"./index.vue_vue_type_script_setup_true_lang-BQWDttp_.js";import"./index-CqUpIMaJ.js";import"./index-DG7dJDRH.js";import"./department-BWPjO77r.js";import"./position_manage-D8o3wCAK.js";import"./department-CinucMBd.js";import"./tenant_role-D0QR-lRW.js";import"./configuration_role-Dgu7B9At.js";import"./configuration_manager-DtPbiEQK.js";import"./stagedData-D4vxuKid.js";import"./index.vue_vue_type_script_setup_true_lang-DlnzN2Xv.js";const st=V=>(Ge("data-v-636fd743"),V=V(),We(),V),rt=st(()=>f("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),it={class:"flex-c"},ct={class:"oneLine",style:{width:"calc(100% - 20px)"}},ut={class:"flex-c"},dt={class:"oneLine",style:{width:"calc(100% - 20px)"}},pt={class:"flex-c"},mt={class:"oneLine",style:{width:"calc(100% - 20px)"}},ft={class:"flex-c"},_t={class:"oneLine",style:{width:"calc(100% - 20px)"}},ht={style:{width:"20px","text-align":"right",display:"inline-block"}},gt=Ue({name:"customer",__name:"index",setup(V){const ne=lt(),{pagination:k,getParams:ae,onSizeChange:le,onCurrentChange:se}=De(),O=c([]),N=c(!1),J=c([]),R=c(),G=c(),W=c(),X=c(),x=c(),re=c(),z=c(!1),A=c(!1),$=c(!1),L=c("default"),u=c([]),U=c([{label:"客户编码",checked:!0,sortable:!0,prop:"tenantCustomerId"},{label:"客户名称",checked:!0,sortable:!0,prop:"customerAccord"},{label:"客户简称",checked:!0,sortable:!0,prop:"customerShortName"},{label:"负责人",checked:!0,sortable:!0,prop:"chargeName"},{label:"关联项目数",checked:!0,sortable:!0,prop:"projectNumber"},{label:"客户状态",checked:!0,sortable:!0,prop:"customerStatus"},{label:"前置问卷",checked:!0,sortable:!0,prop:"antecedentQuestionnaire"},{label:"风险控制",checked:!0,sortable:!0,prop:"riskControl"},{label:"客户营业限额/月",checked:!0,sortable:!0,prop:"turnover"},{label:"审核率Min值",checked:!0,sortable:!0,prop:"rateAudit"}]);function ie(){R.value.showEdit()}function ce(l){R.value.showEdit(l)}async function F(l,a,T){const I={status:l,operationalType:a,tenantCustomerId:T},{status:C}=await oe(K.changestatus(I));C===1&&te.success({message:"修改成功"}),ne.customer=null,h()}function ue(l){G.value.showEdit(l)}function de(l){l?x.value=l.tenantCustomerId:x.value=""}function P(l,a){W.value.showEdit(l,a)}function pe(l){X.value.showEdit(l)}function me(l){Be.confirm("您确定要删除当前项吗?","确认信息").then(async()=>{const{status:a}=await oe(K.delete({tenantCustomerId:l.tenantCustomerId}));a===1&&te.success({message:"删除成功"}),h()}).catch(()=>{})}const _=Qe({customerShortName:"",customerStatus:null,antecedentQuestionnaire:null}),fe=async()=>{const{data:l}=await He.getTenantStaffList();O.value=l};function _e(l){le(l).then(()=>j())}function E(l=1){se(l).then(()=>j())}function he(){Object.assign(_,{customerShortName:"",customerStatus:null,antecedentQuestionnaire:null}),h()}function h(){k.value.page=1,j()}async function j(){try{N.value=!0;const l={...ae(),..._},{data:a}=await K.list(l);J.value=a.getTenantCustomerInfoList,k.value.total=Number(a.total),N.value=!1}catch{}finally{N.value=!1}}function ge(l){re.value=l}return Re(async()=>{await fe(),U.value.forEach(l=>{l.checked&&u.value.push(l.prop)}),h()}),(l,a)=>{const T=r("el-input"),I=r("el-form-item"),C=r("el-option"),Y=r("el-select"),y=Me,B=r("ElButton"),ve=r("ElFormItem"),be=r("ElForm"),ke=et,Ce=r("ElDivider"),w=r("el-button"),ye=Ze,we=qe,Se=Ke,xe=r("el-row"),g=r("el-table-column"),H=r("ElSwitch"),M=r("ElTableColumn"),Ee=Ye,Z=r("el-text"),Ie=Oe,Ve=r("ElSpace"),Ne=r("el-empty"),ze=r("el-table"),Ae=r("ElPagination"),$e=Je,Le=Fe("loading");return i(),ee("div",{class:Q({"absolute-container":n($)})},[t($e,null,{default:o(()=>[t(ke,{"show-toggle":!1},{default:o(({fold:e,toggle:s})=>[t(be,{model:n(_).select,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:o(()=>[D(t(I,null,{default:o(()=>[t(T,{modelValue:n(_).customerShortName,"onUpdate:modelValue":a[0]||(a[0]=v=>n(_).customerShortName=v),clearable:"",placeholder:"客户简称",onKeydown:a[1]||(a[1]=Pe(v=>E(),["enter"]))},null,8,["modelValue"])]),_:2},1536),[[q,!e]]),D(t(I,null,{default:o(()=>[t(Y,{modelValue:n(_).customerStatus,"onUpdate:modelValue":a[2]||(a[2]=v=>n(_).customerStatus=v),clearable:"",placeholder:"客户状态",onChange:a[3]||(a[3]=v=>E())},{default:o(()=>[t(C,{label:"禁用",value:1}),t(C,{label:"启用",value:2})]),_:1},8,["modelValue"])]),_:2},1536),[[q,!e]]),D(t(I,null,{default:o(()=>[t(Y,{modelValue:n(_).antecedentQuestionnaire,"onUpdate:modelValue":a[4]||(a[4]=v=>n(_).antecedentQuestionnaire=v),clearable:"",placeholder:"前置问卷",onChange:a[5]||(a[5]=v=>E())},{default:o(()=>[t(C,{label:"禁用",value:1}),t(C,{label:"启用",value:2})]),_:1},8,["modelValue"])]),_:2},1536),[[q,!e]]),t(ve,null,{default:o(()=>[t(B,{type:"primary",onClick:a[6]||(a[6]=v=>E())},{icon:o(()=>[t(y,{name:"i-ep:search"})]),default:o(()=>[m(" 筛选 ")]),_:1}),t(B,{onClick:he},{icon:o(()=>[rt]),default:o(()=>[m(" 重置 ")]),_:1}),t(B,{disabled:"",link:"",onClick:s},{icon:o(()=>[t(y,{name:e?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:o(()=>[m(" "+b(e?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),t(Ce,{"border-style":"dashed"}),t(xe,null,{default:o(()=>[t(ye,null,{default:o(()=>[t(w,{type:"primary",size:"default",onClick:ie},{default:o(()=>[m(" 新增 ")]),_:1})]),_:1}),t(Se,null,{default:o(()=>[t(w,{size:"default"},{default:o(()=>[m(" 导出 ")]),_:1}),t(we,{border:n(z),"onUpdate:border":a[7]||(a[7]=e=>S(z)?z.value=e:null),tableAutoHeight:n($),"onUpdate:tableAutoHeight":a[8]||(a[8]=e=>S($)?$.value=e:null),checkList:n(u),"onUpdate:checkList":a[9]||(a[9]=e=>S(u)?u.value=e:null),columns:n(U),"onUpdate:columns":a[10]||(a[10]=e=>S(U)?U.value=e:null),"line-height":n(L),"onUpdate:lineHeight":a[11]||(a[11]=e=>S(L)?L.value=e:null),stripe:n(A),"onUpdate:stripe":a[12]||(a[12]=e=>S(A)?A.value=e:null),style:{"margin-left":"12px"},onQueryData:h},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),D((i(),d(ze,{border:n(z),data:n(J),size:n(L),stripe:n(A),onSelectionChange:ge,"highlight-current-row":"",onCurrentChange:de},{empty:o(()=>[t(Ne,{class:"vab-data-empty",description:"暂无数据"})]),default:o(()=>[t(g,{align:"center",type:"selection"}),n(u).includes("customerStatus")?(i(),d(M,{key:0,align:"center","show-overflow-tooltip":"",prop:"customerStatus",label:"客户状态"},{default:o(({row:e})=>[t(H,{modelValue:e.customerStatus,"onUpdate:modelValue":s=>e.customerStatus=s,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:s=>F(s,1,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):p("",!0),n(u).includes("customerAccord")?(i(),d(g,{key:1,align:"center",prop:"customerAccord","show-overflow-tooltip":"",label:"客户名称"},{default:o(({row:e})=>[f("div",it,[f("div",ct,b(e.customerAccord),1),t(y,{onClick:s=>P(e,"customerAccord"),class:Q({edit:"edit",current:e.tenantCustomerId===n(x)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):p("",!0),n(u).includes("tenantCustomerId")?(i(),d(g,{key:2,align:"center",prop:"tenantCustomerId",width:"180","show-overflow-tooltip":"",label:"客户编码"},{default:o(({row:e})=>[f("div",ut,[f("div",dt,b(e.tenantCustomerId),1),t(Ee)])]),_:1})):p("",!0),n(u).includes("customerShortName")?(i(),d(g,{key:3,align:"center",prop:"customerShortName","show-overflow-tooltip":"",label:"客户简称",width:"100"},{default:o(({row:e})=>[f("div",pt,[f("div",mt,b(e.customerShortName),1),t(y,{onClick:s=>P(e,"customerShortName"),class:Q({edit:"edit",current:e.tenantCustomerId===n(x)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):p("",!0),n(u).includes("chargeName")?(i(),d(g,{key:4,align:"center",prop:"chargeName","show-overflow-tooltip":"",label:"负责人"},{default:o(({row:e})=>[f("div",ft,[f("div",_t,[(i(!0),ee(je,null,Te(n(O),s=>(i(),d(Z,{key:s.id},{default:o(()=>[s.id===e.chargeId?(i(),d(Z,{key:0},{default:o(()=>[m(b(s.name),1)]),_:2},1024)):p("",!0)]),_:2},1024))),128))]),t(y,{onClick:s=>P(e,"chargeName"),class:Q({edit:"edit",current:e.tenantCustomerId===n(x)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):p("",!0),n(u).includes("projectNumber")?(i(),d(g,{key:5,align:"center",prop:"turnover","show-overflow-tooltip":"",label:"关联项目数"},{default:o(({row:e})=>[f("span",ht,b(e.projectNumber||0),1),e.projectNumber?(i(),d(w,{key:0,text:"",type:"primary",size:"small",class:"p-1",onClick:s=>pe(e)},{default:o(()=>[t(y,{name:"mdi:cursor-default-click",size:"16px",color:"#409eff"})]),_:2},1032,["onClick"])):p("",!0)]),_:1})):p("",!0),n(u).includes("antecedentQuestionnaire")?(i(),d(M,{key:6,align:"center","show-overflow-tooltip":"",prop:"antecedentQuestionnaire",label:"前置问卷"},{default:o(({row:e})=>[t(H,{modelValue:e.antecedentQuestionnaire,"onUpdate:modelValue":s=>e.antecedentQuestionnaire=s,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:s=>F(s,2,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):p("",!0),n(u).includes("riskControl")?(i(),d(M,{key:7,align:"center","show-overflow-tooltip":"",prop:"riskControl",label:"风险控制"},{default:o(({row:e})=>[t(H,{modelValue:e.riskControl,"onUpdate:modelValue":s=>e.riskControl=s,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:s=>F(s,3,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):p("",!0),n(u).includes("turnover")?(i(),d(g,{key:8,align:"center",prop:"turnover","show-overflow-tooltip":"",label:"客户营业限额/月"},{default:o(({row:e})=>[t(Ie),m(b(e.turnover||0),1)]),_:1})):p("",!0),n(u).includes("rateAudit")?(i(),d(g,{key:9,align:"center",prop:"rateAudit","show-overflow-tooltip":"",label:"审核率Min值"},{default:o(({row:e})=>[m(b(e.rateAudit?e.rateAudit:"-"),1)]),_:1})):p("",!0),t(g,{align:"center",fixed:"right",prop:"i",label:"操作",width:"200"},{default:o(({row:e})=>[t(Ve,null,{default:o(()=>[t(w,{size:"small",plain:"",type:"primary",onClick:s=>ce(e)},{default:o(()=>[m(" 编辑 ")]),_:2},1032,["onClick"]),t(w,{type:"warning",plain:"",size:"small",onClick:s=>ue(e)},{default:o(()=>[m(" 详情 ")]),_:2},1032,["onClick"]),t(w,{type:"danger",plain:"",size:"small",onClick:s=>me(e)},{default:o(()=>[m(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["border","data","size","stripe"])),[[Le,n(N)]]),t(Ae,{"current-page":n(k).page,total:n(k).total,"page-size":n(k).size,"page-sizes":n(k).sizes,layout:n(k).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:_e,onCurrentChange:E},null,8,["current-page","total","page-size","page-sizes","layout"]),t(tt,{ref_key:"editRef",ref:R,onFetchData:h},null,512),t(ot,{ref_key:"QuickEditRef",ref:W,onFetchData:h},null,512),t(nt,{ref_key:"AssociatedProjectsRef",ref:X,onFetchData:h},null,512),t(at,{ref_key:"checkRef",ref:G,onFetchData:h},null,512)]),_:1})],2)}}}),Tt=Xe(gt,[["__scopeId","data-v-636fd743"]]);export{Tt as default};
