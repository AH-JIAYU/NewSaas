
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as se,aG as ie,r as re,B as ue,C as $,G as de,a as s,ai as ce,o as c,b as me,f as a,w as o,av as x,aj as L,g as i,D as pe,e as f,k as V,i as h,O as fe,aH as k,aq as S,K as ge,q as ve,aC as _e,aD as be,j as he,aF as Ee,_ as we,p as B}from"./index-RsT8ijpm.js";import{_ as Ce}from"./index.vue_vue_type_script_setup_true_lang-DT5E0iXI.js";import{_ as ye}from"./index.vue_vue_type_script_setup_true_lang-B0vKHCQS.js";import{a as y}from"./index.vue_vue_type_script_setup_true_lang-DOhHsq8r.js";import{u as Me}from"./useTabbar-B4bf4LfW.js";import"./role-CBHS9LDT.js";const xe=E=>(_e("data-v-e8db752b"),E=E(),be(),E),Ve=xe(()=>he("div",{class:"i-grommet-icons:power-reset w-1em h-1em"},null,-1)),I=se({name:"PagesExampleManagerList",__name:"list",setup(E){const{pagination:g,getParams:T,onSizeChange:U,onCurrentChange:R,onSortChange:G}=ie(),z=Me(),e=re({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,id:""},search:{account:"",name:"",mobile:"",sex:""},batch:{enable:!0,selectionDataList:[]},dataList:[]});ue(()=>{d(),e.value.formMode==="router"&&$.on("get-data-list",()=>{d()})}),de(()=>{e.value.formMode==="router"&&$.off("get-data-list")});function d(){e.value.loading=!0;const n={...T(),...e.value.search.account&&{account:e.value.search.account},...e.value.search.name&&{name:e.value.search.name},...e.value.search.mobile&&{mobile:e.value.search.mobile},...e.value.search.sex!==""&&{sex:e.value.search.sex}};y.list(n).then(t=>{e.value.loading=!1,e.value.dataList=t.data.list,e.value.dataList.forEach(_=>{_.statusLoading=!1}),g.value.total=t.data.total})}function F(){Object.assign(e.value.search,{account:"",name:"",mobile:"",sex:""}),d()}function K(n){U(n).then(()=>d())}function u(n=1){R(n).then(()=>d())}function N({prop:n,order:t}){G(n,t).then(()=>d())}function j(){e.value.formMode==="router"?z.open({name:"pagesExampleGeneralManagerCreate"}):(e.value.formModeProps.id="",e.value.formModeProps.visible=!0)}function H(n){e.value.formMode==="router"?z.open({name:"pagesExampleGeneralManagerEdit",params:{id:n.id}}):(e.value.formModeProps.id=n.id,e.value.formModeProps.visible=!0)}function O(n){return new Promise(t=>{k.confirm(`确认${n.status?"禁用":"启用"}「${n.account}」吗？`,"确认信息").then(()=>{n.statusLoading=!0,y.changeStatus({id:n.id,status:!n.status}).then(()=>(n.statusLoading=!1,S.success({message:`模拟${n.status?"禁用":"启用"}成功`,center:!0}),t(!0))).catch(()=>(n.statusLoading=!1,t(!1)))}).catch(()=>t(!1))})}function q(n){k.confirm(`确认将「${n.account}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{y.passwordReset(n.id).then(()=>{S.success({message:"模拟重置成功",center:!0})})}).catch(()=>{})}function A(n){k.confirm(`确认删除「${n.account}」用户吗？`,"确认信息").then(()=>{y.delete(n.id).then(()=>{d(),S.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}function J(n,t){switch(n){case"resetPassword":q(t);break;case"delete":A(t);break}}return(n,t)=>{const _=s("ElInput"),b=s("ElFormItem"),w=s("ElRadioButton"),Q=s("ElRadioGroup"),C=ge,m=s("ElButton"),W=s("ElForm"),X=Ce,Y=s("ElDivider"),D=s("ElSpace"),p=s("ElTableColumn"),M=s("ElTag"),Z=s("ElSwitch"),P=s("ElDropdownItem"),ee=s("ElDropdownMenu"),ae=s("ElDropdown"),te=s("ElTable"),oe=s("ElPagination"),ne=ve,le=ce("loading");return c(),me("div",{class:fe({"absolute-container":e.value.tableAutoHeight})},[a(ne,null,{default:o(()=>[a(X,{"show-toggle":!1},{default:o(({fold:l,toggle:v})=>[a(W,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:o(()=>[a(b,null,{default:o(()=>[a(_,{modelValue:e.value.search.account,"onUpdate:modelValue":t[0]||(t[0]=r=>e.value.search.account=r),placeholder:"请输入帐号，支持模糊查询",clearable:"",onKeydown:t[1]||(t[1]=x(r=>u(),["enter"])),onClear:t[2]||(t[2]=r=>u())},null,8,["modelValue"])]),_:1}),a(b,null,{default:o(()=>[a(_,{modelValue:e.value.search.name,"onUpdate:modelValue":t[3]||(t[3]=r=>e.value.search.name=r),placeholder:"请输入姓名，支持模糊查询",clearable:"",onKeydown:t[4]||(t[4]=x(r=>u(),["enter"])),onClear:t[5]||(t[5]=r=>u())},null,8,["modelValue"])]),_:1}),a(b,null,{default:o(()=>[a(_,{modelValue:e.value.search.mobile,"onUpdate:modelValue":t[6]||(t[6]=r=>e.value.search.mobile=r),placeholder:"请输入手机号",clearable:"",onKeydown:t[7]||(t[7]=x(r=>u(),["enter"])),onClear:t[8]||(t[8]=r=>u())},null,8,["modelValue"])]),_:1}),L(a(b,null,{default:o(()=>[a(Q,{modelValue:e.value.search.sex,"onUpdate:modelValue":t[9]||(t[9]=r=>e.value.search.sex=r),onChange:t[10]||(t[10]=r=>u())},{default:o(()=>[a(w,{label:""},{default:o(()=>[i(" 全部 ")]),_:1}),a(w,{label:1},{default:o(()=>[i(" 男 ")]),_:1}),a(w,{label:0},{default:o(()=>[i(" 女 ")]),_:1}),a(w,{label:2},{default:o(()=>[i(" 保密 ")]),_:1})]),_:1},8,["modelValue"])]),_:2},1536),[[Ee,!l]]),a(b,null,{default:o(()=>[a(m,{type:"primary",onClick:t[11]||(t[11]=r=>u())},{icon:o(()=>[a(C,{name:"i-ep:search"})]),default:o(()=>[i(" 筛选 ")]),_:1}),a(m,{onClick:F},{icon:o(()=>[Ve]),default:o(()=>[i(" 重置 ")]),_:1}),a(m,{link:"",onClick:v},{icon:o(()=>[a(C,{name:l?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:o(()=>[i(" "+pe(l?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),a(Y,{"border-style":"dashed"}),a(D,{wrap:""},{default:o(()=>[a(m,{type:"primary",size:"default",onClick:j},{icon:o(()=>[a(C,{name:"i-ep:plus"})]),default:o(()=>[i(" 新增用户 ")]),_:1}),e.value.batch.enable?(c(),f(m,{key:0,size:"default",disabled:!e.value.batch.selectionDataList.length},{default:o(()=>[i(" 批量操作 ")]),_:1},8,["disabled"])):V("",!0)]),_:1}),L((c(),f(te,{class:"my-4",data:e.value.dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:N,onSelectionChange:t[12]||(t[12]=l=>e.value.batch.selectionDataList=l)},{default:o(()=>[e.value.batch.enable?(c(),f(p,{key:0,type:"selection",align:"center",fixed:""})):V("",!0),a(p,{prop:"account",sortable:"",label:"帐号"}),a(p,{prop:"name",label:"姓名",width:"100",align:"center"}),a(p,{prop:"sex",label:"性别",width:"100",align:"center"},{default:o(l=>[l.row.sex===1?(c(),f(M,{key:0,type:"success",size:"small"},{default:o(()=>[i(" 男 ")]),_:1})):l.row.sex===0?(c(),f(M,{key:1,type:"warning",size:"small"},{default:o(()=>[i(" 女 ")]),_:1})):(c(),f(M,{key:2,type:"info",size:"small"},{default:o(()=>[i(" 保密 ")]),_:1}))]),_:1}),a(p,{prop:"mobile",label:"手机号",width:"150",align:"center"}),a(p,{label:"状态",width:"100",align:"center"},{default:o(l=>[a(Z,{modelValue:l.row.status,"onUpdate:modelValue":v=>l.row.status=v,loading:l.row.statusLoading,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>O(l.row)},null,8,["modelValue","onUpdate:modelValue","loading","before-change"])]),_:1}),a(p,{label:"操作",width:"200",align:"center",fixed:"right"},{default:o(l=>[a(D,null,{default:o(()=>[a(m,{type:"primary",size:"small",plain:"",onClick:v=>H(l.row)},{default:o(()=>[i(" 编辑 ")]),_:2},1032,["onClick"]),a(ae,{onCommand:v=>J(v,l.row)},{dropdown:o(()=>[a(ee,null,{default:o(()=>[a(P,{command:"resetPassword"},{default:o(()=>[i(" 重置密码 ")]),_:1}),a(P,{command:"delete",divided:""},{default:o(()=>[i(" 删除 ")]),_:1})]),_:1})]),default:o(()=>[a(m,{size:"small"},{default:o(()=>[i(" 更多操作 "),a(C,{name:"i-ep:arrow-down",class:"el-icon--right"})]),_:1})]),_:2},1032,["onCommand"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[le,e.value.loading]]),a(oe,{"current-page":h(g).page,total:h(g).total,"page-size":h(g).size,"page-sizes":h(g).sizes,layout:h(g).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:u,onSizeChange:K},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e.value.formMode==="dialog"||e.value.formMode==="drawer"?(c(),f(ye,{key:0,id:e.value.formModeProps.id,modelValue:e.value.formModeProps.visible,"onUpdate:modelValue":t[13]||(t[13]=l=>e.value.formModeProps.visible=l),mode:e.value.formMode,onSuccess:d},null,8,["id","modelValue","mode"])):V("",!0)],2)}}});typeof B=="function"&&B(I);const Le=we(I,[["__scopeId","data-v-e8db752b"]]);export{Le as default};
