
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Ee,aN as Ie,r as i,Z as Ne,n as Le,a as p,q as ze,o as r,b as $,f as o,w as a,i as t,g,A as y,s as Ae,e as c,aM as Ve,j as d,y as m,z as b,N as k,F as De,t as Qe,E as K,aO as Re,p as Ue,b8 as Pe,b9 as je,_ as $e,bd as Fe,an as Me,L as Te}from"./index-BjTEgIZu.js";import{_ as Be}from"./index-BHuAJi7M.js";import{_ as He}from"./index.vue_vue_type_style_index_0_lang-CnvFyJ7P.js";import{_ as qe}from"./index-CzQKiGhF.js";import Oe from"./index-CSJwwoT3.js";import Ze from"./index-DF_p2ZTc.js";import Ge from"./index-BKQloUpz.js";import Je from"./index-C8utmgPw.js";import{s as W}from"./apiLoading-CdMZNp0S.js";import{u as Ke}from"./user_customer-CYhCBlN6.js";import{c as F}from"./user_customer-CvjpX7OL.js";import"./index-Bo6uSq4E.js";import"./index.vue_vue_type_script_setup_true_lang-CgnS0BGx.js";import"./sortable.esm-C0-Qcoum.js";import"./index.vue_vue_type_script_setup_true_lang-DtHBJx85.js";import"./index-CcL4qTMM.js";import"./index-C20a02bx.js";import"./department-DlVUq1Y_.js";import"./position_manage-D6lcjpYC.js";import"./configuration_role-DlI5_Hua.js";import"./tenant_role-CSAhMkTN.js";import"./configuration_manager-4N8lZg-Q.js";import"./configuration_siteSetting-B5Hy1CT4.js";import"./configuration_site_setting-jFqJMfX2.js";import"./stagedData-UuhrCPM2.js";import"./index.vue_vue_type_script_setup_true_lang-CTlSQltz.js";const We={class:"flex-c tableBig"},Xe={class:"oneLine",style:{width:"calc(100% - 20px)"}},Ye={class:"flex-c tableBig"},et={class:"oneLine",style:{width:"calc(100% - 20px)"}},tt={class:"copyId tableSmall"},ot={class:"oneLine projectId"},nt={class:"flex-c"},at={class:"oneLine",style:{width:"calc(100% - 20px)"}},lt={style:{display:"inline-block"},class:"fontC-System"},st={key:0,class:"fontC-System"},rt={class:"fontC-System"},it=Ee({name:"customer",__name:"index",setup(ct){const X=Ke(),{pagination:v,getParams:Y,onSizeChange:ee,onCurrentChange:te}=Ie(),M=i([]),S=i(!1),T=i([]),L=i(),B=i(),H=i(),q=i(),C=i(),oe=i(),w=i(!1),x=i(!1),E=i(!1),I=i("default"),u=i([]),O=i(),ne=i("formSearch-customer"),N=i([{label:"客户编码",checked:!0,sortable:!0,prop:"tenantCustomerId"},{label:"客户名称",checked:!0,sortable:!0,prop:"customerAccord"},{label:"客户简称",checked:!0,sortable:!0,prop:"customerShortName"},{label:"PM",checked:!0,sortable:!0,prop:"chargeId"},{label:"关联项目数",checked:!0,sortable:!0,prop:"projectNumber"},{label:"客户状态",checked:!0,sortable:!0,prop:"customerStatus"},{label:"前置问卷",checked:!0,sortable:!0,prop:"antecedentQuestionnaire"},{label:"风险控制",checked:!0,sortable:!0,prop:"riskControl"},{label:"客户营业限额/月",checked:!0,sortable:!0,prop:"turnover"},{label:"审核率Min值",checked:!0,sortable:!0,prop:"rateAudit"}]);function ae(){L.value.showEdit()}function le(n){L.value.showEdit(n)}async function z(n,l,D){const Q={status:n,operationalType:l,tenantCustomerId:D},{status:h}=await W(F.changestatus(Q));h===1&&K.success({message:"修改成功"}),X.customer=null,f()}function se(n){B.value.showEdit(n)}function re(n){n?C.value=n.tenantCustomerId:C.value=""}function Z(n,l){H.value.showEdit(n,l)}function ie(n){q.value.showEdit(n)}function ce(n){Re.confirm("您确定要删除当前项吗?","确认信息").then(async()=>{const{status:l}=await W(F.delete({tenantCustomerId:n.tenantCustomerId}));l===1&&K.success({message:"删除成功"}),f()}).catch(()=>{})}const A=Ne({customerShortName:"",customerStatus:null,antecedentQuestionnaire:null}),ue=async()=>{const{data:n}=await Ue.getTenantStaffList();M.value=n};function de(n){ee(n).then(()=>V())}function G(n=1){te(n).then(()=>V())}function pe(){Object.assign(A,{customerShortName:"",customerStatus:null,antecedentQuestionnaire:null}),f()}function f(){v.value.page=1,V()}async function V(){try{S.value=!0;const n={...Y(),...A},{data:l}=await F.list(n);T.value=l.getTenantCustomerInfoList,v.value.total=Number(l.total),S.value=!1}catch{}finally{S.value=!1}}function me(n){oe.value=n}Le(async()=>{await ue(),N.value.forEach(n=>{n.checked&&u.value.push(n.prop)}),f(),O.value=[{index:1,show:!0,type:"input",modelName:"customerShortName",placeholder:"客户简称"},{index:2,show:!0,type:"select",modelName:"customerStatus",placeholder:"客户状态",option:"customerStatus",optionLabel:"label",optionValue:"value"},{index:3,show:!0,type:"select",modelName:"antecedentQuestionnaire",placeholder:"前置问卷",option:"antecedentQuestionnaire",optionLabel:"label",optionValue:"value"}]});const fe={customerStatus:()=>[{label:"禁用",value:1},{label:"启用",value:2}],antecedentQuestionnaire:()=>[{label:"禁用",value:1},{label:"启用",value:2}]};return(n,l)=>{const D=qe,Q=p("ElDivider"),h=p("el-button"),_e=He,he=Pe,ge=je,ve=p("el-row"),_=p("el-table-column"),R=p("ElSwitch"),U=p("ElTableColumn"),J=Be,P=$e,j=p("el-text"),be=Fe,Ce=p("ElSpace"),ye=p("el-empty"),ke=p("el-table"),Se=p("ElPagination"),we=Me,xe=ze("loading");return r(),$("div",{class:k({"absolute-container":t(E)})},[o(we,null,{default:a(()=>[o(D,{formSearchList:t(O),formSearchName:t(ne),onCurrentChange:G,onOnReset:pe,model:t(A),formOption:fe},null,8,["formSearchList","formSearchName","model"]),o(Q,{"border-style":"dashed"}),o(ve,null,{default:a(()=>[o(_e,null,{default:a(()=>[o(h,{type:"primary",size:"default",onClick:ae},{default:a(()=>[g(" 新增 ")]),_:1})]),_:1}),o(ge,null,{default:a(()=>[o(h,{size:"default"},{default:a(()=>[g(" 导出 ")]),_:1}),o(he,{border:t(w),"onUpdate:border":l[0]||(l[0]=e=>y(w)?w.value=e:null),tableAutoHeight:t(E),"onUpdate:tableAutoHeight":l[1]||(l[1]=e=>y(E)?E.value=e:null),checkList:t(u),"onUpdate:checkList":l[2]||(l[2]=e=>y(u)?u.value=e:null),columns:t(N),"onUpdate:columns":l[3]||(l[3]=e=>y(N)?N.value=e:null),"line-height":t(I),"onUpdate:lineHeight":l[4]||(l[4]=e=>y(I)?I.value=e:null),stripe:t(x),"onUpdate:stripe":l[5]||(l[5]=e=>y(x)?x.value=e:null),style:{"margin-left":"12px"},onQueryData:f},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),Ae((r(),c(ke,{border:t(w),data:t(T),size:t(I),stripe:t(x),onSelectionChange:me,"highlight-current-row":"",onCurrentChange:re},{empty:a(()=>[o(ye,{image:t(Ve),"image-size":300},null,8,["image"])]),default:a(()=>[o(_,{align:"left",type:"selection"}),t(u).includes("customerStatus")?(r(),c(U,{key:0,align:"left","show-overflow-tooltip":"",prop:"customerStatus",label:"客户状态",width:"84"},{default:a(({row:e})=>[o(R,{modelValue:e.customerStatus,"onUpdate:modelValue":s=>e.customerStatus=s,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:s=>z(s,1,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):d("",!0),t(u).includes("customerAccord")?(r(),c(_,{key:1,align:"left",prop:"customerAccord","show-overflow-tooltip":"",label:"客户名称"},{default:a(({row:e})=>[m("div",We,[m("div",Xe,b(e.customerAccord),1),o(J,{content:e.customerAccord,class:k({rowCopy:"rowCopy",current:e.tenantCustomerId===t(C)})},null,8,["content","class"])])]),_:1})):d("",!0),t(u).includes("customerShortName")?(r(),c(_,{key:2,align:"left",prop:"customerShortName","show-overflow-tooltip":"",label:"客户简称",width:"150"},{default:a(({row:e})=>[m("div",Ye,[m("div",et,b(e.customerShortName),1),o(P,{onClick:s=>Z(e,"customerShortName"),class:k({edit:"edit",current:e.tenantCustomerId===t(C)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):d("",!0),t(u).includes("tenantCustomerId")?(r(),c(_,{key:3,align:"left",prop:"tenantCustomerId","show-overflow-tooltip":"",label:"客户编码"},{default:a(({row:e})=>[m("div",tt,[m("div",ot,b(e.tenantCustomerId),1),o(J,{content:e.tenantCustomerId,class:k({rowCopy:"rowCopy",current:e.tenantCustomerId===t(C)})},null,8,["content","class"])])]),_:1})):d("",!0),t(u).includes("chargeId")?(r(),c(_,{key:4,align:"left",prop:"chargeId","show-overflow-tooltip":"",label:"PM"},{default:a(({row:e})=>[m("div",nt,[m("div",at,[(r(!0),$(De,null,Qe(t(M),s=>(r(),c(j,{key:s.id},{default:a(()=>[s.id===e.chargeId?(r(),c(j,{key:0,class:"fontC-System"},{default:a(()=>[g(b(s.userName),1)]),_:2},1024)):d("",!0)]),_:2},1024))),128))]),o(P,{onClick:s=>Z(e,"chargeId"),class:k({edit:"edit",current:e.tenantCustomerId===t(C)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):d("",!0),t(u).includes("projectNumber")?(r(),c(_,{key:5,align:"left",prop:"turnover","show-overflow-tooltip":"",label:"关联项目数"},{default:a(({row:e})=>[m("span",lt,b(e.projectNumber||0),1),e.projectNumber?(r(),c(h,{key:0,text:"",type:"primary",size:"small",class:"p-1",onClick:s=>ie(e)},{default:a(()=>[o(P,{name:"mdi:cursor-default-click",size:"16px",color:"#409eff"})]),_:2},1032,["onClick"])):d("",!0)]),_:1})):d("",!0),t(u).includes("antecedentQuestionnaire")?(r(),c(U,{key:6,align:"left","show-overflow-tooltip":"",prop:"antecedentQuestionnaire",label:"前置问卷"},{default:a(({row:e})=>[o(R,{modelValue:e.antecedentQuestionnaire,"onUpdate:modelValue":s=>e.antecedentQuestionnaire=s,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:s=>z(s,2,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):d("",!0),t(u).includes("riskControl")?(r(),c(U,{key:7,align:"left","show-overflow-tooltip":"",prop:"riskControl",label:"风险控制"},{default:a(({row:e})=>[o(R,{modelValue:e.riskControl,"onUpdate:modelValue":s=>e.riskControl=s,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:s=>z(s,3,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):d("",!0),t(u).includes("turnover")?(r(),c(_,{key:8,align:"left",prop:"turnover","show-overflow-tooltip":"",label:"客户营业限额/月"},{default:a(({row:e})=>[e.turnover>0?(r(),$("div",st,[o(be),g(b(e.turnover),1)])):(r(),c(j,{key:1,class:"fontC-System"},{default:a(()=>[g("-")]),_:1}))]),_:1})):d("",!0),t(u).includes("rateAudit")?(r(),c(_,{key:9,align:"left",prop:"rateAudit","show-overflow-tooltip":"",label:"审核率Min值"},{default:a(({row:e})=>[m("div",rt,b(e.rateAudit?e.rateAudit:"-"),1)]),_:1})):d("",!0),o(_,{align:"left",fixed:"right",prop:"i",label:"操作",width:"200"},{default:a(({row:e})=>[o(Ce,null,{default:a(()=>[o(h,{size:"small",plain:"",type:"primary",onClick:s=>le(e)},{default:a(()=>[g(" 编辑 ")]),_:2},1032,["onClick"]),o(h,{type:"warning",plain:"",size:"small",onClick:s=>se(e)},{default:a(()=>[g(" 详情 ")]),_:2},1032,["onClick"]),o(h,{type:"danger",plain:"",size:"small",onClick:s=>ce(e)},{default:a(()=>[g(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["border","data","size","stripe"])),[[xe,t(S)]]),o(Se,{"current-page":t(v).page,total:t(v).total,"page-size":t(v).size,"page-sizes":t(v).sizes,layout:t(v).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:de,onCurrentChange:G},null,8,["current-page","total","page-size","page-sizes","layout"]),o(Oe,{ref_key:"editRef",ref:L,onFetchData:f},null,512),o(Ze,{ref_key:"QuickEditRef",ref:H,onFetchData:f},null,512),o(Ge,{ref_key:"AssociatedProjectsRef",ref:q,onFetchData:f},null,512),o(Je,{ref_key:"checkRef",ref:B,onFetchData:f},null,512)]),_:1})],2)}}}),Ut=Te(it,[["__scopeId","data-v-a0d47c9d"]]);export{Ut as default};
