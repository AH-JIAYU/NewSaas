
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Ne,aO as Ee,r as i,a5 as Le,l as ze,b as m,q as Ie,o as r,e as J,g as o,w as n,j as t,h as v,I as C,s as Ae,f as u,aN as Ve,k as d,t as p,H as b,S as z,F as Re,v as Qe,E as K,aP as De,p as Ue,aQ as $e,aR as Pe,N as Be,be as je,ap as Fe,R as Te}from"./index-B32N5rJq.js";import{_ as He}from"./index-BUiNcO1y.js";import{_ as Me}from"./index.vue_vue_type_style_index_0_lang-8EPm5Gp1.js";import{_ as qe}from"./index-CvSEhIp-.js";import{_ as Oe}from"./index.vue_vue_type_script_setup_true_lang-LsWUJv46.js";import Ge from"./index-179x-VGq.js";import Je from"./index-CHH3yS1Z.js";import Ke from"./index-u-rmOtjb.js";import{s as W}from"./apiLoading-BHXNM8BK.js";import{u as We}from"./user_customer-BjFFnwJF.js";import{a as B}from"./user_customer-3OEKJ1eC.js";import"./index-x6c8W2qD.js";import"./index.vue_vue_type_script_setup_true_lang-CfW_Y4Dw.js";import"./sortable.esm-C0-Qcoum.js";import"./index.vue_vue_type_script_setup_true_lang--MIMY0DW.js";import"./index-Bq5NGaqF.js";import"./index-DlT-yK1u.js";import"./department-tPuP8BNB.js";import"./position_manage-B4wEVh-B.js";import"./department-Cxr8SibV.js";import"./tenant_role-D2D9-yB1.js";import"./configuration_role-3QMdkBQm.js";import"./configuration_manager-DGqdjivD.js";import"./configuration_siteSetting-pPUsZPNm.js";import"./configuration_site_setting-Bon70quM.js";import"./stagedData-BUgLChQ2.js";import"./index.vue_vue_type_script_setup_true_lang-CbCvuyBR.js";const Xe={class:"flex-c tableBig"},Ye={class:"oneLine",style:{width:"calc(100% - 20px)"}},Ze={class:"copyId tableSmall"},et={class:"oneLine"},tt={class:"flex-c tableBig"},ot={class:"oneLine",style:{width:"calc(100% - 20px)"}},at={class:"flex-c tableBig"},nt={class:"oneLine",style:{width:"calc(100% - 20px)"}},lt={style:{display:"inline-block"},class:"tableBig"},st={class:"tableBig"},it={class:"tableBig"},rt=Ne({name:"customer",__name:"index",setup(ct){const X=We(),{pagination:g,getParams:Y,onSizeChange:Z,onCurrentChange:ee}=Ee(),j=i([]),y=i(!1),F=i([]),I=i(),T=i(),H=i(),M=i(),k=i(),te=i(),S=i(!1),w=i(!1),x=i(!1),N=i("default"),c=i([]),q=i(),oe=i("formSearch-customer"),E=i([{label:"客户编码",checked:!0,sortable:!0,prop:"tenantCustomerId"},{label:"客户名称",checked:!0,sortable:!0,prop:"customerAccord"},{label:"客户简称",checked:!0,sortable:!0,prop:"customerShortName"},{label:"负责人",checked:!0,sortable:!0,prop:"chargeName"},{label:"关联项目数",checked:!0,sortable:!0,prop:"projectNumber"},{label:"客户状态",checked:!0,sortable:!0,prop:"customerStatus"},{label:"前置问卷",checked:!0,sortable:!0,prop:"antecedentQuestionnaire"},{label:"风险控制",checked:!0,sortable:!0,prop:"riskControl"},{label:"客户营业限额/月",checked:!0,sortable:!0,prop:"turnover"},{label:"审核率Min值",checked:!0,sortable:!0,prop:"rateAudit"}]);function ae(){I.value.showEdit()}function ne(a){I.value.showEdit(a)}async function A(a,s,D){const U={status:a,operationalType:s,tenantCustomerId:D},{status:h}=await W(B.changestatus(U));h===1&&K.success({message:"修改成功"}),X.customer=null,f()}function le(a){T.value.showEdit(a)}function se(a){a?k.value=a.tenantCustomerId:k.value=""}function V(a,s){H.value.showEdit(a,s)}function ie(a){M.value.showEdit(a)}function re(a){De.confirm("您确定要删除当前项吗?","确认信息").then(async()=>{const{status:s}=await W(B.delete({tenantCustomerId:a.tenantCustomerId}));s===1&&K.success({message:"删除成功"}),f()}).catch(()=>{})}const R=Le({customerShortName:"",customerStatus:null,antecedentQuestionnaire:null}),ce=async()=>{const{data:a}=await Ue.getTenantStaffList();j.value=a};function ue(a){Z(a).then(()=>Q())}function O(a=1){ee(a).then(()=>Q())}function de(){Object.assign(R,{customerShortName:"",customerStatus:null,antecedentQuestionnaire:null}),f()}function f(){g.value.page=1,Q()}async function Q(){try{y.value=!0;const a={...Y(),...R},{data:s}=await B.list(a);F.value=s.getTenantCustomerInfoList,g.value.total=Number(s.total),y.value=!1}catch{}finally{y.value=!1}}function me(a){te.value=a}ze(async()=>{await ce(),E.value.forEach(a=>{a.checked&&c.value.push(a.prop)}),f(),q.value=[{index:1,show:!0,type:"input",modelName:"customerShortName",placeholder:"客户简称"},{index:2,show:!0,type:"select",modelName:"customerStatus",placeholder:"客户状态",option:"customerStatus",optionLabel:"label",optionValue:"value"},{index:3,show:!0,type:"select",modelName:"antecedentQuestionnaire",placeholder:"前置问卷",option:"antecedentQuestionnaire",optionLabel:"label",optionValue:"value"}]});const pe={customerStatus:()=>[{label:"禁用",value:1},{label:"启用",value:2}],antecedentQuestionnaire:()=>[{label:"禁用",value:1},{label:"启用",value:2}]};return(a,s)=>{const D=qe,U=m("ElDivider"),h=m("el-button"),fe=Me,_e=$e,he=Pe,ge=m("el-row"),_=m("el-table-column"),$=m("ElSwitch"),P=m("ElTableColumn"),L=Be,ve=He,G=m("el-text"),be=je,Ce=m("ElSpace"),ke=m("el-empty"),ye=m("el-table"),Se=m("ElPagination"),we=Fe,xe=Ie("loading");return r(),J("div",{class:z({"absolute-container":t(x)})},[o(we,null,{default:n(()=>[o(D,{formSearchList:t(q),formSearchName:t(oe),onCurrentChange:O,onOnReset:de,model:t(R),formOption:pe},null,8,["formSearchList","formSearchName","model"]),o(U,{"border-style":"dashed"}),o(ge,null,{default:n(()=>[o(fe,null,{default:n(()=>[o(h,{type:"primary",size:"default",onClick:ae},{default:n(()=>[v(" 新增 ")]),_:1})]),_:1}),o(he,null,{default:n(()=>[o(h,{size:"default"},{default:n(()=>[v(" 导出 ")]),_:1}),o(_e,{border:t(S),"onUpdate:border":s[0]||(s[0]=e=>C(S)?S.value=e:null),tableAutoHeight:t(x),"onUpdate:tableAutoHeight":s[1]||(s[1]=e=>C(x)?x.value=e:null),checkList:t(c),"onUpdate:checkList":s[2]||(s[2]=e=>C(c)?c.value=e:null),columns:t(E),"onUpdate:columns":s[3]||(s[3]=e=>C(E)?E.value=e:null),"line-height":t(N),"onUpdate:lineHeight":s[4]||(s[4]=e=>C(N)?N.value=e:null),stripe:t(w),"onUpdate:stripe":s[5]||(s[5]=e=>C(w)?w.value=e:null),style:{"margin-left":"12px"},onQueryData:f},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),Ae((r(),u(ye,{border:t(S),data:t(F),size:t(N),stripe:t(w),onSelectionChange:me,"highlight-current-row":"",onCurrentChange:se},{empty:n(()=>[o(ke,{image:t(Ve),"image-size":300},null,8,["image"])]),default:n(()=>[o(_,{align:"left",type:"selection"}),t(c).includes("customerStatus")?(r(),u(P,{key:0,align:"left","show-overflow-tooltip":"",prop:"customerStatus",label:"客户状态"},{default:n(({row:e})=>[o($,{modelValue:e.customerStatus,"onUpdate:modelValue":l=>e.customerStatus=l,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:l=>A(l,1,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):d("",!0),t(c).includes("customerAccord")?(r(),u(_,{key:1,align:"left",prop:"customerAccord","show-overflow-tooltip":"",label:"客户名称"},{default:n(({row:e})=>[p("div",Xe,[p("div",Ye,b(e.customerAccord),1),o(L,{onClick:l=>V(e,"customerAccord"),class:z({edit:"edit",current:e.tenantCustomerId===t(k)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):d("",!0),t(c).includes("tenantCustomerId")?(r(),u(_,{key:2,align:"left",prop:"tenantCustomerId","show-overflow-tooltip":"",label:"客户编码"},{default:n(({row:e})=>[p("div",Ze,[p("div",et,b(e.tenantCustomerId),1),o(ve)])]),_:1})):d("",!0),t(c).includes("customerShortName")?(r(),u(_,{key:3,align:"left",prop:"customerShortName","show-overflow-tooltip":"",label:"客户简称",width:"100"},{default:n(({row:e})=>[p("div",tt,[p("div",ot,b(e.customerShortName),1),o(L,{onClick:l=>V(e,"customerShortName"),class:z({edit:"edit",current:e.tenantCustomerId===t(k)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):d("",!0),t(c).includes("chargeName")?(r(),u(_,{key:4,align:"left",prop:"chargeName","show-overflow-tooltip":"",label:"负责人"},{default:n(({row:e})=>[p("div",at,[p("div",nt,[(r(!0),J(Re,null,Qe(t(j),l=>(r(),u(G,{key:l.id},{default:n(()=>[l.id===e.chargeId?(r(),u(G,{key:0},{default:n(()=>[v(b(l.name),1)]),_:2},1024)):d("",!0)]),_:2},1024))),128))]),o(L,{onClick:l=>V(e,"chargeName"),class:z({edit:"edit",current:e.tenantCustomerId===t(k)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):d("",!0),t(c).includes("projectNumber")?(r(),u(_,{key:5,align:"left",prop:"turnover","show-overflow-tooltip":"",label:"关联项目数"},{default:n(({row:e})=>[p("span",lt,b(e.projectNumber||0),1),e.projectNumber?(r(),u(h,{key:0,text:"",type:"primary",size:"small",class:"p-1",onClick:l=>ie(e)},{default:n(()=>[o(L,{name:"mdi:cursor-default-click",size:"16px",color:"#409eff"})]),_:2},1032,["onClick"])):d("",!0)]),_:1})):d("",!0),t(c).includes("antecedentQuestionnaire")?(r(),u(P,{key:6,align:"left","show-overflow-tooltip":"",prop:"antecedentQuestionnaire",label:"前置问卷"},{default:n(({row:e})=>[o($,{modelValue:e.antecedentQuestionnaire,"onUpdate:modelValue":l=>e.antecedentQuestionnaire=l,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:l=>A(l,2,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):d("",!0),t(c).includes("riskControl")?(r(),u(P,{key:7,align:"left","show-overflow-tooltip":"",prop:"riskControl",label:"风险控制"},{default:n(({row:e})=>[o($,{modelValue:e.riskControl,"onUpdate:modelValue":l=>e.riskControl=l,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:l=>A(l,3,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):d("",!0),t(c).includes("turnover")?(r(),u(_,{key:8,align:"left",prop:"turnover","show-overflow-tooltip":"",label:"客户营业限额/月"},{default:n(({row:e})=>[p("div",st,[o(be),v(b(e.turnover||0),1)])]),_:1})):d("",!0),t(c).includes("rateAudit")?(r(),u(_,{key:9,align:"left",prop:"rateAudit","show-overflow-tooltip":"",label:"审核率Min值"},{default:n(({row:e})=>[p("div",it,b(e.rateAudit?e.rateAudit:"-"),1)]),_:1})):d("",!0),o(_,{align:"left",fixed:"right",prop:"i",label:"操作",width:"200"},{default:n(({row:e})=>[o(Ce,null,{default:n(()=>[o(h,{size:"small",plain:"",type:"primary",onClick:l=>ne(e)},{default:n(()=>[v(" 编辑 ")]),_:2},1032,["onClick"]),o(h,{type:"warning",plain:"",size:"small",onClick:l=>le(e)},{default:n(()=>[v(" 详情 ")]),_:2},1032,["onClick"]),o(h,{type:"danger",plain:"",size:"small",onClick:l=>re(e)},{default:n(()=>[v(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["border","data","size","stripe"])),[[xe,t(y)]]),o(Se,{"current-page":t(g).page,total:t(g).total,"page-size":t(g).size,"page-sizes":t(g).sizes,layout:t(g).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:ue,onCurrentChange:O},null,8,["current-page","total","page-size","page-sizes","layout"]),o(Oe,{ref_key:"editRef",ref:I,onFetchData:f},null,512),o(Ge,{ref_key:"QuickEditRef",ref:H,onFetchData:f},null,512),o(Je,{ref_key:"AssociatedProjectsRef",ref:M,onFetchData:f},null,512),o(Ke,{ref_key:"checkRef",ref:T,onFetchData:f},null,512)]),_:1})],2)}}}),$t=Te(rt,[["__scopeId","data-v-01abd3e7"]]);export{$t as default};
