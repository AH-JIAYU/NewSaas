
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as V}from"./dictionary-DivCbnEr.js";import{d as F,m as I,u as U,c as y,r as E,n as R,a as i,o as T,e as q,w as n,f as d,g as C,i as t,E as x,L as z}from"./index-CIMs2gPi.js";const S=F({__name:"index",props:I({parentId:{default:""},id:{default:""},tree:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:I(["addNode","editNode"],["update:modelValue"]),setup(b,{emit:k}){const s=b,g=k,v=U(b,"modelValue"),N=y(()=>s.id===""?"新增字典":"编辑字典");function _(o,l,p=!1){const u=[];return o.forEach(f=>{const a={...f};a.id===l||p?(a.disabled=!0,a.children&&(a.children=_(a.children,l,!0))):(a.disabled=!1,a.children&&(a.children=_(a.children,l,p))),u.push(a)}),u}const w=y(()=>_(s.tree,s.id)),c=E(),e=E({parentId:s.parentId,id:s.id,name:"",code:""}),B=E({name:[{required:!0,message:"请输入字典名称"}],code:[{required:!0,message:"请输入字典编码"}]});R(()=>{s.id!==""&&V.detail(s.id).then(o=>{e.value.id=o.data.id,e.value.name=o.data.name,e.value.code=o.data.code})});function M(){e.value.id===""?c.value&&c.value.validate(o=>{o&&V.create(e.value).then(l=>{x.success({message:"模拟新增成功",center:!0}),g("addNode",{id:l.data.data,label:e.value.name,code:e.value.code}),m()})}):c.value&&c.value.validate(o=>{o&&V.edit(e.value).then(()=>{x.success({message:"模拟编辑成功",center:!0}),g("editNode",{id:e.value.id,label:e.value.name,code:e.value.code},e.value.parentId),m()})})}function m(){v.value=!1}return(o,l)=>{const p=i("ElCascader"),u=i("ElFormItem"),f=i("ElInput"),a=i("ElForm"),h=i("ElButton"),D=i("ElDialog");return T(),q(D,{modelValue:v.value,"onUpdate:modelValue":l[3]||(l[3]=r=>v.value=r),title:t(N),width:"400px","close-on-click-modal":!1,"append-to-body":"","destroy-on-close":"",onClosed:m},{footer:n(()=>[d(h,{size:"large",onClick:m},{default:n(()=>[C(" 取消 ")]),_:1}),d(h,{type:"primary",size:"large",onClick:M},{default:n(()=>[C(" 确定 ")]),_:1})]),default:n(()=>[d(a,{ref_key:"formRef",ref:c,model:t(e),rules:t(B),"label-width":"80px"},{default:n(()=>[d(u,{label:"父级字典",prop:"parentId"},{default:n(()=>[d(p,{modelValue:t(e).parentId,"onUpdate:modelValue":l[0]||(l[0]=r=>t(e).parentId=r),options:t(w),props:{value:"id",emitPath:!1,checkStrictly:!0},"show-all-levels":!1,placeholder:"请选择父级字典，默认为根字典",clearable:""},null,8,["modelValue","options"])]),_:1}),d(u,{label:"字典名称",prop:"name"},{default:n(()=>[d(f,{modelValue:t(e).name,"onUpdate:modelValue":l[1]||(l[1]=r=>t(e).name=r),placeholder:"请输入字典名称",clearable:""},null,8,["modelValue"])]),_:1}),d(u,{label:"字典编码",prop:"code"},{default:n(()=>[d(f,{modelValue:t(e).code,"onUpdate:modelValue":l[2]||(l[2]=r=>t(e).code=r),placeholder:"请输入字典编码",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),j=z(S,[["__scopeId","data-v-c4b2809f"]]);export{j as default};
