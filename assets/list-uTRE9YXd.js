
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as Le}from"./index-CU4YFawH.js";import{_ as we}from"./index-BDPk5fLH.js";import{d as Ne,aN as De,r as d,l as Ee,n as O,X as B,a as g,q as ze,o as r,b as j,y as _,f as n,w as l,g as f,aA as Ve,s as E,e as s,z as k,az as x,aq as q,i as Be,aM as xe,j as m,F as $e,t as Ue,aO as $,E as U,p as J,_ as Re,aH as Me,aI as Te,L as Ge,ao as K}from"./index-CEjgWoZJ.js";import{a as R}from"./department-CCVJEtaL.js";import{u as Pe}from"./department-CwR988D3.js";import{u as Fe}from"./position_manage-BW-59_yc.js";import Ae from"./index-CRCS9fhz.js";import He from"./index-CXf2nuAV.js";import Oe from"./index-fi90g6sz.js";import je from"./index-C3mOTMwn.js";import qe from"./index-Bf11cEpc.js";import"./index-DFlPOmh5.js";import"./position_manage-D8cQw-AI.js";import"./tenantDictionary-k8a3dtew.js";import"./tenant_role-BQCViB8y.js";import"./configuration_role--gGLuQaz.js";import"./configuration_manager-EVk3yrRr.js";const Je=S=>(Me("data-v-25d86382"),S=S(),Te(),S),Ke={class:"absolute-container"},Xe={class:"page-main"},Qe={class:"custom-tree-node"},We=["title"],Ye={class:"code"},Ze={class:"actions"},ea={class:"dictionary-container"},aa={class:"copyId tableSmall"},ta={class:"id oneLine"},la={class:"dictionary-container"},ia=Je(()=>_("div",{class:"empty"},"请在左侧新增或选择一个部门",-1)),oa=[ia],X=Ne({name:"department",__name:"list",setup(S){const{pagination:M,getParams:na,onSizeChange:ra,onCurrentChange:sa,onSortChange:Q}=De(),z=Fe(),T=d(),W=Ee(),Y=d([]),V=Pe(),Z=d(),ee=d([{label:"员工ID",prop:"id",sortable:!0,checked:!0},{label:"用户名",prop:"userName",sortable:!0,checked:!0},{label:"电话号码",prop:"phoneNumber",sortable:!0,checked:!0},{label:"邮箱",prop:"email",sortable:!0,checked:!0},{label:"部门",prop:"departmentId",sortable:!0,checked:!0},{label:"职位",prop:"positionId",sortable:!0,checked:!0},{label:"小组",prop:"groupId",sortable:!0,checked:!0},{label:"状态",prop:"active",sortable:!0,checked:!0}]),L=d(!1),ae=d(),G=d(),h=d({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),w=d(),te=d(),i=d({loading:!1,tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],search:{page:1,limit:10,id:"",userName:"",active:null,departmentId:null},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}}),P=d(),o=d({search:{name:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:"",isClick:!1},row:"",loading:!1}),p=d({search:{name:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:"",name:""},row:"",loading:!1});d();const u=d({loading:!1,search:{organizationalStructureId:""},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}});async function I(){try{o.value.loading=!0;const e={...o.value.search},t=await R.list(e);o.value.tree=t.data,o.value.loading=!1}catch{}finally{o.value.loading=!1}}O(()=>{I()}),B(()=>o.value.search,e=>{P.value.filter(e)});function le(e,t){return e?t.label.includes(e):!0}function ie(e){o.value.currentData=e,o.value.dialog.parentId="",o.value.dialog.id="",o.value.dialog.visible=!0}function oe(e){p.value.currentData=e,p.value.dialog.parentId=(e==null?void 0:e.id)??"",p.value.dialog.name=(e==null?void 0:e.name)??"",p.value.dialog.id="",p.value.dialog.visible=!0}function ne(e,t){o.value.currentNode=e,o.value.currentData=t,o.value.row=JSON.stringify(t),o.value.dialog.parentId=e.parent.data.id??"",o.value.dialog.id=t.id,o.value.dialog.visible=!0,u.value.search.organizationalStructureId&&(o.value.dialog.isClick=!0)}function re(e,t){$.confirm(`确认删除「${t.name}」吗？`,"确认信息").then(()=>{R.delete({id:t.id}).then(()=>{U.success({message:"删除成功",center:!0}),I()})})}function se(e){M.value.page=1,e.id&&(i.value.dialog.parentId=e.id),u.value.search.organizationalStructureId=e.id}B(()=>u.value.search.organizationalStructureId,()=>{C()});async function C(){w.value=null;try{L.value=!0;const e={...u.value.search},t=await R.itemlist(e);t.data&&(L.value=!1,i.value.dataList=t.data,u.value.dataList.forEach(v=>{v.enableLoading=!1}),M.value.total=t.data.length||0)}catch{}finally{L.value=!1}}O(async()=>{try{h.value.loading=!0,Y.value=await W.getCountry(),Z.value=await(V==null?void 0:V.getDepartment())||[],T.value=await(z==null?void 0:z.getPositionManage())||[],ee.value.forEach(e=>{e.checked&&i.value.checkList.push(e.prop)}),h.value.loading=!1}catch{}finally{h.value.loading=!1}}),B(()=>h.value.search,e=>{ae.value.filter(e)});function ue(e){return new Promise(t=>{$.confirm(`确认${e.active?"禁用":"启用"}「${e.userName}」吗？`,"确认信息").then(()=>{try{h.value.loading=!0,J.edit({id:e.id,email:e.email,phoneNumber:e.phoneNumber,userName:e.userName,country:e.country,role:e.role,positionId:e.positionId,organizationalStructureId:e.organizationalStructureId,active:!e.active}).then(()=>(U.success({message:`${e.active?"禁用":"启用"}成功`,center:!0}),C(),h.value.loading=!1,t(!0))).catch(()=>(h.value.loading=!1,t(!1)))}catch{}finally{h.value.loading=!1}}).catch(()=>t(!1))})}function de({prop:e,order:t}){Q(e,t).then(()=>C())}function ce(e){i.value.dialog.id="",i.value.dialog.visible=!0,i.value.dialog.level=1}const pe=e=>{w.value=e[0]};function ve(){if(w.value){const{userName:e,id:t}=w.value;$.confirm(`确认将「${e}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{J.reset({id:t}).then(()=>{U.success({message:"重置成功",center:!0}),C()})}).catch(()=>{})}}function me(e){i.value.row=JSON.stringify(e),i.value.dialog.id=e.id,i.value.dialog.visible=!0}function ge(e){G.value.showEdit(e)}return(e,t)=>{const v=g("ElButton"),F=g("ElButtonGroup"),N=Re,fe=g("ElInput"),_e=g("ElTree"),he=g("ElScrollbar"),be=g("ElSpace"),b=g("ElTableColumn"),ye=g("ElSwitch"),ke=we,y=g("el-text"),Ie=g("el-empty"),Ce=g("ElTable"),Se=Le,A=ze("loading");return r(),j("div",Ke,[_("div",Xe,[n(Se,{"hide-left-side-toggle":""},{leftSide:l(()=>[n(F,{class:"btns"},{default:l(()=>[n(v,{type:"primary",class:"add",onClick:t[0]||(t[0]=a=>ie())},{default:l(()=>[f(" 新增部门 ")]),_:1})]),_:1}),n(fe,{modelValue:o.value.search.name,"onUpdate:modelValue":t[1]||(t[1]=a=>o.value.search.name=a),placeholder:"请输入关键词筛选",clearable:"",class:"search",onKeydown:Ve(I,["enter"])},{append:l(()=>[n(v,{onClick:I},{default:l(()=>[n(N,{name:"i-ep:search"})]),_:1})]),_:1},8,["modelValue"]),n(he,{class:"tree"},{default:l(()=>[E((r(),s(_e,{ref_key:"dictionaryRef",ref:P,data:o.value.tree,"filter-node-method":le,"default-expand-all":"",onNodeClick:se},{default:l(({node:a,data:c})=>{var H;return[_("div",Qe,[_("div",{class:"label",title:a.label},k(c.name),9,We),_("div",Ye,k((H=c==null?void 0:c.organizationalStructurePersonList)==null?void 0:H.map(D=>D.userName).join("，")),1),_("div",Ze,[n(F,null,{default:l(()=>[n(v,{type:"primary",plain:"",size:"default",onClick:x(D=>oe(c),["stop"])},{icon:l(()=>[n(N,{name:"i-ep:plus"})]),_:2},1032,["onClick"]),n(v,{type:"info",plain:"",size:"default",onClick:x(D=>ne(a,c),["stop"])},{icon:l(()=>[n(N,{name:"i-ep:edit"})]),_:2},1032,["onClick"]),n(v,{type:"danger",plain:"",size:"default",onClick:x(D=>re(a,c),["stop"])},{icon:l(()=>[n(N,{name:"i-ep:delete"})]),_:2},1032,["onClick"])]),_:2},1024)])])]}),_:1},8,["data","filter-node-method"])),[[A,o.value.loading]])]),_:1})]),default:l(()=>[E(_("div",ea,[n(be,{wrap:""},{default:l(()=>[n(v,{type:"primary",onClick:t[2]||(t[2]=a=>ce())},{default:l(()=>[f(" 新增员工 ")]),_:1}),n(v,{onClick:ve},{default:l(()=>[f(" 重置密码 ")]),_:1})]),_:1}),E((r(),s(Ce,{ref_key:"userItemRef",ref:te,data:i.value.dataList,border:i.value.border,size:i.value.lineHeight,stripe:i.value.stripe,"highlight-current-row":"",height:"100%",onSortChange:de,onSelectionChange:t[3]||(t[3]=a=>i.value.selectionDataList=a),"row-key":"id","default-expand-all":"",onSelect:pe},{empty:l(()=>[n(Ie,{image:Be(xe),"image-size":300},null,8,["image"])]),default:l(()=>[n(b,{type:"selection",align:"left",fixed:""}),i.value.checkList.includes("active")?(r(),s(b,{key:0,align:"left",prop:"active",label:"状态"},{default:l(a=>[n(ye,{modelValue:a.row.active,"onUpdate:modelValue":c=>a.row.active=c,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>ue(a.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1})):m("",!0),i.value.checkList.includes("id")?(r(),s(b,{key:1,align:"left",width:"180",prop:"id",label:"员工ID"},{default:l(({row:a})=>[_("div",aa,[_("div",ta,"ID: "+k(a.id),1),n(ke,{class:"copy",content:a.id},null,8,["content"])])]),_:1})):m("",!0),i.value.checkList.includes("userName")?(r(),s(b,{key:2,align:"left",width:"130",prop:"userName",label:"用户名"},{default:l(({row:a})=>[n(y,{class:"tableBig"},{default:l(()=>[f(k(a.userName?a.userName:"-"),1)]),_:2},1024)]),_:1})):m("",!0),i.value.checkList.includes("phoneNumber")?(r(),s(b,{key:3,align:"left",width:"170",prop:"phone",label:"电话号码"},{default:l(({row:a})=>[n(y,{class:"tableBig"},{default:l(()=>[f(k(a.phoneNumber?a.phoneNumber:"-"),1)]),_:2},1024)]),_:1})):m("",!0),i.value.checkList.includes("email")?(r(),s(b,{key:4,align:"left",width:"180",prop:"email",label:"邮箱"},{default:l(({row:a})=>[n(y,{class:"tableBig"},{default:l(()=>[f(k(a.email?a.email:"-"),1)]),_:2},1024)]),_:1})):m("",!0),i.value.checkList.includes("departmentId")?(r(),s(b,{key:5,align:"left",prop:"departmentId",label:"部门"},{default:l(({row:a})=>[n(y,{class:"tableBig"},{default:l(()=>[f(k(a.organizationalStructureName?a.organizationalStructureName:"-"),1)]),_:2},1024)]),_:1})):m("",!0),i.value.checkList.includes("positionId")?(r(),s(b,{key:6,align:"left",prop:"positionId",label:"职位"},{default:l(({row:a})=>[a.positionId?(r(),s(y,{key:0,class:"tableBig"},{default:l(()=>[(r(!0),j($e,null,Ue(T.value,c=>(r(),s(y,null,{default:l(()=>[a.positionId===c.id?(r(),s(y,{key:0},{default:l(()=>[f(k(c.name?c.name:"-"),1)]),_:2},1024)):m("",!0)]),_:2},1024))),256))]),_:2},1024)):(r(),s(y,{key:1,class:"tableBig"},{default:l(()=>[f("-")]),_:1}))]),_:1})):m("",!0),n(b,{label:"操作",fixed:"right",width:"200",align:"left"},{default:l(a=>[n(v,{type:"primary",size:"small",plain:"",onClick:c=>me(a.row)},{default:l(()=>[f(" 编辑 ")]),_:2},1032,["onClick"]),n(v,{type:"warning",size:"small",plain:"",onClick:c=>ge(a.row)},{default:l(()=>[f(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[A,L.value]])],512),[[q,u.value.search.organizationalStructureId]]),E(_("div",la,oa,512),[[q,!u.value.search.organizationalStructureId]])]),_:1}),o.value.dialog.visible?(r(),s(Ae,{key:0,id:o.value.dialog.id,modelValue:o.value.dialog.visible,"onUpdate:modelValue":t[4]||(t[4]=a=>o.value.dialog.visible=a),row:o.value.row,"parent-id":o.value.dialog.parentId,tree:o.value.tree,isClick:o.value.dialog.isClick,onGetList:I,onGetItmelist:C},null,8,["id","modelValue","row","parent-id","tree","isClick"])):m("",!0),p.value.dialog.visible?(r(),s(He,{key:1,id:p.value.dialog.id,modelValue:p.value.dialog.visible,"onUpdate:modelValue":t[5]||(t[5]=a=>p.value.dialog.visible=a),row:p.value.row,"parent-id":p.value.dialog.parentId,name:p.value.dialog.name,tree:p.value.tree,onGetList:I},null,8,["id","modelValue","row","parent-id","name","tree"])):m("",!0),u.value.dialog.visible?(r(),s(Oe,{key:2,id:u.value.dialog.id,modelValue:u.value.dialog.visible,"onUpdate:modelValue":t[6]||(t[6]=a=>u.value.dialog.visible=a),"catalogue-id":u.value.search.organizationalStructureId,"parent-id":u.value.dialog.parentId,level:u.value.dialog.level,tree:o.value.tree,dataList:u.value.dataList,row:u.value.row,onSuccess:C},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):m("",!0),i.value.dialog.visible?(r(),s(je,{key:3,id:i.value.dialog.id,modelValue:i.value.dialog.visible,"onUpdate:modelValue":t[7]||(t[7]=a=>i.value.dialog.visible=a),"catalogue-id":i.value.search.catalogueId,"parent-id":i.value.dialog.parentId,level:i.value.dialog.level,tree:h.value.tree,dataList:i.value.dataList,row:i.value.row,onSuccess:C,onGetList:I},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):m("",!0),n(qe,{ref_key:"detailRef",ref:G},null,512)])])}}});typeof K=="function"&&K(X);const wa=Ge(X,[["__scopeId","data-v-25d86382"]]);export{wa as default};
