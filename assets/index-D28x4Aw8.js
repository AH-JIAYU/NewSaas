
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ue,aB as pe,aj as ie,l as de,ac as me,r as _,c as b,$ as x,n as fe,a0 as ce,a as f,o as c,b as E,f as e,w as l,i as o,bb as be,v as d,A as S,F as U,t as N,g,e as y,j as V,aO as ve,E as ye,_ as ge,aI as Te,aJ as _e,M as Se}from"./index-BDq3fI5e.js";import Le from"./index-CedEfgnI.js";import{U as Ve}from"./user_supplier-C97q4j4B.js";import{u as Ie}from"./configuration_supplierLevel-Bi5xqsAa.js";import{u as we}from"./user_customer-DT397afO.js";import{a as G}from"./user_supplier-CMQ7SQZh.js";import"./apiLoading-BhJI3t5Q.js";const H="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAZCAYAAAArK+5dAAAAAXNSR0IArs4c6QAAAmBJREFUSEvFlU9IFHEUxz9vxjRpvdSmERJEdIgyD0LQH3CsIArqYgoeInZWD9ElCEKJ/lASXqLoarMVQcEKgXaLNsdLXapDfxQkgkAoNRJkI4mdfbXrbJg76y5LS+847/3e5/ve7735CRU2qXB+SgLsv6tb0imaENZlBQnTpslk4qRMFhNYENARV3NmniMI/SLsDEykTKhyaXaK4fHL8jMTYzm6T8Ebi8qLRS0BdmBQG1IGIyLs8oO+qTCB8tWvICzKNoW1/vFR06Mr0SPTVkyTQLVrS3UgwBrURkxeAg0KM8DN2RDXxzsXFS41y9GzKpwTqAfm0h4thsnHTIxrS1Z8XgWWo2cQbgBv+cEe97RkFBU0K64hkjwHmoD3wPYVARlnm6Pt4ToeDwWoDiLtdbRulfAK2JrzF6yg2FQU8rc52qyLELNoBeVCWh0dFuFY5QB39KgoI4GAw7e0JrQBLbXvgeP9QBu8Bb4EAqyYzgGrXVtqy21RdtFiqoUAWQdCrRuRhXIhVkzvAzWuLZ1/7UGObHo0J3rkTbmA5ef+LFoOIMr50ahcqxgA5bMblY2VA2QyK31uVAb+BSSvRX7SFGm63W65Vwqk9bZ2GAbHwyFOLB/zPIAqF0W4gpJCGHBtubDizy6mV1F6f78bVQa0PLPl9dL4PMD6EFWzSXqBfj/wE8LDtEf8u8e7zLc1JjtMoUuFLqDRH+8+N5Lf1qWAURWMsYi0+gtzUMER2FSkTR+AU64tT4PiVnyTO+JaPTPPITFoV2G3KJt9tVMoCVUe1dfxZKhTvEIiSnr0S7no/wb4BVAj4RpK1TCfAAAAAElFTkSuQmCC",k=w=>(Te("data-v-56351957"),w=w(),_e(),w),Ce={class:"card-header"},Ae={style:{display:"flex","justify-content":"space-between","align-items":"center",padding:"0 1rem"}},he=k(()=>d("div",{class:"i-ic:round-plus w-1.3em h-1.3em"},null,-1)),xe=k(()=>d("div",{class:"i-ic:round-plus w-1.3em h-1.3em"},null,-1)),Ee={class:"card-header"},ke=k(()=>d("br",null,null,-1)),Ue=k(()=>d("div",null,[g(" 为供应商设定筛选条件，更精准匹配合适项目"),d("br"),g(" 例：仅选中【客户1】，该供应商只能做【客户1】的项目 ")],-1)),Ne=ue({__name:"index",props:{leftTab:Object,tabIndex:Number},setup(w){const B=pe(),{t:n}=ie(),O=Ve(),Z=Ie();we();const $=de(),ee=me("validateTopTabs"),R=_();_(!1);const t=w,P=_(null);_({});const le=[{label:n("supplier.new.company"),value:"company"},{label:n("supplier.new.personal"),value:"personal"}];b(()=>n("supplier.new.USD")),b(()=>n("supplier.new.CNY"));const L=x({supplierAccord:[{required:!0,message:b(()=>n("supplier.new.enterSuppllierName")),trigger:"blur"},{min:2,max:50,message:b(()=>n("supplier.new.2to50")),trigger:"blur"}],memberLevelId:[{required:!0,message:b(()=>n("supplier.new.memberLevelSelect")),trigger:"change"}],subordinateCountryId:[{required:!0,message:b(()=>n("supplier.new.areaSelect")),trigger:"change"}],supplierLevelId:[{required:!0,message:b(()=>n("supplier.new.supplierLevelSelect")),trigger:"change"}],type:[{required:!0,message:b(()=>n("supplier.new.supplierTypeSelect")),trigger:"change"}]}),te=(s,a,u)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(t.leftTab.supplierPhone)?u():u(new Error(n("supplier.new.legalPhoneNumber")))},ae=(s,a,u)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t.leftTab.emailAddress)?u():u(new Error(n("supplier.new.legalEmail")))},q=s=>{s&&(t.leftTab.countryType=s==="343"?1:2,s==="343"?(t.leftTab.tenantSupplierId||(t.leftTab.currencyType=B.currencyType===1?"USD":"CNY"),L.emailAddress&&delete L.emailAddress,L.supplierPhone=[{required:!0,message:b(()=>n("supplier.new.enterPhoneNumber")),trigger:"blur"},{validator:te,trigger:"blur"}]):(t.leftTab.tenantSupplierId||(t.leftTab.currencyType=B.currencyType===1?"USD":"CNY"),L.supplierPhone&&delete L.supplierPhone,L.emailAddress=[{required:!0,message:b(()=>n("supplier.new.enterEmail")),trigger:"blur"},{validator:ae,trigger:"blur"}]))};t.leftTab.relevanceCountryIdList?console.log(t.leftTab.relevanceCountryIdList):t.leftTab.relevanceCountryIdList=[];const F=()=>{R.value.showEdit()},D=x({checked:!1,relatedCustomers:[],payMethod:O.payMethod,countryList:[],supplierLevelList:[]}),T=x({updateTenantSupplierCustomerInfoList:[],countryList:[]}),M=_("basicSettings"),z=async()=>{D.supplierLevelList=await Z.getLevelNameList(),q(t.leftTab.subordinateCountryId)},Q=_([]);_([]);const C=_([]),K=(s,a)=>s?a.label&&a.label.toLowerCase().includes(s.toLowerCase()):!0,ne=s=>{s.forEach(a=>{Q.value.push({label:a.chineseName,key:a.id,initial:a.code})})};x({customerShortName:"",customerStatus:2,antecedentQuestionnaire:null}),fe(async()=>{C.value=[];const{data:s}=await G.getCustomerCooperation({}),a=(s==null?void 0:s.getCustomerInfoLists)||[],u=(s==null?void 0:s.getCooperationInfoLists)||[];a.length!=0&&a.forEach(m=>{C.value.push({label:m.customerName,key:m.customerId,type:1})}),u.length!=0&&u.forEach(m=>{C.value.push({label:m.tenantName,key:m.tenantId,type:2})}),t.leftTab.updateTenantSupplierCustomerInfoList?t.leftTab.updateTenantSupplierCustomerInfoList.length&&t.leftTab.updateTenantSupplierCustomerInfoList.forEach(m=>{T.updateTenantSupplierCustomerInfoList.push(m.tenantCustomerId)}):(t.leftTab.updateTenantSupplierCustomerInfoList=[],T.updateTenantSupplierCustomerInfoList=[]),T.countryList=await $.getCountry(),await z(),ne(T.countryList)}),ce(()=>{ee(P.value)});const re=()=>{const s=T.updateTenantSupplierCustomerInfoList.map(a=>{const u=C.value.find(m=>m.key===a);return u?{type:u.type,tenantCustomerId:u.key}:null}).filter(Boolean);t.leftTab.updateTenantSupplierCustomerInfoList=s},X=()=>{ve.confirm(`确认将「${t.leftTab.supplierAccord}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{G.supplierResetPassword({supplierId:t.leftTab.tenantSupplierId}).then(()=>{ye.success({message:"重置密码成功",center:!0})})}).catch(()=>{})};return(s,a)=>{const u=f("el-option"),m=f("el-select"),p=f("el-form-item"),i=f("el-col"),v=f("el-input"),W=f("el-button"),I=f("el-row"),A=f("el-tooltip"),J=f("el-card"),h=f("ElSwitch"),Y=ge,j=f("el-transfer"),oe=f("el-tab-pane"),se=f("el-tabs");return c(),E("div",null,[e(se,{modelValue:M.value,"onUpdate:modelValue":a[17]||(a[17]=r=>M.value=r)},{default:l(()=>[e(oe,{label:o(n)("supplier.new.basicSettings"),name:"basicSettings"},{default:l(()=>[e(o(be),{ref_key:"formRef",ref:P,rules:o(L),model:t.leftTab,"label-width":"100px","validate-on-rule-change":!1},{default:l(()=>[e(J,{class:"box-card"},{header:l(()=>[d("div",Ce,[d("span",null,S(o(n)("supplier.new.basicInformation")),1)])]),default:l(()=>[e(I,{gutter:10},{default:l(()=>[e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.supplierType"),prop:"type"},{default:l(()=>[e(m,{modelValue:t.leftTab.type,"onUpdate:modelValue":a[0]||(a[0]=r=>t.leftTab.type=r),"value-key":"",placeholder:"",clearable:"",filterable:""},{default:l(()=>[(c(),E(U,null,N(le,r=>e(u,{key:r.value,label:r.label,value:r.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.supplierAccord"),prop:"supplierAccord"},{default:l(()=>[e(v,{modelValue:t.leftTab.supplierAccord,"onUpdate:modelValue":a[1]||(a[1]=r=>t.leftTab.supplierAccord=r),clearable:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.supplierLevel"),prop:"supplierLevelId"},{default:l(()=>[e(m,{clearable:"",filterable:"",modelValue:t.leftTab.supplierLevelId,"onUpdate:modelValue":a[2]||(a[2]=r=>t.leftTab.supplierLevelId=r)},{empty:l(()=>[d("div",Ae,[g(S(o(n)("supplier.new.nodata"))+" ",1),e(W,{type:"primary",link:"",size:"small",onClick:F},{default:l(()=>[g(S(o(n)("supplier.new.quickAdd"))+" ",1),he]),_:1})])]),default:l(()=>[(c(!0),E(U,null,N(o(D).supplierLevelList,r=>(c(),y(u,{key:r.tenantSupplierLevelId,value:r.tenantSupplierLevelId,label:r.levelNameOrAdditionRatio},null,8,["value","label"]))),128)),e(W,{size:"small",class:"buttonClass",onClick:F},{default:l(()=>[g(S(o(n)("supplier.new.quickAdd"))+" ",1),xe]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(I,{gutter:10},{default:l(()=>[e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.area"),prop:"subordinateCountryId"},{default:l(()=>[e(m,{clearable:"",filterable:"",modelValue:t.leftTab.subordinateCountryId,"onUpdate:modelValue":a[3]||(a[3]=r=>t.leftTab.subordinateCountryId=r),onChange:q},{default:l(()=>[(c(!0),E(U,null,N(o(T).countryList,r=>(c(),y(u,{key:r.id,value:r.id,label:r.chineseName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.supplierName")},{default:l(()=>[e(v,{clearable:"",modelValue:t.leftTab.supplierName,"onUpdate:modelValue":a[4]||(a[4]=r=>t.leftTab.supplierName=r)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.supplierPhone"),prop:"supplierPhone"},{default:l(()=>[e(v,{clearable:"",modelValue:t.leftTab.supplierPhone,"onUpdate:modelValue":a[5]||(a[5]=r=>t.leftTab.supplierPhone=r)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(I,{gutter:10},{default:l(()=>[e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.emailAddress"),prop:"emailAddress"},{default:l(()=>[e(v,{clearable:"",modelValue:t.leftTab.emailAddress,"onUpdate:modelValue":a[6]||(a[6]=r=>t.leftTab.emailAddress=r)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.settlementCycle")},{default:l(()=>[e(m,{modelValue:t.leftTab.settlementCycle,"onUpdate:modelValue":a[7]||(a[7]=r=>t.leftTab.settlementCycle=r)},{default:l(()=>[e(u,{label:"net 30",value:30}),e(u,{label:"net 60",value:60}),e(u,{label:"net 90",value:90}),e(u,{label:"net 180",value:180})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),t.leftTab.type!=="company"?(c(),y(i,{key:0,span:8},{default:l(()=>[e(p,{label:"初始密码"},{default:l(()=>[e(v,{clearable:"",value:"123456",disabled:"",style:{width:"80%"}}),t.leftTab.tenantSupplierId?(c(),y(A,{key:0,effect:"dark",content:"重置密码",placement:"top-start"},{default:l(()=>[d("img",{src:H,alt:"",style:{"margin-left":"10px",cursor:"pointer"},onClick:X})]),_:1})):V("",!0)]),_:1})]),_:1})):V("",!0),e(i,{span:8},{default:l(()=>[t.leftTab.type==="company"?(c(),y(p,{key:0,label:o(n)("supplier.new.companyName")},{default:l(()=>[e(v,{clearable:"",modelValue:t.leftTab.companyName,"onUpdate:modelValue":a[8]||(a[8]=r=>t.leftTab.companyName=r)},null,8,["modelValue"])]),_:1},8,["label"])):V("",!0)]),_:1})]),_:1}),e(I,{gutter:10},{default:l(()=>[e(i,{span:8},{default:l(()=>[t.leftTab.type==="company"?(c(),y(p,{key:0,label:o(n)("supplier.new.legalPersonName"),prop:""},{default:l(()=>[e(v,{clearable:"",modelValue:t.leftTab.legalPersonName,"onUpdate:modelValue":a[9]||(a[9]=r=>t.leftTab.legalPersonName=r)},null,8,["modelValue"])]),_:1},8,["label"])):V("",!0)]),_:1}),e(i,{span:8},{default:l(()=>[t.leftTab.type==="company"?(c(),y(p,{key:0,label:o(n)("supplier.new.taxID"),prop:""},{default:l(()=>[e(v,{clearable:"",modelValue:t.leftTab.taxID,"onUpdate:modelValue":a[10]||(a[10]=r=>t.leftTab.taxID=r)},null,8,["modelValue"])]),_:1},8,["label"])):V("",!0)]),_:1}),t.leftTab.type=="company"?(c(),y(i,{key:0,span:8},{default:l(()=>[e(p,{label:"初始密码"},{default:l(()=>[e(v,{clearable:"",value:"123456",disabled:"",style:{width:"80%"}}),t.leftTab.tenantSupplierId?(c(),y(A,{key:0,effect:"dark",content:"重置密码",placement:"top-start"},{default:l(()=>[d("img",{src:H,alt:"",style:{"margin-left":"10px",cursor:"pointer"},onClick:X})]),_:1})):V("",!0)]),_:1})]),_:1})):V("",!0)]),_:1})]),_:1}),e(J,{class:"box-card"},{header:l(()=>[d("div",Ee,[d("span",null,S(o(n)("supplier.new.permissionInformation")),1)])]),default:l(()=>[e(I,{gutter:10},{default:l(()=>[e(i,{span:3},{default:l(()=>[e(p,{label:o(n)("supplier.new.surveySystem")},{default:l(()=>[e(h,{modelValue:t.leftTab.surveySystem,"onUpdate:modelValue":a[11]||(a[11]=r=>t.leftTab.surveySystem=r),"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":o(n)("common.enable"),"inactive-text":o(n)("common.disable")},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])]),_:1}),e(i,{span:3},{default:l(()=>[e(p,{label:"B2B"},{default:l(()=>[e(h,{modelValue:t.leftTab.b2bStatus,"onUpdate:modelValue":a[12]||(a[12]=r=>t.leftTab.b2bStatus=r),"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":o(n)("common.enable"),"inactive-text":o(n)("common.disable")},null,8,["modelValue","active-text","inactive-text"])]),_:1})]),_:1}),e(i,{span:4},{default:l(()=>[e(p,{label:"B2C"},{default:l(()=>[e(h,{modelValue:t.leftTab.b2cStatus,"onUpdate:modelValue":a[13]||(a[13]=r=>t.leftTab.b2cStatus=r),"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":o(n)("common.enable"),"inactive-text":o(n)("common.disable")},null,8,["modelValue","active-text","inactive-text"])]),_:1})]),_:1}),e(i,{span:3},{default:l(()=>[e(p,{label:o(n)("supplier.new.surveyStatus")},{default:l(()=>[e(h,{modelValue:t.leftTab.supplierStatus,"onUpdate:modelValue":a[14]||(a[14]=r=>t.leftTab.supplierStatus=r),"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":o(n)("common.enable"),"inactive-text":o(n)("common.disable")},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])]),_:1})]),_:1}),e(I,{gutter:24},{default:l(()=>[e(i,{span:11},{default:l(()=>[d("div",null,[e(p,null,{label:l(()=>[d("div",null,[e(A,{class:"tooltips",placement:"top"},{content:l(()=>[d("div",null,[g(S(o(n)("supplier.new.tips1")),1),ke,g(" "+S(o(n)("supplier.new.example")),1)])]),default:l(()=>[e(Y,{class:"SvgIcon2",name:"i-ri:question-line"})]),_:1}),g(" "+S(o(n)("supplier.new.authorizationArea")),1)])]),_:1})]),e(j,{style:{"margin-left":"1.875rem"},modelValue:t.leftTab.relevanceCountryIdList,"onUpdate:modelValue":a[15]||(a[15]=r=>t.leftTab.relevanceCountryIdList=r),filterable:"","filter-method":K,"filter-placeholder":o(n)("supplier.new.enterQueryCountry"),data:Q.value,titles:[o(n)("supplier.new.unselectedCountry"),o(n)("supplier.new.selectedCountries")]},null,8,["modelValue","filter-placeholder","data","titles"])]),_:1}),e(i,{span:11},{default:l(()=>[d("div",null,[e(p,null,{label:l(()=>[d("div",null,[e(A,{class:"tooltips",placement:"top"},{content:l(()=>[Ue]),default:l(()=>[e(Y,{class:"SvgIcon2",name:"i-ri:question-line"})]),_:1}),g(" 分配客户 ")])]),_:1})]),e(j,{style:{"margin-left":"1.875rem"},modelValue:o(T).updateTenantSupplierCustomerInfoList,"onUpdate:modelValue":a[16]||(a[16]=r=>o(T).updateTenantSupplierCustomerInfoList=r),filterable:"","filter-method":K,"filter-placeholder":"输入查询客户",data:C.value,onChange:re,titles:["未选择客户","已分配客户"]},null,8,["modelValue","data"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["label"])]),_:1},8,["modelValue"]),e(Le,{ref_key:"EditRef",ref:R,onQueryData:z},null,512)])}}}),ze=Se(Ne,[["__scopeId","data-v-56351957"]]);export{ze as default};
