
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as w}from"./department-inNRazO8.js";import{d as E,r as o,Z as R,n as L,a as f,o as T,b as B,f as c,w as n,y as F,g,i as d,A as K,L as M}from"./index-CAR0YW6T.js";const P={class:"flex-c"},q=E({__name:"index",emits:["userData"],setup(A,{expose:v,emit:_}){const s=o(!1);o([]);const h=o([]),i=o(),e=o({type:1,tenantStaffList:[],roleList:[],title:"",project:[],form:{chargeUserId:null,chargeUserName:""}}),U={children:"children",label:"name"},k=R({chargeUserId:[{required:!0,message:"请选择负责人",trigger:"change"}]});o(!1);async function y(l,a,r){const t=await w.list({name:""});t.data&&(h.value=t.data),s.value=!0,e.value.title=a,e.value.form.invitationType=2,r&&(e.value.project=r,e.value.form.chargeUserName=r.chargeUserName,e.value.form.chargeUserId=r.chargeUserId)}function I(){s.value=!1,m.value.resetFields()}const x=_,m=o();function C(){m.value.validate(l=>{if(l){let a={chargeUserId:e.value.form.chargeUserId,chargeUserName:e.value.form.chargeUserName,invitationType:e.value.form.invitationType};s.value=!1,x("userData",a)}})}L(async()=>{}),v({showEdit:y}),o();const N=(l,a)=>{a?(i.value.getCheckedKeys().forEach(t=>{t!==l.id&&i.value.setChecked(t,!1)}),e.value.form.chargeUserId=l.id,e.value.form.chargeUserName=l.name):(e.value.form.chargeUserId=[e.value.form.chargeUserId].filter(r=>r!==l.id),e.value.form.chargeUserId.length==0&&(e.value.form.chargeUserId="")),e.value.form.chargeUserId||(e.value.form.chargeUserName="")};return(l,a)=>{const r=f("el-tree-select"),t=f("el-form-item"),b=f("ElForm"),p=f("el-button"),V=f("el-dialog");return T(),B("div",null,[c(V,{modelValue:d(s),"onUpdate:modelValue":a[1]||(a[1]=u=>K(s)?s.value=u:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:"请选择项目负责人",class:"userClass"},{footer:n(()=>[F("div",P,[c(p,{onClick:I},{default:n(()=>[g(" 取消 ")]),_:1}),c(p,{type:"primary",onClick:C},{default:n(()=>[g(" 确认 ")]),_:1})])]),default:n(()=>[c(b,{ref_key:"formRef",ref:m,rules:d(k),model:d(e).form},{default:n(()=>[c(t,{label:"部门",prop:"chargeUserId"},{default:n(()=>[c(r,{placeholder:"请选择部门",ref_key:"treeRef",ref:i,modelValue:d(e).form.chargeUserId,"onUpdate:modelValue":a[0]||(a[0]=u=>d(e).form.chargeUserId=u),data:d(h),"check-strictly":"","show-checkbox":"","default-expand-all":"","node-key":"id",props:U,onCheckChange:N,"check-on-click-node":!0,"expand-on-click-node":!1},null,8,["modelValue","data"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}}}),j=M(q,[["__scopeId","data-v-af86ec8f"]]);export{j as default};
