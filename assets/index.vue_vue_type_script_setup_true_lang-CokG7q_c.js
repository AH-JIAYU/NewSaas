
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as C}from"./sub.vue_vue_type_script_setup_true_lang-CiO2zkM4.js";import{r as P,I as b}from"./item-EysmypKC.js";import{d as E,r as c,c as N,a3 as m,a4 as z,a5 as J,o as r,b as y,F as S,t as q,e as _,S as A,i as k,n as j}from"./index-CWgqmEzW.js";const L=E({name:"MainMenu",__name:"index",props:{menu:{},value:{},accordion:{type:Boolean,default:!0},defaultOpeneds:{default:()=>[]},alwaysOpeneds:{default:()=>[]},mode:{default:"vertical"},collapse:{type:Boolean,default:!1},showCollapseName:{type:Boolean,default:!1},rounded:{type:Boolean,default:!1},direction:{default:"ltr"}},setup(g){const l=g,o=c(l.value),i=c({}),s=c({}),t=c(Array.from(new Set([...l.alwaysOpeneds.slice(0),...l.defaultOpeneds.slice(0)]))),M=c(l.alwaysOpeneds.slice(0)),I=c([]),f=N(()=>l.mode==="horizontal"||l.mode==="vertical"&&l.collapse);function O(e,n=[]){e.forEach(a=>{const u=a.path??JSON.stringify(a);if(a.children){const h=[...n,u];s.value[u]={index:u,indexPath:h,active:!1},O(a.children,h)}else i.value[u]={index:u,indexPath:n}})}const d=(e,n)=>{t.value.includes(e)||(l.accordion&&(t.value=t.value.filter(a=>n.includes(a)||M.value.includes(a))),t.value.push(e))},v=e=>{if(Array.isArray(e)){j(()=>{v(e.at(-1)),e.length>1&&v(e.slice(0,-1))});return}Object.keys(s.value).forEach(n=>{s.value[n].indexPath.includes(e)&&(t.value=t.value.filter(a=>a!==e))})};function w(e){var n,a;for(const u in s.value)s.value[u].active=!1;(n=s.value[e])==null||n.indexPath.forEach(u=>{s.value[u].active=!0}),(a=i.value[e])==null||a.indexPath.forEach(u=>{s.value[u].active=!0})}const x=e=>{(l.mode==="horizontal"||l.collapse)&&(t.value=[]),w(e)},B=(e,n)=>{t.value.includes(e)?v(e):d(e,n)};function p(){const e=o.value&&i.value[o.value];w(o.value),!(!e||l.collapse)&&e.indexPath.forEach(n=>{const a=s.value[n];a&&d(n,a.indexPath)})}return m(()=>l.menu,e=>{O(e),p()},{deep:!0,immediate:!0}),m(()=>l.value,e=>{i.value[e]||(o.value="");const n=i.value[e]||o.value&&i.value[o.value]||i.value[l.value];n?o.value=n.index:o.value=e,p()}),m(()=>l.collapse,e=>{e?t.value=[]:t.value=l.alwaysOpeneds.slice(0),p()}),z(P,J({props:l,items:i,subMenus:s,activeIndex:o,openedMenus:t,alwaysOpenedsMenus:M,mouseInMenu:I,isMenuPopup:f,openMenu:d,closeMenu:v,handleMenuItemClick:x,handleSubMenuClick:B})),(e,n)=>(r(),y("div",{class:A(["flex flex-col of-hidden transition-all",{"w-[200px]":!k(f)&&l.mode==="vertical","w-[64px]":k(f)&&l.mode==="vertical","h-[80px]":l.mode==="horizontal","flex-row! w-auto":k(f)&&l.mode==="horizontal"}])},[(r(!0),y(S,null,q(e.menu,a=>{var u;return r(),y(S,{key:a.path??JSON.stringify(a)},[(u=a.children)!=null&&u.length?(r(),_(C,{key:0,menu:a,"unique-key":[a.path??JSON.stringify(a)]},null,8,["menu","unique-key"])):(r(),_(b,{key:1,item:a,"unique-key":[a.path??JSON.stringify(a)],onClick:h=>x(a.path??JSON.stringify(a))},null,8,["item","unique-key","onClick"]))],64)}),128))],2))}});export{L as _};
