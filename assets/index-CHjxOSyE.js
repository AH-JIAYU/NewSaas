
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as Y}from"./index-BwHKEwVN.js";import{a as Z}from"./department-C2Yu0InS.js";import{d as $,r as h,a as r,o as u,b as g,f as p,w as n,y as i,g as N,i as l,A as j,e as k,j as L,F as D,t as T,z as U,p as ee,aH as te,aI as ae,L as le}from"./index-B9P-dBk8.js";const v=b=>(te("data-v-33a30407"),b=b(),ae(),b),se={key:0,style:{"margin-top":"-2.1875rem"}},ne=v(()=>i("span",{class:"project-name"},"项目",-1)),oe={class:"project-content"},ce={style:{display:"flex"}},ie={style:{"font-weight":"500"}},de={style:{"margin-left":"10px"}},re=v(()=>i("span",{class:"custom-tab-label"},"部门",-1)),ue=v(()=>i("div",{style:{color:"#333333","font-weight":"500","font-size":"14px","margin-bottom":"10px"}}," 分配部门 ",-1)),pe=v(()=>i("span",{class:"custom-tab-label",style:{"margin-left":"20px"}},"员工",-1)),me=v(()=>i("div",{style:{color:"#333333","font-weight":"500","font-size":"14px","margin-bottom":"10px"}}," 分配员工 ",-1)),fe={key:1,style:{display:"flex","align-items":"center"}},_e=v(()=>i("div",{class:"i-ic:sharp-info w-1.5em h-1.5em",style:{color:"#FFB667"}},null,-1)),he={style:{"margin-left":".5rem"}},ge={class:"flex-c"},ve=$({__name:"index",emits:["userData"],setup(b,{expose:B,emit:F}){const m=h(!1),c=h([]),C=h([]),f=h(),e=h({type:1,tenantStaffList:[],roleList:[],title:"",project:[]}),K={children:"children",label:"name"};async function z(t,a,s){await A(),e.value.type=1,m.value=!0,c.value=[];const d=await Z.list({name:""});d.data&&(C.value=d.data),t&&(t.invitationType==1?(e.value.roleList=t.chargeUserId?[t.chargeUserId]:[],e.value.chargeUserName=t.chargeUserName?t.chargeUserName:""):t.invitationType==2&&(c.value=t.chargeUserId?[t.chargeUserId]:[],e.value.chargeUserName=t.chargeUserName?t.chargeUserName:"")),e.value.title=a,s&&(e.value.project=s)}const A=async()=>{const t=await ee.getTenantStaffList();e.value.tenantStaffList=t.data};function E(){m.value=!1}const R=(t,a)=>{if(a?(f.value.getCheckedKeys().forEach(d=>{d!==t.id&&f.value.setChecked(d,!1)}),c.value=[t.id]):c.value=c.value.filter(s=>s!==t.id),c.value.length){e.value.roleList=[];const s=f.value.getCheckedNodes();e.value.chargeUserName=s.map(d=>d.name)[0]}c.value.length==0&&e.value.roleList.length==0&&(e.value.chargeUserName="")},w=()=>{},H=t=>{if(Array.isArray(t)&&t.length>1&&(e.value.roleList=[t[t.length-1]]),e.value.roleList.length!=0){c.value=[],f.value.setCheckedKeys([]);let a=e.value.tenantStaffList.find(s=>s.id===e.value.roleList[0]);e.value.chargeUserName=a.userName}c.value.length==0&&e.value.roleList.length==0&&(e.value.chargeUserName="")};B({showEdit:z});const P=F;function q(){let t="",a=null,s=null;e.value.roleList[0]&&(t=e.value.tenantStaffList.find(y=>y.id===e.value.roleList[0]).userName,a=e.value.roleList[0],s=1),c.value[0]&&(t=f.value.getCheckedNodes().map(y=>y.name)[0],a=c.value[0],s=2),e.value.chargeUserName=t;let d={chargeUserId:a,chargeUserName:t,invitationType:s};m.value=!1,P("userData",d)}const x=h([]),G=t=>{x.value=t};return(t,a)=>{const s=r("el-badge"),d=Y,I=r("el-collapse-item"),y=r("el-collapse"),J=r("el-tree"),M=r("el-text"),V=r("el-tab-pane"),O=r("el-checkbox"),Q=r("el-checkbox-group"),W=r("el-tabs"),S=r("el-button"),X=r("el-dialog");return u(),g("div",null,[p(X,{modelValue:l(m),"onUpdate:modelValue":a[3]||(a[3]=o=>j(m)?m.value=o:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:l(e).title,class:"userClass"},{footer:n(()=>[i("div",ge,[p(S,{onClick:E},{default:n(()=>[N(" 取消 ")]),_:1}),p(S,{type:"primary",onClick:q},{default:n(()=>[N(" 确认 ")]),_:1})])]),default:n(()=>[l(e).project.length!=0?(u(),g("div",se,[p(y,{modelValue:l(x),"onUpdate:modelValue":a[0]||(a[0]=o=>j(x)?x.value=o:null),onChange:G},{default:n(()=>[p(I,{name:"1"},{title:n(()=>[ne,l(e).project.length>1?(u(),k(s,{key:0,value:l(e).project.length,max:99,class:"item"},null,8,["value"])):L("",!0)]),default:n(()=>[i("div",oe,[(u(!0),g(D,null,T(l(e).project,o=>(u(),g("div",{key:o.id},[i("div",ce,[i("span",ie,U(o.tenantName),1),i("span",de,"ID:"+U(o.tenantId),1),p(d,{content:o.tenantId},null,8,["content"])])]))),128))])]),_:1})]),_:1},8,["modelValue"])])):L("",!0),p(W,{modelValue:l(e).type,"onUpdate:modelValue":a[2]||(a[2]=o=>l(e).type=o),onTabChange:w,class:"tabs-user",style:{"margin-top":"-1.5625rem"}},{default:n(()=>[p(V,{label:"部门",name:1},{label:n(()=>[re]),default:n(()=>[ue,l(C).length>0?(u(),k(J,{key:0,style:{"max-width":"600px"},ref_key:"treeRef",ref:f,disabled:!0,data:l(C),"show-checkbox":"","check-strictly":"","node-key":"id","default-expanded-keys":[],"default-checked-keys":l(c),"default-expand-all":"",props:K,onCheckChange:R,"check-on-click-node":!0,"expand-on-click-node":!1},null,8,["data","default-checked-keys"])):(u(),k(M,{key:1},{default:n(()=>[N("暂无数据")]),_:1}))]),_:1}),p(V,{name:2},{label:n(()=>[pe]),default:n(()=>{var o;return[me,(o=l(e).tenantStaffList)!=null&&o.length?(u(),k(Q,{key:0,onChange:H,modelValue:l(e).roleList,"onUpdate:modelValue":a[1]||(a[1]=_=>l(e).roleList=_)},{default:n(()=>[(u(!0),g(D,null,T(l(e).tenantStaffList,_=>(u(),k(O,{key:_.id,value:_.id,label:_.userName,class:"checkBox"},{default:n(()=>[N(U(_.userName),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])):L("",!0)]}),_:1})]),_:1},8,["modelValue"]),l(e).chargeUserName?(u(),g("div",fe,[_e,i("span",he,U(l(e).chargeUserName||""),1)])):L("",!0)]),_:1},8,["modelValue","title"])])}}}),xe=le(ve,[["__scopeId","data-v-33a30407"]]);export{xe as u};
