
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{s as _,d as T,r as b,k as U,E as C,a as r,l as z,n as P,i as t,o as i,b as c,f as l,w as a,g as S,F as f,q as B,e as R,p as j,D as I,P as O}from"./index-CsSreFXq.js";const V={list:m=>_.post("bill/getMemberBillList",m),create:m=>_.post("bill/addMemberSettlement",m),getMemberBillAvailableBalance:m=>_.post("bill/getMemberBillAvailableBalance",m),changestatus:m=>_.post("bill/updateMemberBill",m)},q=T({__name:"index",props:{id:{default:""}},setup(m,{expose:y}){const A=b(!1),v=b(),n=b({minimumAmount:"",settlementType:1,settlementAmount:"",addMemberSettlementInfoList:[]}),p=b({memberSettlementInfoList:[],memberSettlementInfoSelect:[]}),M=b({}),x=async()=>{const u=await V.getMemberBillAvailableBalance({});p.value.memberSettlementInfoList=u.data.memberBillAvailableBalanceInfoList,n.value.minimumAmount=u.data.minimumAmount},E=u=>{const o=p.value.memberSettlementInfoList.filter(s=>u.includes(s.id));for(let s=0;s<o.length;s++)n.value.addMemberSettlementInfoList.push(o[s])};return U(async()=>{await x()}),y({submit(){return new Promise(u=>{v.value&&v.value.validate(o=>{o&&V.create(n.value).then(()=>{C.success({message:"新增成功",center:!0}),u()})})})}}),(u,o)=>{const s=r("el-radio"),L=r("el-radio-group"),d=r("ElFormItem"),g=r("ElInput"),h=r("el-option"),k=r("el-select"),w=r("ElInputNumber"),F=r("ElForm"),N=z("loading");return P((i(),c("div",null,[l(F,{ref_key:"formRef",ref:v,model:t(n),rules:t(M),"label-width":"120px","label-suffix":"："},{default:a(()=>[l(d,{label:"结算方式"},{default:a(()=>[l(L,{modelValue:t(n).settlementType,"onUpdate:modelValue":o[0]||(o[0]=e=>t(n).settlementType=e)},{default:a(()=>[l(s,{value:1,size:"large"},{default:a(()=>[S(" 全部结算 ")]),_:1}),l(s,{value:2,size:"large"},{default:a(()=>[S(" 指定结算 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(n).settlementType===1?(i(),c(f,{key:0},[l(d,{label:"最低结算额度"},{default:a(()=>[l(g,{disabled:"",placeholder:"",value:t(n).minimumAmount},null,8,["value"])]),_:1}),l(d,{label:"结算金额"},{default:a(()=>[l(g,{modelValue:t(n).settlementAmount,"onUpdate:modelValue":o[1]||(o[1]=e=>t(n).settlementAmount=e),placeholder:""},null,8,["modelValue"])]),_:1})],64)):(i(),c(f,{key:1},[l(d,{label:"指定会员"},{default:a(()=>[l(k,{placeholder:"Select",modelValue:t(p).memberSettlementInfoSelect,"onUpdate:modelValue":o[2]||(o[2]=e=>t(p).memberSettlementInfoSelect=e),clearable:"",filterable:"",multiple:"","collapse-tags":"",onChange:E},{default:a(()=>[(i(!0),c(f,null,B(t(p).memberSettlementInfoList,e=>(i(),R(h,{key:e.id,value:e.id,label:e.memberName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"最低结算额度"},{default:a(()=>[l(g,{disabled:"",placeholder:"",value:"111"})]),_:1}),(i(!0),c(f,null,B(t(n).addMemberSettlementInfoList,e=>(i(),c(f,null,[l(d,{label:""},{default:a(()=>[j("p",null,I(e.memberId)+" - "+I(e.memberName)+" - 可用余额："+I(e.availableBalance),1)]),_:2},1024),l(d,{label:"结算金额"},{default:a(()=>[l(w,{"controls-position":"right",modelValue:e.settlementAmount,"onUpdate:modelValue":D=>e.settlementAmount=D,max:e.availableBalance,placeholder:""},null,8,["modelValue","onUpdate:modelValue","max"])]),_:2},1024)],64))),256))],64))]),_:1},8,["model","rules"])])),[[N,t(A)]])}}}),$=O(q,[["__scopeId","data-v-d24633c5"]]),H=Object.freeze(Object.defineProperty({__proto__:null,default:$},Symbol.toStringTag,{value:"Module"}));export{$ as D,V as a,H as i};
