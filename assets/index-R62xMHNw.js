
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import C from"./index-Ck0HOekc.js";import{u as V}from"./index-B0K2KK6O.js";import{d as j,r as l,a3 as E,a4 as c,a as b,o as P,b as S,f as s,w as n,g as u,i as M,an as R,ak as z,_ as B}from"./index-fuY6ctZR.js";import"./index.vue_vue_type_script_setup_true_lang-Cob8vLkA.js";import"./index-C8cHQ_M6.js";import"./index-DFJLODe7.js";import"./apiLoading-3YAmOqA8.js";import"./otherFunctions_basicDictionary-D3X8j4Bd.js";import"./basicDictionary-DrcJ1yKq.js";import"./user_customer-DDO7eHSM.js";import"./user_customer-CTTJ1hJ1.js";const I=j({name:"ProjeckEdit",__name:"index",emits:["fetch-data"],setup(N,{expose:_,emit:T}){const g=V(),k=T,i=l(!1),f=l(""),r=l([]);function y(e){r.value.push(e)}E("validateTopTabs",y);const d=l([]);let t=c([]);const p=l();async function h(e){if(e)f.value="编辑",w(e);else{f.value="添加";const a=R(g.initialTopTabsData);t=c([a])}i.value=!0}function w(e){t.length=0,t.push({...e})}async function m(){const e=[];r.value.forEach(o=>{e.push(o.validate())});const a=await Promise.allSettled(e);d.value=a.map(o=>o.status)}async function x(){if(await m(),d.value.every(e=>e==="fulfilled")){const e=t[0];e.addProjectInfoList=t.slice(1),console.log("masterData",e)}else p.value.activeLeftTab=d.value.indexOf("rejected"),z.warning({message:"请完善表单",center:!0})}function v(){t=c([]),k("fetch-data"),i.value=!1,r.value=[]}return _({showEdit:h}),(e,a)=>{const o=b("el-button"),D=b("el-drawer");return P(),S("div",null,[s(D,{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=L=>i.value=L),class:"hide-drawer-header","append-to-body":"","close-on-click-modal":!1,"destroy-on-close":"",draggable:"",size:"70%",title:"",onClose:v},{footer:n(()=>[s(o,{onClick:v},{default:n(()=>[u(" 取消 ")]),_:1}),s(o,{type:"warning",onClick:a[0]||(a[0]=()=>{})},{default:n(()=>[u(" 暂存 ")]),_:1}),s(o,{type:"primary",onClick:x},{default:n(()=>[u(" 确定 ")]),_:1})]),default:n(()=>[s(C,{onValidate:m,ref_key:"LeftTabsRef",ref:p,"left-tabs-data":M(t),"validate-top-tabs":r.value,"validate-all":d.value},null,8,["left-tabs-data","validate-top-tabs","validate-all"])]),_:1},8,["modelValue"])])}}}),X=B(I,[["__scopeId","data-v-1505fff1"]]);export{X as default};
