
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as He}from"./index-Bg4kDbDt.js";import{_ as xe}from"./index-DhGFn38n.js";import{d as Be,ae as $e,aN as Me,r as m,ad as Pe,o as J,L as T,a3 as _,al as q,b as o,j as E,f,g as r,w as i,a4 as y,c as s,h as C,t as v,i as u,ax as Te,O as Q,P as Ue,k as h,aw as U,aG as W,aM as Ge,B as Oe,aS as G,ai as O,aj as X,_ as Re,aH as Fe,aI as Ze,z as Ae,an as Y}from"./index-BnVk3aZr.js";import{a as R}from"./department-DUOSvPzD.js";import{u as Ke}from"./department-BdEbdrTG.js";import{u as je}from"./position_manage-C43BkCsD.js";import Je from"./index-jOfJNY3x.js";import qe from"./index-Bx55ZQsk.js";import Qe from"./index-DHuwrvM_.js";import We from"./index-DQsOpjOa.js";import Xe from"./index-BNsWKlOc.js";import{columns as Ye}from"./index-CSZAlWE8.js";import"./index-DhY7K8iM.js";import"./clipboard-Dol0gqP4.js";import"./position_manage-BQzUk1TH.js";import"./tenantDictionary-BLRrqJG5.js";import"./configuration_role-C9y9FGXu.js";import"./configuration_manager-BvaEcv6D.js";import"./tenant_role-CnRCbrmi.js";const et=z=>(Fe("data-v-664b7a52"),z=z(),Ze(),z),tt={class:"absolute-container"},at={class:"page-main"},it={class:"custom-tree-node"},lt=["title"],nt={class:"code"},ot={key:0,style:{"margin-right":"0.3rem"}},rt={class:"actions"},st={class:"dictionary-container"},ut={class:"copyId tableSmall"},dt={class:"id oneLine idFont"},ct={style:{display:"flex","align-items":"center"}},mt={key:0,xmlns:"http://www.w3.org/2000/svg",style:{"margin-top":"2px","margin-right":"7px"},width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},pt=et(()=>f("g",{id:"Group 18384"},[f("circle",{id:"Ellipse 105",cx:"10",cy:"10",r:"10",fill:"#F8BB4F"}),f("path",{id:"ç®¡",d:"M13.9946 9.3605V12.1892H7.43481V12.9031H14.6277V16.4995H13.3481V16.0146H7.43481V16.486H6.15517V9.3605H13.9946ZM7.43481 14.8831H13.3481V13.9133H7.43481V14.8831ZM7.43481 11.1655H12.7419V10.3842H7.43481V11.1655ZM15.8534 7.67677V10.2495H14.6008V8.75436H5.52209V10.2495H4.2694V7.67677H9.48222C9.37446 7.40738 9.25323 7.16492 9.13201 6.9494L10.2635 6.76083L10.0345 6.61266C10.6541 5.80447 11.1121 4.9424 11.3815 4.01298L12.6072 4.28238C12.5264 4.51136 12.4591 4.72688 12.3782 4.9424H16.1228V6.06039H13.9273C14.1428 6.35673 14.3179 6.65307 14.4661 6.92246L13.3346 7.34003C13.1191 6.90899 12.8631 6.47796 12.5668 6.06039H11.8799C11.6509 6.5049 11.3949 6.92246 11.1121 7.29962L10.4655 6.88206C10.5733 7.12451 10.6676 7.39391 10.7753 7.67677H15.8534ZM6.08782 6.06039C5.79149 6.54531 5.46821 7.00328 5.118 7.42085L4 6.72042C4.78125 5.88529 5.33351 4.96934 5.67026 3.99951L6.89601 4.26891C6.81519 4.4979 6.72091 4.72688 6.64009 4.9424H10.0345V6.06039H8.01401C8.25647 6.39714 8.47198 6.72042 8.63362 7.03022L7.46175 7.47473C7.23276 6.98981 6.97683 6.51837 6.6805 6.06039H6.08782Z",fill:"white"})],-1)),vt=[pt],ft={class:"dictionary-container"},gt={class:"empty"},ee=Be({name:"department",__name:"list",setup(z){const{t:d}=$e(),{pagination:F,getParams:ht,onSizeChange:_t,onCurrentChange:yt,onSortChange:te}=Me(),$=je(),ae=m(),ie=Pe(),le=m([]),M=Ke(),ne=m(),H=m(!1),oe=m(),Z=m(),k=m({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),x=m(),re=m(),l=m({loading:!1,tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],search:{page:1,limit:10,id:"",userName:"",active:null,departmentId:null},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}}),A=m(),n=m({search:{name:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:"",isClick:!1},row:"",loading:!1}),g=m({search:{name:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:"",name:""},row:"",loading:!1}),c=m({loading:!1,search:{organizationalStructureId:""},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}});async function I(){try{n.value.loading=!0;const e={...n.value.search},t=await R.list(e);t.data&&(n.value.tree=K(t.data),n.value.loading=!1)}catch{}finally{n.value.loading=!1}}const K=e=>(e.sort((t,p)=>{const B=new Date(t.createTime);return new Date(p.createTime)-B}),e.forEach(t=>{t.children&&t.children.length>0&&K(t.children)}),e);J(()=>{I()}),T(()=>n.value.search,e=>{A.value.filter(e)});function se(e,t){return e?t.label.includes(e):!0}function ue(e){n.value.currentData=e,n.value.dialog.parentId="",n.value.dialog.id="",n.value.dialog.visible=!0}function de(e){g.value.currentData=e,g.value.dialog.parentId=(e==null?void 0:e.id)??"",g.value.dialog.name=(e==null?void 0:e.name)??"",g.value.dialog.id="",g.value.dialog.visible=!0}function ce(e,t){n.value.currentNode=e,n.value.currentData=t,n.value.row=JSON.stringify(t),n.value.dialog.parentId=e.parent.data.id??"",n.value.dialog.id=t.id,n.value.dialog.visible=!0,c.value.search.organizationalStructureId&&(n.value.dialog.isClick=!0)}function me(e,t){G.confirm(`确认删除「${t.name}」吗？`,"确认信息").then(()=>{R.delete({id:t.id}).then(()=>{O.success({message:"删除成功",center:!0}),I()})})}function pe(e){F.value.page=1,e.id&&(l.value.dialog.parentId=e.id),c.value.search.organizationalStructureId=e.id}T(()=>c.value.search.organizationalStructureId,()=>{L()});async function L(){x.value=null;try{H.value=!0;const e={...c.value.search},t=await R.itemlist(e);t.data&&(H.value=!1,l.value.dataList=t.data,c.value.dataList.forEach(p=>{p.enableLoading=!1}),F.value.total=t.data.length?t.data.length:0)}catch{}finally{H.value=!1}}J(async()=>{try{k.value.loading=!0,le.value=await ie.getCountry(),ne.value=await(M==null?void 0:M.getDepartment())||[],ae.value=await($==null?void 0:$.getPositionManage())||[],Ye.forEach(e=>{e.checked&&l.value.checkList.push(e.prop)}),k.value.loading=!1}catch{}finally{k.value.loading=!1}}),T(()=>k.value.search,e=>{oe.value.filter(e)});function ve(e){return new Promise(t=>{G.confirm(`确认${e.active?"禁用":"启用"}「${e.userName}」吗？`,"确认信息").then(()=>{try{k.value.loading=!0,X.edit({id:e.id,email:e.email,phoneNumber:e.phoneNumber,userName:e.userName,country:e.country,role:e.role,positionId:e.positionId,organizationalStructureId:e.organizationalStructureId,active:!e.active}).then(()=>(O.success({message:`${e.active?"禁用":"启用"}成功`,center:!0}),L(),k.value.loading=!1,t(!0))).catch(()=>(k.value.loading=!1,t(!1)))}catch{}finally{k.value.loading=!1}}).catch(()=>t(!1))})}function fe({prop:e,order:t}){te(e,t).then(()=>L())}function ge(e){l.value.dialog.id="",l.value.dialog.visible=!0,l.value.dialog.level=1}const he=e=>{x.value=e[0]};function _e(){if(x.value){const{userName:e,id:t}=x.value;G.confirm(`确认将「${e}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{X.reset({id:t}).then(()=>{O.success({message:"重置成功",center:!0}),L()})}).catch(()=>{})}}function ye(e){l.value.row=JSON.stringify(e),l.value.dialog.id=e.id,l.value.dialog.visible=!0}function be(e){Z.value.showEdit(e)}const P=m();function Ce(e){e?P.value=e.id:P.value=""}return(e,t)=>{const p=_("ElButton"),B=_("ElButtonGroup"),D=Re,ke=_("ElInput"),Se=_("ElTree"),we=_("ElScrollbar"),Ie=_("ElSpace"),S=_("ElTableColumn"),Le=_("ElSwitch"),Ve=_("el-tooltip"),De=xe,N=_("el-text"),Ne=_("el-empty"),Ee=_("ElTable"),ze=He,w=q("auth"),j=q("loading");return o(),E("div",tt,[f("div",at,[r(ze,{"hide-left-side-toggle":""},{leftSide:i(()=>[r(B,{class:"btns"},{default:i(()=>[y((o(),s(p,{type:"primary",class:"add",onClick:t[0]||(t[0]=a=>ue())},{default:i(()=>[C(v(u(d)("configuration.department.newDepartment")),1)]),_:1})),[[w,"department-insert-insertOrganizationalStructure"]])]),_:1}),r(ke,{modelValue:n.value.search.name,"onUpdate:modelValue":t[1]||(t[1]=a=>n.value.search.name=a),placeholder:u(d)("configuration.department.enterKeywork"),clearable:"",class:"search",onKeydown:Te(I,["enter"])},{append:i(()=>[r(p,{onClick:I},{default:i(()=>[r(D,{name:"i-ep:search"})]),_:1})]),_:1},8,["modelValue","placeholder"]),r(we,{class:"tree"},{default:i(()=>[y((o(),s(Se,{ref_key:"dictionaryRef",ref:A,data:n.value.tree,"filter-node-method":se,"default-expand-all":"",onNodeClick:pe},{default:i(({node:a,data:b})=>[f("div",it,[f("div",{class:"label",title:a.label},v(b.name),9,lt),f("div",nt,[(o(!0),E(Q,null,Ue(b==null?void 0:b.organizationalStructurePersonList,V=>(o(),E(Q,{key:V.userId},[V.enableChargePerson==1?(o(),E("span",ot,v(V.userName),1)):h("",!0)],64))),128))]),f("div",rt,[r(B,null,{default:i(()=>[y((o(),s(p,{type:"primary",plain:"",size:"default",onClick:U(V=>de(b),["stop"])},{icon:i(()=>[r(D,{name:"i-ep:plus"})]),_:2},1032,["onClick"])),[[w,"department-insert-insertOrganizationalStructure"]]),y((o(),s(p,{type:"info",plain:"",size:"default",onClick:U(V=>ce(a,b),["stop"])},{icon:i(()=>[r(D,{name:"i-ep:edit"})]),_:2},1032,["onClick"])),[[w,"department-update-updateOrganizationalStructure"]]),y((o(),s(p,{type:"danger",plain:"",size:"default",onClick:U(V=>me(a,b),["stop"])},{icon:i(()=>[r(D,{name:"i-ep:delete"})]),_:2},1032,["onClick"])),[[w,"department-delete-deleteOrganizationalStructure"]])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])),[[j,n.value.loading]])]),_:1})]),default:i(()=>[y(f("div",st,[r(Ie,{wrap:""},{default:i(()=>[y((o(),s(p,{type:"primary",onClick:t[2]||(t[2]=a=>ge())},{default:i(()=>[C(v(u(d)("configuration.department.newEmployee")),1)]),_:1})),[[w,"department-insert-insertStaff"]]),y((o(),s(p,{onClick:_e},{default:i(()=>[C(v(u(d)("common.resetPassword")),1)]),_:1})),[[w,"department-update-resetPasswordStaff"]])]),_:1}),y((o(),s(Ee,{ref_key:"userItemRef",ref:re,data:l.value.dataList,border:l.value.border,size:l.value.lineHeight,stripe:l.value.stripe,"highlight-current-row":"",height:"100%",onSortChange:fe,onSelectionChange:t[3]||(t[3]=a=>l.value.selectionDataList=a),"row-key":"id","default-expand-all":"",onSelect:he,onCurrentChange:Ce},{empty:i(()=>[r(Ne,{image:u(Ge),"image-size":300},null,8,["image"])]),default:i(()=>[r(S,{type:"selection",align:"left",fixed:""}),l.value.checkList.includes("active")?(o(),s(S,{key:0,align:"left",prop:"active",label:u(d)("common.status")},{default:i(a=>[r(Le,{modelValue:a.row.active,"onUpdate:modelValue":b=>a.row.active=b,"inline-prompt":"","active-text":u(d)("common.enable"),"inactive-text":u(d)("common.disable"),"before-change":()=>ve(a.row)},null,8,["modelValue","onUpdate:modelValue","active-text","inactive-text","before-change"])]),_:1},8,["label"])):h("",!0),l.value.checkList.includes("id")?(o(),s(S,{key:1,align:"left",width:"180",prop:"id",label:u(d)("configuration.user.id")},{default:i(({row:a})=>[f("div",ut,[f("div",dt,[r(Ve,{effect:"dark",content:a.id,placement:"top-start"},{default:i(()=>[C(v(a.id),1)]),_:2},1032,["content"])]),r(De,{content:a.id,class:Oe({rowCopy:"rowCopy",current:a.id===P.value})},null,8,["content","class"])])]),_:1},8,["label"])):h("",!0),l.value.checkList.includes("userName")?(o(),s(S,{key:2,align:"left",width:"160",prop:"userName",label:u(d)("configuration.user.username")},{default:i(({row:a})=>[f("div",ct,[a.enableChargePerson===1?(o(),E("svg",mt,vt)):h("",!0),r(N,{class:"tableBig"},{default:i(()=>[C(v(a.userName?a.userName:"-"),1)]),_:2},1024)])]),_:1},8,["label"])):h("",!0),l.value.checkList.includes("phoneNumber")?(o(),s(S,{key:3,align:"left",width:"170",prop:"phone",label:u(d)("configuration.user.phonenumber")},{default:i(({row:a})=>[r(N,{class:"fontC-System"},{default:i(()=>[C(v(a.phoneNumber?a.phoneNumber:"-"),1)]),_:2},1024)]),_:1},8,["label"])):h("",!0),l.value.checkList.includes("email")?(o(),s(S,{key:4,align:"left",width:"180",prop:"email",label:u(d)("configuration.user.email")},{default:i(({row:a})=>[r(N,{class:"fontC-System"},{default:i(()=>[C(v(a.email?a.email:"-"),1)]),_:2},1024)]),_:1},8,["label"])):h("",!0),l.value.checkList.includes("departmentId")?(o(),s(S,{key:5,align:"left",prop:"departmentId",label:u(d)("configuration.user.department")},{default:i(({row:a})=>[r(N,{class:"fontC-System"},{default:i(()=>[C(v(a.organizationalStructureName?a.organizationalStructureName:"-"),1)]),_:2},1024)]),_:1},8,["label"])):h("",!0),l.value.checkList.includes("positionId")?(o(),s(S,{key:6,align:"left",prop:"positionId",label:u(d)("configuration.user.position")},{default:i(({row:a})=>[r(N,{class:"fontC-System"},{default:i(()=>[C(v(a.positionName?a.positionName:"-"),1)]),_:2},1024)]),_:1},8,["label"])):h("",!0),r(S,{label:u(d)("common.control"),fixed:"right",width:"200",align:"left"},{default:i(a=>[y((o(),s(p,{type:"primary",size:"small",plain:"",onClick:b=>ye(a.row)},{default:i(()=>[C(v(u(d)("common.edit")),1)]),_:2},1032,["onClick"])),[[w,"department-update-updateStaff"]]),y((o(),s(p,{type:"warning",size:"small",plain:"",onClick:b=>be(a.row)},{default:i(()=>[C(v(u(d)("common.detail")),1)]),_:2},1032,["onClick"])),[[w,"department-get-getStaffList"]])]),_:1},8,["label"])]),_:1},8,["data","border","size","stripe"])),[[j,H.value]])],512),[[W,c.value.search.organizationalStructureId]]),y(f("div",ft,[f("div",gt,v(u(d)("configuration.department.newOrSelect")),1)],512),[[W,!c.value.search.organizationalStructureId]])]),_:1}),n.value.dialog.visible?(o(),s(Je,{key:0,id:n.value.dialog.id,modelValue:n.value.dialog.visible,"onUpdate:modelValue":t[4]||(t[4]=a=>n.value.dialog.visible=a),row:n.value.row,"parent-id":n.value.dialog.parentId,tree:n.value.tree,isClick:n.value.dialog.isClick,onGetList:I,onGetItmelist:L},null,8,["id","modelValue","row","parent-id","tree","isClick"])):h("",!0),g.value.dialog.visible?(o(),s(qe,{key:1,id:g.value.dialog.id,modelValue:g.value.dialog.visible,"onUpdate:modelValue":t[5]||(t[5]=a=>g.value.dialog.visible=a),row:g.value.row,"parent-id":g.value.dialog.parentId,name:g.value.dialog.name,tree:g.value.tree,onGetList:I},null,8,["id","modelValue","row","parent-id","name","tree"])):h("",!0),c.value.dialog.visible?(o(),s(Qe,{key:2,id:c.value.dialog.id,modelValue:c.value.dialog.visible,"onUpdate:modelValue":t[6]||(t[6]=a=>c.value.dialog.visible=a),"catalogue-id":c.value.search.organizationalStructureId,"parent-id":c.value.dialog.parentId,level:c.value.dialog.level,tree:n.value.tree,dataList:c.value.dataList,row:c.value.row,onSuccess:L},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):h("",!0),l.value.dialog.visible?(o(),s(We,{key:3,id:l.value.dialog.id,modelValue:l.value.dialog.visible,"onUpdate:modelValue":t[7]||(t[7]=a=>l.value.dialog.visible=a),"catalogue-id":l.value.search.catalogueId,"parent-id":l.value.dialog.parentId,level:l.value.dialog.level,tree:k.value.tree,dataList:l.value.dataList,row:l.value.row,onSuccess:L,onGetList:I},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):h("",!0),r(Xe,{ref_key:"detailRef",ref:Z},null,512)])])}}});typeof Y=="function"&&Y(ee);const Ut=Ae(ee,[["__scopeId","data-v-664b7a52"]]);export{Ut as default};
