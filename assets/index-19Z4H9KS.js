
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{o as E,s as B}from"./apiLoading-FZ8Rx7ya.js";import{a as F}from"./projectManagement-DUmOvoyI.js";import{u as R}from"./survey_vipGroup-BPr7WTKc.js";import{d as D,r as p,G as M,a as t,al as T,o as u,b as _,f as o,w as l,l as U,g as v,am as q,e as g,i as a,F as A,n as H,p as O,ak as z,_ as J}from"./index-BFpd1KqM.js";import"./survey_vipGroup-D0TvoJlK.js";const K={style:{flex:"auto"}},P=D({name:"AllocationEdit",__name:"index",emits:["fetch-data"],setup(Q,{expose:b,emit:w}){const I=R(),L=w,i=p(!1),c=p(),e=p({list:[],vipGroupList:[],form:{projectId:"",groupSupplierIdList:[]}}),y=p({groupSupplierIdList:[{type:"array",required:!0,trigger:"change",message:"请选择至少一项"}]});async function V(r){console.log("row",r),e.value.list=[{...r}],e.value.form.projectId=r.projectId,e.value.vipGroupList=await E(I.getGroupNameList()),i.value=!0}function d(){c.value.resetFields(),Object.assign(e.value.form,{projectId:"",groupSupplierIdList:[]}),i.value=!1}function h(){c.value.validate(async r=>{if(r){const{status:s}=await B(F.allocation(e.value.form));s===1&&z.success({message:"分配成功",center:!0}),d(),L("fetch-data")}})}return M(async()=>{}),b({showEdit:V}),(r,s)=>{const m=t("el-table-column"),S=t("el-table"),x=t("el-option"),G=t("el-select"),k=t("el-form-item"),j=t("el-form"),f=t("el-button"),N=t("el-dialog"),C=T("loading");return u(),_("div",null,[o(N,{modelValue:a(i),"onUpdate:modelValue":s[1]||(s[1]=n=>O(i)?i.value=n:null),title:"分配",width:"500","before-close":d},{footer:l(()=>[U("div",K,[o(f,{type:"primary",onClick:h},{default:l(()=>[v(" 确定 ")]),_:1}),o(f,{onClick:d},{default:l(()=>[v(" 取消 ")]),_:1})])]),default:l(()=>[q((u(),g(S,{data:a(e).list,"row-key":"id"},{default:l(()=>[o(m,{align:"center","show-overflow-tooltip":"",label:"客户简称",prop:"clientName"}),o(m,{align:"center","show-overflow-tooltip":"",label:"项目编码",prop:"projectId"}),o(m,{align:"center","show-overflow-tooltip":"",label:"项目名称",prop:"name"})]),_:1},8,["data"])),[[C,!1]]),o(j,{ref_key:"formRef",ref:c,"label-width":"80px",rules:a(y),model:a(e).form,inline:!1},{default:l(()=>[o(k,{label:"会员组",prop:"groupSupplierIdList"},{default:l(()=>[o(G,{modelValue:a(e).form.groupSupplierIdList,"onUpdate:modelValue":s[0]||(s[0]=n=>a(e).form.groupSupplierIdList=n),placeholder:"请选择会员组",clearable:"",filterable:"",multiple:"","collapse-tags":""},{default:l(()=>[(u(!0),_(A,null,H(a(e).vipGroupList,n=>(u(),g(x,{label:n.memberGroupName,value:n.memberGroupId},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}}}),ee=J(P,[["__scopeId","data-v-4425600a"]]);export{ee as default};
