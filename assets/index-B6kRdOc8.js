
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as P}from"./project_settlement-DAW2IFcf.js";import{d as q,r as d,a as s,an as H,o as y,b as $,f as t,w as a,A as r,g as i,ak as A,e as j,j as x,E as w,aH as F,aI as J,N as M}from"./index-YllKKoVL.js";const N=v=>(F("data-v-e84f0c28"),v=v(),J(),v),G={class:"border"},K=N(()=>r("p",{class:"pp"},"项目ID",-1)),Q={class:"neip"},W={class:"border"},X=N(()=>r("p",{class:"pp"},"项目名称",-1)),Y={class:"neip"},Z={class:"shenhe"},ee={class:"beizhu"},le={class:"po"},te={style:{flex:"auto"}},ae=q({name:"ProjectReview",__name:"index",emits:["success"],setup(v,{expose:T,emit:D}){const S=D,_=d(!1),n=d(),l=d({projectId:"",projectName:"",settlementType:"",remark:"",projectSettlementBuilderList:[],po:"",arr:""}),z=d({settlementType:[{required:!0,message:"请选择审核方式",trigger:"change"}],arr:[{required:!0,message:"请输入至少一个ID",trigger:"blur"},{validator:(p,e,u)=>{/^\d+$/.test(e)?u():u(new Error("请输入数字"))},trigger:"blur"}]}),f=d(),V=d(!1),m=d(!1);async function B(p){p&&(n.value=JSON.parse(p),l.value.projectId=n.value.projectId,l.value.projectName=n.value.projectName),m.value=!0}async function U(){f.value&&f.value.validate(async p=>{try{if(p){_.value=!0,delete l.value.projectName,l.value.settlementType===1||l.value.settlementType===2?(l.value.projectSettlementBuilderList=l.value.arr.split(`
`)||[],delete l.value.arr):l.value.projectSettlementBuilderList=[];const{status:e}=await P.review(l.value);e===1?(S("success"),_.value=!1,w.success({message:"操作成功",center:!0}),I()):w.error({message:"操作失败，请联系工作人员",center:!0})}else w({message:"请检查必填项,或数据格式不正确",type:"warning"})}catch{}finally{_.value=!1}})}function I(){f.value.resetFields(),Object.assign(l.value,{projectId:"",projectName:"",settlementType:"",remark:"",projectSettlementBuilderList:[],po:"",arr:""}),l.value.arr=[],m.value=!1}return T({showEdit:B}),(p,e)=>{const u=s("el-input"),b=s("el-row"),c=s("el-radio"),C=s("el-radio-group"),g=s("el-form-item"),k=s("el-col"),E=s("el-checkbox"),R=s("el-form"),h=s("el-button"),L=s("el-drawer"),O=H("loading");return y(),$("div",null,[t(L,{modelValue:m.value,"onUpdate:modelValue":e[9]||(e[9]=o=>m.value=o),title:"项目审核",size:"50%","before-close":I},{footer:a(()=>[r("div",te,[t(h,{type:"primary",onClick:U},{default:a(()=>[i(" 确定 ")]),_:1}),t(h,{onClick:e[8]||(e[8]=o=>m.value=!1)},{default:a(()=>[i(" 取消 ")]),_:1})])]),default:a(()=>[A((y(),j(R,{ref_key:"formRef",ref:f,model:l.value,rules:z.value,"label-width":"174px",inline:!1},{default:a(()=>[t(b,{style:{margin:"0"},gutter:20},{default:a(()=>[r("div",G,[K,r("p",Q,[t(u,{modelValue:n.value.projectId,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value.projectId=o),placeholder:"请输入项目ID",disabled:"",clearable:""},null,8,["modelValue"])])]),r("div",W,[X,r("p",Y,[t(u,{modelValue:n.value.projectName,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value.projectName=o),disabled:"",placeholder:"请输入项目名称",clearable:""},null,8,["modelValue"])])])]),_:1}),r("div",Z,[t(g,{prop:"settlementType",style:{display:"flex","align-items":"center"},label:"审核方式"},{default:a(()=>[t(C,{modelValue:l.value.settlementType,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.settlementType=o)},{default:a(()=>[t(c,{value:1,size:"large"},{default:a(()=>[i(" 按成功ID ")]),_:1}),t(c,{value:2,size:"large"},{default:a(()=>[i(" 按失败ID ")]),_:1}),t(c,{value:3,size:"large"},{default:a(()=>[i(" 全部通过 ")]),_:1}),t(c,{value:4,size:"large"},{default:a(()=>[i(" 全部失败 ")]),_:1}),t(c,{value:5,size:"large"},{default:a(()=>[i(" 数据冻结 ")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),r("div",ee,[t(g,{label:"备注"},{default:a(()=>[t(u,{class:"custom-input",modelValue:l.value.remark,"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.remark=o),placeholder:"",clearable:""},null,8,["modelValue"])]),_:1})]),r("div",le,[V.value?(y(),j(g,{key:0,label:"结算PO号"},{default:a(()=>[t(u,{modelValue:l.value.po,"onUpdate:modelValue":e[4]||(e[4]=o=>l.value.po=o),class:"custom-input",placeholder:"",clearable:"",onChange:e[5]||(e[5]=()=>{})},null,8,["modelValue"])]),_:1})):x("",!0)]),t(b,{style:{margin:"0"},gutter:20},{default:a(()=>[t(k,{span:20}),t(k,{span:4},{default:a(()=>[t(E,{modelValue:V.value,"onUpdate:modelValue":e[6]||(e[6]=o=>V.value=o),label:"填写结算PO号",size:"large"},null,8,["modelValue"])]),_:1})]),_:1}),l.value.settlementType===1||l.value.settlementType===2?(y(),j(b,{key:0,style:{margin:"0",width:"100%"},gutter:20},{default:a(()=>[t(g,{style:{width:"100%"},prop:"arr"},{default:a(()=>[t(u,{modelValue:l.value.arr,"onUpdate:modelValue":e[7]||(e[7]=o=>l.value.arr=o),placeholder:"请粘贴ID，每行一个,多个请回车换行",type:"textarea",rows:"15"},null,8,["modelValue"])]),_:1})]),_:1})):x("",!0)]),_:1},8,["model","rules"])),[[O,_.value]])]),_:1},8,["modelValue"])])}}}),re=M(ae,[["__scopeId","data-v-e84f0c28"]]);export{re as default};
