
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{k as _,d as C,r as b,E as D,a as r,al as U,am as z,i as a,o as u,b as c,f as l,w as n,g as S,F as f,n as B,e as R,I as j,J as I,_ as O}from"./index-D7X-4r4C.js";const V={list:s=>_.post("bill/getMemberBillList",s),create:s=>_.post("bill/addMemberSettlement",s),getMemberBillAvailableBalance:s=>_.post("bill/getMemberBillAvailableBalance",s),changestatus:s=>_.post("bill/updateMemberBill",s)},P=C({__name:"index",props:{id:{default:""}},setup(s,{expose:y}){const h=b(!1),v=b(),o=b({settlementType:1,settlementAmount:"",addMemberSettlementInfoList:[]}),p=b({memberSettlementInfoList:[],memberSettlementInfoSelect:[]}),x=b({}),M=async i=>{if(i===2){const t=await V.getMemberBillAvailableBalance({});p.value.memberSettlementInfoList=t.data.memberBillAvailableBalanceInfoList}},E=i=>{const t=p.value.memberSettlementInfoList.filter(m=>i.includes(m.id));for(let m=0;m<t.length;m++)o.value.addMemberSettlementInfoList.push(t[m])};return y({submit(){return new Promise(i=>{v.value&&v.value.validate(t=>{t&&V.create(o.value).then(()=>{D.success({message:"新增成功",center:!0}),i()})})})}}),(i,t)=>{const m=r("el-radio"),A=r("el-radio-group"),d=r("ElFormItem"),g=r("ElInput"),L=r("el-option"),k=r("el-select"),F=r("ElInputNumber"),N=r("ElForm"),T=U("loading");return z((u(),c("div",null,[l(N,{ref_key:"formRef",ref:v,model:a(o),rules:a(x),"label-width":"120px","label-suffix":"："},{default:n(()=>[l(d,{label:"结算方式"},{default:n(()=>[l(A,{modelValue:a(o).settlementType,"onUpdate:modelValue":t[0]||(t[0]=e=>a(o).settlementType=e),onChange:M},{default:n(()=>[l(m,{value:1,size:"large"},{default:n(()=>[S(" 全部结算 ")]),_:1}),l(m,{value:2,size:"large"},{default:n(()=>[S(" 指定结算 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(o).settlementType===1?(u(),c(f,{key:0},[l(d,{label:"最低结算额度"},{default:n(()=>[l(g,{disabled:"",placeholder:"",value:"111"})]),_:1}),l(d,{label:"结算金额"},{default:n(()=>[l(g,{modelValue:a(o).settlementAmount,"onUpdate:modelValue":t[1]||(t[1]=e=>a(o).settlementAmount=e),placeholder:""},null,8,["modelValue"])]),_:1})],64)):(u(),c(f,{key:1},[l(d,{label:"指定会员"},{default:n(()=>[l(k,{placeholder:"Select",modelValue:a(p).memberSettlementInfoSelect,"onUpdate:modelValue":t[2]||(t[2]=e=>a(p).memberSettlementInfoSelect=e),clearable:"",filterable:"",multiple:"","collapse-tags":"",onChange:E},{default:n(()=>[(u(!0),c(f,null,B(a(p).memberSettlementInfoList,e=>(u(),R(L,{key:e.id,value:e.id,label:e.memberName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"最低结算额度"},{default:n(()=>[l(g,{disabled:"",placeholder:"",value:"111"})]),_:1}),(u(!0),c(f,null,B(a(o).addMemberSettlementInfoList,e=>(u(),c(f,null,[l(d,{label:""},{default:n(()=>[j("p",null,I(e.memberId)+" - "+I(e.memberName)+" - 可用余额："+I(e.availableBalance),1)]),_:2},1024),l(d,{label:"结算金额"},{default:n(()=>[l(F,{"controls-position":"right",modelValue:e.settlementAmount,"onUpdate:modelValue":w=>e.settlementAmount=w,max:e.availableBalance,placeholder:""},null,8,["modelValue","onUpdate:modelValue","max"])]),_:2},1024)],64))),256))],64))]),_:1},8,["model","rules"])])),[[T,a(h)]])}}}),J=O(P,[["__scopeId","data-v-800d9fd8"]]),q=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));export{J as D,V as a,q as i};
