
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Le,r as f,am as we,aO as Ne,l as xe,a2 as Ee,b as c,q as De,o as i,e as b,t as C,g as o,k as m,w as l,s as Se,az as A,F as L,v as w,h as p,j as k,aN as Ve,f as s,H as h,p as V,aP as T,E as j,N as Be,aQ as ze,ap as He,R as Ue,ao as K}from"./index-BE-pxncy.js";import{_ as Pe}from"./index-BK6TWFD1.js";import Re from"./index-DnmcT2L1.js";import Me from"./index-CiuFoW0x.js";import{a as $e}from"./department-B-1TFjKz.js";import{u as Ae}from"./department-DJEc9CyA.js";import{u as Te}from"./position_manage-BsgdVojT.js";import{u as je}from"./group_manage-2ea_y4sN.js";import"./index-Bqf353e4.js";import"./position_manage-DNJ6K9He.js";import"./tenant_role-Cc1JLe7_.js";import"./configuration_role-CoTrAJe8.js";import"./configuration_manager-_jsqmH2n.js";import"./group_manage-ExBLbjL3.js";const Ke={class:"absolute-container"},Oe={class:"page-main"},Fe={class:"leftTree"},Qe={key:0,class:"leftData",span:3},qe={class:"dictionary-container"},Ge={class:"copyId tableSmall"},Je={class:"id oneLine"},O=Le({name:"user",__name:"index",setup(We){const N=je(),B=f(),x=Te(),z=f(),F=we(),Q=f([]),E=Ae(),H=f(),{pagination:_,getParams:Xe,onSizeChange:q,onCurrentChange:G,onSortChange:J}=Ne(),D=f([{label:"员工ID",prop:"id",sortable:!0,checked:!0},{label:"用户名",prop:"userName",sortable:!0,checked:!0},{label:"姓名",prop:"name",sortable:!0,checked:!0},{label:"电话号码",prop:"phoneNumber",sortable:!0,checked:!0},{label:"邮箱",prop:"email",sortable:!0,checked:!0},{label:"部门",prop:"departmentId",sortable:!0,checked:!0},{label:"职位",prop:"positionId",sortable:!0,checked:!0},{label:"小组",prop:"groupId",sortable:!0,checked:!0},{label:"状态",prop:"active",sortable:!0,checked:!0}]),W=[{label:"启用",value:!0},{label:"禁用",value:!1}],X={children:"children",label:"name"},Y=f(),U=f(),g=f({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),P=f(),Z=f(),e=f({loading:!1,tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],search:{page:1,limit:10,id:"",userName:"",active:null,departmentId:null},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}}),ee=f();async function u(){const t={...e.value.search},n=await $e.createEvery();n.data&&(g.value.tree=n.data.result);const y=await V.list(t);y.data&&(e.value.dataList=y.data.data,_.value.total=+y.data.total)}xe(async()=>{try{g.value.loading=!0,Q.value=await F.getCountry(),H.value=await(E==null?void 0:E.getDepartment())||[],z.value=await(x==null?void 0:x.getPositionManage())||[],B.value=await(N==null?void 0:N.getGroupManage())||[],u(),D.value.forEach(t=>{t.checked&&e.value.checkList.push(t.prop)}),g.value.loading=!1}catch{}finally{g.value.loading=!1}}),Ee(()=>g.value.search,t=>{Y.value.filter(t)});function ae(t){return new Promise(n=>{T.confirm(`确认${t.active?"禁用":"启用"}「${t.name}」吗？`,"确认信息").then(()=>{try{g.value.loading=!0,V.edit({id:t.id,account:null,name:null,sex:null,phoneNumber:null,active:!t.active}).then(()=>(j.success({message:`${t.active?"禁用":"启用"}成功`,center:!0}),u(),g.value.loading=!1,n(!0))).catch(()=>(g.value.loading=!1,n(!1)))}catch{}finally{g.value.loading=!1}}).catch(()=>n(!1))})}function te(t){var n;_.value.page=1,(n=t==null?void 0:t.children)!=null&&n.length?(e.value.search.id="",e.value.search.departmentId=t.id,u()):(e.value.search.id=t.id,e.value.search.departmentId="",u())}function le(t){q(t).then(()=>{e.value.search.limit=t,u()})}function ne(t=1){G(t).then(()=>{e.value.search.page=t,u()})}function oe({prop:t,order:n}){J(t,n).then(()=>u())}function ie(t){e.value.dialog.id="",e.value.dialog.visible=!0,e.value.dialog.level=1,t&&(e.value.dialog.parentId=t.id,e.value.dialog.level=Number(t.level)+1)}const se=t=>{P.value=t[0]};function re(){const{name:t,id:n}=P.value;T.confirm(`确认将「${t}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{V.reset({id:n}).then(()=>{j.success({message:"重置成功",center:!0}),u()})}).catch(()=>{})}function ue(t){e.value.row=JSON.stringify(t),e.value.dialog.id=t.id,e.value.dialog.parentId=t.parentId,e.value.dialog.visible=!0}function de(t){U.value.showEdit(t)}function ce(){Object.assign(e.value.search,{id:"",userName:"",departmentId:null,active:null}),u()}return(t,n)=>{const y=c("el-tree"),R=c("ElInput"),pe=c("el-option"),me=c("el-select"),M=Be,I=c("ElButton"),ge=c("ElSpace"),S=c("el-button"),$=c("el-col"),fe=ze,ve=c("el-row"),v=c("ElTableColumn"),he=c("ElSwitch"),_e=Pe,r=c("el-text"),be=c("el-empty"),ye=c("ElTable"),ke=c("ElPagination"),Ie=He,Ce=De("loading");return i(),b("div",Ke,[C("div",Oe,[C("div",Fe,[g.value.tree.length?(i(),b("div",Qe,[o(y,{style:{"max-width":"37.5rem","min-height":"45.4375rem",padding:"10px"},data:g.value.tree,ref_key:"treeRef",ref:ee,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,props:X,onNodeClick:te},null,8,["data"])])):m("",!0),o(Ie,null,{default:l(()=>[Se((i(),b("div",qe,[o(ge,null,{default:l(()=>[o(R,{modelValue:e.value.search.id,"onUpdate:modelValue":n[0]||(n[0]=a=>e.value.search.id=a),placeholder:"员工ID",clearable:"",style:{width:"12.5rem"},onKeydown:A(u,["enter"])},null,8,["modelValue"]),o(R,{modelValue:e.value.search.userName,"onUpdate:modelValue":n[1]||(n[1]=a=>e.value.search.userName=a),placeholder:"用户名",clearable:"",style:{width:"12.5rem"},onKeydown:A(u,["enter"])},null,8,["modelValue"]),o(me,{modelValue:e.value.search.active,"onUpdate:modelValue":n[2]||(n[2]=a=>e.value.search.active=a),"value-key":"",placeholder:"状态",style:{width:"12.5rem"},clearable:"",filterable:"",onChange:u},{default:l(()=>[(i(),b(L,null,w(W,a=>o(pe,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),o(I,{type:"primary",onClick:u},{icon:l(()=>[o(M,{name:"i-ep:search"})]),_:1}),o(I,{onClick:ce},{icon:l(()=>[o(M,{name:"i-ep:refresh"})]),_:1})]),_:1}),o(ve,{style:{"margin-bottom":".3125rem"},gutter:24},{default:l(()=>[o($,{style:{"margin-bottom":"1.5625rem"},span:10},{default:l(()=>[o(S,{type:"primary",size:"default",onClick:ie},{default:l(()=>[p(" 新增 ")]),_:1}),o(S,{type:"primary",size:"default",onClick:re},{default:l(()=>[p(" 重置密码 ")]),_:1})]),_:1}),o($,{style:{display:"flex","justify-content":"flex-end"},span:14},{default:l(()=>[o(S,{size:"default",onClick:n[3]||(n[3]=()=>{})},{default:l(()=>[p(" 导出 ")]),_:1}),o(fe,{border:e.value.border,"onUpdate:border":n[4]||(n[4]=a=>e.value.border=a),tableAutoHeight:e.value.tableAutoHeight,"onUpdate:tableAutoHeight":n[5]||(n[5]=a=>e.value.tableAutoHeight=a),checkList:e.value.checkList,"onUpdate:checkList":n[6]||(n[6]=a=>e.value.checkList=a),columns:D.value,"onUpdate:columns":n[7]||(n[7]=a=>D.value=a),"line-height":e.value.lineHeight,"onUpdate:lineHeight":n[8]||(n[8]=a=>e.value.lineHeight=a),stripe:e.value.stripe,"onUpdate:stripe":n[9]||(n[9]=a=>e.value.stripe=a),style:{"margin-left":".75rem"},onQueryData:u},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),o(ye,{ref_key:"dictionaryItemRef",ref:Z,data:e.value.dataList,border:e.value.border,size:e.value.lineHeight,stripe:e.value.stripe,"highlight-current-row":"",height:"100%",onSortChange:oe,onSelectionChange:n[10]||(n[10]=a=>e.value.selectionDataList=a),"row-key":"id","default-expand-all":"",onSelect:se},{empty:l(()=>[o(be,{image:k(Ve),"image-size":300},null,8,["image"])]),default:l(()=>[o(v,{type:"selection",align:"left",fixed:""}),e.value.checkList.includes("active")?(i(),s(v,{key:0,align:"left",prop:"active",label:"状态"},{default:l(a=>[o(he,{modelValue:a.row.active,"onUpdate:modelValue":d=>a.row.active=d,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>ae(a.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1})):m("",!0),e.value.checkList.includes("id")?(i(),s(v,{key:1,align:"left",width:"180",prop:"id",label:"员工ID"},{default:l(({row:a})=>[C("div",Ge,[C("div",Je,"ID: "+h(a.id),1),o(_e,{class:"copy",content:a.id},null,8,["content"])])]),_:1})):m("",!0),e.value.checkList.includes("userName")?(i(),s(v,{key:2,align:"left",width:"130",prop:"userName",label:"用户名"},{default:l(({row:a})=>[o(r,{class:"tableBig"},{default:l(()=>[p(h(a.userName?a.userName:"-"),1)]),_:2},1024)]),_:1})):m("",!0),e.value.checkList.includes("name")?(i(),s(v,{key:3,align:"left",width:"130",prop:"name",label:"姓名"},{default:l(({row:a})=>[o(r,{class:"tableBig"},{default:l(()=>[p(h(a.name?a.name:"-"),1)]),_:2},1024)]),_:1})):m("",!0),e.value.checkList.includes("phoneNumber")?(i(),s(v,{key:4,align:"left",width:"170",prop:"phone",label:"电话号码"},{default:l(({row:a})=>[o(r,{class:"tableBig"},{default:l(()=>[p(h(a.phoneNumber?a.phoneNumber:"-"),1)]),_:2},1024)]),_:1})):m("",!0),e.value.checkList.includes("email")?(i(),s(v,{key:5,align:"left",width:"180",prop:"email",label:"邮箱"},{default:l(({row:a})=>[o(r,{class:"tableBig"},{default:l(()=>[p(h(a.email?a.email:"-"),1)]),_:2},1024)]),_:1})):m("",!0),e.value.checkList.includes("departmentId")?(i(),s(v,{key:6,align:"left",prop:"departmentId",label:"部门"},{default:l(({row:a})=>[a.departmentId?(i(),s(r,{key:0,class:"tableBig"},{default:l(()=>[(i(!0),b(L,null,w(H.value,d=>(i(),s(r,null,{default:l(()=>[a.departmentId===d.id?(i(),s(r,{key:0},{default:l(()=>[p(h(d.name?d.name:"-"),1)]),_:2},1024)):m("",!0)]),_:2},1024))),256))]),_:2},1024)):(i(),s(r,{key:1,class:"tableBig"},{default:l(()=>[p("-")]),_:1}))]),_:1})):m("",!0),e.value.checkList.includes("positionId")?(i(),s(v,{key:7,align:"left",prop:"positionId",label:"职位"},{default:l(({row:a})=>[a.positionId?(i(),s(r,{key:0,class:"tableBig"},{default:l(()=>[(i(!0),b(L,null,w(z.value,d=>(i(),s(r,null,{default:l(()=>[a.positionId===d.id?(i(),s(r,{key:0},{default:l(()=>[p(h(d.name?d.name:"-"),1)]),_:2},1024)):m("",!0)]),_:2},1024))),256))]),_:2},1024)):(i(),s(r,{key:1,class:"tableBig"},{default:l(()=>[p("-")]),_:1}))]),_:1})):m("",!0),e.value.checkList.includes("groupId")?(i(),s(v,{key:8,align:"left",prop:"groupId",label:"小组"},{default:l(({row:a})=>[a.groupId?(i(),s(r,{key:0,class:"tableBig"},{default:l(()=>[(i(!0),b(L,null,w(B.value,d=>(i(),s(r,null,{default:l(()=>[a.groupId===d.id?(i(),s(r,{key:0},{default:l(()=>[p(h(d.name?d.name:"-"),1)]),_:2},1024)):m("",!0)]),_:2},1024))),256))]),_:2},1024)):(i(),s(r,{key:1,class:"tableBig"},{default:l(()=>[p("-")]),_:1}))]),_:1})):m("",!0),o(v,{label:"操作",fixed:"right",width:"200",align:"left"},{default:l(a=>[o(I,{type:"primary",size:"small",plain:"",onClick:d=>ue(a.row)},{default:l(()=>[p(" 编辑 ")]),_:2},1032,["onClick"]),o(I,{type:"warning",size:"small",plain:"",onClick:d=>de(a.row)},{default:l(()=>[p(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"]),o(ke,{"current-page":k(_).page,total:k(_).total,"page-size":k(_).size,"page-sizes":k(_).sizes,layout:k(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:le,onCurrentChange:ne},null,8,["current-page","total","page-size","page-sizes","layout"])])),[[Ce,g.value.loading]])]),_:1})]),e.value.dialog.visible?(i(),s(Re,{key:0,id:e.value.dialog.id,modelValue:e.value.dialog.visible,"onUpdate:modelValue":n[11]||(n[11]=a=>e.value.dialog.visible=a),"catalogue-id":e.value.search.catalogueId,"parent-id":e.value.dialog.parentId,level:e.value.dialog.level,tree:g.value.tree,dataList:e.value.dataList,row:e.value.row,onSuccess:u},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):m("",!0),o(Me,{ref_key:"detailRef",ref:U},null,512)])])}}});typeof K=="function"&&K(O);const pa=Ue(O,[["__scopeId","data-v-e55ee55c"]]);export{pa as default};
