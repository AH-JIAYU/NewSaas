
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as X,aO as Q,r as _,X as Y,a as f,p as ee,o as C,e as le,w as s,q as L,i,b as D,s as e,f as l,g as r,ay as te,aq as P,B as ae,E as x,bc as se,_ as ie,aI as oe,aJ as ne,M as de}from"./index--d-k_wOm.js";import{a as q}from"./configuration_site_setting-DpwTyCCR.js";import re from"./index-Oet4ZGjq.js";const c=S=>(oe("data-v-279b84e6"),S=S(),ne(),S),ce={class:"step"},pe={class:"stepTop"},ue=c(()=>e("div",{class:"stepTopL"},[e("span"),e("h3",null,"核心步骤")],-1)),me={style:{display:"flex","align-items":"center","margin-left":".25rem","margin-top":".125rem",color:"#333"}},fe=c(()=>e("div",{class:"stepBom"},[e("p",{class:"detail"},"1、登录域名注册商的网站，找到管理域名的控制面板或域名管理页面。"),e("p",{class:"detail"},"2、在域名管理页面中，找到DNS设置、域名解析或类似的选项。"),e("p",{class:"detail"},[r("3、添加相应的DNS记录来完成域名解析。注意"),e("span",null,"仅支持采用CNAME "),r("记录来完成解析。")]),e("p",{class:"detail bule"},"4、顶级域名请用一级域名；租户域名、供应商域名、会员域名，为顶级域名下的二级域名，HTTPS需要配置通配符证书")],-1)),ve={class:"step"},_e=c(()=>e("p",{class:"svgRed"},[e("span",{class:"colorRed"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},[e("g",{id:"Group 18219"},[e("circle",{id:"Ellipse 84",cx:"7",cy:"7",r:"7",fill:"#FFD5D5"}),e("circle",{id:"Ellipse 83",cx:"7",cy:"7",r:"3.5",fill:"#FF8181"})])])]),r(" 未生效 ")],-1)),ge=c(()=>e("p",{class:"svgGreen"},[e("span",{class:"colorGreen"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},[e("g",{id:"Group 18219"},[e("circle",{id:"Ellipse 84",cx:"7",cy:"7",r:"7",fill:"#DDFED5"}),e("circle",{id:"Ellipse 83",cx:"7",cy:"7",r:"3.5",fill:"#01D83D"})])])]),r(" 已生效 ")],-1)),he=c(()=>e("p",{class:"svgRed"},[e("span",{class:"colorRed"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},[e("g",{id:"Group 18219"},[e("circle",{id:"Ellipse 84",cx:"7",cy:"7",r:"7",fill:"#FFD5D5"}),e("circle",{id:"Ellipse 83",cx:"7",cy:"7",r:"3.5",fill:"#FF8181"})])])]),r(" 未生效 ")],-1)),ye=c(()=>e("p",{class:"svgGreen"},[e("span",{class:"colorGreen"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},[e("g",{id:"Group 18219"},[e("circle",{id:"Ellipse 84",cx:"7",cy:"7",r:"7",fill:"#DDFED5"}),e("circle",{id:"Ellipse 83",cx:"7",cy:"7",r:"3.5",fill:"#01D83D"})])])]),r(" 已生效 ")],-1)),we=c(()=>e("p",{class:"svgRed"},[e("span",{class:"colorRed"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},[e("g",{id:"Group 18219"},[e("circle",{id:"Ellipse 84",cx:"7",cy:"7",r:"7",fill:"#FFD5D5"}),e("circle",{id:"Ellipse 83",cx:"7",cy:"7",r:"3.5",fill:"#FF8181"})])])]),r(" 未生效 ")],-1)),Ce=c(()=>e("p",{class:"svgGreen"},[e("span",{class:"colorGreen"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},[e("g",{id:"Group 18219"},[e("circle",{id:"Ellipse 84",cx:"7",cy:"7",r:"7",fill:"#DDFED5"}),e("circle",{id:"Ellipse 83",cx:"7",cy:"7",r:"3.5",fill:"#01D83D"})])])]),r(" 已生效 ")],-1)),xe=c(()=>e("p",{class:"svgRed"},[e("span",{class:"colorRed"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},[e("g",{id:"Group 18219"},[e("circle",{id:"Ellipse 84",cx:"7",cy:"7",r:"7",fill:"#FFD5D5"}),e("circle",{id:"Ellipse 83",cx:"7",cy:"7",r:"3.5",fill:"#FF8181"})])])]),r(" 未生效 ")],-1)),be=c(()=>e("p",{class:"svgGreen"},[e("span",{class:"colorGreen"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},[e("g",{id:"Group 18219"},[e("circle",{id:"Ellipse 84",cx:"7",cy:"7",r:"7",fill:"#DDFED5"}),e("circle",{id:"Ellipse 83",cx:"7",cy:"7",r:"3.5",fill:"#01D83D"})])])]),r(" 已生效 ")],-1)),De={style:{display:"flex","justify-content":"space-between",height:"30px",margin:"24px 0"}},Se={class:"update"},Ve=c(()=>e("div",{class:"title"},[e("span",{style:{"margin-right":"50px"}},"证书"),e("span",null,"私钥")],-1)),ke={class:"form"},Ee=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"81",height:"80",viewBox:"0 0 81 80",fill:"none"},[e("g",{id:"Frame"},[e("path",{id:"Vector",d:"M64.7018 37.4596C64.7018 37.4596 64.2118 21.3346 51.0768 18.1296C37.9418 14.9246 31.6118 28.7646 31.4818 29.1596C31.3518 29.5546 30.7068 29.3746 30.7068 29.3746C29.6568 28.3796 25.0268 26.0946 20.1618 29.0246C15.3018 31.9546 17.0618 37.5196 17.0618 37.5196C17.0618 37.5196 9.85676 36.9346 6.16176 48.0596C2.47176 59.1946 15.4168 62.3496 15.4168 62.3496H37.1468V50.5046H32.7968H32.4168H32.1218V50.4846C31.8718 50.4846 31.6718 50.2846 31.6718 50.0296C31.6718 49.8796 31.7518 49.7496 31.8718 49.6646L40.7768 40.2996C40.9018 40.1596 41.0768 40.0646 41.2818 40.0646C41.4918 40.0646 41.6768 40.1696 41.8018 40.3246L50.6418 49.6146C50.6568 49.6246 50.6718 49.6396 50.6868 49.6546L50.7718 49.7446H50.7418C50.7868 49.8246 50.8168 49.8946 50.8168 49.9896C50.8168 50.2696 50.5918 50.4996 50.3068 50.4996C50.2968 50.4996 50.2968 50.4896 50.2868 50.4896V50.5096H45.4968V62.3546H65.2218C65.2218 62.3546 74.6268 59.9996 75.4568 50.2896C76.2968 40.5796 64.7018 37.4596 64.7018 37.4596Z",fill:"#409EFF"})])],-1)),He=c(()=>e("div",{class:"el-upload__text"}," 支持点击或拖拽上传 ",-1)),Fe={key:0,class:"el-upload__tip"},Le={key:1,class:"el-upload__tip"},Ue=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"81",height:"80",viewBox:"0 0 81 80",fill:"none"},[e("g",{id:"Frame"},[e("path",{id:"Vector",d:"M64.7018 37.4596C64.7018 37.4596 64.2118 21.3346 51.0768 18.1296C37.9418 14.9246 31.6118 28.7646 31.4818 29.1596C31.3518 29.5546 30.7068 29.3746 30.7068 29.3746C29.6568 28.3796 25.0268 26.0946 20.1618 29.0246C15.3018 31.9546 17.0618 37.5196 17.0618 37.5196C17.0618 37.5196 9.85676 36.9346 6.16176 48.0596C2.47176 59.1946 15.4168 62.3496 15.4168 62.3496H37.1468V50.5046H32.7968H32.4168H32.1218V50.4846C31.8718 50.4846 31.6718 50.2846 31.6718 50.0296C31.6718 49.8796 31.7518 49.7496 31.8718 49.6646L40.7768 40.2996C40.9018 40.1596 41.0768 40.0646 41.2818 40.0646C41.4918 40.0646 41.6768 40.1696 41.8018 40.3246L50.6418 49.6146C50.6568 49.6246 50.6718 49.6396 50.6868 49.6546L50.7718 49.7446H50.7418C50.7868 49.8246 50.8168 49.8946 50.8168 49.9896C50.8168 50.2696 50.5918 50.4996 50.3068 50.4996C50.2968 50.4996 50.2968 50.4896 50.2868 50.4896V50.5096H45.4968V62.3546H65.2218C65.2218 62.3546 74.6268 59.9996 75.4568 50.2896C76.2968 40.5796 64.7018 37.4596 64.7018 37.4596Z",fill:"#409EFF"})])],-1)),Be=c(()=>e("div",{class:"el-upload__text"}," 支持点击或拖拽上传 ",-1)),Ge={key:0,class:"el-upload__tip"},Re={key:1,class:"el-upload__tip"},Te={style:{display:"flex",height:"30px","margin-bottom":"1.5rem"}},ze={style:{display:"flex","align-items":"center","margin-right":"4px",color:"#333"}},Me={class:"footer"},Ne=X({__name:"index",emits:["fetch-data"],setup(S,{expose:A,emit:Pe}){Q();const y=_(!1),k=_(),E=_(),v=_(!1),b=_([]),d=_({certificateContent:"",privateKeyContent:"",isChecked:!1,isAnalysis:!1,isHttpsStatus:!1,isUploadSSLCert:null}),t=_({domain:"",certificate:[],private_key:[],forceHttps:1}),V=(o,a,p)=>{new RegExp("^(?!-)[A-Za-z0-9-]{1,63}(?<!-)(?:\\.[A-Za-z0-9-]{1,63}(?<!-))*\\.[A-Za-z]{2,}$").test(a)?p():p(new Error("请输入合法的域名"))},I=_({domain:[{required:!0,message:"请输入顶级域名",trigger:"blur"},{validator:V,trigger:"submit"}],tenantDomain:[{required:!1,message:"请输入租户域名",trigger:"blur"},{validator:V,trigger:"submit"}],supplierDomain:[{required:!1,message:"请输入供应商域名",trigger:"blur"},{validator:V,trigger:"submit"}],memberDomain:[{required:!1,message:"请输入会员域名",trigger:"blur"},{validator:V,trigger:"submit"}]});async function K(o){b.value=[];try{v.value=!0,o?(t.value.domain=o.topLevelDomainName,t.value.forceHttps=o.forceHttps,b.value=[o],d.value.certificateContent=o.certificateContent,d.value.privateKeyContent=o.privateKeyContent,d.value.isAnalysis=o.isAnalysis,t.value.forceHttps=o.forceHttps,o.httpsStatus===1||o.httpsStatus===null?d.value.isHttpsStatus=!1:d.value.isHttpsStatus=!0,o.isUploadSSLCert===1||o.isUploadSSLCert===null?d.value.isUploadSSLCert=!1:d.value.isUploadSSLCert=!0,v.value=!1):b.value=[]}catch{}finally{v.value=!1}y.value=!0}const H=async()=>{k.value&&k.value.validate(async o=>{if(o)try{v.value=!0;const a=new FormData;if(t.value.domain){a.append("domain",t.value.domain),a.append("forceHttps",t.value.forceHttps);const p=await q.getTenantWebConfigKeepOnRecord({topLevelDomainName:t.value.domain}),{status:w}=await q.uploadSSLCert(a);w===1&&x({type:"success",message:"修改域名成功"}),p.status===1&&(b.value=[p.data]),v.value=!1}}catch{}finally{v.value=!1}})},U=Y().token,B=_({Token:U}),F="https://saas-api.surveysaas.com/api/tenant-web-config/uploadSSLCert",G=o=>(a,p)=>{if(a.name.endsWith(".pem"))t.value[o]=p;else return t.value[o]=[],x({type:"warning",message:"上传文件类型不正确，仅支持 .pem 格式。"})},R=o=>a=>{t.value[o]=t.value[o].filter(p=>p.uid!==a.uid),(t.value.private_key.length||t.value.certificate.length)&&(t.value.forceHttps=!1),x.success(`${o} 文件删除成功`)},T=async()=>{try{v.value=!0;const o=new FormData;t.value.certificate.length>0&&o.append("certificate",t.value.certificate[0].raw),t.value.private_key.length>0&&o.append("private_key",t.value.private_key[0].raw),o.append("forceHttps",t.value.forceHttps),o.append("domain",t.value.domain);try{const a=await se.post(F,o,{headers:{"Content-Type":"multipart/form-data",Token:U}});a.data.status===1?(x.success("上传成功"),v.value=!1,d.value.isHttpsStatus=!0):x.error(a.data.error)}catch{x.error("上传失败")}}catch{}finally{v.value=!1}},z=o=>{d.value.certificateContent&&(o==="certificate"?E.value.showEdit(d.value.certificateContent,"certificate"):E.value.showEdit(d.value.privateKeyContent,"private_key"))};function $(){b.value=[],Object.assign(t,{domain:"",certificate:[],private_key:[],forceHttps:1}),Object.assign(d,{certificateContent:"",privateKeyContent:"",isChecked:!1,isAnalysis:!1,isHttpsStatus:!1,isUploadSSLCert:null}),y.value=!1}return A({showEdit:K}),(o,a)=>{const p=ie,w=f("el-tooltip"),g=f("el-input"),u=f("el-form-item"),m=f("el-col"),Z=f("el-row"),M=f("el-form"),h=f("el-button"),O=f("el-checkbox"),N=f("el-upload"),j=f("el-switch"),W=f("el-dialog"),J=ee("loading");return C(),le(W,{modelValue:i(y),"onUpdate:modelValue":a[13]||(a[13]=n=>ae(y)?y.value=n:null),style:{"min-height":"35rem",width:"56.25rem"},title:"域名配置",onClose:$},{default:s(()=>[L((C(),D("div",null,[e("div",ce,[e("div",pe,[ue,e("div",me,[l(w,{class:"tooltips",content:"核心步骤",placement:"top"},{default:s(()=>[l(p,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})])]),fe]),e("div",ve,[l(M,{style:{margin:"0",width:"100%",height:"100%"},model:i(t),ref_key:"formRef",ref:k,rules:i(I),"label-width":"120px",inline:!1},{default:s(()=>[l(Z,{style:{margin:"0 !important"},gutter:20},{default:s(()=>[l(m,{span:12},{default:s(()=>[l(u,{label:"顶级域名",prop:"domain"},{default:s(()=>[l(g,{style:{width:"19.5rem"},modelValue:i(t).domain,"onUpdate:modelValue":a[0]||(a[0]=n=>i(t).domain=n),placeholder:"请输入顶级域名"},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{span:10},{default:s(()=>[l(u,{label:"指向域名"},{default:s(()=>[l(g,{disabled:"",style:{width:"16.375rem"},modelValue:i(t).domain,"onUpdate:modelValue":a[1]||(a[1]=n=>i(t).domain=n)},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{span:2},{default:s(()=>[_e,ge]),_:1}),l(m,{span:12},{default:s(()=>[l(u,{label:"租户后台域名",prop:"tenantDomain"},{default:s(()=>[l(g,{style:{width:"19.5rem"},modelValue:i(t).domain,"onUpdate:modelValue":a[2]||(a[2]=n=>i(t).domain=n),placeholder:"请输入租户域名"},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{span:10},{default:s(()=>[l(u,{label:"指向域名"},{default:s(()=>[l(g,{disabled:"",style:{width:"16.375rem"},modelValue:i(t).domain,"onUpdate:modelValue":a[3]||(a[3]=n=>i(t).domain=n)},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{span:2},{default:s(()=>[he,ye]),_:1}),l(m,{span:12},{default:s(()=>[l(u,{label:"供应商后台域名",prop:"supplierDomain"},{default:s(()=>[l(g,{style:{width:"19.5rem"},modelValue:i(t).domain,"onUpdate:modelValue":a[4]||(a[4]=n=>i(t).domain=n),placeholder:"请输入供应商域名"},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{span:10},{default:s(()=>[l(u,{label:"指向域名"},{default:s(()=>[l(g,{disabled:"",style:{width:"16.375rem"},modelValue:i(t).domain,"onUpdate:modelValue":a[5]||(a[5]=n=>i(t).domain=n)},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{span:2},{default:s(()=>[we,Ce]),_:1}),l(m,{span:12},{default:s(()=>[l(u,{label:"会员后台域名",prop:"memberDomain"},{default:s(()=>[l(g,{style:{width:"19.5rem"},modelValue:i(t).domain,"onUpdate:modelValue":a[6]||(a[6]=n=>i(t).domain=n),placeholder:"请输入会员域名"},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{span:10},{default:s(()=>[l(u,{label:"指向域名"},{default:s(()=>[l(g,{disabled:"",style:{width:"16.375rem"},modelValue:i(t).domain,"onUpdate:modelValue":a[7]||(a[7]=n=>i(t).domain=n)},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{span:2},{default:s(()=>[xe,be]),_:1})]),_:1})]),_:1},8,["model","rules"])]),e("div",De,[e("div",null,[l(h,{size:"default",type:"primary",onClick:H},{default:s(()=>[r("确认")]),_:1}),l(h,{style:{"margin-left":"1rem","background-color":"#aaaaaa",border:"none"},size:"default",type:"primary",onClick:H},{default:s(()=>[r("已确认")]),_:1}),l(h,{style:{"margin-left":"1rem","background-color":"#ff9d33",border:"none"},size:"default",type:"primary",onClick:H},{default:s(()=>[r("验证")]),_:1})]),l(u,{style:{width:"8.25rem"},label:"开启HTTPS上传"},{default:s(()=>[l(O,{modelValue:i(d).isChecked,"onUpdate:modelValue":a[8]||(a[8]=n=>i(d).isChecked=n),size:"large"},null,8,["modelValue"])]),_:1})]),L(e("div",Se,[Ve,e("div",ke,[l(M,{style:{display:"flex",width:"23rem",height:"10.625rem"},onSubmit:te(T,["prevent"])},{default:s(()=>[l(u,{label:""},{default:s(()=>[l(N,{class:"upload-demo",drag:"","file-list":i(t).certificate,action:F,headers:i(B),"on-change":G("certificate"),"on-remove":R("certificate"),"list-type":"text",limit:1,"auto-upload":!1},{tip:s(()=>[i(d).isUploadSSLCert?(C(),D("div",Fe,[l(h,{type:"primary",size:"default",link:"",onClick:a[9]||(a[9]=n=>z("certificate"))},{default:s(()=>[r("点击查看文件详情")]),_:1})])):(C(),D("div",Le," 请上传.PEM格式的文件 "))]),default:s(()=>[Ee,He]),_:1},8,["file-list","headers","on-change","on-remove"])]),_:1}),l(u,{label:""},{default:s(()=>[l(N,{class:"upload-demo",drag:"",action:F,headers:i(B),"file-list":i(t).private_key,"on-change":G("private_key"),"on-remove":R("private_key"),"list-type":"text",limit:1,"auto-upload":!1},{tip:s(()=>[i(d).isUploadSSLCert?(C(),D("div",Ge,[l(h,{type:"primary",size:"default",link:"",onClick:a[10]||(a[10]=n=>z("private_key"))},{default:s(()=>[r("点击查看文件详情")]),_:1})])):(C(),D("div",Re," 请上传.PEM格式的文件 "))]),default:s(()=>[Ue,Be]),_:1},8,["headers","file-list","on-change","on-remove"])]),_:1})]),_:1})])],512),[[P,i(d).isChecked]]),L(e("div",Te,[l(h,{style:{"margin-right":"1.5rem"},type:"primary",size:"default",onClick:T},{default:s(()=>[r("确认")]),_:1}),e("div",ze,[l(w,{class:"tooltips",content:"证书上传成功后,支持开启此功能",placement:"top"},{default:s(()=>[l(p,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})]),l(u,{label:""},{default:s(()=>[l(j,{modelValue:i(t).forceHttps,"onUpdate:modelValue":a[11]||(a[11]=n=>i(t).forceHttps=n),disabled:!i(t).certificate.length&&!i(t).private_key.length&&!i(d).isUploadSSLCert,"inline-prompt":"","active-value":2,"inactive-value":1,"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue","disabled"])]),_:1})],512),[[P,i(d).isChecked]]),e("div",Me,[l(h,{style:{width:"7.75rem",height:"2rem","background-color":"#fff",color:"#58aaff"},type:"primary",size:"default",onClick:a[12]||(a[12]=n=>y.value=!1)},{default:s(()=>[r("关闭")]),_:1})]),l(re,{ref_key:"fileDtailRef",ref:E},null,512)])),[[J,i(v)]])]),_:1},8,["modelValue"])}}}),$e=de(Ne,[["__scopeId","data-v-279b84e6"]]);export{$e as default};
