
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Se,r as u,aO as De,a5 as we,l as Ee,b as r,q as xe,s as B,o as i,e as E,g as e,w as t,F,v as H,f as c,aq as ze,h as p,H as x,j as k,aN as Ve,k as d,S as Ie,aP as Re,E as $e,N as Ne,aQ as Ue,aR as Ae,bc as Le,ap as Te,aI as Be,aJ as Fe,t as He,R as Pe}from"./index-ClxkxBuo.js";import{_ as Me}from"./index.vue_vue_type_style_index_0_lang-xYOpFn_y.js";import{_ as Oe}from"./index.vue_vue_type_script_setup_true_lang-B4398pD_.js";import{_ as Ye,a as j}from"./index.vue_vue_type_script_setup_true_lang-FiPTIy53.js";import{u as qe}from"./user_customer-BkziUpIB.js";import"./index.vue_vue_type_script_setup_true_lang-D7jzAX0N.js";import"./index.vue_vue_type_script_setup_true_lang-BlHEL9G7.js";import"./index-V5d8YJhg.js";import"./user_customer-CqORQ7BD.js";import"./index-Dk3kq6KX.js";import"./department-CETq9ZVj.js";import"./position_manage-D1BnaHNQ.js";import"./department-FUw-LMK2.js";import"./tenant_role-OBmAFON4.js";import"./configuration_role-B9TRRuMq.js";import"./configuration_manager-CNKKVHju.js";import"./apiLoading-P2Ci3FQj.js";import"./stagedData-CYeHD75l.js";const je=C=>(Be("data-v-af5cf3d4"),C=C(),Fe(),C),Je=je(()=>He("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Qe=Se({name:"invoice",__name:"list",setup(C){const J=qe(),P=u([]),{pagination:g,onSizeChange:Q,onCurrentChange:G,onSortChange:Ge}=De(),K=u(""),M=u([]),f=u(!0),z=u(),V=u(!1),m=u([]),I=u(!0);u(!1);const R=u("default"),$=u(!1),W=u([]),X=[{lable:"未收款",value:1},{lable:"部分收款",value:2},{lable:"已完结",value:3},{lable:"坏账",value:4}],h=u(null),_=u([]),Z=[{lable:"开票日期",value:1},{lable:"收款日期",value:2}],N=u([{label:"客户简称",prop:"tenantCustomerShortName",sortable:!0,disableCheck:!1,checked:!0},{label:"发票编号",prop:"invoiceCode",sortable:!0,disableCheck:!1,checked:!0},{label:"金额",prop:"invoiceAmount",sortable:!0,disableCheck:!1,checked:!0},{label:"手续费(税)",prop:"invoiceTax",sortable:!0,disableCheck:!1,checked:!0},{label:"实收款",prop:"actualReceipts",sortable:!0,disableCheck:!1,checked:!0},{label:"开票日期",prop:"invoiceDate",sortable:!0,disableCheck:!1,checked:!0},{label:"收款日期",prop:"paymentDate",sortable:!0,disableCheck:!1,checked:!0},{label:"状态",prop:"invoiceStatus",sortable:!0,disableCheck:!1,checked:!0},{label:"备注",prop:"remark",sortable:!0,disableCheck:!1,checked:!0}]),s=we({page:1,limit:10,tenantCustomerId:"",invoiceStatus:null,invoiceDateStart:"",invoiceDateEnd:"",paymentDateStart:"",paymentDateEnd:""});function ee(){z.value.showEdit("")}function te(o){z.value.showEdit(JSON.stringify(o))}function ae(o){Re.confirm(`确认删除「${o.tenantCustomerShortName}」这条数据吗？`,"确认信息").then(()=>{try{f.value=!0,j.delete({id:o.id}).then(()=>{f.value=!1,y(),$e.success({message:"删除成功",center:!0})})}catch{}finally{f.value=!1}}).catch(()=>{})}function le(o){W.value=o}function oe(){Object.assign(s,{page:1,limit:10,tenantCustomerId:"",invoiceStatus:null,invoiceDateStart:"",invoiceDateEnd:"",paymentDateStart:"",paymentDateEnd:""}),h.value=null,y()}const ne=o=>{h.value=o,_.value=[],s.invoiceDateStart="",s.invoiceDateEnd="",s.paymentDateStart="",s.paymentDateEnd="",b()},ie=()=>{h.value===1?(s.invoiceDateStart=_.value[0],s.invoiceDateEnd=_.value[1]):(s.paymentDateStart=_.value[0],s.paymentDateEnd=_.value[1]),b()};function se(o){Q(o).then(()=>{s.limit=o,y()})}function b(o=1){G(o).then(()=>{s.page=o,y()})}async function y(){try{f.value=!0,P.value=await J.getCustomerList();const{data:o}=await j.list(s);M.value=o.data,g.value.total=parseInt(o.total)||0,f.value=!1}catch{}finally{f.value=!1}}return Ee(()=>{N.value.forEach(o=>{o.checked&&m.value.push(o.prop)}),y()}),(o,a)=>{const re=r("el-option"),U=r("el-select"),S=r("el-form-item"),O=r("ElOption"),ue=r("el-date-picker"),Y=Ne,A=r("ElButton"),ce=r("ElFormItem"),pe=r("el-form"),de=Oe,me=r("ElDivider"),D=r("el-button"),ve=Me,fe=Ue,_e=Ae,be=r("el-row"),v=r("el-table-column"),L=Le,w=r("el-text"),ge=r("ElTableColumn"),he=r("el-empty"),ye=r("el-table"),ke=r("ElPagination"),Ce=Te,q=xe("loading");return B((i(),E("div",{class:Ie({"absolute-container":V.value})},[e(Ce,null,{default:t(()=>[e(de,{"show-toggle":!1},{default:t(({fold:l,toggle:T})=>[e(pe,{model:s.select,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:t(()=>[e(S,{label:""},{default:t(()=>[e(U,{modelValue:s.tenantCustomerId,"onUpdate:modelValue":a[0]||(a[0]=n=>s.tenantCustomerId=n),placeholder:"客户简称",clearable:"",filterable:"",onChange:a[1]||(a[1]=n=>b())},{default:t(()=>[(i(!0),E(F,null,H(P.value,n=>(i(),c(re,{key:n.tenantCustomerId,value:n.tenantCustomerId,label:n.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(S,{label:""},{default:t(()=>[e(U,{modelValue:s.invoiceStatus,"onUpdate:modelValue":a[2]||(a[2]=n=>s.invoiceStatus=n),placeholder:"发票状态",clearable:"",filterable:"",onChange:a[3]||(a[3]=n=>b())},{default:t(()=>[(i(),E(F,null,H(X,n=>e(O,{label:n.lable,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(S,{label:""},{default:t(()=>[e(U,{modelValue:h.value,"onUpdate:modelValue":a[4]||(a[4]=n=>h.value=n),placeholder:"时间类型",clearable:"",filterable:"",onChange:ne},{default:t(()=>[(i(),E(F,null,H(Z,n=>e(O,{label:n.lable,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),B(e(S,null,{default:t(()=>[e(ue,{modelValue:_.value,"onUpdate:modelValue":a[5]||(a[5]=n=>_.value=n),disabled:!h.value,"value-format":"YYYY-MM-DD hh:mm:ss",type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:"",size:"",onChange:ie},null,8,["modelValue","disabled"])]),_:2},1536),[[ze,!l]]),e(ce,null,{default:t(()=>[e(A,{type:"primary",onClick:a[6]||(a[6]=n=>b())},{icon:t(()=>[e(Y,{name:"i-ep:search"})]),default:t(()=>[p(" 筛选 ")]),_:1}),e(A,{onClick:oe},{icon:t(()=>[Je]),default:t(()=>[p(" 重置 ")]),_:1}),e(A,{link:"",onClick:T},{icon:t(()=>[e(Y,{name:l?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:t(()=>[p(" "+x(l?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),e(me,{"border-style":"dashed"}),e(be,{gutter:24},{default:t(()=>[e(ve,null,{default:t(()=>[e(D,{style:{"margin-right":"10px"},type:"primary",size:"default",onClick:ee},{default:t(()=>[p(" 新增发票 ")]),_:1})]),_:1}),e(_e,null,{default:t(()=>[e(D,{size:"default",onClick:a[7]||(a[7]=()=>{})},{default:t(()=>[p(" 导出 ")]),_:1}),e(fe,{border:I.value,"onUpdate:border":a[8]||(a[8]=l=>I.value=l),tableAutoHeight:V.value,"onUpdate:tableAutoHeight":a[9]||(a[9]=l=>V.value=l),checkList:m.value,"onUpdate:checkList":a[10]||(a[10]=l=>m.value=l),columns:N.value,"onUpdate:columns":a[11]||(a[11]=l=>N.value=l),"line-height":R.value,"onUpdate:lineHeight":a[12]||(a[12]=l=>R.value=l),stripe:$.value,"onUpdate:stripe":a[13]||(a[13]=l=>$.value=l),style:{"margin-left":"12px"},onQueryData:b},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),B((i(),c(ye,{ref_key:"tableSortRef",ref:K,style:{"margin-top":"10px"},"row-key":"id",data:M.value,border:I.value,size:R.value,stripe:$.value,onSelectionChange:le},{empty:t(()=>[e(he,{image:k(Ve),"image-size":300},null,8,["image"])]),default:t(()=>[e(v,{align:"center",type:"selection"}),m.value.includes("tenantCustomerShortName")?(i(),c(v,{key:0,prop:"tenantCustomerShortName","show-overflow-tooltip":"",align:"center",width:"100",label:"客户简称"})):d("",!0),m.value.includes("invoiceCode")?(i(),c(v,{key:1,prop:"invoiceCode","show-overflow-tooltip":"",align:"center",label:"发票编号"})):d("",!0),m.value.includes("invoiceAmount")?(i(),c(v,{key:2,prop:"invoiceAmount","show-overflow-tooltip":"",align:"center",label:"金额"},{default:t(({row:l})=>[e(L),p(x(l.invoiceAmount||0),1)]),_:1})):d("",!0),m.value.includes("invoiceTax")?(i(),c(v,{key:3,prop:"invoiceTax","show-overflow-tooltip":"",align:"center",label:"手续费(税)"},{default:t(({row:l})=>[e(L),p(x(l.invoiceTax||0),1)]),_:1})):d("",!0),m.value.includes("actualReceipts")?(i(),c(v,{key:4,prop:"actualReceipts","show-overflow-tooltip":"",align:"center",label:"实收款"},{default:t(({row:l})=>[e(L),p(x(l.actualReceipts||0),1)]),_:1})):d("",!0),m.value.includes("invoiceDate")?(i(),c(v,{key:5,prop:"invoiceDate","show-overflow-tooltip":"",align:"center",label:"开票日期"})):d("",!0),m.value.includes("paymentDate")?(i(),c(v,{key:6,prop:"paymentDate","show-overflow-tooltip":"",align:"center",label:"收款日期"})):d("",!0),m.value.includes("invoiceStatus")?(i(),c(ge,{key:7,align:"center","show-overflow-tooltip":"",prop:"invoiceStatus",label:"状态"},{default:t(({row:l})=>[l.invoiceStatus===1?(i(),c(w,{key:0,class:"mx-1",type:"info"},{default:t(()=>[p("未收款")]),_:1})):d("",!0),l.invoiceStatus===2?(i(),c(w,{key:1,class:"mx-1",type:"warning"},{default:t(()=>[p("部分收款")]),_:1})):d("",!0),l.invoiceStatus===3?(i(),c(w,{key:2,class:"mx-1",type:"success"},{default:t(()=>[p("已完结")]),_:1})):d("",!0),l.invoiceStatus===4?(i(),c(w,{key:3,class:"mx-1",type:"danger"},{default:t(()=>[p("坏账")]),_:1})):d("",!0)]),_:1})):d("",!0),m.value.includes("remark")?(i(),c(v,{key:8,prop:"remark",align:"center",label:"备注"})):d("",!0),e(v,{align:"center",fixed:"right",label:"操作",width:"170"},{default:t(({row:l})=>[e(D,{size:"small",plain:"",type:"primary",onClick:T=>te(l)},{default:t(()=>[p(" 编辑 ")]),_:2},1032,["onClick"]),e(D,{size:"small",plain:"",type:"danger",onClick:T=>ae(l)},{default:t(()=>[p(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[q,!1]]),e(ke,{"current-page":k(g).page,total:k(g).total,"page-size":k(g).size,"page-sizes":k(g).sizes,layout:k(g).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:b,onSizeChange:se},null,8,["current-page","total","page-size","page-sizes","layout"]),e(Ye,{onSuccess:y,ref_key:"editRef",ref:z},null,512)]),_:1})],2)),[[q,f.value]])}}}),vt=Pe(Qe,[["__scopeId","data-v-af5cf3d4"]]);export{vt as default};
