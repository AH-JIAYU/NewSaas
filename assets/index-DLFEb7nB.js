
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ye,aM as we,r as m,a3 as O,c as Ie,l as ke,a as i,al as Ce,o as u,b as P,f as e,w as l,i as t,am as y,F as Q,n as K,e as _,g as d,D as w,G as I,aE as k,j as C,Q as Le,L as xe,aO as Se,aP as Ve,ak as je,aK as ze,aL as Ee,C as W,P as Ne}from"./index-BViWRxgD.js";import{_ as De}from"./index.vue_vue_type_style_index_0_lang-CP5K_RCB.js";import{_ as Re}from"./index.vue_vue_type_script_setup_true_lang-BQDe_v55.js";import{_ as Ue,a as J}from"./index.vue_vue_type_script_setup_true_lang-C0Hhg4Se.js";import{u as Pe}from"./user_customer-BEb3HRAC.js";/* empty css                      */import"./user_customer-Be--lctP.js";const X=L=>(ze("data-v-92dd1796"),L=L(),Ee(),L),Fe=X(()=>W("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Me=X(()=>W("br",null,null,-1)),Te=ye({name:"RecordSurveyIndex",__name:"index",setup(L){const Y=Pe(),{getParams:Z,pagination:p,onSizeChange:ee,onCurrentChange:te}=we(),R=m(!1),F=m([]);m("");const f=m([]),x=m(!0),S=m(!1),V=m("default"),j=m(!1),z=m([{prop:"projectId",label:"项目id",sortable:!0,checked:!0},{prop:"projectName",label:"项目名称/客户简称",sortable:!0,checked:!0},{prop:"allocationType",label:"分配类型",sortable:!0,checked:!0},{prop:"passNumber",label:"通过数/提交数",sortable:!0,checked:!0},{prop:"passRate",label:"通过率",sortable:!0,checked:!0}]),s=O({memberId:"",memberGroupId:"",projectId:"",projectName:"",customerId:"",ip:"",surveyStatus:""}),M=m(),b=O({allocationTypeList:["未分配","供应商","会员组"],surveyStatusList:["完成/待审核","被甄别","配额满","安全终止","未完成"],viceStatusList:["待审","免审","过IR","时间果断","超时完成","超量完成","审核成功","审核失败","数据冻结","时间段过载","ip不一致","id重复参与"],customerList:[],vipList:[],vipGroupList:[],tenantSupplierList:[],expandedRows:[]});function le(){s.pageNo=1,U()}function ae(r){ee(r)}function T(r=1){te(r)}async function $(r){const a=b.expandedRows.indexOf(r.id);if(a!==-1?b.expandedRows.splice(a,1):b.expandedRows.push(r.id),!r.children){const g=await J.childList({projectId:r.projectId});r.children=g.data.projectScreenMemberChildInfoList}}function oe(r){M.value.showEdit(r)}const ne=Ie(()=>F.value.slice((p.value.page-1)*p.value.size,p.value.page*p.value.size));async function U(){R.value=!0;const r={...Z(),...s},{data:a}=await J.list(r);F.value=a.projectSurveyScreenInfoList,p.value.total=a.projectSurveyScreenInfoList.length,R.value=!1}function se(){Object.assign(s,{memberId:"",memberGroupId:"",projectId:"",projectName:"",customerId:"",ip:"",surveyStatus:""}),U()}return ke(async()=>{b.customerList=await Y.getCustomerList(),z.value.forEach(r=>{r.checked&&f.value.push(r.prop)}),U()}),(r,a)=>{const g=i("el-input"),h=i("el-form-item"),B=i("el-option"),G=i("el-select"),H=xe,E=i("ElButton"),re=i("ElFormItem"),ie=i("ElForm"),ue=Re,de=i("ElDivider"),pe=De,A=i("el-button"),ce=Se,me=Ve,_e=i("el-row"),v=i("el-table-column"),N=i("el-text"),D=i("ElTableColumn"),q=i("el-table"),fe=i("el-empty"),be=i("ElPagination"),ge=je,he=Ce("loading");return u(),P("div",{class:Le({"absolute-container":t(j)})},[e(ge,null,{default:l(()=>[e(ue,{"show-toggle":!1},{default:l(({fold:o,toggle:c})=>[e(ie,{model:t(s),size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:l(()=>[e(h,{label:""},{default:l(()=>[e(g,{modelValue:t(s).memberId,"onUpdate:modelValue":a[0]||(a[0]=n=>t(s).memberId=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"会员ID"},null,8,["modelValue"])]),_:1}),y(e(h,{label:""},{default:l(()=>[e(g,{modelValue:t(s).memberGroupId,"onUpdate:modelValue":a[1]||(a[1]=n=>t(s).memberGroupId=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"会员ID"},null,8,["modelValue"])]),_:2},1536),[[k,!o]]),e(h,{label:""},{default:l(()=>[e(g,{modelValue:t(s).projectId,"onUpdate:modelValue":a[2]||(a[2]=n=>t(s).projectId=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"项目ID"},null,8,["modelValue"])]),_:1}),y(e(h,{label:""},{default:l(()=>[e(g,{modelValue:t(s).name,"onUpdate:modelValue":a[3]||(a[3]=n=>t(s).name=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"项目名称"},null,8,["modelValue"])]),_:2},1536),[[k,!o]]),y(e(h,{label:""},{default:l(()=>[e(G,{modelValue:t(s).projectName,"onUpdate:modelValue":a[4]||(a[4]=n=>t(s).projectName=n),clearable:"",placeholder:"客户简称"},{default:l(()=>[(u(!0),P(Q,null,K(t(b).customerList,n=>(u(),_(B,{key:n.tenantCustomerId,value:n.tenantCustomerId,label:n.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:2},1536),[[k,!o]]),y(e(h,{label:""},{default:l(()=>[e(g,{modelValue:t(s).ip,"onUpdate:modelValue":a[5]||(a[5]=n=>t(s).ip=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"IP地址"},null,8,["modelValue"])]),_:2},1536),[[k,!o]]),y(e(h,{label:""},{default:l(()=>[e(G,{modelValue:t(s).surveyStatus,"onUpdate:modelValue":a[6]||(a[6]=n=>t(s).surveyStatus=n),clearable:"",placeholder:"调查状态"},{default:l(()=>[(u(!0),P(Q,null,K(t(b).surveyStatusList,(n,ve)=>(u(),_(B,{label:n,value:ve+1},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:2},1536),[[k,!o]]),e(re,null,{default:l(()=>[e(E,{type:"primary",onClick:a[7]||(a[7]=n=>T())},{icon:l(()=>[e(H,{name:"i-ep:search"})]),default:l(()=>[d(" 筛选 ")]),_:1}),e(E,{onClick:se},{icon:l(()=>[Fe]),default:l(()=>[d(" 重置 ")]),_:1}),e(E,{link:"",onClick:c},{icon:l(()=>[e(H,{name:o?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:l(()=>[d(" "+w(o?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),e(de,{"border-style":"dashed"}),e(_e,null,{default:l(()=>[e(pe),e(me,null,{default:l(()=>[e(A,{size:"default"},{default:l(()=>[d(" 导出 ")]),_:1}),e(ce,{border:t(x),"onUpdate:border":a[8]||(a[8]=o=>I(x)?x.value=o:null),tableAutoHeight:t(j),"onUpdate:tableAutoHeight":a[9]||(a[9]=o=>I(j)?j.value=o:null),checkList:t(f),"onUpdate:checkList":a[10]||(a[10]=o=>I(f)?f.value=o:null),columns:t(z),"onUpdate:columns":a[11]||(a[11]=o=>I(z)?z.value=o:null),"line-height":t(V),"onUpdate:lineHeight":a[12]||(a[12]=o=>I(V)?V.value=o:null),stripe:t(S),"onUpdate:stripe":a[13]||(a[13]=o=>I(S)?S.value=o:null),style:{"margin-left":"12px"},onQueryData:le},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),y((u(),_(q,{border:t(x),data:t(ne),size:t(V),stripe:t(S),"row-key":"id","expand-row-keys":t(b).expandedRows,onExpandChange:$},{empty:l(()=>[e(fe,{class:"vab-data-empty",description:"暂无数据"})]),default:l(()=>[e(v,{type:"expand",width:"55"},{default:l(o=>[e(q,{data:o.row.children,"highlight-current-row":"",class:"hide-table-header",border:"",height:"100%"},{default:l(()=>[e(v,{width:"55"}),e(v,{width:"300",prop:"memberChildName",label:"名称+ID",align:"center"},{default:l(c=>[e(N,null,{default:l(()=>[d(w(c.row.memberChildName),1)]),_:2},1024),Me,y(e(N,{type:"danger"},{default:l(()=>[d("随机id:"+w(c.row.randomIdentityId),1)]),_:2},1536),[[k,c.row.randomIdentityId]])]),_:1}),e(D,{prop:"status",label:"状态",align:"center"},{default:l(c=>[c.row.status===1?(u(),_(N,{key:0,type:"success"},{default:l(()=>[d("前置问卷通过")]),_:1})):(u(),_(N,{key:1,type:"danger"},{default:l(()=>[d("前置问卷未通过")]),_:1}))]),_:1}),e(D,{width:"200",align:"center",fixed:"right",label:"操作"},{default:l(c=>[e(E,{type:"primary",size:"small",plain:"",onClick:n=>oe(c.row)},{default:l(()=>[d(" 查看问卷详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:2},1032,["data"])]),_:1}),t(f).includes("projectId")?(u(),_(v,{key:0,width:"300",align:"center",prop:"projectId","show-overflow-tooltip":"",label:"项目ID"})):C("",!0),t(f).includes("projectName")?(u(),_(v,{key:1,align:"center",prop:"projectName","show-overflow-tooltip":"",label:"项目名称/客户简称"})):C("",!0),t(f).includes("allocationType")?(u(),_(v,{key:2,align:"center","show-overflow-tooltip":"",label:"分配类型"},{default:l(({row:o})=>[d(w(t(b).allocationTypeList[o.allocationType-1]),1)]),_:1})):C("",!0),t(f).includes("passNumber")?(u(),_(v,{key:3,align:"center","show-overflow-tooltip":"",label:"通过数/提交数"},{default:l(({row:o})=>[d(w(o.passNumber||0)+"/ "+w(o.submitNumber||0),1)]),_:1})):C("",!0),t(f).includes("passRate")?(u(),_(D,{key:4,align:"center","show-overflow-tooltip":"",prop:"passRate",label:"通过率"})):C("",!0),e(D,{align:"center","show-overflow-tooltip":"",prop:"",label:"操作",width:"200"},{default:l(({row:o})=>[e(A,{plain:"",type:"primary",size:"small",onClick:c=>$(o)},{default:l(()=>[d(w(t(b).expandedRows.includes(o.id)?"收起":"展开"),1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","data","size","stripe","expand-row-keys"])),[[he,t(R)]]),e(be,{"current-page":t(p).page,total:t(p).total,"page-size":t(p).size,"page-sizes":t(p).sizes,layout:t(p).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:ae,onCurrentChange:T},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e(Ue,{ref_key:"questionnaireDetailsRef",ref:M},null,512)],2)}}}),Qe=Ne(Te,[["__scopeId","data-v-92dd1796"]]);export{Qe as default};
