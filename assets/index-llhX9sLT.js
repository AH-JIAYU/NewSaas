
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ge,aM as he,r as d,a2 as O,D as ve,a as i,al as ye,o as u,b as U,f as e,w as l,i as t,am as y,a3 as K,a4 as Q,e as p,g as c,G as D,l as w,j as k,P as we,L as Ie,aO as ke,aP as Ce,p as Le,aK as Ve,aL as xe,F as Se,aE as C,_ as je}from"./index-BEU4aNZB.js";import{_ as Ee}from"./index.vue_vue_type_style_index_0_lang-Cht6PVGW.js";import{_ as Ne}from"./index.vue_vue_type_script_setup_true_lang-CHLxvR0y.js";import{_ as ze,a as J}from"./index.vue_vue_type_script_setup_true_lang-ngFTq-F6.js";import{u as De}from"./user_customer-Bssy1Ur8.js";/* empty css                      */import"./user_customer-gvBX7VsR.js";const Re=L=>(Ve("data-v-b7262c05"),L=L(),xe(),L),Ue=Re(()=>Se("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Pe=ge({name:"RecordSurveyIndex",__name:"index",setup(L){const W=De(),{getParams:X,pagination:h,onSizeChange:Y,onCurrentChange:Z}=he(),R=d(!1),P=d([]);d("");const m=d([]),V=d(!0),x=d(!1),S=d("default"),j=d(!1),E=d([{prop:"projectId",label:"项目id",sortable:!0,checked:!0},{prop:"projectName",label:"项目名称/客户简称",sortable:!0,checked:!0},{prop:"allocationType",label:"分配类型",sortable:!0,checked:!0},{prop:"passNumber",label:"通过数/提交数",sortable:!0,checked:!0},{prop:"passRate",label:"通过率",sortable:!0,checked:!0}]),s=O({memberId:"",memberGroupId:"",projectId:"",projectName:"",customerId:"",ip:"",surveyStatus:""}),F=d(),_=O({allocationTypeList:["未分配","供应商","会员组"],surveyStatusList:["完成/待审核","被甄别","配额满","安全终止","未完成"],viceStatusList:["待审","免审","过IR","时间果断","超时完成","超量完成","审核成功","审核失败","数据冻结","时间段过载","ip不一致","id重复参与"],customerList:[],vipList:[],vipGroupList:[],tenantSupplierList:[],expandedRows:[]});function ee(){s.pageNo=1,I()}function te(r){Y(r).then(()=>I())}function M(r=1){Z(r).then(()=>I())}async function T(r){const o=_.expandedRows.indexOf(r.id);if(o!==-1?_.expandedRows.splice(o,1):_.expandedRows.push(r.id),!r.children){const f=await J.childList({projectId:r.projectId});r.children=f.data.projectScreenMemberChildInfoList}}function le(r){F.value.showEdit(r)}async function I(){R.value=!0;const r={...X(),...s},{data:o}=await J.list(r);P.value=o.projectSurveyScreenInfoList,h.value.total=o.total,R.value=!1}function oe(){Object.assign(s,{memberId:"",memberGroupId:"",projectId:"",projectName:"",customerId:"",ip:"",surveyStatus:""}),I()}return ve(async()=>{_.customerList=await W.getCustomerList(),E.value.forEach(r=>{r.checked&&m.value.push(r.prop)}),I()}),(r,o)=>{const f=i("el-input"),b=i("el-form-item"),$=i("el-option"),B=i("el-select"),G=Ie,N=i("ElButton"),ae=i("ElFormItem"),ne=i("ElForm"),se=Ne,re=i("ElDivider"),ie=Ee,H=i("el-button"),ue=ke,de=Ce,pe=i("el-row"),g=i("el-table-column"),A=i("el-text"),z=i("ElTableColumn"),q=i("el-table"),ce=i("el-empty"),me=i("ElPagination"),_e=Le,fe=ye("loading");return u(),U("div",{class:we({"absolute-container":t(j)})},[e(_e,null,{default:l(()=>[e(se,{"show-toggle":!1},{default:l(({fold:a,toggle:v})=>[e(ne,{model:t(s),size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:l(()=>[e(b,{label:""},{default:l(()=>[e(f,{modelValue:t(s).memberId,"onUpdate:modelValue":o[0]||(o[0]=n=>t(s).memberId=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"会员ID"},null,8,["modelValue"])]),_:1}),y(e(b,{label:""},{default:l(()=>[e(f,{modelValue:t(s).memberGroupId,"onUpdate:modelValue":o[1]||(o[1]=n=>t(s).memberGroupId=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"会员ID"},null,8,["modelValue"])]),_:2},1536),[[C,!a]]),e(b,{label:""},{default:l(()=>[e(f,{modelValue:t(s).projectId,"onUpdate:modelValue":o[2]||(o[2]=n=>t(s).projectId=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"项目ID"},null,8,["modelValue"])]),_:1}),y(e(b,{label:""},{default:l(()=>[e(f,{modelValue:t(s).name,"onUpdate:modelValue":o[3]||(o[3]=n=>t(s).name=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"项目名称"},null,8,["modelValue"])]),_:2},1536),[[C,!a]]),y(e(b,{label:""},{default:l(()=>[e(B,{modelValue:t(s).projectName,"onUpdate:modelValue":o[4]||(o[4]=n=>t(s).projectName=n),clearable:"",placeholder:"客户简称"},{default:l(()=>[(u(!0),U(K,null,Q(t(_).customerList,n=>(u(),p($,{key:n.tenantCustomerId,value:n.tenantCustomerId,label:n.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:2},1536),[[C,!a]]),y(e(b,{label:""},{default:l(()=>[e(f,{modelValue:t(s).ip,"onUpdate:modelValue":o[5]||(o[5]=n=>t(s).ip=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"IP地址"},null,8,["modelValue"])]),_:2},1536),[[C,!a]]),y(e(b,{label:""},{default:l(()=>[e(B,{modelValue:t(s).surveyStatus,"onUpdate:modelValue":o[6]||(o[6]=n=>t(s).surveyStatus=n),clearable:"",placeholder:"调查状态"},{default:l(()=>[(u(!0),U(K,null,Q(t(_).surveyStatusList,(n,be)=>(u(),p($,{label:n,value:be+1},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:2},1536),[[C,!a]]),e(ae,null,{default:l(()=>[e(N,{type:"primary",onClick:o[7]||(o[7]=n=>M())},{icon:l(()=>[e(G,{name:"i-ep:search"})]),default:l(()=>[c(" 筛选 ")]),_:1}),e(N,{onClick:oe},{icon:l(()=>[Ue]),default:l(()=>[c(" 重置 ")]),_:1}),e(N,{link:"",onClick:v},{icon:l(()=>[e(G,{name:a?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:l(()=>[c(" "+D(a?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),e(re,{"border-style":"dashed"}),e(pe,null,{default:l(()=>[e(ie),e(de,null,{default:l(()=>[e(H,{size:"default"},{default:l(()=>[c(" 导出 ")]),_:1}),e(ue,{border:t(V),"onUpdate:border":o[8]||(o[8]=a=>w(V)?V.value=a:null),tableAutoHeight:t(j),"onUpdate:tableAutoHeight":o[9]||(o[9]=a=>w(j)?j.value=a:null),checkList:t(m),"onUpdate:checkList":o[10]||(o[10]=a=>w(m)?m.value=a:null),columns:t(E),"onUpdate:columns":o[11]||(o[11]=a=>w(E)?E.value=a:null),"line-height":t(S),"onUpdate:lineHeight":o[12]||(o[12]=a=>w(S)?S.value=a:null),stripe:t(x),"onUpdate:stripe":o[13]||(o[13]=a=>w(x)?x.value=a:null),style:{"margin-left":"12px"},onQueryData:ee},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),y((u(),p(q,{border:t(V),data:t(P),size:t(S),stripe:t(x),"row-key":"id","expand-row-keys":t(_).expandedRows,onExpandChange:T},{empty:l(()=>[e(ce,{class:"vab-data-empty",description:"暂无数据"})]),default:l(()=>[e(g,{type:"expand",width:"55"},{default:l(a=>[e(q,{data:a.row.children,"highlight-current-row":"",class:"hide-table-header",border:"",height:"100%"},{default:l(()=>[e(g,{width:"55"}),e(g,{width:"300",prop:"memberChildName",label:"名称+ID",align:"center"}),e(z,{prop:"status",label:"状态",align:"center"},{default:l(v=>[v.row.status===1?(u(),p(A,{key:0,type:"success"},{default:l(()=>[c("前置问卷通过")]),_:1})):(u(),p(A,{key:1,type:"danger"},{default:l(()=>[c("前置问卷未通过")]),_:1}))]),_:1}),e(z,{width:"200",align:"center",fixed:"right",label:"操作"},{default:l(v=>[e(N,{type:"primary",size:"small",plain:"",onClick:n=>le(v.row)},{default:l(()=>[c(" 查看问卷详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:2},1032,["data"])]),_:1}),t(m).includes("projectId")?(u(),p(g,{key:0,width:"300",align:"center",prop:"projectId","show-overflow-tooltip":"",label:"项目ID"})):k("",!0),t(m).includes("projectName")?(u(),p(g,{key:1,align:"center",prop:"projectName","show-overflow-tooltip":"",label:"项目名称/客户简称"})):k("",!0),t(m).includes("allocationType")?(u(),p(g,{key:2,align:"center","show-overflow-tooltip":"",label:"分配类型"},{default:l(({row:a})=>[c(D(t(_).allocationTypeList[a.allocationType-1]),1)]),_:1})):k("",!0),t(m).includes("passNumber")?(u(),p(g,{key:3,align:"center","show-overflow-tooltip":"",label:"通过数/提交数"},{default:l(({row:a})=>[c(D(a.passNumber||0)+"/ "+D(a.submitNumber||0),1)]),_:1})):k("",!0),t(m).includes("passRate")?(u(),p(z,{key:4,align:"center","show-overflow-tooltip":"",prop:"passRate",label:"通过率"})):k("",!0),e(z,{align:"center","show-overflow-tooltip":"",prop:"",label:"操作",width:"200"},{default:l(({row:a})=>[e(H,{plain:"",type:"primary",size:"small",onClick:v=>T(a)},{default:l(()=>[c(" 展开 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","data","size","stripe","expand-row-keys"])),[[fe,t(R)]]),e(me,{"current-page":t(h).page,total:t(h).total,"page-size":t(h).size,"page-sizes":t(h).sizes,layout:t(h).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:te,onCurrentChange:M},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e(ze,{ref_key:"questionnaireDetailsRef",ref:F},null,512)],2)}}}),Ae=je(Pe,[["__scopeId","data-v-b7262c05"]]);export{Ae as default};
