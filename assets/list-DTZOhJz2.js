
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as H,d as he,aO as ke,r as i,l as we,b as n,q as Ce,o as r,e as x,g as e,w as l,az as Se,s as Y,F,v as ze,h as o,H as p,f as _,j as f,aN as Ie,k as h,S as xe,bd as Te,aP as Ee,E as q,N as $e,aQ as Ae,aR as Be,bc as Ve,ap as De,aI as Ue,aJ as Fe,t as Le,aq as Me,R as Pe}from"./index-Ca4QanMD.js";import{_ as Ne}from"./index.vue_vue_type_style_index_0_lang-CAzIZnua.js";import{_ as Re}from"./index.vue_vue_type_script_setup_true_lang-BwYgqRlf.js";import{U as He}from"./user_supplier-DNkSKHU3.js";import"./user_supplier-CPSTC5iV.js";const L={list:d=>H.post("bill/getTenantSupplierBillList",d),changestatus:d=>H.post("bill/updateTenantSupplierBill",d)},Ye=d=>(Ue("data-v-ae82d8ef"),d=d(),Fe(),d),qe=Ye(()=>Le("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),je=he({name:"supplierSettlement",__name:"list",setup(d){const j=He(),{getParams:K,pagination:g,onSizeChange:O,onCurrentChange:Q}=ke(),{format:J}=Te(),G=i(""),w=i(!0);i();const T=i(!1),c=i([]),E=i(!0);i(!1);const $=i("default"),A=i(!1),W=i([]),M=["待收票","待支付","已支付","已拒绝"],X=j.payMethod,B=i([{label:"供应商ID",prop:"supplierId",sortable:!0,checked:!0},{label:"账单日期",prop:"billTime",sortable:!0,checked:!0},{label:"账单金额",prop:"billAmount",sortable:!0,checked:!0},{label:"税费",prop:"taxesFees",sortable:!0,checked:!0},{label:"实付金额",prop:"payAmount",sortable:!0,checked:!0},{label:"状态",prop:"billStatus",sortable:!0,checked:!0}]),m=i({supplierId:"",billStatus:"",time:[],beginTime:"",endTime:""}),P=i([]);function Z(s){W.value=s}function ee(){Object.assign(m.value,{supplierId:0,billStatus:0,time:[],beginTime:"",endTime:""})}function te(s){O(s).then(()=>k())}function v(s=1){Q(s).then(()=>k())}async function k(){try{w.value=!0;const s={...K(),...m.value},a=await L.list(s);P.value=a.data.tenantSupplierBillInfoList,g.value.total=a.data.total,w.value=!1}catch{}finally{w.value=!1}}async function V(s,a){a===3?Ee.prompt("请说明拒绝的理由","说明",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/.{2,}/,inputErrorMessage:"请输理由-最少2为字符"}).then(async C=>{(await L.changestatus({id:s,type:a,notes:C.value})).status===1&&q.success({message:"操作成功"}),k()}):((await L.changestatus({id:s,type:a})).status===1&&q.success({message:"操作成功"}),k())}return we(()=>{B.value.forEach(s=>{s.checked&&c.value.push(s.prop)}),k()}),(s,a)=>{const C=n("el-input"),S=n("el-form-item"),le=n("el-date-picker"),ae=n("el-option"),ne=n("el-select"),N=$e,D=n("ElButton"),oe=n("ElFormItem"),se=n("el-form"),ie=Re,ue=n("ElDivider"),re=Ne,z=n("el-button"),pe=Ae,ce=Be,R=n("el-row"),y=n("el-col"),b=n("el-table-column"),me=n("el-tag"),U=Ve,de=n("ElTableColumn"),_e=n("el-empty"),fe=n("el-table"),be=n("ElPagination"),ge=De,ve=Ce("loading");return r(),x("div",{class:xe({"absolute-container":T.value})},[e(ge,null,{default:l(()=>[e(ie,{"show-toggle":!1},{default:l(({fold:t,toggle:I})=>[e(se,{model:m.value,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:l(()=>[e(S,{label:""},{default:l(()=>[e(C,{modelValue:m.value.supplierId,"onUpdate:modelValue":a[0]||(a[0]=u=>m.value.supplierId=u),clearable:"",placeholder:"供应商ID",onKeydown:a[1]||(a[1]=Se(u=>v(),["enter"]))},null,8,["modelValue"])]),_:1}),Y(e(S,null,{default:l(()=>[e(le,{modelValue:m.value.time,"onUpdate:modelValue":a[2]||(a[2]=u=>m.value.time=u),type:"datetimerange","unlink-panels":"","range-separator":"-","start-placeholder":"创建开始日期","end-placeholder":"创建结束日期","value-format":"YYYY-MM-DD hh:mm:ss",size:"default",onChange:a[3]||(a[3]=u=>v())},null,8,["modelValue"])]),_:2},1536),[[Me,!t]]),e(S,{label:""},{default:l(()=>[e(ne,{modelValue:m.value.billStatus,"onUpdate:modelValue":a[4]||(a[4]=u=>m.value.billStatus=u),placeholder:"状态",clearable:"",filterable:"",onChange:a[5]||(a[5]=u=>v())},{default:l(()=>[(r(),x(F,null,ze(M,(u,ye)=>e(ae,{key:u,label:u,value:ye+1},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(D,{type:"primary",onClick:a[6]||(a[6]=u=>v())},{icon:l(()=>[e(N,{name:"i-ep:search"})]),default:l(()=>[o(" 筛选 ")]),_:1}),e(D,{onClick:ee},{icon:l(()=>[qe]),default:l(()=>[o(" 重置 ")]),_:1}),e(D,{disabled:"",link:"",onClick:I},{icon:l(()=>[e(N,{name:t?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:l(()=>[o(" "+p(t?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),e(ue,{"border-style":"dashed"}),e(R,{gutter:24},{default:l(()=>[e(re),e(ce,null,{default:l(()=>[e(z,{size:"default",onClick:a[7]||(a[7]=()=>{})},{default:l(()=>[o(" 导出 ")]),_:1}),e(pe,{border:E.value,"onUpdate:border":a[8]||(a[8]=t=>E.value=t),tableAutoHeight:T.value,"onUpdate:tableAutoHeight":a[9]||(a[9]=t=>T.value=t),checkList:c.value,"onUpdate:checkList":a[10]||(a[10]=t=>c.value=t),columns:B.value,"onUpdate:columns":a[11]||(a[11]=t=>B.value=t),"line-height":$.value,"onUpdate:lineHeight":a[12]||(a[12]=t=>$.value=t),stripe:A.value,"onUpdate:stripe":a[13]||(a[13]=t=>A.value=t),style:{"margin-left":"12px"},onQueryData:v},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),Y((r(),_(fe,{ref_key:"tableSortRef",ref:G,style:{"margin-top":"10px"},"row-key":"id",data:P.value,border:E.value,size:$.value,stripe:A.value,onSelectionChange:Z},{empty:l(()=>[e(_e,{image:f(Ie),"image-size":300},null,8,["image"])]),default:l(()=>[e(b,{type:"expand"},{default:l(t=>[e(R,{gutter:20,style:{margin:"10px 0"}},{default:l(()=>[e(y,{span:1}),e(y,{span:3},{default:l(()=>[o(" 付款方式: "+p(f(X)[t.row.billStatus-1].label),1)]),_:2},1024),e(y,{span:3},{default:l(()=>[o("账户名称: "+p(t.row.accountName),1)]),_:2},1024),e(y,{span:3},{default:l(()=>[o("收款账号: "+p(t.row.collectionAccount),1)]),_:2},1024),e(y,{span:3},{default:l(()=>[o("银行名称: "+p(t.row.bankName),1)]),_:2},1024),e(y,{span:3},{default:l(()=>[o("结算周期: "+p(t.row.settlementCycle),1)]),_:2},1024)]),_:2},1024)]),_:1}),c.value.includes("supplierId")?(r(),_(b,{key:0,prop:"supplierId","show-overflow-tooltip":"",align:"center",label:"供应商ID"})):h("",!0),c.value.includes("billTime")?(r(),_(b,{key:1,prop:"billTime","show-overflow-tooltip":"",align:"center",label:"账单日期"},{default:l(({row:t})=>[e(me,{effect:"plain",type:"info"},{default:l(()=>[o(p(f(J)(t.billTime)),1)]),_:2},1024)]),_:1})):h("",!0),c.value.includes("billAmount")?(r(),_(b,{key:2,prop:"billAmount","show-overflow-tooltip":"",align:"center",label:"账单金额"},{default:l(({row:t})=>[e(U),o(p(t.billAmount||0),1)]),_:1})):h("",!0),c.value.includes("taxesFees")?(r(),_(b,{key:3,prop:"taxesFees","show-overflow-tooltip":"",align:"center",label:"税费"},{default:l(({row:t})=>[e(U),o(p(t.taxesFees||0),1)]),_:1})):h("",!0),c.value.includes("payAmount")?(r(),_(b,{key:4,prop:"payAmount","show-overflow-tooltip":"",align:"center",label:"实付金额"},{default:l(({row:t})=>[e(U),o(p(t.payAmount||0),1)]),_:1})):h("",!0),c.value.includes("billStatus")?(r(),_(de,{key:5,align:"center","show-overflow-tooltip":"",prop:"",label:"状态"},{default:l(({row:t})=>[o(p(M[t.billStatus-1]),1)]),_:1})):h("",!0),e(b,{align:"center",fixed:"right",label:"操作",width:"170"},{default:l(({row:t})=>[t.billStatus===1?(r(),_(z,{key:0,size:"small",plain:"",type:"primary",onClick:I=>V(t.id,1)},{default:l(()=>[o(" 确认收票 ")]),_:2},1032,["onClick"])):t.billStatus===2?(r(),x(F,{key:1},[e(z,{size:"small",plain:"",onClick:I=>V(t.id,2)},{default:l(()=>[o(" 支付 ")]),_:2},1032,["onClick"]),e(z,{size:"small",plain:"",type:"danger",onClick:I=>V(t.id,3)},{default:l(()=>[o(" 拒绝 ")]),_:2},1032,["onClick"])],64)):(r(),x(F,{key:2},[o("- ")],64))]),_:1})]),_:1},8,["data","border","size","stripe"])),[[ve,w.value]]),e(be,{"current-page":f(g).page,total:f(g).total,"page-size":f(g).size,"page-sizes":f(g).sizes,layout:f(g).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:te,onCurrentChange:v},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1})],2)}}}),We=Pe(je,[["__scopeId","data-v-ae82d8ef"]]);export{We as default};
