
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as se}from"./index-BSF78pUv.js";import{d as de,r as k,aF as re,B as ce,$ as T,a as r,aj as ue,o as m,b as pe,l as v,f as t,w as o,g as f,ak as I,e as E,D,aw as N,aK as M,i as _,j as G,aG as S,ai as z,K as ve,az as ge,aA as me,_ as fe,p as P}from"./index-Cw-g3-rV.js";import _e from"./index-CwKEswmz.js";import he from"./index-WnNmRTCW.js";import{a as h}from"./tenantDictionary-CFiiXByZ.js";const ye=y=>(ge("data-v-a278e5d0"),y=y(),me(),y),Ce={class:"absolute-container"},be={class:"page-main"},ke={class:"custom-tree-node"},Ie=["title"],Ee={class:"code"},we={class:"actions"},De={class:"dictionary-container"},Ne={class:"dictionary-container"},Se=ye(()=>v("div",{class:"empty"},"请在左侧新增或选择一个字典",-1)),ze=[Se],R=de({name:"PagesExampleDictionary",__name:"index",setup(y){const L=k(),l=k({search:"",tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),{pagination:c,onSizeChange:U,onCurrentChange:j,onSortChange:A}=re();c.value.size=20,c.value.sizes=[20,50,100];const F=k(),a=k({loading:!1,search:{dictionaryId:"",chineseName:""},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}});function w(){l.value.loading=!0,a.value.search.dictionaryId="",h.list({chineseName:l.value.search}).then(e=>{l.value.tree=e.data,l.value.loading=!1})}ce(()=>{w()}),T(()=>l.value.search,e=>{L.value.filter(e)});function J(e,i){return e?i.label.includes(e):!0}function V(e){l.value.currentData=e,l.value.dialog.parentId=(e==null?void 0:e.id)??"",l.value.dialog.id="",l.value.dialog.visible=!0}function K(e,i){l.value.currentNode=e,l.value.currentData=i,l.value.row=JSON.stringify(i),l.value.dialog.parentId=e.parent.data.id??"",l.value.dialog.id=i.id,l.value.dialog.visible=!0}function O(e,i){S.confirm(`确认删除「${i.chineseName}」吗？`,"确认信息").then(()=>{h.delete(i.id).then(()=>{z.success({message:"删除成功",center:!0});const s=e.parent,d=s.data.children||s.data,C=d.findIndex(b=>b.id===i.id);d.splice(C,1),l.value.tree=[...l.value.tree]})})}function q(e){c.value.page=1,a.value.search.dictionaryId=e.id}T(()=>a.value.search.dictionaryId,()=>{u()});function u(){a.value.loading=!0,h.itemlist({...a.value.search,page:1,limit:10}).then(e=>{a.value.loading=!1,a.value.dataList=e.data,a.value.dataList.forEach(i=>{i.enableLoading=!1}),c.value.total=e.data.length})}function H(e){U(e).then(()=>u())}function Q(e=1){j(e).then(()=>u())}function W({prop:e,order:i}){A(e,i).then(()=>u())}function x(e){a.value.dialog.id="",a.value.dialog.visible=!0,a.value.dialog.level=1,e&&(a.value.dialog.parentId=e.id,a.value.dialog.level=Number(e.level)+1)}function X(e){a.value.row=JSON.stringify(e),a.value.dialog.id=e.id,a.value.dialog.parentId=e.parentId,a.value.dialog.visible=!0}function Y(e){S.confirm(`确认删除「${e.chineseName}」吗？`,"确认信息").then(()=>{h.itemdelete([e.id]).then(()=>{u(),z.success({message:"删除成功",center:!0})})}).catch(()=>{})}function Z(e){const i=e.map(s=>s.id);S.confirm(`确认删除选中的 ${e.length} 条数据吗？`,"确认信息").then(()=>{h.itemdelete(i).then(()=>{u(),z.success({message:"删除成功",center:!0})})}).catch(()=>{})}return(e,i)=>{const s=r("ElButton"),d=ve,C=r("ElButtonGroup"),b=r("ElInput"),ee=r("ElTree"),ae=r("ElScrollbar"),te=r("ElSpace"),g=r("ElTableColumn"),ie=r("ElTag"),le=r("ElTable"),ne=r("ElPagination"),oe=se,$=ue("loading");return m(),pe("div",Ce,[v("div",be,[t(oe,{"hide-left-side-toggle":""},{leftSide:o(()=>[t(C,{class:"btns"},{default:o(()=>[t(s,{type:"primary",class:"add",onClick:i[0]||(i[0]=n=>V())},{default:o(()=>[f(" 新增字典 ")]),_:1}),t(s,{onClick:w},{icon:o(()=>[t(d,{name:"i-ep:refresh"})]),_:1})]),_:1}),t(b,{modelValue:l.value.search,"onUpdate:modelValue":i[1]||(i[1]=n=>l.value.search=n),placeholder:"请输入关键词筛选字典",clearable:"",class:"search"},null,8,["modelValue"]),t(ae,{class:"tree"},{default:o(()=>[I((m(),E(ee,{ref_key:"dictionaryRef",ref:L,data:l.value.tree,"filter-node-method":J,"default-expand-all":"",onNodeClick:q},{default:o(({node:n,data:p})=>[v("div",ke,[v("div",{class:"label",title:n.label},D(p.chineseName),9,Ie),v("div",Ee,D(p.englishName),1),v("div",we,[t(C,null,{default:o(()=>[t(s,{type:"primary",plain:"",size:"default",onClick:N(B=>V(p),["stop"])},{icon:o(()=>[t(d,{name:"i-ep:plus"})]),_:2},1032,["onClick"]),t(s,{type:"info",plain:"",size:"default",onClick:N(B=>K(n,p),["stop"])},{icon:o(()=>[t(d,{name:"i-ep:edit"})]),_:2},1032,["onClick"]),t(s,{type:"danger",plain:"",size:"default",onClick:N(B=>O(n,p),["stop"])},{icon:o(()=>[t(d,{name:"i-ep:delete"})]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])),[[$,l.value.loading]])]),_:1})]),default:o(()=>[I(v("div",De,[t(te,{wrap:""},{default:o(()=>[t(s,{type:"primary",onClick:i[2]||(i[2]=n=>x())},{icon:o(()=>[t(d,{name:"i-ep:plus"})]),_:1}),t(s,{type:"danger",disabled:!a.value.selectionDataList.length,onClick:i[3]||(i[3]=n=>Z(a.value.selectionDataList))},{icon:o(()=>[t(d,{name:"i-ep:delete"})]),_:1},8,["disabled"]),t(b,{modelValue:a.value.search.chineseName,"onUpdate:modelValue":i[4]||(i[4]=n=>a.value.search.chineseName=n),placeholder:"请输入关键词筛选字典项",clearable:"",style:{width:"200px"}},null,8,["modelValue"]),t(s,{onClick:u},{icon:o(()=>[t(d,{name:"i-ep:search"})]),_:1})]),_:1}),I((m(),E(le,{ref_key:"dictionaryItemRef",ref:F,data:a.value.dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:W,onSelectionChange:i[5]||(i[5]=n=>a.value.selectionDataList=n),"row-key":"id","default-expand-all":""},{default:o(()=>[t(g,{type:"selection",align:"center",fixed:""}),t(g,{prop:"chineseName",label:"中文名称"}),t(g,{prop:"englishName",label:"英文名称"}),t(g,{prop:"remark",label:"备注"}),t(g,{label:"键值",align:"center",width:"150"},{default:o(n=>[t(ie,{type:"info"},{default:o(()=>[f(D(n.row.code),1)]),_:2},1024)]),_:1}),t(g,{label:"操作",width:"250",align:"center"},{default:o(n=>[t(s,{type:"primary",size:"small",plain:"",onClick:p=>x(n.row)},{default:o(()=>[f(" 新增子项 ")]),_:2},1032,["onClick"]),t(s,{type:"primary",size:"small",plain:"",onClick:p=>X(n.row)},{default:o(()=>[f(" 编辑 ")]),_:2},1032,["onClick"]),t(s,{type:"danger",size:"small",plain:"",onClick:p=>Y(n.row)},{default:o(()=>[f(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,a.value.loading]]),t(ne,{"current-page":_(c).page,total:_(c).total,"page-size":_(c).size,"page-sizes":_(c).sizes,layout:_(c).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:H,onCurrentChange:Q},null,8,["current-page","total","page-size","page-sizes","layout"])],512),[[M,a.value.search.dictionaryId]]),I(v("div",Ne,ze,512),[[M,!a.value.search.dictionaryId]])]),_:1}),l.value.dialog.visible?(m(),E(_e,{key:0,id:l.value.dialog.id,modelValue:l.value.dialog.visible,"onUpdate:modelValue":i[6]||(i[6]=n=>l.value.dialog.visible=n),row:l.value.row,"parent-id":l.value.dialog.parentId,tree:l.value.tree,onGetList:w},null,8,["id","modelValue","row","parent-id","tree"])):G("",!0),a.value.dialog.visible?(m(),E(he,{key:1,id:a.value.dialog.id,modelValue:a.value.dialog.visible,"onUpdate:modelValue":i[7]||(i[7]=n=>a.value.dialog.visible=n),"dictionary-id":a.value.search.dictionaryId,"parent-id":a.value.dialog.parentId,level:a.value.dialog.level,tree:l.value.tree,dataList:a.value.dataList,row:a.value.row,onSuccess:u},null,8,["id","modelValue","dictionary-id","parent-id","level","tree","dataList","row"])):G("",!0)])])}}});typeof P=="function"&&P(R);const Te=fe(R,[["__scopeId","data-v-a278e5d0"]]);export{Te as default};
