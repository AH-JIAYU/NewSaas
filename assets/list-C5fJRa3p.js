
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ke,r,aK as we,a1 as De,n as Ee,a as o,an as xe,ak as N,o as p,b as k,f as e,w as t,F as T,p as F,e as f,al as ze,g as u,B as w,j as D,i as g,O as Ie,aL as Ve,E as Le,J as Ue,aM as $e,aN as Re,aj as Ae,aH as Be,aI as Ne,A as Te,N as Fe}from"./index-C-YnF30x.js";import{_ as He}from"./index.vue_vue_type_script_setup_true_lang-BGf16_fj.js";import{_ as Me}from"./index.vue_vue_type_style_index_0_lang-DSHbF8JP.js";import{_ as Pe}from"./index.vue_vue_type_script_setup_true_lang-CjHEmTpl.js";import{_ as Oe,a as J}from"./index.vue_vue_type_script_setup_true_lang-CaZl-CSu.js";import{u as Ye}from"./user_customer-Ced5Fcn2.js";import"./user_customer-BCSYcchn.js";const je=b=>(Be("data-v-e79689ce"),b=b(),Ne(),b),Je=je(()=>Te("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),qe=ke({name:"invoice",__name:"list",setup(b){const q=Ye(),y=r([]),{pagination:d,onSizeChange:K,onCurrentChange:Q,onSortChange:Ke}=we(),G=r(""),H=r([]),E=r(!0),x=r(),z=r(!1),M=r([]),I=r(!0);r(!1);const V=r("default"),L=r(!1),W=r([]),X=[{lable:"未收款",value:1},{lable:"部分收款",value:2},{lable:"已完结",value:3},{lable:"坏账",value:4}],_=r(null),m=r([]),Z=[{lable:"开票日期",value:1},{lable:"收款日期",value:2}],P=r([{label:"选择渠道",prop:"ID",sortable:!0,disableCheck:!0,checked:!0}]),i=De({page:1,limit:10,tenantCustomerId:"",invoiceStatus:null,invoiceDateStart:"",invoiceDateEnd:"",paymentDateStart:"",paymentDateEnd:""});function ee(){x.value.showEdit("",y.value)}function te(s){x.value.showEdit(JSON.stringify(s),y.value)}function ae(s){Ve.confirm(`确认删除「${s.tenantCustomerShortName}」这条数据吗？`,"确认信息").then(()=>{J.delete({id:s.id}).then(()=>{v(),Le.success({message:"删除成功",center:!0})})}).catch(()=>{})}function le(s){W.value=s}function ne(){Object.assign(i,{page:1,limit:10,tenantCustomerId:"",invoiceStatus:null,invoiceDateStart:"",invoiceDateEnd:"",paymentDateStart:"",paymentDateEnd:""}),_.value=null,v()}const oe=s=>{_.value=s,m.value=[],i.invoiceDateStart="",i.invoiceDateEnd="",i.paymentDateStart="",i.paymentDateEnd=""},se=()=>{_.value===1?(i.invoiceDateStart=m.value[0],i.invoiceDateEnd=m.value[1]):(i.paymentDateStart=m.value[0],i.paymentDateEnd=m.value[1])};function ie(s){K(s).then(()=>v())}function U(s=1){Q(s).then(()=>v())}async function v(){E.value=!0,y.value=await q.getCustomerList();const{data:s}=await J.list(i);H.value=s.data,d.value.total=parseInt(s.total)||0,E.value=!1}return Ee(()=>{v()}),(s,l)=>{const re=o("el-option"),$=o("el-select"),h=o("el-form-item"),O=o("ElOption"),ue=o("el-date-picker"),Y=Ue,R=o("ElButton"),ce=o("ElFormItem"),pe=o("el-form"),me=Pe,de=o("ElDivider"),C=o("el-button"),_e=Me,ve=$e,fe=Re,ge=o("el-row"),c=o("el-table-column"),A=He,S=o("el-text"),be=o("ElTableColumn"),ye=o("el-empty"),he=o("el-table"),Ce=o("ElPagination"),Se=Ae,j=xe("loading");return N((p(),k("div",{class:Ie({"absolute-container":z.value})},[e(Se,null,{default:t(()=>[e(me,{"show-toggle":!1},{default:t(({fold:a,toggle:B})=>[e(pe,{model:i.select,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:t(()=>[e(h,{label:""},{default:t(()=>[e($,{modelValue:i.tenantCustomerId,"onUpdate:modelValue":l[0]||(l[0]=n=>i.tenantCustomerId=n),placeholder:"客户简称",clearable:"",filterable:""},{default:t(()=>[(p(!0),k(T,null,F(y.value,n=>(p(),f(re,{key:n.tenantCustomerId,value:n.tenantCustomerId,label:n.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(h,{label:""},{default:t(()=>[e($,{modelValue:i.invoiceStatus,"onUpdate:modelValue":l[1]||(l[1]=n=>i.invoiceStatus=n),placeholder:"发票状态",clearable:"",filterable:""},{default:t(()=>[(p(),k(T,null,F(X,n=>e(O,{label:n.lable,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(h,{label:""},{default:t(()=>[e($,{modelValue:_.value,"onUpdate:modelValue":l[2]||(l[2]=n=>_.value=n),placeholder:"时间类型",clearable:"",filterable:"",onChange:oe},{default:t(()=>[(p(),k(T,null,F(Z,n=>e(O,{label:n.lable,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),N(e(h,null,{default:t(()=>[e(ue,{modelValue:m.value,"onUpdate:modelValue":l[3]||(l[3]=n=>m.value=n),disabled:!_.value,"value-format":"YYYY-MM-DD hh:mm:ss",type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:"",size:"",onChange:se},null,8,["modelValue","disabled"])]),_:2},1536),[[ze,!a]]),e(ce,null,{default:t(()=>[e(R,{type:"primary",onClick:l[4]||(l[4]=n=>U())},{icon:t(()=>[e(Y,{name:"i-ep:search"})]),default:t(()=>[u(" 筛选 ")]),_:1}),e(R,{onClick:ne},{icon:t(()=>[Je]),default:t(()=>[u(" 重置 ")]),_:1}),e(R,{link:"",onClick:B},{icon:t(()=>[e(Y,{name:a?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:t(()=>[u(" "+w(a?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),e(de,{"border-style":"dashed"}),e(ge,{gutter:24},{default:t(()=>[e(_e,null,{default:t(()=>[e(C,{style:{"margin-right":"10px"},type:"primary",size:"default",onClick:ee},{default:t(()=>[u(" 新增发票 ")]),_:1})]),_:1}),e(fe,null,{default:t(()=>[e(C,{size:"default",onClick:l[5]||(l[5]=()=>{})},{default:t(()=>[u(" 导出 ")]),_:1}),e(ve,{border:I.value,"onUpdate:border":l[6]||(l[6]=a=>I.value=a),tableAutoHeight:z.value,"onUpdate:tableAutoHeight":l[7]||(l[7]=a=>z.value=a),checkList:M.value,"onUpdate:checkList":l[8]||(l[8]=a=>M.value=a),columns:P.value,"onUpdate:columns":l[9]||(l[9]=a=>P.value=a),"line-height":V.value,"onUpdate:lineHeight":l[10]||(l[10]=a=>V.value=a),stripe:L.value,"onUpdate:stripe":l[11]||(l[11]=a=>L.value=a),style:{"margin-left":"12px"},onQueryData:U},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),N((p(),f(he,{ref_key:"tableSortRef",ref:G,style:{"margin-top":"10px"},"row-key":"id",data:H.value,border:I.value,size:V.value,stripe:L.value,onSelectionChange:le},{empty:t(()=>[e(ye,{description:"暂无数据"})]),default:t(()=>[e(c,{align:"center",type:"selection"}),e(c,{prop:"tenantCustomerShortName","show-overflow-tooltip":"",align:"center",label:"客户简称"}),e(c,{prop:"invoiceCode","show-overflow-tooltip":"",align:"center",label:"发票编号"}),e(c,{prop:"invoiceAmount","show-overflow-tooltip":"",align:"center",label:"金额"},{default:t(({row:a})=>[u(w(a.invoiceAmount||0),1),e(A)]),_:1}),e(c,{prop:"invoiceTax","show-overflow-tooltip":"",align:"center",label:"手续费(税)"},{default:t(({row:a})=>[u(w(a.invoiceTax||0),1),e(A)]),_:1}),e(c,{prop:"actualReceipts","show-overflow-tooltip":"",align:"center",label:"实收款"},{default:t(({row:a})=>[u(w(a.actualReceipts||0),1),e(A)]),_:1}),e(c,{prop:"invoiceDate","show-overflow-tooltip":"",align:"center",label:"开票日期"}),e(c,{prop:"paymentDate","show-overflow-tooltip":"",align:"center",label:"收款日期"}),e(be,{align:"center","show-overflow-tooltip":"",prop:"invoiceStatus",label:"状态"},{default:t(({row:a})=>[a.invoiceStatus===1?(p(),f(S,{key:0,class:"mx-1",type:"info"},{default:t(()=>[u("未收款")]),_:1})):D("",!0),a.invoiceStatus===2?(p(),f(S,{key:1,class:"mx-1",type:"warning"},{default:t(()=>[u("部分收款")]),_:1})):D("",!0),a.invoiceStatus===3?(p(),f(S,{key:2,class:"mx-1",type:"success"},{default:t(()=>[u("已完结")]),_:1})):D("",!0),a.invoiceStatus===4?(p(),f(S,{key:3,class:"mx-1",type:"danger"},{default:t(()=>[u("坏账")]),_:1})):D("",!0)]),_:1}),e(c,{prop:"remark",align:"center",label:"备注"}),e(c,{align:"center",label:"操作",width:"170"},{default:t(({row:a})=>[e(C,{size:"small",plain:"",type:"primary",onClick:B=>te(a)},{default:t(()=>[u(" 编辑 ")]),_:2},1032,["onClick"]),e(C,{size:"small",plain:"",type:"danger",onClick:B=>ae(a)},{default:t(()=>[u(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[j,!1]]),e(Ce,{"current-page":g(d).page,total:g(d).total,"page-size":g(d).size,"page-sizes":g(d).sizes,layout:g(d).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:U,onSizeChange:ie},null,8,["current-page","total","page-size","page-sizes","layout"]),e(Oe,{onSuccess:v,ref_key:"editRef",ref:x},null,512)]),_:1})],2)),[[j,E.value]])}}}),at=Fe(qe,[["__scopeId","data-v-e79689ce"]]);export{at as default};
