
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{k as B,d as be,r as m,aD as Ve,n as xe,aE as N,a as d,q as we,s as Ce,o as x,b as L,f as e,w as l,y as i,e as W,g,z as Z,j as O,N as Ne,F as Le,t as De,E as D,$ as Ee,U as Re,au as qe,_ as Te,an as Ue,aH as Se,aI as ke,L as Oe}from"./index-D_G0Q2kt.js";import{a as z}from"./configuration_site_setting-BDGT_NpR.js";import{u as ze}from"./index-BC180RQj.js";import Ae from"./index-CjHUF6tA.js";import{u as Ie}from"./configuration_siteSetting-DORFQu4C.js";import"./clipboard-BHZmLWZa.js";import"./index-CAXRxdi9.js";import"./index-Vq8ZNA-n.js";import"./index--CS1khVc.js";const Pe={getTenantLogo:y=>B.post("tenant-logo/getTenantLogo",y),uploadLogo:y=>B.post("tenant-logo/upload",y)},h=y=>(Se("data-v-992d5ea9"),y=y(),ke(),y),Qe={class:"domainNamess"},$e={class:"domainNames"},Fe={class:"domainName"},je={key:1},He={key:0},Me=h(()=>i("span",{class:"green"},null,-1)),Be=h(()=>i("span",{style:{"margin-right":"10px"}},"已生效",-1)),We=[Me,Be],Ze={key:1},Ge=h(()=>i("span",{class:"red"},null,-1)),Je=h(()=>i("span",{style:{"margin-right":"10px"}},"未生效",-1)),Ye=[Ge,Je],Ke=h(()=>i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"80",height:"80",viewBox:"0 0 80 80",fill:"none"},[i("g",{id:"Frame"},[i("path",{id:"Vector",d:"M64.2018 37.4596C64.2018 37.4596 63.7118 21.3346 50.5768 18.1296C37.4418 14.9246 31.1118 28.7646 30.9818 29.1596C30.8518 29.5546 30.2068 29.3746 30.2068 29.3746C29.1568 28.3796 24.5268 26.0946 19.6618 29.0246C14.8018 31.9546 16.5618 37.5196 16.5618 37.5196C16.5618 37.5196 9.35676 36.9346 5.66176 48.0596C1.97176 59.1946 14.9168 62.3496 14.9168 62.3496H36.6468V50.5046H32.2968H31.9168H31.6218V50.4846C31.3718 50.4846 31.1718 50.2846 31.1718 50.0296C31.1718 49.8796 31.2518 49.7496 31.3718 49.6646L40.2768 40.2996C40.4018 40.1596 40.5768 40.0646 40.7818 40.0646C40.9918 40.0646 41.1768 40.1696 41.3018 40.3246L50.1418 49.6146C50.1568 49.6246 50.1718 49.6396 50.1868 49.6546L50.2718 49.7446H50.2418C50.2868 49.8246 50.3168 49.8946 50.3168 49.9896C50.3168 50.2696 50.0918 50.4996 49.8068 50.4996C49.7968 50.4996 49.7968 50.4896 49.7868 50.4896V50.5096H44.9968V62.3546H64.7218C64.7218 62.3546 74.1268 59.9996 74.9568 50.2896C75.7968 40.5796 64.2018 37.4596 64.2018 37.4596Z",fill:"#409EFF"})])],-1)),Xe=h(()=>i("div",{class:"el-upload__text"}," 支持点击拖拽上传 ",-1)),el=h(()=>i("div",{style:{color:"#47a2ff"},class:"el-upload__text"}," 支持上传JPG/JPEG/PNG图片，小于10MB ",-1)),ll=["src"],al={class:"exchangeRate"},tl=h(()=>i("div",{class:"left"},[i("div",{style:{width:"119.86px"},class:"top"},"1 美元 (USD)      =")],-1)),ol={class:"right"},nl={class:"bottom"},sl=be({name:"site_setting",__name:"list",setup(y){const G=[{label:"美元",value:"USD"},{label:"人民币",value:"CNY"}],f=m(),A=m(),J=Ie(),p=Ve(),I=m(),Y="https://saas-api.surveysaas.com/api/tenant-logo/upload",{toClipboard:K}=ze(),P=m("基本设置"),b=m(!1),V=m(),Q=m(!1),E=m(),a=m({id:"",registerOffOrOn:!0,registerExamineOffOrOn:!1,keyWords:"",description:"",webName:"",topLevelDomainName:"",defaultPriceRatio:null,taxRate:null,minimumAmount:null,phone:"",email:"",qqCode:"",address:"",projectOutAlias:""}),w=m({webName:[{required:!0,message:"请输入网站名称",trigger:"blur"}],topLevelDomainName:[{required:!1,message:"请输入顶级域名",trigger:"blur"},{validator:(o,t,u)=>{new RegExp("^(?!-)[A-Za-z0-9-]{1,63}(?<!-)(?:\\.[A-Za-z0-9-]{1,63}(?<!-))*\\.[A-Za-z]{2,}$").test(t)?u():u(new Error("请输入合法的域名"))},trigger:"submit"}],phone:[{required:!1,trigger:"blur",message:"请输入手机号"},{validator:(o,t,u)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(a.value.phone)?u():u(new Error("请输入合法手机号"))},trigger:"blur"}],email:[{required:!1,trigger:"blur",message:"请输入邮箱"},{validator:(o,t,u)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a.value.email)?u():u(new Error("请输入合法邮箱"))},trigger:"blur"}],qqCode:[{required:!1,trigger:"blur",message:"请输入QQ号码"},{validator:(o,t,u)=>{/^[1-9][0-9]{4,14}$/.test(t)?u():u(new Error("请输入合法QQ号（5到15位数字，不能以0开头）"))},trigger:"blur"}],address:[{required:!1,message:"请输入内容",trigger:"blur"},{max:50,message:"最多输入 50 字",trigger:"blur"}],exchangeRate:[{required:!1,message:"请输入美元汇率",trigger:"blur"},{pattern:/^(?!0(\.0+)?$)(\d+(\.\d{1,2})?)$/,message:"请输入一个有效的数字，不能小于0，最多保留两位小数",trigger:"blur"}]});xe(()=>{b.value=!0,p.logo&&(c.value=[{name:"logo",url:p.logo}]),R(),b.value=!1});async function R(){try{const{data:o}=await z.list();if(J.setSiteConfig(o),o&&(a.value=o||a.value,A.value=o.currencyType,f.value=N.local.get("currencyTypeRes"),o.currencyType==="USD"&&(f.value=o.exchangeRate),a.value.minimumAmount===0&&(a.value.minimumAmount=null),E.value=a.value,p.originalExchangeRate=a.value.exchangeRate,p.setWebName(o.webName),p.setDescription(o.description),p.setkeyWords(o.keyWords)),a.value.topLevelDomainName!==""&&a.value.topLevelDomainName!==null){const t=await z.getTenantWebConfigQueryAnalysis({url:a.value.topLevelDomainName});Q.value=t.data.success,a.value.isAnalysis=t.data.success}}catch{}finally{b.value=!1}}const X=async()=>{var t;c.value=[];const o=await Pe.getTenantLogo();o.data&&(p.setLogo(o.data.logoUrl),c.value.push({name:"file",url:(t=o==null?void 0:o.data)==null?void 0:t.logoUrl}))},ee=()=>{I.value.showEdit(E.value)},le=()=>{const o=a.value.personalizedDomainName;K(o),D({type:"success",message:"复制成功"})},ae=p.token,te=m({Token:ae}),$=m(""),q=m(!1),F=m(),c=m([]),oe=async()=>{D.success({message:"删除成功",center:!0}),p.delLogo()},ne=(o,t)=>(t.value=t.filter(u=>u.uid!==o.uid),!0),se=(o,t)=>{const u=[".jpg",".jpeg",".png"],_=o.name.slice((o.name.lastIndexOf(".")-1>>>0)+2).toLowerCase();if(!u.includes(`.${_}`))return c.value=[],Ee(()=>{c.value=[]}),D({type:"warning",message:"上传文件类型不正确，仅支持 jpg、jpeg 和 png 格式。"})},ue=(o,t)=>{o.status===-1?(Re.error(o.error,{zIndex:2e3}),c.value=c.value.filter(u=>u.name!==t.name)):X()},re=async()=>{D.warning({message:"只能上传一个,删除原文件后重新上传",center:!0})},ie=o=>{$.value=o.url,q.value=!0},de=o=>{o&&(A.value=o)};function T(){(a.value.email===""||a.value.email===null)&&(w.value.email=[],V.value.clearValidate("email")),(a.value.phone===""||a.value.phone===null)&&(w.value.phone=[],V.value.clearValidate("phone")),(a.value.qqCode===""||a.value.qqCode===null)&&(w.value.qqCode=[],V.value.clearValidate("qqCode")),(a.value.topLevelDomainName===""||a.value.topLevelDomainName===null)&&(w.value.topLevelDomainName=[],V.value.clearValidate("topLevelDomainName")),V.value&&V.value.validate(async o=>{if(o)try{b.value=!0,a.value.topLevelDomainName&&(a.value.topLevelDomainName=a.value.topLevelDomainName.replace(/^https?:\/\//,"")),c.value.length&&F.value.submit(),a.value.currencyType==="USD"?(p.currencyType=1,a.value.exchangeRate=f.value,N.local.remove("currencyTypeRes"),N.local.set("currencyTypeRes",f.value.toString())):(p.currencyType=2,f.value&&(N.local.remove("currencyTypeRes"),N.local.set("currencyTypeRes",f.value.toString()),a.value.exchangeRate=f.value,a.value.exchangeRate=(1/a.value.exchangeRate).toFixed(2).toString()));const t=await z.edit(a.value);b.value=!1,t.status===1&&(await p.getCurrencyType(),R(),D.success({message:"修改成功",center:!0}))}catch(t){console.log("error",t)}finally{b.value=!1}})}return(o,t)=>{var M;const u=qe,_=Te,U=d("el-tooltip"),j=d("el-switch"),r=d("el-form-item"),s=d("el-col"),v=d("el-input"),H=d("el-text"),C=d("el-button"),me=d("el-upload"),pe=d("el-dialog"),ce=d("ElFormItem"),S=d("el-row"),k=d("el-tab-pane"),ve=d("el-option"),fe=d("el-select"),_e=d("el-form"),ge=d("el-tabs"),ye=Ue,he=we("loading");return Ce((x(),L("div",null,[e(u,{title:"站点设置管理"}),e(ye,null,{default:l(()=>[e(ge,{modelValue:P.value,"onUpdate:modelValue":t[16]||(t[16]=n=>P.value=n)},{default:l(()=>[e(_e,{ref_key:"formRef",ref:V,model:a.value,rules:w.value,"label-width":"100px","label-position":"right",inline:!1},{default:l(()=>[e(k,{label:"基础设置",name:"基本设置"},{default:l(()=>[e(S,{gutter:20},{default:l(()=>[e(s,{span:3},{default:l(()=>[e(r,{label:"注册开关"},{default:l(()=>[i("div",Qe,[e(U,{class:"tooltips",content:"注册开关、注册审核，进行变更后，需要点击【确认】才可生效",placement:"top"},{default:l(()=>[e(_,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})]),e(j,{modelValue:a.value.registerOffOrOn,"onUpdate:modelValue":t[0]||(t[0]=n=>a.value.registerOffOrOn=n),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:6},{default:l(()=>[e(r,{label:"注册审核"},{default:l(()=>[e(j,{modelValue:a.value.registerExamineOffOrOn,"onUpdate:modelValue":t[1]||(t[1]=n=>a.value.registerExamineOffOrOn=n),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(r,{label:"网站名称",prop:"webName"},{default:l(()=>[e(v,{modelValue:a.value.webName,"onUpdate:modelValue":t[2]||(t[2]=n=>a.value.webName=n),style:{width:"22.4375rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(r,{label:"网站关键字"},{default:l(()=>[i("div",$e,[e(U,{class:"tooltips",content:"设定网站关键字，在浏览器中输入该关键字即可搜索到该网站",placement:"top"},{default:l(()=>[e(_,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})]),e(v,{modelValue:a.value.keyWords,"onUpdate:modelValue":t[3]||(t[3]=n=>a.value.keyWords=n),style:{width:"22.4375rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(r,{label:"网站描述"},{default:l(()=>[i("div",Fe,[e(U,{class:"tooltips",content:"描述该网址功能及意义，可对外宣传使用",placement:"top"},{default:l(()=>[e(_,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})]),e(v,{modelValue:a.value.description,"onUpdate:modelValue":t[4]||(t[4]=n=>a.value.description=n),style:{width:"22.4375rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(r,{label:"默认官网域名",prop:""},{default:l(()=>[a.value.personalizedDomainName?(x(),W(H,{key:0,class:"mx-1"},{default:l(()=>[g(Z(a.value.personalizedDomainName),1)]),_:1})):O("",!0),e(C,{class:"copy",type:"primary",plain:"",size:"small",onClick:le},{default:l(()=>[g("复制")]),_:1})]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(r,{label:"域名配置",prop:"topLevelDomainName"},{default:l(()=>[a.value.topLevelDomainName?(x(),W(H,{key:0,class:"mx-1"},{default:l(()=>[g(Z(a.value.topLevelDomainName),1)]),_:1})):O("",!0),a.value.topLevelDomainName?(x(),L("div",je,[Q.value?(x(),L("div",He,We)):(x(),L("div",Ze,Ye))])):O("",!0),e(C,{class:"copy",onClick:ee,type:"primary",size:"small",plain:""},{default:l(()=>[g("CNAME配置")]),_:1})]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(ce,{style:{display:"flex","justify-content":"center"},label:"网址Logo"},{default:l(()=>[e(me,{class:Ne({hide_box:c.value.length}),ref_key:"uploadRef",ref:F,drag:"","file-list":c.value,"onUpdate:fileList":t[5]||(t[5]=n=>c.value=n),headers:te.value,action:Y,"auto-upload":!1,"list-type":"picture-card",limit:1,"on-preview":ie,"on-remove":oe,"on-success":ue,"on-change":se,"on-exceed":re,"before-remove":ne},{default:l(()=>[Ke,Xe,el]),_:1},8,["class","file-list","headers"]),e(pe,{modelValue:q.value,"onUpdate:modelValue":t[6]||(t[6]=n=>q.value=n),style:{"z-index":"1000",transform:"translate(0)",position:"relative"}},{default:l(()=>[i("img",{"w-full":"",src:$.value,alt:"Preview Image"},null,8,ll)]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(r,{label:"外包项目别名"},{default:l(()=>[e(v,{modelValue:a.value.projectOutAlias,"onUpdate:modelValue":t[7]||(t[7]=n=>a.value.projectOutAlias=n),style:{width:"22.4375rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(r,null,{default:l(()=>[e(C,{type:"primary",onClick:T},{default:l(()=>[g(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{label:"高级设置",name:"高级设置"},{default:l(()=>[e(S,{gutter:20},{default:l(()=>[e(s,{span:24},{default:l(()=>[e(r,{label:"默认币种",prop:""},{default:l(()=>[e(fe,{modelValue:a.value.currencyType,"onUpdate:modelValue":t[8]||(t[8]=n=>a.value.currencyType=n),"value-key":"",style:{width:"22.4375rem"},placeholder:"请选择币种",clearable:"",filterable:"",onChange:de},{default:l(()=>[(x(),L(Le,null,De(G,n=>e(ve,{key:n.value,label:n.label,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(r,{style:{display:"flex"},label:"美元汇率",prop:"exchangeRate"},{default:l(()=>[i("div",null,[i("div",al,[tl,i("div",ol,[i("div",nl,[e(v,{modelValue:f.value,"onUpdate:modelValue":t[9]||(t[9]=n=>f.value=n),style:{width:"7.4375rem"},placeholder:"请输入数值",clearable:""},null,8,["modelValue"]),g(" 人民币 (CNY) ")])])])])]),_:1})]),_:1}),e(s,{span:24}),e(s,{span:24},{default:l(()=>[e(r,{label:"最低结算金额",prop:""},{default:l(()=>[e(v,{modelValue:a.value.minimumAmount,"onUpdate:modelValue":t[10]||(t[10]=n=>a.value.minimumAmount=n),modelModifiers:{number:!0},style:{width:"22.4375rem"},placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(r,{label:"供应商税点",prop:""},{default:l(()=>[e(v,{modelValue:a.value.taxRate,"onUpdate:modelValue":t[11]||(t[11]=n=>a.value.taxRate=n),modelModifiers:{number:!0},style:{width:"22.4375rem"},placeholder:""},{append:l(()=>[g("%")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(r,null,{default:l(()=>[e(C,{type:"primary",onClick:T},{default:l(()=>[g(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{label:"联系我们",name:"联系我们"},{default:l(()=>[e(S,{gutter:20},{default:l(()=>[e(s,{span:24},{default:l(()=>[e(r,{label:"电子邮箱",prop:"email"},{default:l(()=>[e(v,{style:{width:"22.4375rem"},modelValue:a.value.email,"onUpdate:modelValue":t[12]||(t[12]=n=>a.value.email=n),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(r,{label:"手机号码",prop:"phone"},{default:l(()=>[e(v,{style:{width:"22.4375rem"},modelValue:a.value.phone,"onUpdate:modelValue":t[13]||(t[13]=n=>a.value.phone=n),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(r,{label:"QQ号码",prop:"qqCode"},{default:l(()=>[e(v,{style:{width:"22.4375rem"},modelValue:a.value.qqCode,"onUpdate:modelValue":t[14]||(t[14]=n=>a.value.qqCode=n),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(r,{label:"公司地址",prop:"address"},{default:l(()=>[e(v,{style:{width:"22.4375rem"},modelValue:a.value.address,"onUpdate:modelValue":t[15]||(t[15]=n=>a.value.address=n),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(r,null,{default:l(()=>[e(C,{type:"primary",onClick:T},{default:l(()=>[g("确认")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]),_:1}),e(Ae,{ref_key:"recordRef",ref:I,onFetchData:R,personalizedDomainName:(M=E.value)==null?void 0:M.personalizedDomainName},null,8,["personalizedDomainName"])])),[[he,b.value]])}}}),bl=Oe(sl,[["__scopeId","data-v-992d5ea9"]]);export{bl as default};
