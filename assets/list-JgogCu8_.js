
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as I,d as oe,a1 as ne,r as d,l as se,b as i,q as ue,s as ie,o as U,e as k,g as e,w as l,h as _,H,S as re,t as m,E as x,a0 as de,aB as me,ap as pe,aI as ve,aJ as fe,R as ce}from"./index-I0CHLqnn.js";import{a as O,s as _e}from"./index-Dk2Q42_X.js";import{u as ge}from"./index-CCKR2kj8.js";import"./index-Cv6AjbxM.js";import"./index-BnkSC4Ci.js";import"./clipboard-C0AgS22l.js";const ye={getTenantLogo:v=>I.post("tenant-logo/getTenantLogo",v),uploadLogo:v=>I.post("tenant-logo/upload",v)},g=v=>(ve("data-v-821e74a2"),v=v(),fe(),v),Ve={key:0},be=g(()=>m("span",{class:"green"},null,-1)),he=g(()=>m("span",{style:{"margin-right":"10px"}},"已生效",-1)),we=[be,he],xe={key:1},Ce=g(()=>m("span",{class:"red"},null,-1)),Le=g(()=>m("span",{style:{"margin-right":"10px"}},"未生效",-1)),Ne=[Ce,Le],De=g(()=>m("span",{style:{"margin-left":"1.5625rem",color:"#606266","font-size":"14px"}},"网址Logo",-1)),Ee=g(()=>m("svg",{xmlns:"http://www.w3.org/2000/svg",width:"80",height:"80",viewBox:"0 0 80 80",fill:"none"},[m("g",{id:"Frame"},[m("path",{id:"Vector",d:"M64.2018 37.4596C64.2018 37.4596 63.7118 21.3346 50.5768 18.1296C37.4418 14.9246 31.1118 28.7646 30.9818 29.1596C30.8518 29.5546 30.2068 29.3746 30.2068 29.3746C29.1568 28.3796 24.5268 26.0946 19.6618 29.0246C14.8018 31.9546 16.5618 37.5196 16.5618 37.5196C16.5618 37.5196 9.35676 36.9346 5.66176 48.0596C1.97176 59.1946 14.9168 62.3496 14.9168 62.3496H36.6468V50.5046H32.2968H31.9168H31.6218V50.4846C31.3718 50.4846 31.1718 50.2846 31.1718 50.0296C31.1718 49.8796 31.2518 49.7496 31.3718 49.6646L40.2768 40.2996C40.4018 40.1596 40.5768 40.0646 40.7818 40.0646C40.9918 40.0646 41.1768 40.1696 41.3018 40.3246L50.1418 49.6146C50.1568 49.6246 50.1718 49.6396 50.1868 49.6546L50.2718 49.7446H50.2418C50.2868 49.8246 50.3168 49.8946 50.3168 49.9896C50.3168 50.2696 50.0918 50.4996 49.8068 50.4996C49.7968 50.4996 49.7968 50.4896 49.7868 50.4896V50.5096H44.9968V62.3546H64.7218C64.7218 62.3546 74.1268 59.9996 74.9568 50.2896C75.7968 40.5796 64.2018 37.4596 64.2018 37.4596Z",fill:"#409EFF"})])],-1)),Ue=g(()=>m("div",{class:"el-upload__text"}," 支持点击拖拽上传 ",-1)),ke=g(()=>m("div",{style:{color:"#47a2ff"},class:"el-upload__text"}," 支持上传JPG/JPEG/PNG图片，小于10MB ",-1)),Oe=["src"],Pe=oe({name:"site_setting",__name:"list",setup(v){const f=ne(),P=d(),S="https://saas-api.surveysaas.com/api/tenant-logo/upload",{toClipboard:M}=ge(),z=d("基本设置"),y=d(!1),V=d(),R=d(!1),q=d(),a=d({id:"",registerOffOrOn:!0,registerExamineOffOrOn:!1,keyWords:"",description:"",webName:"",topLevelDomainName:"",defaultPriceRatio:null,taxRate:null,minimumAmount:null,phone:"",email:"",qqCode:"",address:""}),w=d({webName:[{required:!0,message:"请输入网站名称",trigger:"blur"}],topLevelDomainName:[{required:!1,message:"请输入顶级域名",trigger:"submit"},{validator:(n,t,r)=>{new RegExp("^(?!-)[A-Za-z0-9-]{1,63}(?<!-)(?:\\.[A-Za-z0-9-]{1,63}(?<!-))*\\.[A-Za-z]{2,}$").test(t)?r():r(new Error("请输入合法的域名"))},trigger:"submit"}],phone:[{required:!1,trigger:"submit",message:"请输入手机号"},{validator:(n,t,r)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(a.value.phone)?r():r(new Error("请输入合法手机号"))},trigger:"submit"}],email:[{required:!1,trigger:"submit",message:"请输入邮箱"},{validator:(n,t,r)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a.value.email)?r():r(new Error("请输入合法邮箱"))},trigger:"submit"}]});se(()=>{y.value=!0,f.logo&&(c.value=[{name:"logo",url:f.logo}]),C(),y.value=!1});async function C(){try{const{data:n}=await O.list();if(n&&(a.value=n||a.value,q.value=a.value,f.setWebName(n.webName),f.setDescription(n.description),f.setkeyWords(n.keyWords)),a.value.topLevelDomainName!==""&&a.value.topLevelDomainName!==null){const t=await O.getTenantWebConfigQueryAnalysis({url:a.value.topLevelDomainName});R.value=t.data.success}}catch{}finally{y.value=!1}}const W=async()=>{var t;c.value=[];const n=await ye.getTenantLogo();n.data&&(f.setLogo(n.data.logoUrl),c.value.push({name:"file",url:(t=n==null?void 0:n.data)==null?void 0:t.logoUrl}))},B=()=>{P.value.showEdit(q.value)},Z=()=>{const n=a.value.personalizedDomainName;M(n),x({type:"success",message:"复制成功"})},$=f.token,F=d({Token:$}),A=d(""),L=d(!1),c=d([]),G=async()=>{x.success({message:"删除成功",center:!0}),f.delLogo()},J=(n,t)=>{n.status===-1?(de.error(n.error,{zIndex:2e3}),c.value=c.value.filter(r=>r.name!==t.name)):W()},Q=async()=>{x.warning({message:"只能上传一个,删除原文件后重新上传",center:!0})},j=n=>{A.value=n.url,L.value=!0};function N(){(a.value.email===""||a.value.email===null)&&(w.value.email=[],V.value.clearValidate("email")),(a.value.phone===""||a.value.phone===null)&&(w.value.phone=[],V.value.clearValidate("phone")),(a.value.topLevelDomainName===""||a.value.topLevelDomainName===null)&&(w.value.topLevelDomainName=[],V.value.clearValidate("topLevelDomainName")),V.value&&V.value.validate(async n=>{if(n)try{y.value=!0,a.value.topLevelDomainName&&(a.value.topLevelDomainName=a.value.topLevelDomainName.replace(/^https?:\/\//,""));const t=await O.edit(a.value);y.value=!1,t.status===1&&(C(),x.success({message:"修改成功",center:!0}))}catch(t){console.log("error",t)}finally{y.value=!1}})}return(n,t)=>{const r=me,b=i("el-switch"),u=i("el-form-item"),s=i("el-col"),p=i("el-input"),T=i("el-text"),h=i("el-button"),K=i("el-upload"),X=i("el-dialog"),Y=i("ElFormItem"),D=i("el-row"),E=i("el-tab-pane"),ee=i("el-form"),le=i("el-tabs"),ae=pe,te=ue("loading");return ie((U(),k("div",null,[e(r,{title:"站点设置管理"}),e(ae,null,{default:l(()=>[e(le,{modelValue:z.value,"onUpdate:modelValue":t[13]||(t[13]=o=>z.value=o)},{default:l(()=>[e(ee,{ref_key:"formRef",ref:V,model:a.value,rules:w.value,"label-width":"100px","label-position":"right",inline:!1},{default:l(()=>[e(E,{label:"基础设置",name:"基本设置"},{default:l(()=>[e(D,{gutter:20},{default:l(()=>[e(s,{span:3},{default:l(()=>[e(u,{label:"注册开关"},{default:l(()=>[e(b,{modelValue:a.value.registerOffOrOn,"onUpdate:modelValue":t[0]||(t[0]=o=>a.value.registerOffOrOn=o),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:6},{default:l(()=>[e(u,{label:"注册审核"},{default:l(()=>[e(b,{modelValue:a.value.registerExamineOffOrOn,"onUpdate:modelValue":t[1]||(t[1]=o=>a.value.registerExamineOffOrOn=o),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"网站名称",prop:"webName"},{default:l(()=>[e(p,{modelValue:a.value.webName,"onUpdate:modelValue":t[2]||(t[2]=o=>a.value.webName=o),style:{width:"18rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"网站关键字"},{default:l(()=>[e(p,{modelValue:a.value.keyWords,"onUpdate:modelValue":t[3]||(t[3]=o=>a.value.keyWords=o),style:{width:"18rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"网站描述"},{default:l(()=>[e(p,{modelValue:a.value.description,"onUpdate:modelValue":t[4]||(t[4]=o=>a.value.description=o),style:{width:"18rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"个性化域名",prop:""},{default:l(()=>[e(T,{class:"mx-1"},{default:l(()=>[_(H(a.value.personalizedDomainName),1)]),_:1}),e(h,{class:"copy",type:"primary",link:"",onClick:Z},{default:l(()=>[_("复制")]),_:1})]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"顶级域名",prop:"topLevelDomainName"},{default:l(()=>[e(T,null,{default:l(()=>[_(H(a.value.topLevelDomainName),1)]),_:1}),R.value?(U(),k("div",Ve,we)):(U(),k("div",xe,Ne)),e(h,{class:"copy",onClick:B,type:"primary",link:""},{default:l(()=>[_("CNAME配置")]),_:1})]),_:1})]),_:1}),e(s,{style:{"margin-bottom":"1rem"},span:24},{default:l(()=>[De]),_:1}),e(s,{span:24},{default:l(()=>[e(Y,{style:{display:"flex","justify-content":"center","align-items":"center"},label:""},{default:l(()=>[e(K,{class:re({hide_box:c.value.length}),drag:"","file-list":c.value,"onUpdate:fileList":t[5]||(t[5]=o=>c.value=o),headers:F.value,action:S,"list-type":"picture-card",limit:1,"on-preview":j,"on-remove":G,"on-success":J,"on-exceed":Q},{default:l(()=>[Ee,Ue,ke]),_:1},8,["class","file-list","headers"]),e(X,{modelValue:L.value,"onUpdate:modelValue":t[6]||(t[6]=o=>L.value=o),style:{"z-index":"1000",transform:"translate(0)",position:"relative"}},{default:l(()=>[m("img",{"w-full":"",src:A.value,alt:"Preview Image"},null,8,Oe)]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,null,{default:l(()=>[e(h,{type:"primary",onClick:N},{default:l(()=>[_(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{label:"高级设置",name:"高级设置"},{default:l(()=>[e(D,{gutter:20},{default:l(()=>[e(s,{span:24},{default:l(()=>[e(u,{label:"最低结算金额",prop:""},{default:l(()=>[e(p,{modelValue:a.value.minimumAmount,"onUpdate:modelValue":t[7]||(t[7]=o=>a.value.minimumAmount=o),modelModifiers:{number:!0},style:{width:"18rem"},placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"供应商税点",prop:""},{default:l(()=>[e(p,{modelValue:a.value.taxRate,"onUpdate:modelValue":t[8]||(t[8]=o=>a.value.taxRate=o),modelModifiers:{number:!0},style:{width:"18rem"},placeholder:""},{append:l(()=>[_("%")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,null,{default:l(()=>[e(h,{type:"primary",onClick:N},{default:l(()=>[_(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{label:"联系我们",name:"联系我们"},{default:l(()=>[e(D,{gutter:20},{default:l(()=>[e(s,{span:24},{default:l(()=>[e(u,{label:"电子邮箱",prop:"email"},{default:l(()=>[e(p,{style:{width:"18rem"},modelValue:a.value.email,"onUpdate:modelValue":t[9]||(t[9]=o=>a.value.email=o),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"手机号码",prop:"phone"},{default:l(()=>[e(p,{style:{width:"18rem"},modelValue:a.value.phone,"onUpdate:modelValue":t[10]||(t[10]=o=>a.value.phone=o),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"QQ号码",prop:""},{default:l(()=>[e(p,{style:{width:"18rem"},modelValue:a.value.qqCode,"onUpdate:modelValue":t[11]||(t[11]=o=>a.value.qqCode=o),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"公司地址",prop:""},{default:l(()=>[e(p,{style:{width:"18rem"},modelValue:a.value.address,"onUpdate:modelValue":t[12]||(t[12]=o=>a.value.address=o),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,null,{default:l(()=>[e(h,{type:"primary",onClick:N},{default:l(()=>[_("确认")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]),_:1}),e(_e,{ref_key:"recordRef",ref:P,onFetchData:C},null,512)])),[[te,y.value]])}}}),We=ce(Pe,[["__scopeId","data-v-821e74a2"]]);export{We as default};
