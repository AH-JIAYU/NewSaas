
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as q}from"./department-CaIjgMtb.js";import{g as N}from"./group_manage-Bw8AHYBZ.js";import{d as A,r as l,k as F,n as M,l as P,a as s,p as $,q as j,o as c,b as g,f as o,w as n,s as z,g as b,F as G,t as H,e as J,E as V,v as K}from"./index-D7ktWcYH.js";import{u as O}from"./department-DW9JldVy.js";const Q={style:{flex:"auto"}},te=A({name:"Edit",__name:"index",emits:["success"],setup(W,{expose:w,emit:k}){const x=O(),p=l(),y=l([]),v=k,f=l(""),C=l(),S=l(!1);l([]);const i=l(),u=l(!1),a=l({name:"",departmentId:null,remark:"",commissionStatus:null}),D=l({invoiceCode:[{required:!0,trigger:"blur",message:"请输入姓名"}],tenantCustomerId:[{required:!0,trigger:"change",message:"请选择客户"}]});function E(){return new Promise(r=>{a.value.id?i.value&&i.value.validate(e=>{if(e){const m=K(a.value);q.edit(m).then(()=>{V.success({message:"编辑成功",center:!0}),v("success"),u.value=!1,r()})}}):i.value&&i.value.validate(e=>{e&&(delete a.value.id,N.create(a.value).then(()=>{V.success({message:"新增成功",center:!0}),v("success"),u.value=!1,r()}))})})}async function T(){f.value="新增小组",u.value=!0}return F(async()=>{M(async()=>{const{data:r}=await P.getTenantStaffList();y.value=r}),p.value=await x.getDepartment(),C.value=new Date}),w({showEdit:T}),(r,e)=>{const m=s("el-input"),d=s("el-form-item"),h=s("el-option"),B=s("el-select"),I=s("el-switch"),L=s("el-form"),_=s("el-button"),R=s("el-dialog"),U=$("loading");return j((c(),g("div",null,[o(R,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=t=>u.value=t),title:f.value,width:"700"},{footer:n(()=>[z("div",Q,[o(_,{type:"",onClick:e[3]||(e[3]=t=>u.value=!1)},{default:n(()=>[b(" 取消 ")]),_:1}),o(_,{type:"primary",onClick:E},{default:n(()=>[b(" 确定 ")]),_:1})])]),default:n(()=>[o(L,{ref_key:"formRef",ref:i,"label-width":"80px",model:a.value,rules:D.value,inline:!1},{default:n(()=>[o(d,{prop:"name",label:"组名称"},{default:n(()=>[o(m,{modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.name=t),placeholder:"请输入组名称",clearable:""},null,8,["modelValue"])]),_:1}),o(d,{label:"所属部门"},{default:n(()=>[o(B,{modelValue:a.value.departmentId,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.departmentId=t),"value-key":"",placeholder:"请选择部门",clearable:"",filterable:""},{default:n(()=>[(c(!0),g(G,null,H(p.value,t=>(c(),J(h,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(d,{label:"组提成"},{default:n(()=>[o(I,{modelValue:a.value.commissionStatus,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.commissionStatus=t),"inline-prompt":"","active-text":"启用","inactive-text":"禁用","active-value":1,"inactive-value":2},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])),[[U,S.value]])}}});export{te as _};
