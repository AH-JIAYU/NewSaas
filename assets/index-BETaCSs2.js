
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as Y}from"./index-vGWXgTgK.js";import{a as Z}from"./department-CRTsECS1.js";import{d as $,r as h,a as d,o as u,b as v,f,w as n,y as r,g as N,i as l,A as j,F as D,t as T,z as x,j as I,e as L,p as ee,aH as te,aI as ae,L as le}from"./index-Bn1vWZLk.js";const y=k=>(te("data-v-a10def2c"),k=k(),ae(),k),se={key:0},ne=y(()=>r("span",{class:"project-name"},"项目",-1)),oe={class:"project-content"},ce={style:{display:"flex"}},ie={style:{"font-weight":"500"}},de={style:{"margin-left":"10px"}},re=y(()=>r("span",{class:"custom-tab-label"},"部门",-1)),ue=y(()=>r("div",{style:{color:"#333333","font-weight":"500","font-size":"14px","margin-bottom":"10px"}}," 分配部门 ",-1)),fe=y(()=>r("span",{class:"custom-tab-label",style:{"margin-left":"20px"}},"员工",-1)),pe={key:1},_e=y(()=>r("div",{class:"i-ic:sharp-info w-1.5em h-1.5em",style:{color:"#FFB667"}},null,-1)),me={style:{"margin-left":".5rem"}},he={class:"flex-c"},ve=$({__name:"index",emits:["userData"],setup(k,{expose:B,emit:w}){const p=h(!1),c=h([]),C=h([]),_=h(),e=h({type:1,tenantStaffList:[],roleList:[],title:"",project:[]}),F={children:"children",label:"name"};async function K(t,a,s){await A(),e.value.type=1,p.value=!0,c.value=[];const i=await Z.list({name:""});i.data&&(C.value=i.data),t&&(t.invitationType==1?t.chargeUserId&&(e.value.roleList=[t.chargeUserId],e.value.chargeUserName=t.chargeUserName):t.invitationType==2&&(c.value=[t.chargeUserId],e.value.chargeUserName=t.chargeUserName)),e.value.title=a,s&&(e.value.project=s)}const A=async()=>{const t=await ee.getTenantStaffList();e.value.tenantStaffList=t.data};function E(){p.value=!1}const R=(t,a)=>{if(a?(_.value.getCheckedKeys().forEach(i=>{i!==t.id&&_.value.setChecked(i,!1)}),c.value=[t.id]):c.value=c.value.filter(s=>s!==t.id),c.value.length){e.value.roleList=[];const s=_.value.getCheckedNodes();e.value.chargeUserName=s.map(i=>i.name)[0]}c.value.length==0&&e.value.roleList.length==0&&(e.value.chargeUserName="")},z=()=>{},H=t=>{if(console.log(t,"newValue"),Array.isArray(t)&&t.length>1&&(e.value.roleList=[t[t.length-1]]),e.value.roleList.length!=0){c.value=[],_.value.setCheckedKeys([]);let a=e.value.tenantStaffList.find(s=>s.id===e.value.roleList[0]);e.value.chargeUserName=a.userName}c.value.length==0&&e.value.roleList.length==0&&(e.value.chargeUserName="")};B({showEdit:K});const P=w;function q(){let t="",a=null,s=null;e.value.roleList[0]&&(t=e.value.tenantStaffList.find(g=>g.id===e.value.roleList[0]).userName,a=e.value.roleList[0],s=1),c.value[0]&&(t=_.value.getCheckedNodes().map(g=>g.name)[0],a=c.value[0],s=2),e.value.chargeUserName=t;let i={chargeUserId:a,chargeUserName:t,invitationType:s};p.value=!1,P("userData",i)}const b=h([]),G=t=>{b.value=t};return(t,a)=>{const s=d("el-badge"),i=Y,U=d("el-collapse-item"),g=d("el-collapse"),J=d("el-tree"),M=d("el-text"),V=d("el-tab-pane"),O=d("el-checkbox"),Q=d("el-checkbox-group"),W=d("el-tabs"),S=d("el-button"),X=d("el-dialog");return u(),v("div",null,[f(X,{modelValue:l(p),"onUpdate:modelValue":a[3]||(a[3]=o=>j(p)?p.value=o:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:l(e).title,class:"userClass"},{footer:n(()=>[r("div",he,[f(S,{onClick:E},{default:n(()=>[N(" 取消 ")]),_:1}),f(S,{type:"primary",onClick:q},{default:n(()=>[N(" 确认 ")]),_:1})])]),default:n(()=>[l(e).project.length!=0?(u(),v("div",se,[f(g,{modelValue:l(b),"onUpdate:modelValue":a[0]||(a[0]=o=>j(b)?b.value=o:null),onChange:G},{default:n(()=>[f(U,{name:"1"},{title:n(()=>[ne,f(s,{value:l(e).project.length,max:99,class:"item"},null,8,["value"])]),default:n(()=>[r("div",oe,[(u(!0),v(D,null,T(l(e).project,o=>(u(),v("div",{key:o.id},[r("div",ce,[r("span",ie,x(o.tenantName),1),r("span",de,"ID:"+x(o.tenantId),1),f(i,{content:o.tenantId},null,8,["content"])])]))),128))])]),_:1})]),_:1},8,["modelValue"])])):I("",!0),f(W,{modelValue:l(e).type,"onUpdate:modelValue":a[2]||(a[2]=o=>l(e).type=o),onTabChange:z,class:"tabs-user"},{default:n(()=>[f(V,{label:"部门",name:1},{label:n(()=>[re]),default:n(()=>[ue,l(C).length>0?(u(),L(J,{key:0,style:{"max-width":"600px"},ref_key:"treeRef",ref:_,disabled:!0,data:l(C),"show-checkbox":"","check-strictly":"","node-key":"id","default-expanded-keys":[],"default-checked-keys":l(c),"default-expand-all":"",props:F,onCheckChange:R,"check-on-click-node":!0,"expand-on-click-node":!1},null,8,["data","default-checked-keys"])):(u(),L(M,{key:1},{default:n(()=>[N("暂无数据")]),_:1}))]),_:1}),f(V,{name:2},{label:n(()=>[fe]),default:n(()=>{var o;return[(o=l(e).tenantStaffList)!=null&&o.length?(u(),L(Q,{key:0,onChange:H,modelValue:l(e).roleList,"onUpdate:modelValue":a[1]||(a[1]=m=>l(e).roleList=m)},{default:n(()=>[(u(!0),v(D,null,T(l(e).tenantStaffList,m=>(u(),L(O,{key:m.id,value:m.id,label:m.userName},{default:n(()=>[N(x(m.userName),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])):I("",!0)]}),_:1})]),_:1},8,["modelValue"]),l(e).chargeUserName?(u(),v("div",pe,[_e,r("span",me,x(l(e).chargeUserName||""),1)])):I("",!0)]),_:1},8,["modelValue","title"])])}}}),be=le(ve,[["__scopeId","data-v-a10def2c"]]);export{be as u};
