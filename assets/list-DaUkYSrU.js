
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{k as g,d as Q,L as W,aH as X,t as Y,r as Z,B as ee,C as w,G as te,a as s,ai as ae,o as b,b as oe,f as a,w as o,i as t,ax as le,g as u,D as ne,e as _,j as y,aj as ie,O as se,aI as re,ar as de,K as ue,q as ce,_ as me}from"./index-6BKMpupp.js";import{_ as pe}from"./index.vue_vue_type_script_setup_true_lang-DVPLtRjt.js";import{_ as fe}from"./index.vue_vue_type_script_setup_true_lang-Cm7qRRLO.js";import{_ as be}from"./index.vue_vue_type_script_setup_true_lang-BWC9Bbd7.js";import{u as ge}from"./useTabbar-Y7F0v9rn.js";import"./index-IbWLRZYp.js";const M={list:r=>g.get("otherFunctions/screen_library/list",{params:r,baseURL:"/mock/"}),detail:r=>g.get("otherFunctions/screen_library/detail",{params:{id:r},baseURL:"/mock/"}),create:r=>g.post("otherFunctions/screen_library/create",r,{baseURL:"/mock/"}),edit:r=>g.post("otherFunctions/screen_library/edit",r,{baseURL:"/mock/"}),delete:r=>g.post("otherFunctions/screen_library/delete",{id:r},{baseURL:"/mock/"})},_e=Q({name:"OtherFunctionsScreenLibraryList",__name:"list",setup(r){const V=W(),{pagination:p,getParams:L,onSizeChange:S,onCurrentChange:z,onSortChange:B}=X(),D=ge(),E=Y(),e=Z({loading:!1,tableAutoHeight:!1,formMode:"router",formModeProps:{visible:!1,id:"",details:""},editProps:{id:"",visible:!1,row:""},search:{title:""},batch:{enable:!1,selectionDataList:[]},dataList:[]});ee(()=>{m(),e.value.formMode==="router"&&w.on("get-data-list",()=>{m()})}),te(()=>{e.value.formMode==="router"&&w.off("get-data-list")});function m(){e.value.loading=!0;const l={...L(),...e.value.search.title&&{title:e.value.search.title}};M.list(l).then(n=>{e.value.loading=!1,e.value.dataList=n.data.list,p.value.total=n.data.total})}function U(l){S(l).then(()=>m())}function h(l=1){z(l).then(()=>m())}function $({prop:l,order:n}){B(l,n).then(()=>m())}function x(){e.value.editProps.id="",e.value.editProps.row="",e.value.editProps.visible=!0}function F(l){console.log("row.id",l.id),e.value.editProps.id=l.id,e.value.editProps.row=JSON.stringify(l),e.value.editProps.visible=!0}function I(l){e.value.formMode==="router"?E.settings.tabbar.enable&&E.settings.tabbar.mergeTabsBy!=="activeMenu"?D.open({name:"screenLibraryEdit",params:{id:l.id}}):V.push({name:"screenLibraryEdit",params:{id:l.id}}):(e.value.formModeProps.id=l.id,e.value.formModeProps.details=l.details,e.value.formModeProps.visible=!0)}function T(l){re.confirm(`确认删除「${l.title}」吗？`,"确认信息").then(()=>{M.delete(l.id).then(()=>{m(),de.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}return(l,n)=>{const R=s("ElInput"),k=s("ElFormItem"),C=ue,d=s("ElButton"),N=s("ElForm"),G=pe,H=s("ElDivider"),K=s("ElButtonGroup"),O=s("ElSpace"),f=s("ElTableColumn"),P=s("ElSwitch"),j=s("ElTable"),A=s("ElPagination"),q=ce,J=ae("loading");return b(),oe("div",{class:se({"absolute-container":t(e).tableAutoHeight})},[a(q,null,{default:o(()=>[a(G,{"show-toggle":!1},{default:o(({fold:i,toggle:c})=>[a(N,{model:t(e).search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:o(()=>[a(k,{label:"标题"},{default:o(()=>[a(R,{modelValue:t(e).search.title,"onUpdate:modelValue":n[0]||(n[0]=v=>t(e).search.title=v),placeholder:"请输入标题，支持模糊查询",clearable:"",onKeydown:n[1]||(n[1]=le(v=>h(),["enter"])),onClear:n[2]||(n[2]=v=>h())},null,8,["modelValue"])]),_:1}),a(k,null,{default:o(()=>[a(d,{type:"primary",onClick:n[3]||(n[3]=v=>h())},{icon:o(()=>[a(C,{name:"i-ep:search"})]),default:o(()=>[u(" 筛选 ")]),_:1}),a(d,{link:"",disabled:"",onClick:c},{icon:o(()=>[a(C,{name:i?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:o(()=>[u(" "+ne(i?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),a(H,{"border-style":"dashed"}),a(O,{wrap:""},{default:o(()=>[a(d,{type:"primary",size:"default",onClick:x},{icon:o(()=>[a(C,{name:"i-ep:plus"})]),default:o(()=>[u(" 新增筛选库 ")]),_:1}),t(e).batch.enable?(b(),_(d,{key:0,size:"default",disabled:!t(e).batch.selectionDataList.length},{default:o(()=>[u(" 单个批量操作按钮 ")]),_:1},8,["disabled"])):y("",!0),t(e).batch.enable?(b(),_(K,{key:1},{default:o(()=>[a(d,{size:"default",disabled:!t(e).batch.selectionDataList.length},{default:o(()=>[u(" 批量操作按钮组1 ")]),_:1},8,["disabled"]),a(d,{size:"default",disabled:!t(e).batch.selectionDataList.length},{default:o(()=>[u(" 批量操作按钮组2 ")]),_:1},8,["disabled"])]),_:1})):y("",!0)]),_:1}),ie((b(),_(j,{class:"my-4",data:t(e).dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:$,onSelectionChange:n[4]||(n[4]=i=>t(e).batch.selectionDataList=i)},{default:o(()=>[t(e).batch.enable?(b(),_(f,{key:0,type:"selection",align:"center",fixed:""})):y("",!0),a(f,{prop:"title",label:"标题"}),a(f,{prop:"country",label:"国家"}),a(f,{prop:"default",label:"默认"},{default:o(i=>[a(P,{modelValue:i.row.default,"onUpdate:modelValue":c=>i.row.default=c},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(f,{prop:"state",label:"状态"},{default:o(i=>[a(P,{modelValue:i.row.state,"onUpdate:modelValue":c=>i.row.state=c},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(f,{label:"操作",width:"250",align:"center",fixed:"right"},{default:o(i=>[a(d,{type:"primary",size:"small",plain:"",onClick:c=>F(i.row)},{default:o(()=>[u(" 编辑 ")]),_:2},1032,["onClick"]),a(d,{type:"primary",size:"small",plain:"",onClick:c=>I(i.row)},{default:o(()=>[u(" 设计问卷 ")]),_:2},1032,["onClick"]),a(d,{type:"danger",size:"small",plain:"",onClick:c=>T(i.row)},{default:o(()=>[u(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[J,t(e).loading]]),a(A,{"current-page":t(p).page,total:t(p).total,"page-size":t(p).size,"page-sizes":t(p).sizes,layout:t(p).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:U,onCurrentChange:h},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),a(be,{id:t(e).editProps.id,modelValue:t(e).editProps.visible,"onUpdate:modelValue":n[5]||(n[5]=i=>t(e).editProps.visible=i),row:t(e).editProps.row},null,8,["id","modelValue","row"]),t(e).formMode==="dialog"||t(e).formMode==="drawer"?(b(),_(fe,{key:0,id:t(e).formModeProps.id,modelValue:t(e).formModeProps.visible,"onUpdate:modelValue":n[6]||(n[6]=i=>t(e).formModeProps.visible=i),mode:t(e).formMode,details:t(e).formModeProps.details,onSuccess:m},null,8,["id","modelValue","mode","details"])):y("",!0)],2)}}}),Pe=me(_e,[["__scopeId","data-v-e9a7f0f7"]]);export{Pe as default};
