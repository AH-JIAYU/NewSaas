
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Ee,r as d,aM as xe,$ as ze,n as Ie,a as r,q as Q,s as S,o as n,b as I,f as l,w as e,F as H,t as P,e as u,aH as Ve,g as s,A as v,i as w,aN as $e,j as p,O as Be,aO as Fe,E as Re,_ as Ae,aP as Ne,aQ as Te,be as Ue,ao as Le,aI as Me,aJ as He,v as Pe,M as Oe}from"./index-CaoSRXoh.js";import{_ as Ye}from"./index.vue_vue_type_style_index_0_lang-DxMwroYg.js";import{_ as je}from"./index.vue_vue_type_script_setup_true_lang-Dd_eNXxL.js";import{_ as qe,a as G}from"./index.vue_vue_type_script_setup_true_lang-Yfp_xnH-.js";import{u as Je}from"./user_customer-BlJpj8AN.js";import"./index-407bArVZ.js";import"./index.vue_vue_type_script_setup_true_lang-jL8gaBwB.js";import"./index-DFSMLYcH.js";import"./index-BZfYE4xi.js";import"./index-NRV-Vh4J.js";import"./clipboard-D4z11t65.js";import"./index-4SvP6ap3.js";import"./department-TIg1SYvd.js";import"./position_manage--588earZ.js";import"./configuration_role-SPzaC7f2.js";import"./tenant_role-IHua6E1q.js";import"./configuration_manager-DrJ3Lfsm.js";import"./configuration_siteSetting-ChWY8VW9.js";import"./configuration_site_setting-CcclIQpg.js";import"./apiLoading-CCUbcnAt.js";import"./stagedData-CVpUb3zK.js";const Qe=D=>(Me("data-v-8b5b764c"),D=D(),He(),D),Ge=Qe(()=>Pe("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Ke=Ee({name:"invoice",__name:"list",setup(D){const K=Je(),O=d([]),{pagination:C,onSizeChange:W,onCurrentChange:X,onSortChange:We}=xe(),Z=d(""),Y=d([]),b=d(!0),V=d(),$=d(!1),m=d([]),B=d(!0);d(!1);const F=d("default"),R=d(!0),ee=d([]),te=[{lable:"未收款",value:1},{lable:"部分收款",value:2},{lable:"已完结",value:3},{lable:"坏账",value:4}],y=d(null),g=d([]),le=[{lable:"开票日期",value:1},{lable:"收款日期",value:2}],A=d([{label:"客户简称",prop:"tenantCustomerShortName",sortable:!0,disableCheck:!1,checked:!0},{label:"发票编号",prop:"invoiceCode",sortable:!0,disableCheck:!1,checked:!0},{label:"发票金额",prop:"invoiceAmount",sortable:!0,disableCheck:!1,checked:!0},{label:"手续费(税)",prop:"invoiceTax",sortable:!0,disableCheck:!1,checked:!0},{label:"实收款",prop:"actualReceipts",sortable:!0,disableCheck:!1,checked:!0},{label:"开票日期",prop:"invoiceDate",sortable:!0,disableCheck:!1,checked:!0},{label:"收款日期",prop:"paymentDate",sortable:!0,disableCheck:!1,checked:!0},{label:"状态",prop:"invoiceStatus",sortable:!0,disableCheck:!1,checked:!0},{label:"备注",prop:"remark",sortable:!0,disableCheck:!1,checked:!0}]),c=ze({page:1,limit:10,tenantCustomerId:"",invoiceStatus:[],invoiceDateStart:"",invoiceDateEnd:"",paymentDateStart:"",paymentDateEnd:""});function ae(){V.value.showEdit("")}function oe(o){V.value.showEdit(JSON.stringify(o))}function ne(o){Fe.confirm(`确认删除「${o.tenantCustomerShortName}」这条数据吗？`,"确认信息").then(()=>{try{b.value=!0,G.delete({id:o.id}).then(()=>{b.value=!1,k(),Re.success({message:"删除成功",center:!0})})}catch{}finally{b.value=!1}}).catch(()=>{})}function ie(o){ee.value=o}function se(){Object.assign(c,{page:1,limit:10,tenantCustomerId:"",invoiceStatus:[],invoiceDateStart:"",invoiceDateEnd:"",paymentDateStart:"",paymentDateEnd:""}),y.value=null,k()}const re=o=>{y.value=o,g.value=[],c.invoiceDateStart="",c.invoiceDateEnd="",c.paymentDateStart="",c.paymentDateEnd="",h()},ue=()=>{y.value===1?(c.invoiceDateStart=g.value[0],c.invoiceDateEnd=g.value[1]):(c.paymentDateStart=g.value[0],c.paymentDateEnd=g.value[1]),h()};function ce(o){W(o).then(()=>{c.limit=o,k()})}function h(o=1){X(o).then(()=>{c.page=o,k()})}async function k(){try{b.value=!0,O.value=await K.getCustomerList();const{data:o}=await G.list(c);Y.value=o.data,C.value.total=parseInt(o.total)||0,b.value=!1}catch{}finally{b.value=!1}}return Ie(()=>{A.value.forEach(o=>{o.checked&&m.value.push(o.prop)}),k()}),(o,a)=>{const de=r("el-option"),N=r("el-select"),E=r("el-form-item"),j=r("ElOption"),pe=r("el-date-picker"),q=Ae,T=r("ElButton"),me=r("ElFormItem"),fe=r("el-form"),ve=je,_e=r("ElDivider"),x=r("el-button"),be=Ye,ge=Ne,he=Te,Ce=r("el-row"),_=r("el-text"),f=r("el-table-column"),U=Ue,z=r("el-tag"),ye=r("ElTableColumn"),ke=r("el-empty"),Se=r("el-table"),we=r("ElPagination"),De=Le,L=Q("auth"),J=Q("loading");return S((n(),I("div",{class:Be({"absolute-container":$.value})},[l(De,null,{default:e(()=>[l(ve,{"show-toggle":!1},{default:e(({fold:t,toggle:M})=>[l(fe,{model:c.select,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:e(()=>[l(E,{label:""},{default:e(()=>[l(N,{modelValue:c.tenantCustomerId,"onUpdate:modelValue":a[0]||(a[0]=i=>c.tenantCustomerId=i),placeholder:"客户简称",clearable:"",filterable:"",onChange:a[1]||(a[1]=i=>h())},{default:e(()=>[(n(!0),I(H,null,P(O.value,i=>(n(),u(de,{key:i.tenantCustomerId,value:i.tenantCustomerId,label:i.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(E,{label:""},{default:e(()=>[l(N,{modelValue:c.invoiceStatus,"onUpdate:modelValue":a[2]||(a[2]=i=>c.invoiceStatus=i),placeholder:"发票状态",clearable:"",filterable:"",onChange:a[3]||(a[3]=i=>h()),multiple:!0},{default:e(()=>[(n(),I(H,null,P(te,i=>l(j,{label:i.lable,value:i.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(E,{label:""},{default:e(()=>[l(N,{modelValue:y.value,"onUpdate:modelValue":a[4]||(a[4]=i=>y.value=i),placeholder:"时间类型",clearable:"",filterable:"",onChange:re},{default:e(()=>[(n(),I(H,null,P(le,i=>l(j,{label:i.lable,value:i.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),S(l(E,null,{default:e(()=>[l(pe,{modelValue:g.value,"onUpdate:modelValue":a[5]||(a[5]=i=>g.value=i),disabled:!y.value,"value-format":"YYYY-MM-DD hh:mm:ss",type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:"",size:"",onChange:ue},null,8,["modelValue","disabled"])]),_:2},1536),[[Ve,!t]]),l(me,null,{default:e(()=>[l(T,{type:"primary",onClick:a[6]||(a[6]=i=>h())},{icon:e(()=>[l(q,{name:"i-ep:search"})]),default:e(()=>[s(" 筛选 ")]),_:1}),l(T,{onClick:se},{icon:e(()=>[Ge]),default:e(()=>[s(" 重置 ")]),_:1}),l(T,{link:"",onClick:M},{icon:e(()=>[l(q,{name:t?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:e(()=>[s(" "+v(t?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),l(_e,{"border-style":"dashed"}),l(Ce,{gutter:24},{default:e(()=>[l(be,null,{default:e(()=>[S((n(),u(x,{style:{"margin-right":"10px"},type:"primary",size:"default",onClick:ae},{default:e(()=>[s(" 新增发票 ")]),_:1})),[[L,"invoice-insert-insertTenantInvoice"]])]),_:1}),l(he,null,{default:e(()=>[l(x,{size:"default",onClick:a[7]||(a[7]=()=>{})},{default:e(()=>[s(" 导出 ")]),_:1}),l(ge,{border:B.value,"onUpdate:border":a[8]||(a[8]=t=>B.value=t),tableAutoHeight:$.value,"onUpdate:tableAutoHeight":a[9]||(a[9]=t=>$.value=t),checkList:m.value,"onUpdate:checkList":a[10]||(a[10]=t=>m.value=t),columns:A.value,"onUpdate:columns":a[11]||(a[11]=t=>A.value=t),"line-height":F.value,"onUpdate:lineHeight":a[12]||(a[12]=t=>F.value=t),stripe:R.value,"onUpdate:stripe":a[13]||(a[13]=t=>R.value=t),style:{"margin-left":"12px"},onQueryData:h},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),S((n(),u(Se,{ref_key:"tableSortRef",ref:Z,style:{"margin-top":"10px"},"row-key":"id",data:Y.value,border:B.value,class:"my-4",size:F.value,stripe:R.value,onSelectionChange:ie},{empty:e(()=>[l(ke,{image:w($e),"image-size":300},null,8,["image"])]),default:e(()=>[m.value.includes("tenantCustomerShortName")?(n(),u(f,{key:0,prop:"tenantCustomerShortName","show-overflow-tooltip":"",align:"left",width:"100",label:"客户简称"},{default:e(({row:t})=>[l(_,{class:"fontColor tableBig"},{default:e(()=>[s(v(t.tenantCustomerShortName),1)]),_:2},1024)]),_:1})):p("",!0),m.value.includes("invoiceCode")?(n(),u(f,{key:1,prop:"invoiceCode","show-overflow-tooltip":"",align:"left",label:"发票编号"},{default:e(({row:t})=>[l(_,{class:"fontColor"},{default:e(()=>[s(v(t.invoiceCode),1)]),_:2},1024)]),_:1})):p("",!0),m.value.includes("invoiceAmount")?(n(),u(f,{key:2,prop:"invoiceAmount","show-overflow-tooltip":"",align:"left",label:"发票金额"},{default:e(({row:t})=>[l(U),l(_,{class:"fontColor"},{default:e(()=>[s(v(t.invoiceAmount||0),1)]),_:2},1024)]),_:1})):p("",!0),m.value.includes("invoiceTax")?(n(),u(f,{key:3,prop:"invoiceTax","show-overflow-tooltip":"",align:"left",label:"手续费(税)"},{default:e(({row:t})=>[l(U),l(_,{class:"fontColor"},{default:e(()=>[s(v(t.invoiceTax||0),1)]),_:2},1024)]),_:1})):p("",!0),m.value.includes("actualReceipts")?(n(),u(f,{key:4,prop:"actualReceipts","show-overflow-tooltip":"",align:"left",label:"实收款"},{default:e(({row:t})=>[l(U),l(_,{class:"fontColor"},{default:e(()=>[s(v(t.actualReceipts||0),1)]),_:2},1024)]),_:1})):p("",!0),m.value.includes("invoiceDate")?(n(),u(f,{key:5,prop:"invoiceDate","show-overflow-tooltip":"",align:"left",width:"180",label:"开票日期"},{default:e(({row:t})=>[l(_,{class:"fontColor"},{default:e(()=>[s(v(t.invoiceDate),1)]),_:2},1024)]),_:1})):p("",!0),m.value.includes("paymentDate")?(n(),u(f,{key:6,prop:"paymentDate","show-overflow-tooltip":"",align:"left",width:"180",label:"收款日期"},{default:e(({row:t})=>[l(_,{class:"fontColor"},{default:e(()=>[s(v(t.paymentDate),1)]),_:2},1024)]),_:1})):p("",!0),m.value.includes("invoiceStatus")?(n(),u(ye,{key:7,align:"left","show-overflow-tooltip":"",prop:"invoiceStatus",label:"状态"},{default:e(({row:t})=>[t.invoiceStatus===1?(n(),u(z,{key:0,class:"mx-1 fontC-System",effect:"dark",style:{"background-color":"#FFB365","border-color":"white",color:"white"}},{default:e(()=>[s("未收款")]),_:1})):p("",!0),t.invoiceStatus===2?(n(),u(z,{key:1,class:"mx-1 fontC-System",effect:"dark",style:{"background-color":"#409EFF","border-color":"white",color:"white"}},{default:e(()=>[s("部分收款")]),_:1})):p("",!0),t.invoiceStatus===3?(n(),u(z,{key:2,class:"mx-1 fontC-System",effect:"dark",style:{"background-color":"#03C239","border-color":"white",color:"white"}},{default:e(()=>[s("已完结")]),_:1})):p("",!0),t.invoiceStatus===4?(n(),u(z,{key:3,class:"mx-1 fontC-System",effect:"dark",style:{"background-color":"#FB6868","border-color":"white",color:"white"}},{default:e(()=>[s("坏账")]),_:1})):p("",!0)]),_:1})):p("",!0),m.value.includes("remark")?(n(),u(f,{key:8,prop:"remark",align:"left",label:"备注"},{default:e(({row:t})=>[l(_,{class:"mx-1 fontC-System"},{default:e(()=>[s(v(t.remark?t.remark:"-"),1)]),_:2},1024)]),_:1})):p("",!0),l(f,{align:"left",fixed:"right",label:"操作",width:"170"},{default:e(({row:t})=>[S((n(),u(x,{size:"small",plain:"",type:"primary",onClick:M=>oe(t)},{default:e(()=>[s(" 编辑 ")]),_:2},1032,["onClick"])),[[L,"invoice-update-updateById"]]),S((n(),u(x,{size:"small",plain:"",type:"danger",onClick:M=>ne(t)},{default:e(()=>[s(" 删除 ")]),_:2},1032,["onClick"])),[[L,"invoice-delete-deleteById"]])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[J,!1]]),l(we,{"current-page":w(C).page,total:w(C).total,"page-size":w(C).size,"page-sizes":w(C).sizes,layout:w(C).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:h,onSizeChange:ce},null,8,["current-page","total","page-size","page-sizes","layout"]),l(qe,{onSuccess:k,ref_key:"editRef",ref:V},null,512)]),_:1})],2)),[[J,b.value]])}}}),ht=Oe(Ke,[["__scopeId","data-v-8b5b764c"]]);export{ht as default};
