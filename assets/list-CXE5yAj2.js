
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{k as h,d as N,r as p,n as R,a as s,q as $,s as D,o as L,b as S,f as l,w as t,g as q,E as C,an as T,L as z}from"./index-B3X1V31b.js";import"./clipboard-BI26RVHe.js";const E={list:()=>h.post("member-config/getMemberConfig"),create:v=>h.post("member-config/insertMemberConfig",v),edit:v=>h.post("member-config/updateMemberConfig",v)},B=N({name:"setting",__name:"list",setup(v){const y=p("基本设置"),r=p(!1),m=p(),e=p({webName:"",keyWords:"",registerOffOrOn:!0,registerExamineOffOrOn:!1,priceProportion:null,taxPointsProportion:null,minimumAmount:null,fixedPrice:null,externalSite:"",phone:"",email:"",qqCode:"",address:""}),c=p({webName:[{required:!0,message:"请输入网站名称",trigger:"blur"}],memberURL:[{required:!0,message:"请输入会员网址",trigger:"blur"}],phone:[{required:!1,trigger:"blur",message:"请输入手机号"},{validator:(u,a,n)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(e.value.phone)?n():n(new Error("请输入合法手机号"))},trigger:"blur"}],email:[{required:!1,trigger:"blur",message:"请输入邮箱"},{validator:(u,a,n)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.value.email)?n():n(new Error("请输入合法邮箱"))},trigger:"blur"}]});R(()=>{_()});async function _(){try{r.value=!0;const{data:u}=await E.list();e.value=u||e.value,e.value.minimumAmount===0&&(e.value.minimumAmount=null),r.value=!1}catch{}finally{r.value=!1}}function M(){e.value.email===""&&(c.value.email=[],m.value.clearValidate("email")),e.value.phone===""&&(c.value.phone=[],m.value.clearValidate("phone")),e.value.id?m.value&&m.value.validate(u=>{if(u)try{let{id:a,keyWords:n,registerExamineOffOrOn:i,registerOffOrOn:d,webName:f,priceProportion:g,taxPointsProportion:b,minimumAmount:x,fixedPrice:O,externalSite:P,phone:V,email:w,qqCode:o,address:A}=e.value;const U={id:a,keyWords:n,registerExamineOffOrOn:i,registerOffOrOn:d,webName:f,priceProportion:g,taxPointsProportion:b,minimumAmount:x,fixedPrice:O,externalSite:P,phone:V,email:w,qqCode:o,address:A};r.value=!0,E.edit(U).then(k=>{r.value=!1,k.status===1&&(_(),C.success({message:"修改成功",center:!0}))})}catch{}finally{r.value=!1}}):m.value&&m.value.validate(u=>{if(u)try{r.value=!0,E.create(e.value).then(()=>{r.value=!1,_(),C.success({message:"新增成功",center:!0})})}catch{}finally{r.value=!1}})}return(u,a)=>{const n=s("el-switch"),i=s("el-form-item"),d=s("el-col"),f=s("el-input"),g=s("el-row"),b=s("el-button"),x=s("el-tab-pane"),O=s("el-form"),P=s("el-tabs"),V=T,w=$("loading");return D((L(),S("div",null,[l(V,null,{default:t(()=>[l(P,{modelValue:y.value,"onUpdate:modelValue":a[5]||(a[5]=o=>y.value=o)},{default:t(()=>[l(O,{ref_key:"formRef",ref:m,model:e.value,rules:c.value,"label-position":"right","label-width":"140px",style:{width:"500px"}},{default:t(()=>[l(x,{label:"基础设置",name:"基本设置"},{default:t(()=>[l(g,{gutter:20},{default:t(()=>[l(d,{span:7},{default:t(()=>[l(i,{label:"注册开关"},{default:t(()=>[l(n,{modelValue:e.value.registerOffOrOn,"onUpdate:modelValue":a[0]||(a[0]=o=>e.value.registerOffOrOn=o),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),l(d,{span:6},{default:t(()=>[l(i,{label:"注册审核"},{default:t(()=>[l(n,{modelValue:e.value.registerExamineOffOrOn,"onUpdate:modelValue":a[1]||(a[1]=o=>e.value.registerExamineOffOrOn=o),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),l(d,{span:24},{default:t(()=>[l(i,{label:"最低结算金额",prop:"confirmPassword"},{default:t(()=>[l(f,{modelValue:e.value.minimumAmount,"onUpdate:modelValue":a[2]||(a[2]=o=>e.value.minimumAmount=o),modelModifiers:{number:!0},style:{width:"18rem"},placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),l(d,{span:24},{default:t(()=>[l(i,{label:"会员税点",prop:"confirmPassword"},{default:t(()=>[l(f,{modelValue:e.value.taxPointsProportion,"onUpdate:modelValue":a[3]||(a[3]=o=>e.value.taxPointsProportion=o),modelModifiers:{number:!0},style:{width:"18rem"},placeholder:""},{append:t(()=>[q("%")]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(d,{span:24},{default:t(()=>[l(i,{label:"调查限价",prop:"confirmPassword"},{default:t(()=>[l(f,{modelValue:e.value.fixedPrice,"onUpdate:modelValue":a[4]||(a[4]=o=>e.value.fixedPrice=o),modelModifiers:{number:!0},style:{width:"18rem"},placeholder:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(i,null,{default:t(()=>[l(b,{type:"primary",onClick:M},{default:t(()=>[q(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]),_:1})])),[[w,r.value]])}}}),F=z(B,[["__scopeId","data-v-9e473e2e"]]);export{F as default};
