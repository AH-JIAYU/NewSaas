
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as qe}from"./index.vue_vue_type_script_setup_true_lang-DlXPFsRh.js";import{k as W,d as Ie,l as Pe,q as Re,X as Ae,Z as Fe,r as d,aJ as V,bb as Y,aN as Se,$ as $e,b as Z,f as a,w as o,A as i,ak as M,al as G,i as e,s as Le,a as c,aH as ze,aI as De,K as Be,E as I,a2 as Ke,o as f,C as Ze,aD as Me,g,B as C,e as b,az as ee,j as E,ay as J,F as le,p as ae,J as Ge,N as Je,ai as oe}from"./index-CN3B1iWi.js";import Oe from"./index-B-RSnP7R.js";const F={sendCode:h=>W.post("user/sendCode",h),register:h=>W.post("user/register",h)},T=h=>(ze("data-v-e88964fa"),h=h(),De(),h),je=T(()=>i("div",{class:"bg-banner"},null,-1)),He={id:"login-box"},Xe=T(()=>i("div",{class:"login-banner"},[i("h1",{style:{"font-size":"50px","font-weight":"normal"}},"欢迎"),i("h3",{h1:"",style:{"font-size":"30px","font-weight":"normal"}},"来到租户系统 !")],-1)),Qe={class:"title-container"},We={class:"fx-c"},Ye={class:"flex-bar",style:{width:"100%",margin:"0"}},el={class:"flex-bar"},ll={class:"sub-link"},al=T(()=>i("span",{class:"text"},"还不是会员?",-1)),ol=T(()=>i("div",{class:"i-ic:round-supervisor-account w-1.5em h-1.5em"},null,-1)),tl={class:"flex-bar",style:{margin:"0"}},rl={class:"sub-link"},nl=T(()=>i("span",{class:"text"},"已经有帐号?",-1)),sl=T(()=>i("div",{class:"title-container"},[i("h3",{class:"title"},"忘记密码了? 🔒")],-1)),ul={class:"sub-link"},te=Ie({name:"Login",__name:"login",setup(h){var H;const re=Pe(),ne=Le(),se=Be(),ue=Re(),ie=Ae(),{t:v}=Fe();new URL(""+new URL("login-banner-ZfMZACb6.png",import.meta.url).href,import.meta.url).href,new URL(""+new URL("logo-CLz_KCqM.png",import.meta.url).href,import.meta.url).href;const y=d("login"),k=d(!1),de=d(((H=ne.query.redirect)==null?void 0:H.toString())??ue.settings.home.fullPath),N=d(),_=d("code"),S=d("获取验证码"),$=d(!1),u=d({account:V.local.get("login_account")||"",remember:V.local.has("login_account"),agreeToTheAgreement:!1}),pe=(n,l,s)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(u.value.account)?s():s(new Error("请输入合法手机号"))},me=(n,l,s)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(u.value.account)?s():s(new Error("请输入合法邮箱"))},P=d({account:[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}],agreeToTheAgreement:[{required:!0,validator:(n,l)=>l===!0,message:"请阅读并勾选协议",trigger:"change"}]}),ce=()=>{u.value.account.includes("@")?P.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"},{validator:me,trigger:"blur"}]:P.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"},{validator:pe,trigger:"blur"}]};async function ge(){N.value.validateField("account",async n=>{if(n){let l;u.value.account.includes("@")?l={email:u.value.account,type:"login_email"}:l={phone:u.value.account,type:"login_phone_number"};const{status:s}=await F.sendCode(l);s===1&&I.success({message:"已发送"})}}),fe()}const fe=()=>{$.value=!0;let n=60;x.value=setInterval(()=>{n>0?(n--,S.value=`请在${n}s后重新获取`):(clearInterval(x.value),S.value="获取验证码",x.value=null,$.value=!1)},1e3)},L=Y(()=>{N.value&&N.value.validate(n=>{if(n){let l={...u.value};_.value==="password"?l.type=1:u.value.account.includes("@")?l.type=3:l.type=2,k.value=!0,ie.login(l).then(()=>{k.value=!1,u.value.remember?V.local.set("login_account",u.value.account):V.local.remove("login_account"),se.push(de.value)}).catch(()=>{k.value=!1})}})},3e3),x=d(null),z=d("获取验证码"),D=d(!1),R=d(),ve=[{label:"公司",value:"company"},{label:"个人",value:"personal"}],O=d([]),r=d({name:"",password:"",email:"",phoneNumber:"",code:"",country:"",type:"phone",agreeToTheAgreement:!1,companyType:"personal",companyName:"",legalPersonName:"",taxID:""}),ye=d({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],companyName:[{required:!0,trigger:"blur",message:"请输入公司名称"}],companyType:[{required:!0,trigger:"change",message:"请选择账户类型"}],legalPersonName:[{required:!0,trigger:"blur",message:"请输入法人姓名"}],email:[{required:!0,trigger:"blur",message:"请输入邮箱"},{validator:(n,l,s)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(r.value.email)?s():s(new Error("请输入合法邮箱"))},trigger:"blur"}],phoneNumber:[{required:!0,trigger:"blur",message:"请输入手机号码"},{validator:(n,l,s)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(r.value.phoneNumber)?s():s(new Error("请输入合法手机号"))},trigger:"blur"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],country:[{required:!0,trigger:"change",message:"请选择国家"}],name:[{required:!0,trigger:"blur",message:"请输入用户名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}],agreeToTheAgreement:[{required:!0,validator:(n,l)=>l===!0,message:"请阅读并勾选协议",trigger:"blur"}]}),_e=async()=>{const n={type:"register_phone_number",email:r.value.email,phone:r.value.phoneNumber};if(r.value.country==="CN"){const{status:l}=await F.sendCode(n);l===1&&I.success({message:"已发送"})}else{n.type="register_email";const{status:l}=await F.sendCode(n);l===1&&I.success({message:"已发送"})}be()},be=()=>{D.value=!0;let n=60;x.value=setInterval(()=>{n>0?(n--,z.value=`请在${n}s后重新获取`):(clearInterval(x.value),z.value="获取验证码",x.value=null,D.value=!1)},1e3)},he=Y(async()=>{R.value&&R.value.validate(async n=>{if(n){r.value.type=r.value.country==="CN"?"phone":"email",r.value.companyName="",r.value.legalPersonName="",r.value.taxID="",delete r.value.agreeToTheAgreement;const{status:l}=await F.register(r.value);l===1&&(I.success({message:"注册成功"}),y.value="login",_.value="password",Ke(()=>{u.value.account=r.value.email||r.value.phoneNumber}))}})},3e3),B=d(),w=d({account:V.local.get("login_account"),code:"",newPassword:""}),xe=d({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],newPassword:[{required:!0,trigger:"blur",message:"请输入新密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}]});function we(){I({message:"重置密码仅提供界面演示，无实际功能，需开发者自行扩展",type:"info"}),B.value&&B.value.validate(n=>{})}Se(()=>{clearInterval(x.value),x.value=null});const j=()=>{P.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"}],N.value.resetFields()};return $e(()=>y.value,async n=>{switch(n){case"login":j(),u.value={account:V.local.get("login_account")||"",remember:V.local.has("login_account")};break;case"register":R.value.resetFields(),r.value={name:"",password:"",email:"",phoneNumber:"",code:"",country:"",type:"phone"};break}n==="register"&&(O.value=await re.getCountry())}),(n,l)=>{const s=Ge,U=qe,X=c("el-radio-button"),Ve=c("el-radio-group"),ke=c("el-button"),m=c("ElInput"),p=c("ElFormItem"),K=c("ElCheckbox"),A=c("ElLink"),q=c("ElButton"),Ce=c("el-form"),Ee=c("el-option"),Te=c("el-select"),Ne=c("ElOption"),Ue=c("ElSelect"),Q=c("ElForm");return f(),Z("div",null,[je,a(U,{placement:"bottom-end",class:"i18n-selector"},{default:o(()=>[a(s,{name:"i-ri:translate"})]),_:1}),i("div",He,[Xe,M(a(Ce,{ref_key:"loginFormRef",ref:N,model:e(u),rules:e(P),class:"login-form","validate-on-rule-change":!1},{default:o(()=>[i("div",Qe,[i("div",We,[a(Ve,{modelValue:e(_),"onUpdate:modelValue":l[0]||(l[0]=t=>Ze(_)?_.value=t:null),size:"large",onChange:j},{default:o(()=>[a(X,{label:"验证码登录",value:"code"}),a(X,{label:"密码登录",value:"password"})]),_:1},8,["modelValue"])])]),i("div",null,[a(p,{prop:"account"},{default:o(()=>[a(m,{modelValue:e(u).account,"onUpdate:modelValue":l[1]||(l[1]=t=>e(u).account=t),placeholder:e(v)("app.account"),type:"text",tabindex:"1",onBlur:ce},Me({prefix:o(()=>[a(s,{name:"i-ri:user-3-fill"})]),_:2},[e(_)==="code"?{name:"append",fn:o(()=>[a(ke,{type:"primary",disabled:e($),onClick:ge},{default:o(()=>[g(C(e(S)),1)]),_:1},8,["disabled"])]),key:"0"}:void 0]),1032,["modelValue","placeholder"])]),_:1}),e(_)==="password"?(f(),b(p,{key:0,prop:"password"},{default:o(()=>[a(m,{modelValue:e(u).password,"onUpdate:modelValue":l[2]||(l[2]=t=>e(u).password=t),type:"password",placeholder:e(v)("app.password"),tabindex:"2",autocomplete:"new-password","show-password":"",onKeyup:ee(e(L),["enter"])},{prefix:o(()=>[a(s,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue","placeholder","onKeyup"])]),_:1})):E("",!0),e(_)==="code"?(f(),b(p,{key:1,prop:"code"},{default:o(()=>[a(m,{modelValue:e(u).code,"onUpdate:modelValue":l[3]||(l[3]=t=>e(u).code=t),type:"text",placeholder:e(v)("app.captcha"),tabindex:"2",onKeyup:ee(e(L),["enter"])},{prefix:o(()=>[a(s,{name:"i-ep:message"})]),_:1},8,["modelValue","placeholder","onKeyup"])]),_:1})):E("",!0),a(p,{prop:"agreeToTheAgreement"},{default:o(()=>[i("div",Ye,[a(K,{modelValue:e(u).agreeToTheAgreement,"onUpdate:modelValue":l[4]||(l[4]=t=>e(u).agreeToTheAgreement=t),tabindex:"3"},{default:o(()=>[g(" 我已阅读并同意《xxxx协议》 ")]),_:1},8,["modelValue"]),e(_)==="password"?(f(),b(A,{key:0,type:"primary",underline:!1,onClick:l[5]||(l[5]=t=>y.value="reset")},{default:o(()=>[g(" 忘记密码了? ")]),_:1})):E("",!0)])]),_:1})]),i("div",el,[a(K,{modelValue:e(u).remember,"onUpdate:modelValue":l[6]||(l[6]=t=>e(u).remember=t),tabindex:"4"},{default:o(()=>[g(" 保持登录 ")]),_:1},8,["modelValue"])]),a(q,{loading:e(k),type:"primary",size:"large",style:{width:"100%"},onClick:J(e(L),["prevent"]),tabindex:"5"},{default:o(()=>[g(C(e(v)("app.login")),1)]),_:1},8,["loading","onClick"]),i("div",ll,[al,a(A,{type:"primary",underline:!1,onClick:l[7]||(l[7]=t=>y.value="register")},{default:o(()=>[g(" 立即注册 ")]),_:1})])]),_:1},8,["model","rules"]),[[G,e(y)==="login"]]),M(a(Q,{ref_key:"registerFormRef",ref:R,model:e(r),rules:e(ye),class:"login-form","auto-complete":"on"},{default:o(()=>[i("div",null,[a(p,{prop:"companyType"},{default:o(()=>[a(Te,{modelValue:e(r).companyType,"onUpdate:modelValue":l[8]||(l[8]=t=>e(r).companyType=t),"value-key":"",placeholder:"账户类型",clearable:"",filterable:""},{prefix:o(()=>[ol]),default:o(()=>[(f(),Z(le,null,ae(ve,t=>a(Ee,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(r).companyType==="company"?(f(),b(p,{key:0,prop:"companyName"},{default:o(()=>[a(m,{modelValue:e(r).companyName,"onUpdate:modelValue":l[9]||(l[9]=t=>e(r).companyName=t),placeholder:"请输入公司名称"},null,8,["modelValue"])]),_:1})):E("",!0),e(r).companyType==="company"?(f(),b(p,{key:1,prop:"taxID"},{default:o(()=>[a(m,{modelValue:e(r).taxID,"onUpdate:modelValue":l[10]||(l[10]=t=>e(r).taxID=t),placeholder:"请输入公司税号"},null,8,["modelValue"])]),_:1})):E("",!0),e(r).companyType==="company"?(f(),b(p,{key:2,prop:"legalPersonName"},{default:o(()=>[a(m,{modelValue:e(r).legalPersonName,"onUpdate:modelValue":l[11]||(l[11]=t=>e(r).legalPersonName=t),placeholder:"请输入法人姓名"},null,8,["modelValue"])]),_:1})):E("",!0),a(p,{prop:"name"},{default:o(()=>[a(m,{modelValue:e(r).name,"onUpdate:modelValue":l[12]||(l[12]=t=>e(r).name=t),placeholder:"用户名",tabindex:"1"},{prefix:o(()=>[a(s,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue"])]),_:1}),a(p,{prop:"country"},{default:o(()=>[a(Ue,{modelValue:e(r).country,"onUpdate:modelValue":l[13]||(l[13]=t=>e(r).country=t),placeholder:"国家",clearable:"",filterable:"",tabindex:"2"},{prefix:o(()=>[a(s,{name:"i-mdi:format-list-bulleted-type"})]),default:o(()=>[(f(!0),Z(le,null,ae(e(O),t=>(f(),b(Ne,{label:t.chineseName,value:t.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),e(r).country==="CN"?(f(),b(p,{key:3,prop:"phoneNumber"},{default:o(()=>[a(m,{modelValue:e(r).phoneNumber,"onUpdate:modelValue":l[14]||(l[14]=t=>e(r).phoneNumber=t),placeholder:"手机号",tabindex:"3"},{prefix:o(()=>[a(s,{name:"i-ant-design:phone-outlined"})]),_:1},8,["modelValue"])]),_:1})):(f(),b(p,{key:4,prop:"email"},{default:o(()=>[a(m,{modelValue:e(r).email,"onUpdate:modelValue":l[15]||(l[15]=t=>e(r).email=t),placeholder:"邮箱",tabindex:"3"},{prefix:o(()=>[a(s,{name:"i-mdi:email"})]),_:1},8,["modelValue"])]),_:1})),a(p,{prop:"code"},{default:o(()=>[a(m,{modelValue:e(r).code,"onUpdate:modelValue":l[16]||(l[16]=t=>e(r).code=t),placeholder:"验证码",tabindex:"4"},{prefix:o(()=>[a(s,{name:"i-ic:baseline-verified-user"})]),append:o(()=>[a(q,{disabled:e(D),onClick:_e},{default:o(()=>[g(C(e(z)),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),a(p,{prop:"password"},{default:o(()=>[a(m,{modelValue:e(r).password,"onUpdate:modelValue":l[17]||(l[17]=t=>e(r).password=t),type:"password",placeholder:"密码",tabindex:"5","show-password":""},{prefix:o(()=>[a(s,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue"])]),_:1}),a(p,{prop:"agreeToTheAgreement"},{default:o(()=>[i("div",tl,[a(K,{modelValue:e(r).agreeToTheAgreement,"onUpdate:modelValue":l[18]||(l[18]=t=>e(r).agreeToTheAgreement=t),tabindex:"6"},{default:o(()=>[g(" 我已阅读并同意《xxxx协议》 ")]),_:1},8,["modelValue"])])]),_:1})]),a(q,{tabindex:"7",loading:e(k),type:"primary",size:"large",style:{width:"100%","margin-top":"20px"},onClick:J(e(he),["prevent"])},{default:o(()=>[g(" 注册 ")]),_:1},8,["loading","onClick"]),i("div",rl,[nl,a(A,{type:"primary",underline:!1,onClick:l[19]||(l[19]=t=>y.value="login")},{default:o(()=>[g(" 去登录 ")]),_:1})])]),_:1},8,["model","rules"]),[[G,e(y)==="register"]]),M(a(Q,{ref_key:"resetFormRef",ref:B,model:e(w),rules:e(xe),class:"login-form"},{default:o(()=>[sl,i("div",null,[a(p,{prop:"account"},{default:o(()=>[a(m,{modelValue:e(w).account,"onUpdate:modelValue":l[20]||(l[20]=t=>e(w).account=t),placeholder:e(v)("app.account"),type:"text",tabindex:"1"},{prefix:o(()=>[a(s,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1}),a(p,{prop:"code"},{default:o(()=>[a(m,{modelValue:e(w).code,"onUpdate:modelValue":l[21]||(l[21]=t=>e(w).code=t),placeholder:e(v)("app.code"),type:"text",tabindex:"2"},{prefix:o(()=>[a(s,{name:"i-ic:baseline-verified-user"})]),append:o(()=>[a(q,null,{default:o(()=>[g(C(e(v)("app.sendCaptcha")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),a(p,{prop:"newPassword"},{default:o(()=>[a(m,{modelValue:e(w).newPassword,"onUpdate:modelValue":l[22]||(l[22]=t=>e(w).newPassword=t),type:"password",placeholder:e(v)("app.newPassword"),tabindex:"3","show-password":""},{prefix:o(()=>[a(s,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1})]),a(q,{loading:e(k),type:"primary",size:"large",style:{width:"100%","margin-top":"20px"},onClick:J(we,["prevent"])},{default:o(()=>[g(C(e(v)("app.check")),1)]),_:1},8,["loading"]),i("div",ul,[a(A,{type:"primary",underline:!1,onClick:l[23]||(l[23]=t=>y.value="login")},{default:o(()=>[g(C(e(v)("app.goLogin")),1)]),_:1})])]),_:1},8,["model","rules"]),[[G,e(y)==="reset"]])]),a(Oe)])}}});typeof oe=="function"&&oe(te);const gl=Je(te,[["__scopeId","data-v-e88964fa"]]);export{gl as default};
