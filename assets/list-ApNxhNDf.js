
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Le,aO as Ie,r as v,a5 as j,k as Be,a as i,p as xe,o,b as M,f as l,w as t,F as J,t as Q,e as n,q as H,g as d,H as g,j as b,i as y,S as Ee,ba as ze,E as Ge,N as Ue,aQ as De,aR as Te,ao as Pe,aJ as Fe,aK as Re,s as S,ap as K,R as $e}from"./index-B9G65lgK.js";import{_ as Me}from"./index.vue_vue_type_script_setup_true_lang-0vupJV8C.js";import{_ as He}from"./index.vue_vue_type_style_index_0_lang-Bj_h6NGz.js";import{_ as Ae}from"./index.vue_vue_type_script_setup_true_lang-DUrTZD3k.js";import{_ as Oe}from"./index.vue_vue_type_script_setup_true_lang-p2PFSGMy.js";import{_ as Ye}from"./index.vue_vue_type_script_setup_true_lang-cpDyCI9x.js";import{s as qe}from"./apiLoading-BB74-exq.js";import{a as W}from"./survey_vip-WDXNJFXe.js";import{u as je}from"./index-kkun1qfs.js";import{u as Je}from"./survey_vipGroup-RJhEcV9T.js";import{u as Qe}from"./survey_vip-JsBxhMTq.js";import"./index.vue_vue_type_script_setup_true_lang-CbMDhx8w.js";import"./index.vue_vue_type_script_setup_true_lang-DxIAzHUP.js";import"./stagedData-MVZ2S2cK.js";import"./survey_vipGroup-DThVP2CF.js";const w=N=>(Fe("data-v-52a0f983"),N=N(),Re(),N),Ke=w(()=>S("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),We=w(()=>S("div",{style:{color:"#15d36a"},class:"i-fluent:checkmark-12-filled w-1.5em h-1.5em"},null,-1)),Xe=w(()=>S("div",{style:{color:"#e74032"},class:"i-entypo:cross w-1.5em h-1.5em"},null,-1)),Ze=w(()=>S("div",{style:{color:"#15d36a"},class:"i-fluent:checkmark-12-filled w-1.5em h-1.5em"},null,-1)),et=w(()=>S("div",{style:{color:"#e74032"},class:"i-entypo:cross w-1.5em h-1.5em"},null,-1)),tt=Le({name:"vip",__name:"list",setup(N){const X=je(),Z=Je(),ee=Qe(),{pagination:_,getParams:te,onSizeChange:le,onCurrentChange:ae}=Ie(),{format:oe}=ze(),V=v(!1),h=j({list:[],vipLevelList:[],vipGroupList:[]}),ne=v(),x=v(),A=v(),E=v(!0),z=v(!1),G=v("default"),u=v([]),U=v(!1),D=v([{prop:"memberId",label:"会员ID",checked:!0,sprtable:!0},{prop:"memberNickname",label:"会员名称",checked:!0,sprtable:!0},{label:"会员姓名",checked:!0,sortable:!0,prop:"memberName"},{label:"可用余额",checked:!0,sortable:!0,prop:"availableBalance"},{label:"待审金额",checked:!0,sortable:!0,prop:"pendingBalance"},{prop:"memberName",label:"会员姓名",checked:!0,sprtable:!0},{prop:"memberLevelName",label:"会员等级",checked:!0,sprtable:!0},{prop:"memberGroupName",label:"会员组",checked:!0,sprtable:!0},{prop:"B2B|B2C",label:"B2B|B2C",checked:!0,sprtable:!0},{prop:"memberStatus",label:"会员状态",checked:!0,sprtable:!0},{prop:"randomStatus",label:"随机身份",checked:!0,sprtable:!0},{prop:"createName",label:"创建人",checked:!0,sprtable:!0},{prop:"createTime",label:"创建日期",checked:!0,sprtable:!0}]),m=j({memberName:"",memberLevelId:"",memberStatus:"",memberGroupId:"",beginTime:"",endTime:"",time:[]});function re(){x.value.showEdit()}function se(r){x.value.showEdit(r)}const ie=r=>{A.value.showEdit(JSON.stringify(r))};async function T(r,a){const P={memberId:a,memberStatus:r},{status:f}=await qe(W.changestatus(P));f===1&&Ge.success({message:"修改成功"}),ee.NickNameList=null,k()}function k(){_.value.page=1,C()}function me(r){le(r).then(()=>C())}function O(r=1){ae(r).then(()=>C())}async function C(){try{V.value=!0;const r={...te(),...m};m.time&&m.time.length&&(r.beginTime=m.time[0]||"",r.endTime=m.time[1]||"");const a=await W.list(r);h.list=a.data.getMemberInfoList,_.value.total=a.data.total,V.value=!1}catch{}finally{V.value=!1}}function ue(){Object.assign(m,{memberName:"",memberLevelId:"",memberStatus:"",memberGroupId:"",beginTime:"",endTime:"",time:[]}),k()}function ce(r){ne.value=r}return Be(async()=>{D.value.forEach(r=>{r.checked&&u.value.push(r.prop)}),C(),h.vipLevelList=await X.getLevelNameList(),h.vipGroupList=await Z.getGroupNameList()}),(r,a)=>{const P=i("el-input"),f=i("el-form-item"),L=i("el-option"),F=i("el-select"),pe=i("el-date-picker"),Y=Ue,R=i("ElButton"),de=i("ElFormItem"),be=i("ElForm"),ve=Ae,_e=i("ElDivider"),I=i("el-button"),fe=He,ge=De,he=Te,ye=i("el-row"),p=i("el-table-column"),q=Me,B=i("el-text"),$=i("ElSwitch"),ke=i("el-tag"),Se=i("el-empty"),we=i("el-table"),Ne=i("ElPagination"),Ve=Pe,Ce=xe("loading");return o(),M("div",{class:Ee({"absolute-container":U.value})},[l(Ve,null,{default:t(()=>[l(ve,{"show-toggle":!1},{default:t(({fold:e,toggle:c})=>[l(be,{model:m,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:t(()=>[l(f,{label:""},{default:t(()=>[l(P,{modelValue:m.memberName,"onUpdate:modelValue":a[0]||(a[0]=s=>m.memberName=s),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"会员ID、会员名称、姓名"},null,8,["modelValue"])]),_:1}),l(f,{label:""},{default:t(()=>[l(F,{modelValue:m.memberLevelId,"onUpdate:modelValue":a[1]||(a[1]=s=>m.memberLevelId=s),clearable:"",placeholder:"会员等级"},{default:t(()=>[(o(!0),M(J,null,Q(h.vipLevelList,s=>(o(),n(L,{key:s.memberLevelId,label:s.levelNameOrAdditionRatio,value:s.memberLevelId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(f,{label:""},{default:t(()=>[l(F,{modelValue:m.memberStatus,"onUpdate:modelValue":a[2]||(a[2]=s=>m.memberStatus=s),clearable:"",placeholder:"会员状态"},{default:t(()=>[l(L,{label:"关闭",value:1}),l(L,{label:"开启",value:2})]),_:1},8,["modelValue"])]),_:1}),H(l(f,{label:""},{default:t(()=>[l(F,{modelValue:m.memberGroupId,"onUpdate:modelValue":a[3]||(a[3]=s=>m.memberGroupId=s),clearable:"",placeholder:"所属会员组"},{default:t(()=>[(o(!0),M(J,null,Q(h.vipGroupList,s=>(o(),n(L,{key:s.memberGroupId,label:s.memberGroupName,value:s.memberGroupId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:2},1536),[[K,!e]]),H(l(f,null,{default:t(()=>[l(pe,{modelValue:m.time,"onUpdate:modelValue":a[4]||(a[4]=s=>m.time=s),type:"datetimerange","unlink-panels":"","range-separator":"-","start-placeholder":"创建开始日期","end-placeholder":"创建结束日期","value-format":"YYYY-MM-DD hh:mm:ss",size:"default"},null,8,["modelValue"])]),_:2},1536),[[K,!e]]),l(de,null,{default:t(()=>[l(R,{type:"primary",onClick:a[5]||(a[5]=s=>O())},{icon:t(()=>[l(Y,{name:"i-ep:search"})]),default:t(()=>[d(" 筛选 ")]),_:1}),l(R,{onClick:ue},{icon:t(()=>[Ke]),default:t(()=>[d(" 重置 ")]),_:1}),l(R,{link:"",onClick:c},{icon:t(()=>[l(Y,{name:e?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:t(()=>[d(" "+g(e?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),l(_e,{"border-style":"dashed"}),l(ye,null,{default:t(()=>[l(fe,null,{default:t(()=>[l(I,{type:"primary",size:"default",onClick:re},{default:t(()=>[d(" 新增 ")]),_:1})]),_:1}),l(he,null,{default:t(()=>[l(I,{size:"default"},{default:t(()=>[d(" 导出 ")]),_:1}),l(ge,{border:E.value,"onUpdate:border":a[6]||(a[6]=e=>E.value=e),tableAutoHeight:U.value,"onUpdate:tableAutoHeight":a[7]||(a[7]=e=>U.value=e),checkList:u.value,"onUpdate:checkList":a[8]||(a[8]=e=>u.value=e),columns:D.value,"onUpdate:columns":a[9]||(a[9]=e=>D.value=e),"line-height":G.value,"onUpdate:lineHeight":a[10]||(a[10]=e=>G.value=e),stripe:z.value,"onUpdate:stripe":a[11]||(a[11]=e=>z.value=e),style:{"margin-left":"12px"},onQueryData:k},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),H((o(),n(we,{border:E.value,data:h.list,size:G.value,stripe:z.value,onSelectionChange:ce},{empty:t(()=>[l(Se,{class:"vab-data-empty",description:"暂无数据"})]),default:t(()=>[l(p,{align:"center",type:"selection"}),u.value.includes("memberId")?(o(),n(p,{key:0,align:"center",prop:"memberId",width:"180","show-overflow-tooltip":"",label:"会员ID"})):b("",!0),u.value.includes("memberNickname")?(o(),n(p,{key:1,align:"center",prop:"memberNickname","show-overflow-tooltip":"",label:"会员名称"})):b("",!0),u.value.includes("memberName")?(o(),n(p,{key:2,align:"center",prop:"memberName","show-overflow-tooltip":"",label:"会员姓名"},{default:t(({row:e})=>[d(g(e.memberName?e.memberName:"-"),1)]),_:1})):b("",!0),u.value.includes("availableBalance")?(o(),n(p,{key:3,align:"center",prop:"availableBalance","show-overflow-tooltip":"",label:"可用余额"},{default:t(({row:e})=>[l(q),d(g(e.availableBalance||0),1)]),_:1})):b("",!0),u.value.includes("pendingBalance")?(o(),n(p,{key:4,align:"center",prop:"pendingBalance","show-overflow-tooltip":"",label:"待审金额"},{default:t(({row:e})=>[l(q),d(g(e.pendingBalance||0),1)]),_:1})):b("",!0),u.value.includes("memberLevelName")?(o(),n(p,{key:5,align:"center",prop:"memberLevelName","show-overflow-tooltip":"",label:"会员等级"})):b("",!0),u.value.includes("memberGroupName")?(o(),n(p,{key:6,align:"center",prop:"memberGroupName","show-overflow-tooltip":"",label:"会员组"},{default:t(({row:e})=>[d(g(e.memberGroupName?e.memberGroupName:"-"),1)]),_:1})):b("",!0),u.value.includes("B2B|B2C")?(o(),n(p,{key:7,align:"center","show-overflow-tooltip":"",label:"B2B|B2C"},{default:t(({row:e})=>[e.b2bStatus&&e.b2bStatus===2?(o(),n(B,{key:0,class:"mx-1"},{default:t(()=>[We]),_:1})):(o(),n(B,{key:1,class:"mx-1"},{default:t(()=>[Xe]),_:1})),d(" | "),e.b2cStatus&&e.b2cStatus===2?(o(),n(B,{key:2,class:"mx-1"},{default:t(()=>[Ze]),_:1})):(o(),n(B,{key:3,class:"mx-1"},{default:t(()=>[et]),_:1}))]),_:1})):b("",!0),u.value.includes("memberStatus")?(o(),n(p,{key:8,align:"center","show-overflow-tooltip":"",label:"会员状态"},{default:t(({row:e})=>[e.memberStatus===3?(o(),n($,{key:0,modelValue:e.memberStatus,"onUpdate:modelValue":c=>e.memberStatus=c,"inline-prompt":"","inactive-value":3,"active-value":2,"inactive-text":"待审核","active-text":"启用",onChange:c=>T(c,e.memberId)},null,8,["modelValue","onUpdate:modelValue","onChange"])):(o(),n($,{key:1,modelValue:e.memberStatus,"onUpdate:modelValue":c=>e.memberStatus=c,"inline-prompt":"","inactive-value":1,"active-value":2,"inactive-text":"禁用","active-text":"启用",onChange:c=>T(c,e.memberId)},null,8,["modelValue","onUpdate:modelValue","onChange"]))]),_:1})):b("",!0),u.value.includes("randomStatus")?(o(),n(p,{key:9,align:"center","show-overflow-tooltip":"",label:"随机身份"},{default:t(({row:e})=>[l($,{modelValue:e.randomStatus,"onUpdate:modelValue":c=>e.randomStatus=c,"inline-prompt":"","inactive-value":1,"active-value":2,"inactive-text":"禁用","active-text":"启用",onChange:c=>T(c,e.memberId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):b("",!0),u.value.includes("createName")?(o(),n(p,{key:10,align:"center",prop:"createName","show-overflow-tooltip":"",label:"创建人"},{default:t(({row:e})=>[d(g(e.createName?e.createName:"-"),1)]),_:1})):b("",!0),u.value.includes("createTime")?(o(),n(p,{key:11,align:"center",prop:"createTime","show-overflow-tooltip":"",label:"创建时间"},{default:t(({row:e})=>[l(ke,{effect:"plain",type:"info"},{default:t(()=>[d(g(y(oe)(e.createTime)),1)]),_:2},1024)]),_:1})):b("",!0),l(p,{align:"center",label:"操作",fixed:"right","show-overflow-tooltip":"",width:"180"},{default:t(({row:e})=>[l(I,{size:"small",plain:"",type:"primary",onClick:c=>se(e)},{default:t(()=>[d(" 编辑 ")]),_:2},1032,["onClick"]),l(I,{size:"small",plain:"",type:"primary",onClick:c=>ie(e)},{default:t(()=>[d(" 加减款 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","data","size","stripe"])),[[Ce,V.value]]),l(Ne,{"current-page":y(_).page,total:y(_).total,"page-size":y(_).size,"page-sizes":y(_).sizes,layout:y(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:me,onCurrentChange:O},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),l(Oe,{ref_key:"editRef",ref:x,onFetchData:k},null,512),l(Ye,{ref_key:"vipPlusMinusPaymentsRef",ref:A,onFetchData:k},null,512)],2)}}}),ft=$e(tt,[["__scopeId","data-v-52a0f983"]]);export{ft as default};
