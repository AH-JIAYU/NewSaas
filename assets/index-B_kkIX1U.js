
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{c as j}from"./user_cooperation-WeC_KTb_.js";import{d as $,r as c,c as G,a as s,o as d,b as p,f as a,w as o,g as i,i as n,F as L,t as J,e as I,y as m,z as y,j as h,A as K,E as P,aH as Q,aI as W,aE as X,L as Y}from"./index-ChQqcNbm.js";import{_ as Z}from"./index.vue_vue_type_script_setup_true_lang-SxHCfjyr.js";import"./department-htT9pOTR.js";const w=f=>(Q("data-v-c4ba2852"),f=f(),W(),f),ee={style:{float:"left"}},te={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"0.8125rem"}},ae={key:0},oe={key:1},ne={style:{display:"flex","justify-items":"center"}},le=w(()=>m("span",{style:{"margin-right":"15px"}},"发送项目",-1)),re={style:{display:"flex","justify-items":"center"}},se=w(()=>m("span",{style:{"margin-right":"15px"}},"接收项目",-1)),de=$({__name:"index",emits:["fetch-data"],setup(f,{expose:E,emit:R}){const C=R,u=c(!1);c("");const b=c(),e=c({form:{},tenantUserList:[],tenantStaffList:[],chargeUserId:null,departmentId:null,chargeUserName:"",rules:{beInvitationTenantId:[{required:!0,message:"请选择租户",trigger:"change"}],priceRatio:[{required:!0,message:"请输入价格比例",trigger:"blur"}],sendProjectType:[{required:!0,message:"请选择发送项目",trigger:"change"}],receiveProjectType:[{required:!0,message:"请选择接收项目",trigger:"change"}]}});async function B(){await D(),u.value=!0}async function D(){const r=await j.getTenantUserList({});e.value.tenantUserList=r.data.tenantUserInfoList}const U=G(()=>{const r=e.value.tenantUserList.find(l=>l.tenantId===e.value.form.beInvitationTenantId);return r?(e.value.form.tenantName=r.name,e.value.form.phoneOrEmail=X.local.get("account"),[r]):[]});function V(){u.value=!1,e.value.form={},b.value.resetFields()}async function F(){b.value.validate(r=>{r&&(e.value.form.receiveProjectType==2&&(e.value.form.chargeUserId=null,e.value.form.chargeUserName="",e.value.form.departmentId=""),j.addInvitationBind(e.value.form).then(l=>{l.status==-1?P.success({message:l.error,center:!0}):(P.success({message:"发送成功",center:!0}),C("fetch-data"),V())}))})}E({showEdit:B});const T=c();function S(){T.value.showEdit()}function q(r){e.value.form.chargeUserId=r.chargeUserId,e.value.form.departmentId=r.departmentId,e.value.form.chargeUserName=r.chargeUserName,e.value.form.name=(r.departmentName?r.departmentName:"")+(e.value.form.chargeUserName?e.value.form.chargeUserName:"")}return(r,l)=>{const z=s("el-option"),A=s("el-select"),_=s("el-form-item"),v=s("el-table-column"),M=s("el-table"),N=s("el-input"),g=s("el-radio"),k=s("el-radio-group"),H=s("ElForm"),x=s("el-button"),O=s("el-dialog");return d(),p("div",null,[a(O,{modelValue:n(u),"onUpdate:modelValue":l[5]||(l[5]=t=>K(u)?u.value=t:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:"邀约公司"},{footer:o(()=>[a(x,{onClick:V},{default:o(()=>[i(" 关闭 ")]),_:1}),a(x,{type:"primary",onClick:F},{default:o(()=>[i(" 发送邀约 ")]),_:1})]),default:o(()=>[a(H,{ref_key:"formRef",ref:b,rules:n(e).rules,model:n(e).form,"label-width":"7rem"},{default:o(()=>[a(_,{label:"公司名称",prop:"beInvitationTenantId"},{default:o(()=>[a(A,{modelValue:n(e).form.beInvitationTenantId,"onUpdate:modelValue":l[0]||(l[0]=t=>n(e).form.beInvitationTenantId=t),clearable:""},{default:o(()=>[(d(!0),p(L,null,J(n(e).tenantUserList,t=>(d(),I(z,{key:t.tenantId,value:t.tenantId,label:t.tenantName},{default:o(()=>[m("span",ee,y(t.tenantName),1),m("span",te,y(t.tenantId),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(U).length?(d(),I(M,{key:0,data:n(U),border:"",stripe:"",style:{"margin-bottom":"18px"}},{default:o(()=>[a(v,{prop:"name",label:"用户名"}),a(v,{prop:"tenantName",label:"公司名称"}),a(v,{prop:"country",label:"区域"}),a(v,{label:"电子邮箱/手机号"},{default:o(({row:t})=>[t.phone?(d(),p("span",ae,y(t.phone),1)):(d(),p("span",oe,y(t.email),1))]),_:1})]),_:1},8,["data"])):h("",!0),n(e).form.beInvitationTenantId?(d(),p(L,{key:1},[a(_,{label:"价格比例",prop:"priceRatio"},{default:o(()=>[a(N,{modelValue:n(e).form.priceRatio,"onUpdate:modelValue":l[1]||(l[1]=t=>n(e).form.priceRatio=t),clearable:""},{append:o(()=>[i("%")]),_:1},8,["modelValue"])]),_:1}),a(_,{label:"项目分配方式",prop:"sendProjectType","label-width":"7rem"},{default:o(()=>[m("div",ne,[le,a(k,{modelValue:n(e).form.sendProjectType,"onUpdate:modelValue":l[2]||(l[2]=t=>n(e).form.sendProjectType=t)},{default:o(()=>[a(g,{value:1},{default:o(()=>[i("自动")]),_:1}),a(g,{value:2},{default:o(()=>[i("手动")]),_:1})]),_:1},8,["modelValue"])])]),_:1}),a(_,{prop:"receiveProjectType"},{default:o(()=>[m("div",re,[se,a(k,{modelValue:n(e).form.receiveProjectType,"onUpdate:modelValue":l[3]||(l[3]=t=>n(e).form.receiveProjectType=t)},{default:o(()=>[a(g,{value:1},{default:o(()=>[i("自动")]),_:1}),a(g,{value:2},{default:o(()=>[i("手动")]),_:1})]),_:1},8,["modelValue"])]),n(e).form.receiveProjectType==1?(d(),I(N,{key:0,placeholder:"请选择负责部门/PM",clearable:"",style:{width:"200px","margin-left":"25px"},onClick:S,modelValue:n(e).form.name,"onUpdate:modelValue":l[4]||(l[4]=t=>n(e).form.name=t)},null,8,["modelValue"])):h("",!0)]),_:1})],64)):h("",!0)]),_:1},8,["rules","model"])]),_:1},8,["modelValue"]),a(Z,{ref_key:"userRef",ref:T,onUserData:q},null,512)])}}}),pe=Y(de,[["__scopeId","data-v-c4ba2852"]]);export{pe as default};
