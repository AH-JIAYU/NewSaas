
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ue,az as oe,ae as re,ac as se,a6 as pe,r as _,E as c,M as x,o as ie,P as de,a2 as f,a as b,i as h,f as e,w as l,h as o,bc as me,b as m,t as g,N as U,O as E,g as v,c as I,j as k,_ as fe,aH as ce,aI as be,y as ve}from"./index-7OqlQ5Tf.js";import ye from"./index-D2wWPckc.js";import{U as _e}from"./user_supplier-DyZSW_bb.js";import{u as ge}from"./configuration_supplierLevel-CZwoIna9.js";import{u as Te}from"./user_customer-D3TgpjmT.js";import{a as Se}from"./user_supplier-ByBWrZ_e.js";import"./apiLoading-Cx6WB2ya.js";import"./user_customer-DaQObqgK.js";const N=V=>(ce("data-v-e3a786ba"),V=V(),be(),V),we={class:"card-header"},Ve={style:{display:"flex","justify-content":"space-between","align-items":"center",padding:"0 1rem"}},Ce=N(()=>m("div",{class:"i-ic:round-plus w-1.3em h-1.3em"},null,-1)),Ie=N(()=>m("div",{class:"i-ic:round-plus w-1.3em h-1.3em"},null,-1)),Le={class:"card-header"},xe=N(()=>m("br",null,null,-1)),he=N(()=>m("div",null,[v(" 为供应商设定筛选条件，更精准匹配合适项目"),m("br"),v(" 例：仅选中【客户1】，该供应商只能做【客户1】的项目 ")],-1)),Ne=ue({__name:"index",props:{leftTab:Object,tabIndex:Number},setup(V){const A=oe(),{t:n}=re(),H=_e(),G=ge();Te();const J=se(),K=pe("validateTopTabs"),P=_();_(!1);const t=V,D=_(null);_({});const W=[{label:n("supplier.new.company"),value:"company"},{label:n("supplier.new.personal"),value:"personal"}];c(()=>n("supplier.new.USD")),c(()=>n("supplier.new.CNY"));const T=x({supplierAccord:[{required:!0,message:c(()=>n("supplier.new.enterSuppllierName")),trigger:"blur"},{min:2,max:50,message:c(()=>n("supplier.new.2to50")),trigger:"blur"}],memberLevelId:[{required:!0,message:c(()=>n("supplier.new.memberLevelSelect")),trigger:"change"}],subordinateCountryId:[{required:!0,message:c(()=>n("supplier.new.areaSelect")),trigger:"change"}],supplierLevelId:[{required:!0,message:c(()=>n("supplier.new.supplierLevelSelect")),trigger:"change"}],type:[{required:!0,message:c(()=>n("supplier.new.supplierTypeSelect")),trigger:"change"}]}),X=(r,a,s)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(t.leftTab.supplierPhone)?s():s(new Error(n("supplier.new.legalPhoneNumber")))},ee=(r,a,s)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t.leftTab.emailAddress)?s():s(new Error(n("supplier.new.legalEmail")))},q=r=>{r&&(t.leftTab.countryType=r==="343"?1:2,r==="343"?(t.leftTab.tenantSupplierId||(t.leftTab.currencyType=A.currencyType===1?"USD":"CNY"),T.emailAddress&&delete T.emailAddress,T.supplierPhone=[{required:!0,message:c(()=>n("supplier.new.enterPhoneNumber")),trigger:"blur"},{validator:X,trigger:"blur"}]):(t.leftTab.tenantSupplierId||(t.leftTab.currencyType=A.currencyType===1?"USD":"CNY"),T.supplierPhone&&delete T.supplierPhone,T.emailAddress=[{required:!0,message:c(()=>n("supplier.new.enterEmail")),trigger:"blur"},{validator:ee,trigger:"blur"}]))};t.leftTab.relevanceCountryIdList?console.log(t.leftTab.relevanceCountryIdList):t.leftTab.relevanceCountryIdList=[];const B=()=>{P.value.showEdit()},z=x({checked:!1,relatedCustomers:[],payMethod:H.payMethod,countryList:[],supplierLevelList:[]}),y=x({updateTenantSupplierCustomerInfoList:[],countryList:[]}),M=_("basicSettings"),R=async()=>{z.supplierLevelList=await G.getLevelNameList(),q(t.leftTab.subordinateCountryId)},j=_([]);_([]);const C=_([]),Y=(r,a)=>r?a.label&&a.label.toLowerCase().includes(r.toLowerCase()):!0,le=r=>{r.forEach(a=>{j.value.push({label:a.chineseName,key:a.id,initial:a.code})})};x({customerShortName:"",customerStatus:2,antecedentQuestionnaire:null}),ie(async()=>{C.value=[];const{data:r}=await Se.getCustomerCooperation({}),a=(r==null?void 0:r.getCustomerInfoLists)||[],s=(r==null?void 0:r.getCooperationInfoLists)||[];a.length!=0&&a.forEach(d=>{C.value.push({label:d.customerName,key:d.customerId,type:1})}),s.length!=0&&s.forEach(d=>{C.value.push({label:d.tenantName,key:d.tenantId,type:2})}),t.leftTab.updateTenantSupplierCustomerInfoList?t.leftTab.updateTenantSupplierCustomerInfoList.length&&t.leftTab.updateTenantSupplierCustomerInfoList.forEach(d=>{y.updateTenantSupplierCustomerInfoList.push(d.tenantCustomerId)}):(t.leftTab.updateTenantSupplierCustomerInfoList=[],y.updateTenantSupplierCustomerInfoList=[]),y.countryList=await J.getCountry(),await R(),le(y.countryList)}),de(()=>{K(D.value)});const te=()=>{const r=y.updateTenantSupplierCustomerInfoList.map(a=>{const s=C.value.find(d=>d.key===a);return s?{type:s.type,tenantCustomerId:s.key}:null}).filter(Boolean);t.leftTab.updateTenantSupplierCustomerInfoList=r};return(r,a)=>{const s=f("el-option"),d=f("el-select"),p=f("el-form-item"),i=f("el-col"),S=f("el-input"),O=f("el-button"),w=f("el-row"),Q=f("el-card"),L=f("ElSwitch"),$=fe,F=f("el-tooltip"),Z=f("el-transfer"),ae=f("el-tab-pane"),ne=f("el-tabs");return b(),h("div",null,[e(ne,{modelValue:M.value,"onUpdate:modelValue":a[17]||(a[17]=u=>M.value=u)},{default:l(()=>[e(ae,{label:o(n)("supplier.new.basicSettings"),name:"basicSettings"},{default:l(()=>[e(o(me),{ref_key:"formRef",ref:D,rules:o(T),model:t.leftTab,"label-width":"100px","validate-on-rule-change":!1},{default:l(()=>[e(Q,{class:"box-card"},{header:l(()=>[m("div",we,[m("span",null,g(o(n)("supplier.new.basicInformation")),1)])]),default:l(()=>[e(w,{gutter:10},{default:l(()=>[e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.supplierType"),prop:"type"},{default:l(()=>[e(d,{modelValue:t.leftTab.type,"onUpdate:modelValue":a[0]||(a[0]=u=>t.leftTab.type=u),"value-key":"",placeholder:"",clearable:"",filterable:""},{default:l(()=>[(b(),h(U,null,E(W,u=>e(s,{key:u.value,label:u.label,value:u.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.supplierAccord"),prop:"supplierAccord"},{default:l(()=>[e(S,{modelValue:t.leftTab.supplierAccord,"onUpdate:modelValue":a[1]||(a[1]=u=>t.leftTab.supplierAccord=u),clearable:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.supplierLevel"),prop:"supplierLevelId"},{default:l(()=>[e(d,{clearable:"",filterable:"",modelValue:t.leftTab.supplierLevelId,"onUpdate:modelValue":a[2]||(a[2]=u=>t.leftTab.supplierLevelId=u)},{empty:l(()=>[m("div",Ve,[v(g(o(n)("supplier.new.nodata"))+" ",1),e(O,{type:"primary",link:"",size:"small",onClick:B},{default:l(()=>[v(g(o(n)("supplier.new.quickAdd"))+" ",1),Ce]),_:1})])]),default:l(()=>[(b(!0),h(U,null,E(o(z).supplierLevelList,u=>(b(),I(s,{key:u.tenantSupplierLevelId,value:u.tenantSupplierLevelId,label:u.levelNameOrAdditionRatio},null,8,["value","label"]))),128)),e(O,{size:"small",class:"buttonClass",onClick:B},{default:l(()=>[v(g(o(n)("supplier.new.quickAdd"))+" ",1),Ie]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(w,{gutter:10},{default:l(()=>[e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.area"),prop:"subordinateCountryId"},{default:l(()=>[e(d,{clearable:"",filterable:"",modelValue:t.leftTab.subordinateCountryId,"onUpdate:modelValue":a[3]||(a[3]=u=>t.leftTab.subordinateCountryId=u),onChange:q},{default:l(()=>[(b(!0),h(U,null,E(o(y).countryList,u=>(b(),I(s,{key:u.id,value:u.id,label:u.chineseName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.supplierName")},{default:l(()=>[e(S,{clearable:"",modelValue:t.leftTab.supplierName,"onUpdate:modelValue":a[4]||(a[4]=u=>t.leftTab.supplierName=u)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.supplierPhone"),prop:"supplierPhone"},{default:l(()=>[e(S,{clearable:"",modelValue:t.leftTab.supplierPhone,"onUpdate:modelValue":a[5]||(a[5]=u=>t.leftTab.supplierPhone=u)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(w,{gutter:10},{default:l(()=>[e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.emailAddress"),prop:"emailAddress"},{default:l(()=>[e(S,{clearable:"",modelValue:t.leftTab.emailAddress,"onUpdate:modelValue":a[6]||(a[6]=u=>t.leftTab.emailAddress=u)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:o(n)("supplier.new.settlementCycle")},{default:l(()=>[e(d,{modelValue:t.leftTab.settlementCycle,"onUpdate:modelValue":a[7]||(a[7]=u=>t.leftTab.settlementCycle=u)},{default:l(()=>[e(s,{label:"net 30",value:30}),e(s,{label:"net 60",value:60}),e(s,{label:"net 90",value:90}),e(s,{label:"net 180",value:180})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[t.leftTab.type==="company"?(b(),I(p,{key:0,label:o(n)("supplier.new.companyName")},{default:l(()=>[e(S,{clearable:"",modelValue:t.leftTab.companyName,"onUpdate:modelValue":a[8]||(a[8]=u=>t.leftTab.companyName=u)},null,8,["modelValue"])]),_:1},8,["label"])):k("",!0)]),_:1})]),_:1}),e(w,{gutter:10},{default:l(()=>[e(i,{span:8},{default:l(()=>[t.leftTab.type==="company"?(b(),I(p,{key:0,label:o(n)("supplier.new.legalPersonName"),prop:""},{default:l(()=>[e(S,{clearable:"",modelValue:t.leftTab.legalPersonName,"onUpdate:modelValue":a[9]||(a[9]=u=>t.leftTab.legalPersonName=u)},null,8,["modelValue"])]),_:1},8,["label"])):k("",!0)]),_:1}),e(i,{span:8},{default:l(()=>[t.leftTab.type==="company"?(b(),I(p,{key:0,label:o(n)("supplier.new.taxID"),prop:""},{default:l(()=>[e(S,{clearable:"",modelValue:t.leftTab.taxID,"onUpdate:modelValue":a[10]||(a[10]=u=>t.leftTab.taxID=u)},null,8,["modelValue"])]),_:1},8,["label"])):k("",!0)]),_:1})]),_:1})]),_:1}),e(Q,{class:"box-card"},{header:l(()=>[m("div",Le,[m("span",null,g(o(n)("supplier.new.permissionInformation")),1)])]),default:l(()=>[e(w,{gutter:10},{default:l(()=>[e(i,{span:3},{default:l(()=>[e(p,{label:o(n)("supplier.new.surveySystem")},{default:l(()=>[e(L,{modelValue:t.leftTab.surveySystem,"onUpdate:modelValue":a[11]||(a[11]=u=>t.leftTab.surveySystem=u),"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":o(n)("common.enable"),"inactive-text":o(n)("common.disable")},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])]),_:1}),e(i,{span:3},{default:l(()=>[e(p,{label:"B2B"},{default:l(()=>[e(L,{modelValue:t.leftTab.b2bStatus,"onUpdate:modelValue":a[12]||(a[12]=u=>t.leftTab.b2bStatus=u),"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":o(n)("common.enable"),"inactive-text":o(n)("common.disable")},null,8,["modelValue","active-text","inactive-text"])]),_:1})]),_:1}),e(i,{span:4},{default:l(()=>[e(p,{label:"B2C"},{default:l(()=>[e(L,{modelValue:t.leftTab.b2cStatus,"onUpdate:modelValue":a[13]||(a[13]=u=>t.leftTab.b2cStatus=u),"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":o(n)("common.enable"),"inactive-text":o(n)("common.disable")},null,8,["modelValue","active-text","inactive-text"])]),_:1})]),_:1}),e(i,{span:3},{default:l(()=>[e(p,{label:o(n)("supplier.new.surveyStatus")},{default:l(()=>[e(L,{modelValue:t.leftTab.supplierStatus,"onUpdate:modelValue":a[14]||(a[14]=u=>t.leftTab.supplierStatus=u),"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":o(n)("common.enable"),"inactive-text":o(n)("common.disable")},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])]),_:1})]),_:1}),e(w,{gutter:24},{default:l(()=>[e(i,{span:11},{default:l(()=>[m("div",null,[e(p,null,{label:l(()=>[m("div",null,[e(F,{class:"tooltips",placement:"top"},{content:l(()=>[m("div",null,[v(g(o(n)("supplier.new.tips1")),1),xe,v(" "+g(o(n)("supplier.new.example")),1)])]),default:l(()=>[e($,{class:"SvgIcon2",name:"i-ri:question-line"})]),_:1}),v(" "+g(o(n)("supplier.new.authorizationArea")),1)])]),_:1})]),e(Z,{style:{"margin-left":"1.875rem"},modelValue:t.leftTab.relevanceCountryIdList,"onUpdate:modelValue":a[15]||(a[15]=u=>t.leftTab.relevanceCountryIdList=u),filterable:"","filter-method":Y,"filter-placeholder":o(n)("supplier.new.enterQueryCountry"),data:j.value,titles:[o(n)("supplier.new.unselectedCountry"),o(n)("supplier.new.selectedCountries")]},null,8,["modelValue","filter-placeholder","data","titles"])]),_:1}),e(i,{span:11},{default:l(()=>[m("div",null,[e(p,null,{label:l(()=>[m("div",null,[e(F,{class:"tooltips",placement:"top"},{content:l(()=>[he]),default:l(()=>[e($,{class:"SvgIcon2",name:"i-ri:question-line"})]),_:1}),v(" 分配客户 ")])]),_:1})]),e(Z,{style:{"margin-left":"1.875rem"},modelValue:o(y).updateTenantSupplierCustomerInfoList,"onUpdate:modelValue":a[16]||(a[16]=u=>o(y).updateTenantSupplierCustomerInfoList=u),filterable:"","filter-method":Y,"filter-placeholder":"输入查询客户",data:C.value,onChange:te,titles:["未选择客户","已分配客户"]},null,8,["modelValue","data"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["label"])]),_:1},8,["modelValue"]),e(ye,{ref_key:"EditRef",ref:P,onQueryData:R},null,512)])}}}),ze=ve(Ne,[["__scopeId","data-v-e3a786ba"]]);export{ze as default};
