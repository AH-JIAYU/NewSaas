
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as Ee}from"./index.vue_vue_type_script_setup_true_lang-lvIn-2Jo.js";import{s as W,d as ke,al as Ne,x as Te,a0 as Ue,a1 as qe,r as d,aL as w,bd as X,aR as Ie,a2 as Re,b as Y,f as l,w as o,p as i,n as K,ao as Z,i as e,y as Pe,a as g,aH as Fe,aI as Se,N as Ae,E as U,a5 as Le,o as h,H as $e,aD as ze,g as c,G as C,e as E,az as ee,j as M,ay as G,F as De,q as Be,M as Ke,Q as Ze,am as ae}from"./index-BQjh9Koe.js";import Me from"./index-Cw73pj_D.js";const F={sendCode:b=>W.post("user/sendCode",b),register:b=>W.post("user/register",b)},q=b=>(Fe("data-v-db29fea0"),b=b(),Se(),b),Ge=q(()=>i("div",{class:"bg-banner"},null,-1)),He={id:"login-box"},Oe=q(()=>i("div",{class:"login-banner"},[i("h1",{style:{"font-size":"50px","font-weight":"normal"}},"欢迎"),i("h3",{h1:"",style:{"font-size":"30px","font-weight":"normal"}},"来到租户系统 !")],-1)),je={class:"title-container"},Qe={class:"fx-c"},Je={style:{height:"11.5625rem"}},We={class:"flex-bar",style:{width:"100%",margin:"0"}},Xe={class:"flex-bar"},Ye={class:"sub-link"},ea=q(()=>i("span",{class:"text"},"还不是会员?",-1)),aa={class:"flex-bar",style:{margin:"0"}},la={class:"sub-link"},oa=q(()=>i("span",{class:"text"},"已经有帐号?",-1)),ta=q(()=>i("div",{class:"title-container"},[i("h3",{class:"title"},"忘记密码了? 🔒")],-1)),ra={class:"sub-link"},le=ke({name:"Login",__name:"login",setup(b){var j;const oe=Ne(),te=Pe(),re=Ae(),ne=Te(),se=Ue(),{t:f}=qe();new URL(""+new URL("login-banner-ZfMZACb6.png",import.meta.url).href,import.meta.url).href,new URL(""+new URL("logo-CLz_KCqM.png",import.meta.url).href,import.meta.url).href;const v=d("login"),V=d(!1),ue=d(((j=te.query.redirect)==null?void 0:j.toString())??ne.settings.home.fullPath),k=d(),_=d("code"),S=d("获取验证码"),A=d(!1),u=d({account:w.local.get("login_account")||"",remember:w.local.has("login_account"),agreeToTheAgreement:!1}),ie=(n,a,s)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(u.value.account)?s():s(new Error("请输入合法手机号"))},de=(n,a,s)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(u.value.account)?s():s(new Error("请输入合法邮箱"))},I=d({account:[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}],agreeToTheAgreement:[{required:!0,validator:(n,a)=>a===!0,message:"请阅读并勾选协议",trigger:"change"}]}),pe=()=>{u.value.account.includes("@")?I.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"},{validator:de,trigger:"blur"}]:I.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"},{validator:ie,trigger:"blur"}]};async function me(){k.value.validateField("account",async n=>{if(n){let a;u.value.account.includes("@")?a={email:u.value.account,type:"login_email"}:a={phone:u.value.account,type:"login_phone_number"};const{status:s}=await F.sendCode(a);s===1&&U.success({message:"已发送"})}}),ce()}const ce=()=>{A.value=!0;let n=60;y.value=setInterval(()=>{n>0?(n--,S.value=`请在${n}s后重新获取`):(clearInterval(y.value),S.value="获取验证码",y.value=null,A.value=!1)},1e3)},L=X(()=>{k.value&&k.value.validate(n=>{if(n){let a={...u.value};_.value==="password"?a.type=1:u.value.account.includes("@")?a.type=3:a.type=2,V.value=!0,se.login(a).then(()=>{V.value=!1,u.value.remember?w.local.set("login_account",u.value.account):w.local.remove("login_account"),re.push(ue.value)}).catch(()=>{V.value=!1})}})},3e3),y=d(null),$=d("获取验证码"),z=d(!1),R=d(),H=d([]),r=d({name:"",password:"",email:"",phoneNumber:"",code:"",country:"",type:"phone",agreeToTheAgreement:!1,companyType:"company",companyName:"",legalPersonName:"",taxID:""}),ge=d({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],companyName:[{required:!0,trigger:"blur",message:"请输入公司名称"}],companyType:[{required:!0,trigger:"change",message:"请选择账户类型"}],legalPersonName:[{required:!0,trigger:"blur",message:"请输入法人姓名"}],email:[{required:!0,trigger:"blur",message:"请输入邮箱"},{validator:(n,a,s)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(r.value.email)?s():s(new Error("请输入合法邮箱"))},trigger:"blur"}],phoneNumber:[{required:!0,trigger:"blur",message:"请输入手机号码"},{validator:(n,a,s)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(r.value.phoneNumber)?s():s(new Error("请输入合法手机号"))},trigger:"blur"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],country:[{required:!0,trigger:"change",message:"请选择国家"}],name:[{required:!0,trigger:"blur",message:"请输入用户名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}],agreeToTheAgreement:[{required:!0,validator:(n,a)=>a===!0,message:"请阅读并勾选协议",trigger:"blur"}]}),fe=async()=>{const n={type:"register_phone_number",email:r.value.email,phone:r.value.phoneNumber};if(r.value.country==="CN"){const{status:a}=await F.sendCode(n);a===1&&U.success({message:"已发送"})}else{n.type="register_email";const{status:a}=await F.sendCode(n);a===1&&U.success({message:"已发送"})}ve()},ve=()=>{z.value=!0;let n=60;y.value=setInterval(()=>{n>0?(n--,$.value=`请在${n}s后重新获取`):(clearInterval(y.value),$.value="获取验证码",y.value=null,z.value=!1)},1e3)},_e=X(async()=>{R.value&&R.value.validate(async n=>{if(n){r.value.type=r.value.country==="CN"?"phone":"email",r.value.companyName="",r.value.legalPersonName="",r.value.taxID="",delete r.value.agreeToTheAgreement;const{status:a}=await F.register(r.value);a===1&&(U.success({message:"注册成功"}),v.value="login",_.value="password",Le(()=>{u.value.account=r.value.email||r.value.phoneNumber}))}})},3e3),D=d(),x=d({account:w.local.get("login_account"),code:"",newPassword:""}),be=d({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],newPassword:[{required:!0,trigger:"blur",message:"请输入新密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}]});function ye(){U({message:"重置密码仅提供界面演示，无实际功能，需开发者自行扩展",type:"info"}),D.value&&D.value.validate(n=>{})}Ie(()=>{clearInterval(y.value),y.value=null});const O=()=>{I.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"}],k.value.resetFields()};return Re(()=>v.value,async n=>{switch(n){case"login":O(),u.value={account:w.local.get("login_account")||"",remember:w.local.has("login_account")};break;case"register":R.value.resetFields(),r.value={name:"",password:"",email:"",phoneNumber:"",code:"",country:"",type:"phone"};break}n==="register"&&(H.value=await oe.getCountry())}),(n,a)=>{const s=Ke,N=Ee,Q=g("el-radio-button"),he=g("el-radio-group"),xe=g("el-button"),m=g("ElInput"),p=g("ElFormItem"),B=g("ElCheckbox"),P=g("ElLink"),T=g("ElButton"),we=g("el-form"),Ve=g("ElOption"),Ce=g("ElSelect"),J=g("ElForm");return h(),Y("div",null,[Ge,l(N,{placement:"bottom-end",class:"i18n-selector"},{default:o(()=>[l(s,{name:"i-ri:translate"})]),_:1}),i("div",He,[Oe,K(l(we,{ref_key:"loginFormRef",ref:k,model:e(u),rules:e(I),class:"login-form","validate-on-rule-change":!1},{default:o(()=>[i("div",je,[i("div",Qe,[l(he,{modelValue:e(_),"onUpdate:modelValue":a[0]||(a[0]=t=>$e(_)?_.value=t:null),size:"large",onChange:O},{default:o(()=>[l(Q,{label:"验证码登录",value:"code"}),l(Q,{label:"密码登录",value:"password"})]),_:1},8,["modelValue"])])]),i("div",Je,[l(p,{prop:"account"},{default:o(()=>[l(m,{modelValue:e(u).account,"onUpdate:modelValue":a[1]||(a[1]=t=>e(u).account=t),placeholder:e(f)("app.account"),type:"text",tabindex:"1",onBlur:pe},ze({prefix:o(()=>[l(s,{name:"i-ri:user-3-fill"})]),_:2},[e(_)==="code"?{name:"append",fn:o(()=>[l(xe,{type:"primary",disabled:e(A),onClick:me},{default:o(()=>[c(C(e(S)),1)]),_:1},8,["disabled"])]),key:"0"}:void 0]),1032,["modelValue","placeholder"])]),_:1}),e(_)==="password"?(h(),E(p,{key:0,prop:"password"},{default:o(()=>[l(m,{modelValue:e(u).password,"onUpdate:modelValue":a[2]||(a[2]=t=>e(u).password=t),type:"password",placeholder:e(f)("app.password"),tabindex:"2",autocomplete:"new-password","show-password":"",onKeyup:ee(e(L),["enter"])},{prefix:o(()=>[l(s,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue","placeholder","onKeyup"])]),_:1})):M("",!0),e(_)==="code"?(h(),E(p,{key:1,prop:"code"},{default:o(()=>[l(m,{modelValue:e(u).code,"onUpdate:modelValue":a[3]||(a[3]=t=>e(u).code=t),type:"text",placeholder:e(f)("app.captcha"),tabindex:"2",onKeyup:ee(e(L),["enter"])},{prefix:o(()=>[l(s,{name:"i-ep:message"})]),_:1},8,["modelValue","placeholder","onKeyup"])]),_:1})):M("",!0),l(p,{prop:"agreeToTheAgreement"},{default:o(()=>[i("div",We,[l(B,{modelValue:e(u).agreeToTheAgreement,"onUpdate:modelValue":a[4]||(a[4]=t=>e(u).agreeToTheAgreement=t),tabindex:"3"},{default:o(()=>[c(" 我已阅读并同意《xxxx协议》 ")]),_:1},8,["modelValue"]),e(_)==="password"?(h(),E(P,{key:0,type:"primary",underline:!1,onClick:a[5]||(a[5]=t=>v.value="reset")},{default:o(()=>[c(" 忘记密码了? ")]),_:1})):M("",!0)])]),_:1})]),i("div",Xe,[l(B,{modelValue:e(u).remember,"onUpdate:modelValue":a[6]||(a[6]=t=>e(u).remember=t),tabindex:"4"},{default:o(()=>[c(" 保持登录 ")]),_:1},8,["modelValue"])]),l(T,{loading:e(V),type:"primary",size:"large",style:{width:"100%"},onClick:G(e(L),["prevent"]),tabindex:"5"},{default:o(()=>[c(C(e(f)("app.login")),1)]),_:1},8,["loading","onClick"]),i("div",Ye,[ea,l(P,{type:"primary",underline:!1,onClick:a[7]||(a[7]=t=>v.value="register")},{default:o(()=>[c(" 立即注册 ")]),_:1})])]),_:1},8,["model","rules"]),[[Z,e(v)==="login"]]),K(l(J,{ref_key:"registerFormRef",ref:R,model:e(r),rules:e(ge),class:"login-form","auto-complete":"on"},{default:o(()=>[i("div",null,[l(p,{prop:"companyName"},{default:o(()=>[l(m,{modelValue:e(r).companyName,"onUpdate:modelValue":a[8]||(a[8]=t=>e(r).companyName=t),placeholder:"请输入公司名称"},null,8,["modelValue"])]),_:1}),l(p,{prop:"taxID"},{default:o(()=>[l(m,{modelValue:e(r).taxID,"onUpdate:modelValue":a[9]||(a[9]=t=>e(r).taxID=t),placeholder:"请输入公司税号"},null,8,["modelValue"])]),_:1}),l(p,{prop:"legalPersonName"},{default:o(()=>[l(m,{modelValue:e(r).legalPersonName,"onUpdate:modelValue":a[10]||(a[10]=t=>e(r).legalPersonName=t),placeholder:"请输入法人姓名"},null,8,["modelValue"])]),_:1}),l(p,{prop:"name"},{default:o(()=>[l(m,{modelValue:e(r).name,"onUpdate:modelValue":a[11]||(a[11]=t=>e(r).name=t),placeholder:"用户名",tabindex:"1"},{prefix:o(()=>[l(s,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue"])]),_:1}),l(p,{prop:"country"},{default:o(()=>[l(Ce,{modelValue:e(r).country,"onUpdate:modelValue":a[12]||(a[12]=t=>e(r).country=t),placeholder:"国家",clearable:"",filterable:"",tabindex:"2"},{prefix:o(()=>[l(s,{name:"i-mdi:format-list-bulleted-type"})]),default:o(()=>[(h(!0),Y(De,null,Be(e(H),t=>(h(),E(Ve,{label:t.chineseName,value:t.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),e(r).country==="CN"?(h(),E(p,{key:0,prop:"phoneNumber"},{default:o(()=>[l(m,{modelValue:e(r).phoneNumber,"onUpdate:modelValue":a[13]||(a[13]=t=>e(r).phoneNumber=t),placeholder:"手机号",tabindex:"3"},{prefix:o(()=>[l(s,{name:"i-ant-design:phone-outlined"})]),_:1},8,["modelValue"])]),_:1})):(h(),E(p,{key:1,prop:"email"},{default:o(()=>[l(m,{modelValue:e(r).email,"onUpdate:modelValue":a[14]||(a[14]=t=>e(r).email=t),placeholder:"邮箱",tabindex:"3"},{prefix:o(()=>[l(s,{name:"i-mdi:email"})]),_:1},8,["modelValue"])]),_:1})),l(p,{prop:"code"},{default:o(()=>[l(m,{modelValue:e(r).code,"onUpdate:modelValue":a[15]||(a[15]=t=>e(r).code=t),placeholder:"验证码",tabindex:"4"},{prefix:o(()=>[l(s,{name:"i-ic:baseline-verified-user"})]),append:o(()=>[l(T,{disabled:e(z),onClick:fe},{default:o(()=>[c(C(e($)),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),l(p,{prop:"password"},{default:o(()=>[l(m,{modelValue:e(r).password,"onUpdate:modelValue":a[16]||(a[16]=t=>e(r).password=t),type:"password",placeholder:"密码",tabindex:"5","show-password":""},{prefix:o(()=>[l(s,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue"])]),_:1}),l(p,{prop:"agreeToTheAgreement"},{default:o(()=>[i("div",aa,[l(B,{modelValue:e(r).agreeToTheAgreement,"onUpdate:modelValue":a[17]||(a[17]=t=>e(r).agreeToTheAgreement=t),tabindex:"6"},{default:o(()=>[c(" 我已阅读并同意《xxxx协议》 ")]),_:1},8,["modelValue"])])]),_:1})]),l(T,{tabindex:"7",loading:e(V),type:"primary",size:"large",style:{width:"100%","margin-top":"20px"},onClick:G(e(_e),["prevent"])},{default:o(()=>[c(" 注册 ")]),_:1},8,["loading","onClick"]),i("div",la,[oa,l(P,{type:"primary",underline:!1,onClick:a[18]||(a[18]=t=>v.value="login")},{default:o(()=>[c(" 去登录 ")]),_:1})])]),_:1},8,["model","rules"]),[[Z,e(v)==="register"]]),K(l(J,{ref_key:"resetFormRef",ref:D,model:e(x),rules:e(be),class:"login-form"},{default:o(()=>[ta,i("div",null,[l(p,{prop:"account"},{default:o(()=>[l(m,{modelValue:e(x).account,"onUpdate:modelValue":a[19]||(a[19]=t=>e(x).account=t),placeholder:e(f)("app.account"),type:"text",tabindex:"1"},{prefix:o(()=>[l(s,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1}),l(p,{prop:"code"},{default:o(()=>[l(m,{modelValue:e(x).code,"onUpdate:modelValue":a[20]||(a[20]=t=>e(x).code=t),placeholder:e(f)("app.code"),type:"text",tabindex:"2"},{prefix:o(()=>[l(s,{name:"i-ic:baseline-verified-user"})]),append:o(()=>[l(T,null,{default:o(()=>[c(C(e(f)("app.sendCaptcha")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),l(p,{prop:"newPassword"},{default:o(()=>[l(m,{modelValue:e(x).newPassword,"onUpdate:modelValue":a[21]||(a[21]=t=>e(x).newPassword=t),type:"password",placeholder:e(f)("app.newPassword"),tabindex:"3","show-password":""},{prefix:o(()=>[l(s,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1})]),l(T,{loading:e(V),type:"primary",size:"large",style:{width:"100%","margin-top":"20px"},onClick:G(ye,["prevent"])},{default:o(()=>[c(C(e(f)("app.check")),1)]),_:1},8,["loading"]),i("div",ra,[l(P,{type:"primary",underline:!1,onClick:a[22]||(a[22]=t=>v.value="login")},{default:o(()=>[c(C(e(f)("app.goLogin")),1)]),_:1})])]),_:1},8,["model","rules"]),[[Z,e(v)==="reset"]])]),l(Me)])}}});typeof ae=="function"&&ae(le);const pa=Ze(le,[["__scopeId","data-v-db29fea0"]]);export{pa as default};
