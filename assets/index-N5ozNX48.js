
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as K,am as z,r as C,l as J,b as u,o as i,e as y,j as t,f as p,w as l,g as r,h as g,F as v,k as m,v as G,t as c,H as O,s as V,aq as D,an as L,E as W,aI as X,aJ as Y,R as Z}from"./index-BFOgWOqQ.js";import{u as $}from"./projectManagement_list-CWIQGR8R.js";import{u as ee}from"./stagedData-Cy2cxNAL.js";import{u as te}from"./user_customer-arT2c9VK.js";import{a as j}from"./projectManagement-B3UgNnqg.js";import"./user_customer-BLPQOZxg.js";const w=b=>(X("data-v-faf17e4c"),b=b(),Y(),b),ae=w(()=>c("span",null,"限量",-1)),oe=w(()=>c("br",null,null,-1)),le=w(()=>c("span",null,"(小时完成量)",-1)),re={style:{float:"left"}},se={style:{float:"right",color:"red","font-size":"13px"}},ie=K({name:"ProjeckEdit",__name:"index",emits:["fetch-data"],setup(b,{expose:M,emit:P}){const _=$();ee();const U=z(),k=te(),q=P,x=C(),e=C({dialogTableVisible:!1,title:"",type:"",loading:"",formData:{},customerList:[],rules:{name:[{required:!0,message:"请输入项目名称",trigger:"blur"},{min:2,max:50,message:"内容在2-50个字之间",trigger:"blur"}],projectIdentification:[{max:100,required:!0,message:"请输入项目标识",trigger:"blur"},{min:2,max:100,message:"内容在2-100个字之间",trigger:"blur"}],countryIdList:[{required:!0,message:"请选择所属国家",trigger:"change"}],clientId:[{required:!0,message:"请选择所属客户",trigger:"change"}],doMoneyPrice:[{required:!0,message:"请输入原价",trigger:"blur"}],num:[{required:!0,message:"请输入配额",trigger:"blur"}],minimumDuration:[{required:!0,message:"请输入最小分长",trigger:"blur"}],ir:[{required:!0,message:"请输入配额",trigger:"blur"}]}}),R={PCNL:"参数",customer:"客户",name:"名称/标识",doMoneyPrice:"原价",ir:"IR",remark:"备注"};async function T(s,o){e.value.title=R[o],e.value.type=o;try{e.value.loading=!0;const d=await j.detail({projectId:s.projectId});e.value.formData=d.data,e.value.dialogTableVisible=!0,e.value.loading=!1,_.dataBeforeEditing=[L(e.value.formData)]}catch{}finally{e.value.loading=!1}e.value.customerList=await k.getCustomerList()}const I=s=>{s.key==="."&&s.preventDefault()},B=async()=>{const s=L(e.value.formData);return await _.compareProjectData(_.dataBeforeEditing,[s]),s};async function E(){e.value.loading=!0,x.value.validate(async s=>{if(s){const o=await B(),{status:d}=await j.edit(o);d===1&&W.success({message:"编辑成功",center:!0}),q("fetch-data"),h()}e.value.loading=!1})}function h(){e.value.dialogTableVisible=!1,e.value.formData={}}const N=async()=>{await k.getCustomerList(),await U.getCountry()};return J(async()=>{await N()}),M({showEdit:T}),(s,o)=>{const d=u("el-input-number"),n=u("el-form-item"),A=u("el-option"),Q=u("el-select"),f=u("el-input"),F=u("el-form"),S=u("el-button"),H=u("el-dialog");return i(),y("div",null,[t(e).dialogTableVisible?(i(),p(H,{key:0,modelValue:t(e).dialogTableVisible,"onUpdate:modelValue":o[8]||(o[8]=a=>t(e).dialogTableVisible=a),title:t(e).title+"编辑",draggable:""},{footer:l(()=>[r(S,{onClick:h,disabled:t(e).loading},{default:l(()=>[g(" 取消 ")]),_:1},8,["disabled"]),r(S,{type:"primary",onClick:E,disabled:t(e).loading},{default:l(()=>[g(" 确定 ")]),_:1},8,["disabled"])]),default:l(()=>[r(F,{ref_key:"formRef",ref:x,model:t(e).formData,rules:t(e).rules,"label-width":"100","label-position":"right"},{default:l(()=>[t(e).type==="PCNL"?(i(),y(v,{key:0},[r(n,{label:"配额",prop:"num"},{default:l(()=>[r(d,{style:{width:"100%"},class:"text-left",modelValue:t(e).formData.num,"onUpdate:modelValue":o[0]||(o[0]=a=>t(e).formData.num=a),step:1,"step-strictly":"",min:1,max:100,"controls-position":"right",onKeydown:I},null,8,["modelValue"])]),_:1}),r(n,{class:"limitedQuantity"},{label:l(()=>[ae,g(),oe,le]),default:l(()=>[r(d,{style:{width:"100%"},class:"text-left",modelValue:t(e).formData.limitedQuantity,"onUpdate:modelValue":o[1]||(o[1]=a=>t(e).formData.limitedQuantity=a),min:1,step:1,"step-strictly":"","controls-position":"right",onKeydown:I},null,8,["modelValue"])]),_:1})],64)):m("",!0),t(e).type==="customer"?(i(),p(n,{key:1,label:"所属客户",prop:"clientId"},{default:l(()=>[r(Q,{placeholder:"Select",modelValue:t(e).formData.clientId,"onUpdate:modelValue":o[2]||(o[2]=a=>t(e).formData.clientId=a),clearable:""},{default:l(()=>[(i(!0),y(v,null,G(t(e).customerList,a=>(i(),p(A,{key:a.tenantCustomerId,value:a.tenantCustomerId,label:a.customerAccord,disabled:a.isReveal===1},{default:l(()=>[c("span",re,O(a.customerAccord),1),V(c("span",se,[V(c("span",null," 营业额超限 ",512),[[D,a.turnover<a.practiceTurover]]),V(c("span",null," 审核率不合格 ",512),[[D,a.rateAudit>a.practiceRateAudit]])],512),[[D,a.isReveal===1]])]),_:2},1032,["value","label","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})):m("",!0),t(e).type==="name"?(i(),y(v,{key:2},[r(n,{label:"项目名称",prop:"name"},{default:l(()=>[r(f,{modelValue:t(e).formData.name,"onUpdate:modelValue":o[3]||(o[3]=a=>t(e).formData.name=a),clearable:"",maxlength:50},null,8,["modelValue"])]),_:1}),r(n,{label:"项目标识",prop:"projectIdentification"},{default:l(()=>[r(f,{clearable:"",modelValue:t(e).formData.projectIdentification,"onUpdate:modelValue":o[4]||(o[4]=a=>t(e).formData.projectIdentification=a),maxlength:100},null,8,["modelValue"])]),_:1})],64)):m("",!0),t(e).type==="doMoneyPrice"?(i(),p(n,{key:3,label:"原价",prop:"doMoneyPrice"},{default:l(()=>[r(f,{style:{width:"100%"},modelValue:t(e).formData.doMoneyPrice,"onUpdate:modelValue":o[5]||(o[5]=a=>t(e).formData.doMoneyPrice=a),type:"number",min:1,precision:1,step:.1,"controls-position":"right"},{suffix:l(()=>[g(" RNB/USA ")]),_:1},8,["modelValue"])]),_:1})):m("",!0),t(e).type==="ir"?(i(),p(n,{key:4,label:"IR",prop:"ir"},{default:l(()=>[r(f,{modelValue:t(e).formData.ir,"onUpdate:modelValue":o[6]||(o[6]=a=>t(e).formData.ir=a),modelModifiers:{number:!0},min:1,max:100,step:"0.01",oninput:"if(value>100)value=100;if(value.length>4)value=value.slice(0,4);if(value<0)value=0;value=Number(value).toFixed(1)"},{append:l(()=>[g(" % ")]),_:1},8,["modelValue"])]),_:1})):m("",!0),t(e).type==="remark"?(i(),p(n,{key:5,label:"备注"},{default:l(()=>[r(f,{maxlength:"200","show-word-limit":"",style:{width:"100%"},type:"textarea",rows:5,modelValue:t(e).formData.remark,"onUpdate:modelValue":o[7]||(o[7]=a=>t(e).formData.remark=a)},null,8,["modelValue"])]),_:1})):m("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])):m("",!0)])}}}),fe=Z(ie,[["__scopeId","data-v-faf17e4c"]]);export{fe as default};
