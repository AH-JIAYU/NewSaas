
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as se,r as w,aH as re,G as ie,H as z,J as ue,a as s,al as ce,o as c,b as N,f as a,w as t,am as $,ay as de,F as me,n as pe,e as f,g as r,I as g,j as B,i as h,R as fe,aI as I,ak as L,N as ge,s as ve,aF as _e,aG as he,l as be,aA as Ce,_ as ye,q as D}from"./index-BWtuCxpb.js";import{_ as Ee}from"./index.vue_vue_type_script_setup_true_lang-CwEBDyKA.js";import{_ as Me}from"./index.vue_vue_type_script_setup_true_lang-CH1Yk09T.js";import{u as we,a as S}from"./index.vue_vue_type_script_setup_true_lang-BLVFkRGP.js";import{u as Se}from"./otherFunctions_basicDictionary-B_XPiorv.js";import{u as ke}from"./useTabbar-BbSySeOq.js";import"./configuration_role-CJRyBb8N.js";import"./basicDictionary-Ww8RCJq-.js";const xe=b=>(_e("data-v-41534d42"),b=b(),he(),b),Pe=xe(()=>be("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),U=se({name:"SettingUserList",__name:"list",setup(b){const F=Se(),k=w([]),T=we(),x=w(),{pagination:m,onSizeChange:G,onCurrentChange:H,onSortChange:R}=re(),P=ke(),e=w({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,id:"",row:""},editProps:{visible:!1,id:""},search:{name:"",role:""},batch:{enable:!0,selectionDataList:[]},dataList:[]});ie(async()=>{u(),k.value=await F.getCountry(),x.value=await T.getRole,e.value.dataList.map(n=>{k.value.find(l=>{n.country===l.code&&(n.countryName=l.chineseName)})}),e.value.formMode==="router"&&z.on("get-data-list",()=>{u()})}),ue(()=>{e.value.formMode==="router"&&z.off("get-data-list")});function u(){e.value.loading=!0,S.list(e.value.search).then(n=>{var l;e.value.loading=!1,e.value.dataList=n.data,m.value.total=(l=n.data)==null?void 0:l.length,e.value.dataList.forEach(y=>{y.statusLoading=!1})})}function A(){Object.assign(e.value.search,{name:"",role:""}),u()}function j(n){G(n).then(()=>u())}function C(n=1){H(n).then(()=>u())}function J({prop:n,order:l}){R(n,l).then(()=>u())}function K(){e.value.formMode==="router"?P.open({name:"pagesExampleGeneralManagerCreate"}):(e.value.formModeProps.id="",e.value.formModeProps.row="",e.value.formModeProps.visible=!0)}function O(n){e.value.formMode==="router"?P.open({name:"pagesExampleGeneralManagerEdit",params:{id:n.id}}):(e.value.formModeProps.id=n.id,e.value.formModeProps.row=JSON.stringify(n),e.value.formModeProps.visible=!0)}function q(n){return new Promise(l=>{I.confirm(`确认${n.active?"禁用":"启用"}「${n.name}」吗？`,"确认信息").then(()=>{e.value.loading=!0,S.edit({id:n.id,account:null,name:null,sex:null,phoneNumber:null,active:!n.active}).then(()=>(L.success({message:`${n.active?"禁用":"启用"}成功`,center:!0}),u(),e.value.loading=!1,l(!0))).catch(()=>(e.value.loading=!1,l(!1)))}).catch(()=>l(!1))})}function Q(n){I.confirm(`确认删除「${n.name}」用户吗？`,"确认信息").then(()=>{S.delete({id:n.id}).then(()=>{u(),L.success({message:"删除成功",center:!0})})}).catch(()=>{})}return(n,l)=>{const y=s("ElInput"),E=s("ElFormItem"),W=s("el-option"),X=s("el-select"),M=ge,p=s("ElButton"),Y=s("ElForm"),Z=Ee,ee=s("ElDivider"),V=s("ElSpace"),d=s("ElTableColumn"),v=s("el-text"),ae=s("ElSwitch"),te=s("ElTable"),oe=s("ElPagination"),le=ve,ne=ce("loading");return c(),N("div",{class:fe({"absolute-container":e.value.tableAutoHeight})},[a(le,null,{default:t(()=>[a(Z,{"show-toggle":!1},{default:t(({fold:o,toggle:_})=>[a(Y,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:t(()=>[$(a(E,null,{default:t(()=>[a(y,{modelValue:e.value.search.name,"onUpdate:modelValue":l[0]||(l[0]=i=>e.value.search.name=i),placeholder:"请输入姓名",clearable:"",onKeydown:l[1]||(l[1]=de(i=>C(),["enter"])),onClear:l[2]||(l[2]=i=>C())},null,8,["modelValue"])]),_:2},1536),[[Ce,!o]]),a(E,{prop:"role"},{default:t(()=>[a(X,{modelValue:e.value.search.role,"onUpdate:modelValue":l[3]||(l[3]=i=>e.value.search.role=i),placeholder:"请选择角色"},{default:t(()=>[(c(!0),N(me,null,pe(x.value,i=>(c(),f(W,{key:i.id,label:i.roleName,value:i.roleName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(E,null,{default:t(()=>[a(p,{type:"primary",onClick:l[4]||(l[4]=i=>C())},{icon:t(()=>[a(M,{name:"i-ep:search"})]),default:t(()=>[r(" 筛选 ")]),_:1}),a(p,{onClick:A},{icon:t(()=>[Pe]),default:t(()=>[r(" 重置 ")]),_:1}),a(p,{link:"",onClick:_},{icon:t(()=>[a(M,{name:o?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:t(()=>[r(" "+g(o?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),a(ee,{"border-style":"dashed"}),a(V,{wrap:""},{default:t(()=>[a(p,{type:"primary",size:"default",onClick:K},{icon:t(()=>[a(M,{name:"i-ep:plus"})]),default:t(()=>[r(" 新增用户 ")]),_:1})]),_:1}),$((c(),f(te,{class:"my-4",data:e.value.dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:J,onSelectionChange:l[5]||(l[5]=o=>e.value.batch.selectionDataList=o)},{default:t(()=>[e.value.batch.enable?(c(),f(d,{key:0,type:"selection",align:"center",fixed:""})):B("",!0),a(d,{prop:"account",sortable:"",label:"帐号"},{default:t(({row:o})=>[o.country==="CN"?(c(),f(v,{key:0,class:"mx-1"},{default:t(()=>[r(g(o.phone),1)]),_:2},1024)):(c(),f(v,{key:1,class:"mx-1"},{default:t(()=>[r(g(o.email),1)]),_:2},1024))]),_:1}),a(d,{prop:"name",label:"姓名",width:"100",align:"center"},{default:t(({row:o})=>[a(v,{class:"mx-1"},{default:t(()=>[r(g(o.name?o.name:"暂无数据"),1)]),_:2},1024)]),_:1}),a(d,{prop:"role",align:"center",width:"150",label:"角色"},{default:t(({row:o})=>[a(v,{class:"mx-1"},{default:t(()=>[r(g(o.role?o.role:"暂无数据"),1)]),_:2},1024)]),_:1}),a(d,{prop:"mobile",label:"国家",width:"150",align:"center"},{default:t(({row:o})=>[a(v,{class:"mx-1"},{default:t(()=>[r(g(o.countryName?o.countryName:"暂无数据"),1)]),_:2},1024)]),_:1}),a(d,{label:"状态",width:"100",align:"center"},{default:t(o=>[a(ae,{modelValue:o.row.active,"onUpdate:modelValue":_=>o.row.active=_,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>q(o.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1}),a(d,{label:"操作",width:"200",align:"center",fixed:"right"},{default:t(o=>[a(V,null,{default:t(()=>[a(p,{type:"primary",size:"small",plain:"",onClick:_=>O(o.row)},{default:t(()=>[r(" 编辑 ")]),_:2},1032,["onClick"]),a(p,{type:"danger",size:"small",plain:"",onClick:_=>Q(o.row)},{default:t(()=>[r(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ne,e.value.loading]]),a(oe,{"current-page":h(m).page,total:h(m).total,"page-size":h(m).size,"page-sizes":h(m).sizes,layout:h(m).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:C,onSizeChange:j},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e.value.formMode==="dialog"||e.value.formMode==="drawer"?(c(),f(Me,{key:0,id:e.value.formModeProps.id,modelValue:e.value.formModeProps.visible,"onUpdate:modelValue":l[6]||(l[6]=o=>e.value.formModeProps.visible=o),row:e.value.formModeProps.row,mode:e.value.formMode,onSuccess:u},null,8,["id","modelValue","row","mode"])):B("",!0)],2)}}});typeof D=="function"&&D(U);const Ue=ye(U,[["__scopeId","data-v-41534d42"]]);export{Ue as default};
