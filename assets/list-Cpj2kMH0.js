
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as we,aN as Ie,r as d,a3 as Ne,n as je,a as b,q as Ce,o as s,b as Le,f as l,w as t,e as r,j as i,g as n,s as ze,i as h,aM as se,y as m,z as p,N as R,E as I,aO as V,b9 as De,ba as xe,be as Re,ap as Ue,L as Ee}from"./index-C5qFWr5w.js";import{_ as Be}from"./index-CHANe3GA.js";import{_ as Te}from"./index.vue_vue_type_style_index_0_lang-B937Q30B.js";import{_ as Ae}from"./index-HX42mQcb.js";import{u as Me,o as Pe,a as U}from"./index-B8Ngtzu2.js";import He from"./index-DeEaEKkx.js";import Ve from"./index-zSYzEnKj.js";import"./index-C6j_7URJ.js";import"./index.vue_vue_type_script_setup_true_lang-BvB5y3L5.js";import"./sortable.esm-C0-Qcoum.js";import"./apiLoading-BJXF-0cp.js";import"./projectManagement-W_KI7Et3.js";import"./user_cooperation-B1rAkIsn.js";import"./survey_vip_department-DZRbJ7m-.js";import"./user_supplier-BwDbK72e.js";import"./user_supplier-D1p_noI6.js";import"./survey_vipGroup-iaNr7iZY.js";import"./survey_vipGroup-Bo3ukxL5.js";import"./position_manage-gaik89w5.js";import"./index-tr9jfECI.js";import"./department-TzNP_-Uk.js";import"./configuration_role-Im4Lkks_.js";import"./tenant_role-DOjcIKCN.js";import"./configuration_manager-BLwmaC40.js";const $e={class:"tableBig"},Oe={class:"tableBig"},Fe={class:"copyId tableSmall"},Qe={class:"id oneLine projectId"},qe={class:"tableBig oneLine"},Ge={class:"copyId tableSmall"},Je={class:"id oneLine projectId"},Ke={class:"tableBig"},We={class:"tableBig"},Xe={class:"copyId tableSmall"},Ye={class:"id oneLine projectId"},Ze={class:"tableBig"},et={class:"copyId tableSmall"},tt={class:"id oneLine projectId"},at={class:"tableBig"},lt=we({name:"outsource",__name:"list",setup(ot){const $=Me(),{pagination:_,getParams:re,onSizeChange:ie,onCurrentChange:ue}=Ie(),ce=d(),P=d(),pe=d(),g=d(!0),N=d(!1),O=d(),w=d({selectList:[]}),D=d(!1),u=d([]),F=d(),Q=d(),q=d("formSearch-outsource"),j=d("default"),C=d(!1),x=d([{sotrtable:!0,checked:!0,label:"合作商ID",prop:"tenantId"},{sotrtable:!0,checked:!0,label:"接收状态",prop:"receiveStatus"},{sotrtable:!0,checked:!0,label:"PM",prop:"userName"},{sotrtable:!0,checked:!0,label:"合作商名称",prop:"tenantName"},{sotrtable:!0,checked:!0,label:"分配",prop:"allocationType"},{sotrtable:!0,checked:!0,label:"项目价",prop:"doMoneyPrice"},{sotrtable:!0,checked:!0,label:"项目ID",prop:"projectId"},{sotrtable:!0,checked:!0,label:"项目名称",prop:"projectName"},{sotrtable:!0,checked:!0,label:"参与/完成/配额/限量",prop:"participationNumber"},{sotrtable:!0,checked:!0,label:"状态",prop:"projectStatus"}]),k=Ne({projectId:"",tenantId:"",tenantName:"",projectStatus:"",type:2}),E=d([]);function G(o){O.value.showEdit(o,k.type===2?1:0)}function J(o){ie(o).then(()=>S())}function L(o=1){ue(o).then(()=>S())}function K(){Object.assign(k,{tenantId:"",tenantName:"",projectStatus:"",type:2}),S()}async function S(){try{g.value=!0;const o={...re(),...k};if(k.type===1){const a=await U.list(o);E.value=a.data.projectAllocationInfoList,_.value.total=a.data.total}else{const a=await U.meList(o);E.value=a.data.projectMeAllocationInfoList,_.value.total=a.data.total}g.value=!1}catch{}finally{g.value=!1}}je(()=>{x.value.forEach(o=>{o.checked&&u.value.push(o.prop)}),S(),F.value=[{index:1,show:!0,type:"input",modelName:"projectId",placeholder:"项目ID"},{index:2,show:!0,type:"input",modelName:"tenantId",placeholder:"合作商ID"},{index:3,show:!0,type:"input",modelName:"tenantName",placeholder:"合作商名称"},{index:4,show:!0,type:"select",modelName:"projectStatus",placeholder:"项目状态",option:"projectStatus",optionLabel:"label",optionValue:"value"}],Q.value=[{index:1,show:!0,type:"input",modelName:"projectId",placeholder:"项目ID"},{index:2,show:!0,type:"input",modelName:"tenantId",placeholder:"合作商ID"},{index:3,show:!0,type:"input",modelName:"tenantName",placeholder:"合作商名称"},{index:4,show:!0,type:"select",modelName:"projectStatus",placeholder:"项目状态",option:"projectStatus",optionLabel:"label",optionValue:"value"},{index:5,show:!0,type:"select",modelName:"receiveStatus",placeholder:"接收状态",option:"receiveStatus",optionLabel:"label",optionValue:"value"}]});const de=[{value:1,label:"自动（已接收）"},{value:2,label:"手动（未接收）"}],W={projectStatus:()=>$.projectStatusList.map((o,a)=>({label:o,value:a+1})),receiveStatus:()=>de},z=d();function X(o){o?z.value=o.projectId:z.value=""}const H=d();function me(){const o=P.value.getSelectionRows();if(o.length!==1)I.warning({message:"请选择一个项目",center:!0});else{let a=o.length;o.forEach(f=>{f.receiveStatus==1&&a++}),a!=o.length?I.warning({message:"已接收的项目不能再次接收，请重新选择",center:!0}):(w.value.receivingMode="批量接收",w.value.selectList=o,H.value.showEdit("","接收",o))}}function fe(){const o=P.value.getSelectionRows();if(o.length!==1){I.warning({message:"请选择一个项目",center:!0});return}else{let a=o.length;o.forEach(f=>{f.receiveStatus==2&&a++}),a!=o.length?I.warning({message:"未接收的项目不能取消接收，请重新选择",center:!0}):V.confirm("确认取消接收吗？","确认信息").then(()=>{try{g.value=!0;let f=[];o.forEach(T=>{f.push(T.id)});let B={type:2,idList:f};U.updateReceiveStatus(B).then(()=>{g.value=!1,S(),I.success({message:"取消接收成功",center:!0})})}catch{}finally{g.value=!1}}).catch(()=>{})}}function ve(o){w.value.selectList=[o],H.value.showEdit("","接收",[o])}function ge(o){V.confirm("确认取消接收吗？","确认信息").then(()=>{try{g.value=!0;let a={type:2,idList:[o.id]};U.updateReceiveStatus(a).then(()=>{g.value=!1,S(),I.success({message:"取消接收成功",center:!0})})}catch{}finally{g.value=!1}}).catch(()=>{})}function ye(o){w.value.chargeUserId=o.chargeUserId,w.value.invitationType=o.invitationType,w.value.chargeUserName=o.chargeUserName;let a=[];w.value.selectList.forEach(f=>{a.push(f.id)});try{g.value=!0;let f={type:1,idList:a,userId:o.chargeUserId,userName:o.chargeUserName,allocationType:o.invitationType};U.updateReceiveStatus(f).then(()=>{g.value=!1,S(),I.success({message:"接收成功",center:!0})})}catch{}finally{g.value=!1}}const he=o=>{V.confirm("确认拒绝项目吗？","确认信息").then(()=>{}).catch(()=>{})};return(o,a)=>{const f=Ae,B=b("ElDivider"),T=Te,v=b("el-button"),Y=De,Z=xe,ee=b("el-row"),c=b("el-table-column"),y=b("el-text"),A=Be,te=b("el-tooltip"),ae=b("el-empty"),le=b("el-table"),oe=b("ElPagination"),ne=b("el-tab-pane"),_e=Re,be=b("el-tabs"),ke=Ue,Se=Ce("loading");return s(),Le("div",{class:R({"absolute-container":D.value})},[l(ke,null,{default:t(()=>[l(be,{modelValue:k.type,"onUpdate:modelValue":a[14]||(a[14]=e=>k.type=e),onTabChange:S},{default:t(()=>[l(ne,{label:"外包项目",name:2},{default:t(()=>[k.type===2?(s(),r(f,{key:0,formSearchList:F.value,formSearchName:q.value,onCurrentChange:L,onOnReset:K,model:k,formOption:W},null,8,["formSearchList","formSearchName","model"])):i("",!0),l(B,{"border-style":"dashed"}),l(ee,{gutter:24},{default:t(()=>[l(T),l(Z,null,{default:t(()=>[l(v,{size:"default",onClick:a[0]||(a[0]=()=>{})},{default:t(()=>[n(" 导出 ")]),_:1}),l(Y,{border:N.value,"onUpdate:border":a[1]||(a[1]=e=>N.value=e),tableAutoHeight:D.value,"onUpdate:tableAutoHeight":a[2]||(a[2]=e=>D.value=e),checkList:u.value,"onUpdate:checkList":a[3]||(a[3]=e=>u.value=e),columns:x.value,"onUpdate:columns":a[4]||(a[4]=e=>x.value=e),"line-height":j.value,"onUpdate:lineHeight":a[5]||(a[5]=e=>j.value=e),stripe:C.value,"onUpdate:stripe":a[6]||(a[6]=e=>C.value=e),style:{"margin-left":"12px"},onQueryData:L},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),ze((s(),r(le,{ref_key:"tableSortRef",ref:ce,style:{"margin-top":"10px"},"row-key":"id",data:E.value,border:N.value,size:j.value,stripe:C.value,"highlight-current-row":"",onCurrentChange:X},{empty:t(()=>[l(ae,{image:h(se),"image-size":300},null,8,["image"])]),default:t(()=>[l(c,{align:"left",type:"selection"}),u.value.includes("projectStatus")?(s(),r(c,{key:0,"show-overflow-tooltip":"",prop:"receiveStatus",align:"left",width:"140",label:"状态"},{default:t(({row:e})=>[m("span",$e,[e.projectStatus===1?(s(),r(y,{key:0,type:"primary"},{default:t(()=>[n(" 进行中(在线)")]),_:1})):e.projectStatus===2?(s(),r(y,{key:1,type:"warning"},{default:t(()=>[n(" 已完成(审核通过)")]),_:1})):e.projectStatus===3?(s(),r(y,{key:2,type:"info"},{default:t(()=>[n(" 离线")]),_:1})):i("",!0)])]),_:1})):i("",!0),u.value.includes("tenantName")?(s(),r(c,{key:1,"show-overflow-tooltip":"",prop:"tenantName",align:"left",label:"合作商名称"},{default:t(({row:e})=>[m("div",Oe,p(e.tenantName),1)]),_:1})):i("",!0),u.value.includes("tenantId")?(s(),r(c,{key:2,"show-overflow-tooltip":"",prop:"tenantId",align:"left",width:"280",label:"合作商ID"},{default:t(({row:e})=>[m("div",Fe,[m("div",Qe,p(e.tenantId),1),l(A,{content:e.tenantId,class:R({rowCopy:"rowCopy",current:e.projectId===z.value})},null,8,["content","class"])])]),_:1})):i("",!0),u.value.includes("projectName")?(s(),r(c,{key:3,"show-overflow-tooltip":"",prop:"projectName",align:"left",label:"项目名称"},{default:t(({row:e})=>[m("div",qe,p(e.projectName),1)]),_:1})):i("",!0),u.value.includes("projectId")?(s(),r(c,{key:4,"show-overflow-tooltip":"",prop:"projectId",align:"left",width:"280",label:"项目ID"},{default:t(({row:e})=>[m("div",Ge,[m("div",Je,[l(te,{effect:"dark",content:e.projectId,placement:"top-start"},{default:t(()=>[n(p(e.projectId),1)]),_:2},1032,["content"])]),l(A,{content:e.projectId,class:R({rowCopy:"rowCopy",current:e.projectId===z.value})},null,8,["content","class"])])]),_:1})):i("",!0),u.value.includes("participationNumber")?(s(),r(c,{key:5,"show-overflow-tooltip":"",prop:"participationNumber",align:"left",label:"参数",width:"300"},{default:t(({row:e})=>[l(y,{style:{color:"rgb(251, 104, 104)"},class:"oneLine",type:"danger"},{default:t(()=>[n("参与: "+p(e.participationNumber||0),1)]),_:2},1024),n("   "),l(y,{style:{color:"rgb(3, 194, 57)"},class:"oneLine",type:"success"},{default:t(()=>[n("完成: "+p(e.doneNumber||0),1)]),_:2},1024),n("   "),l(y,{style:{color:"rgb(255, 172, 84)"},class:"oneLine",type:"warning"},{default:t(()=>[n("配额: "+p(e.num||0),1)]),_:2},1024),n("   "),l(y,{style:{color:"rgb(170, 170, 170)"},class:"oneLine",type:"info"},{default:t(()=>[n("限量: "+p(e.limitedQuantity||"-"),1)]),_:2},1024)]),_:1})):i("",!0),l(c,{align:"left",fixed:"right",label:"操作",width:"170"},{default:t(({row:e})=>[l(v,{type:"primary",plain:"",size:"small",onClick:M=>G(e)},{default:t(()=>[n(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[Se,g.value]]),l(oe,{"current-page":h(_).page,total:h(_).total,"page-size":h(_).size,"page-sizes":h(_).sizes,layout:h(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:J,onCurrentChange:L},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),l(ne,{label:"接收项目",name:1},{default:t(()=>[k.type===1?(s(),r(f,{key:0,formSearchList:Q.value,formSearchName:q.value,onCurrentChange:L,onOnReset:K,model:k,formOption:W},null,8,["formSearchList","formSearchName","model"])):i("",!0),l(B,{"border-style":"dashed"}),l(ee,{gutter:24},{default:t(()=>[l(T,null,{default:t(()=>[l(v,{type:"primary",size:"default",onClick:me},{default:t(()=>[n(" 接收项目 ")]),_:1}),l(v,{size:"default",onClick:fe},{default:t(()=>[n(" 取消接收 ")]),_:1})]),_:1}),l(Z,null,{default:t(()=>[l(v,{size:"default",onClick:a[7]||(a[7]=()=>{})},{default:t(()=>[n(" 导出 ")]),_:1}),l(Y,{border:N.value,"onUpdate:border":a[8]||(a[8]=e=>N.value=e),tableAutoHeight:D.value,"onUpdate:tableAutoHeight":a[9]||(a[9]=e=>D.value=e),checkList:u.value,"onUpdate:checkList":a[10]||(a[10]=e=>u.value=e),columns:x.value,"onUpdate:columns":a[11]||(a[11]=e=>x.value=e),"line-height":j.value,"onUpdate:lineHeight":a[12]||(a[12]=e=>j.value=e),stripe:C.value,"onUpdate:stripe":a[13]||(a[13]=e=>C.value=e),style:{"margin-left":"12px"},onQueryData:L},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),l(le,{ref_key:"tableSortRef2",ref:P,style:{"margin-top":"10px"},"row-key":"id",data:E.value,border:N.value,size:j.value,"highlight-current-row":"",stripe:C.value,onCurrentChange:X},{empty:t(()=>[l(ae,{image:h(se),"image-size":300},null,8,["image"])]),default:t(()=>[l(c,{align:"left",type:"selection"}),u.value.includes("projectStatus")?(s(),r(c,{key:0,"show-overflow-tooltip":"",prop:"projectStatus",align:"left",label:"状态",width:"140"},{default:t(({row:e})=>[m("span",Ke,p(h($).projectStatusList[e.projectStatus-1]),1)]),_:1})):i("",!0),u.value.includes("receiveStatus")?(s(),r(c,{key:1,"show-overflow-tooltip":"",prop:"receiveStatus",align:"left",label:"接收状态",width:"140"},{default:t(({row:e})=>[e.receiveStatus==2?(s(),r(y,{key:0,style:{color:"rgb(251, 104, 104)"},class:"oneLine",type:"danger"},{default:t(()=>[n("未接收")]),_:1})):i("",!0),e.receiveStatus==1?(s(),r(y,{key:1,style:{color:"rgb(3, 194, 57)"},class:"oneLine",type:"success"},{default:t(()=>[n("已接收")]),_:1})):i("",!0)]),_:1})):i("",!0),u.value.includes("tenantName")?(s(),r(c,{key:2,"show-overflow-tooltip":"",prop:"tenantName",align:"left",label:"合作商名称",width:"200"},{default:t(({row:e})=>[m("div",We,p(e.tenantName),1)]),_:1})):i("",!0),u.value.includes("tenantId")?(s(),r(c,{key:3,"show-overflow-tooltip":"",prop:"tenantId",align:"left",label:"合作商ID",width:"280"},{default:t(({row:e})=>[m("div",Xe,[m("div",Ye,p(e.tenantId),1),l(A,{content:e.tenantId,class:R({rowCopy:"rowCopy",current:e.projectId===z.value})},null,8,["content","class"])])]),_:1})):i("",!0),u.value.includes("allocationType")?(s(),r(c,{key:4,align:"left",label:"分配",width:"120"},{default:t(({row:e})=>[e.allocationType===1?(s(),r(v,{key:0,class:"tableBut",size:"small",type:"danger",plain:""},{default:t(()=>[n("自动分配")]),_:1})):e.allocationType===2?(s(),r(v,{key:1,class:"tableBut",size:"small",type:"danger"},{default:t(()=>[n("供应商")]),_:1})):e.allocationType===3?(s(),r(v,{key:2,class:"tableBut",size:"small",type:"success"},{default:t(()=>[n("部门")]),_:1})):e.allocationType===4?(s(),r(v,{key:3,class:"tableBut",size:"small",type:"primary"},{default:t(()=>[n("合作商")]),_:1})):(s(),r(v,{key:4,size:"small",class:"tableBut"},{default:t(()=>[n(" 未分配")]),_:1}))]),_:1})):i("",!0),u.value.includes("doMoneyPrice")?(s(),r(c,{key:5,"show-overflow-tooltip":"",align:"left",label:"项目价",width:"120"},{default:t(({row:e})=>[m("div",null,[l(_e),n(p(e.doMoneyPrice||0),1)])]),_:1})):i("",!0),u.value.includes("projectName")?(s(),r(c,{key:6,"show-overflow-tooltip":"",prop:"projectName",align:"left",label:"项目名称",width:"200"},{default:t(({row:e})=>[m("div",Ze,p(e.projectName),1)]),_:1})):i("",!0),u.value.includes("projectId")?(s(),r(c,{key:7,"show-overflow-tooltip":"",prop:"projectId",align:"left",width:"280",label:"项目ID"},{default:t(({row:e})=>[m("div",et,[m("div",tt,[l(te,{effect:"dark",content:e.projectId,placement:"top-start"},{default:t(()=>[n(p(e.projectId),1)]),_:2},1032,["content"])]),l(A,{content:e.projectId,class:R({rowCopy:"rowCopy",current:e.projectId===z.value})},null,8,["content","class"])])]),_:1})):i("",!0),u.value.includes("participationNumber")?(s(),r(c,{key:8,"show-overflow-tooltip":"",prop:"participationNumber",align:"left",label:"参数",width:"300"},{default:t(({row:e})=>[l(y,{style:{color:"rgb(251, 104, 104)"},class:"oneLine",type:"danger"},{default:t(()=>[n("参与: "+p(e.participationNumber||0),1)]),_:2},1024),n("   "),l(y,{style:{color:"rgb(3, 194, 57)"},class:"oneLine",type:"success"},{default:t(()=>[n("完成: "+p(e.doneNumber||0),1)]),_:2},1024),n("   "),l(y,{style:{color:"rgb(255, 172, 84)"},class:"oneLine",type:"warning"},{default:t(()=>[n("配额: "+p(e.num||0),1)]),_:2},1024),n("   "),l(y,{style:{color:"rgb(170, 170, 170)"},class:"oneLine",type:"info"},{default:t(()=>[n("限量: "+p(e.limitedQuantity||"-"),1)]),_:2},1024)]),_:1})):i("",!0),u.value.includes("userName")?(s(),r(c,{key:9,"show-overflow-tooltip":"",prop:"userName",align:"left",label:"负责人",width:"140"},{default:t(({row:e})=>[m("div",at,p(e.userName),1)]),_:1})):i("",!0),l(c,{align:"left",fixed:"right",label:"操作",width:"220"},{default:t(({row:e})=>[e.receiveStatus==2?(s(),r(v,{key:0,plain:"",type:"primary",size:"small",onClick:M=>ve(e)},{default:t(()=>[n(" 接收 ")]),_:2},1032,["onClick"])):i("",!0),e.receiveStatus==1?(s(),r(v,{key:1,plain:"",type:"danger",size:"small",onClick:M=>ge(e)},{default:t(()=>[n(" 取消接收 ")]),_:2},1032,["onClick"])):i("",!0),e.receiveStatus==2?(s(),r(v,{key:2,down:"",plain:"",type:"danger",size:"small",onClick:M=>he(e)},{default:t(()=>[n(" 拒绝 ")]),_:2},1032,["onClick"])):i("",!0),l(v,{type:"primary",plain:"",size:"small",onClick:M=>G(e)},{default:t(()=>[n(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"]),l(oe,{"current-page":h(_).page,total:h(_).total,"page-size":h(_).size,"page-sizes":h(_).sizes,layout:h(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:J,onCurrentChange:L},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1})]),_:1},8,["modelValue"]),l(He,{ref_key:"addAllocationEditRef",ref:pe,onFetchData:S},null,512),l(Pe,{ref_key:"editRef",ref:O,onFetchData:S},null,512)]),_:1}),l(Ve,{ref_key:"userRef",ref:H,onUserData:ye},null,512)],2)}}}),zt=Ee(lt,[["__scopeId","data-v-8a2dca1d"]]);export{zt as default};
