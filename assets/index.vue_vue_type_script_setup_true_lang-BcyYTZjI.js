
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as N}from"./financial_pm_log-BzMC7whO.js";import{d as $,r as n,a as s,q,s as w,o as B,b as P,f as l,w as a,g as i,z as R,y as U,E as S}from"./index-0OvYWKzQ.js";const J=$({__name:"index",emits:["fetch-data"],setup(M,{expose:z,emit:C}){const I=C,d=n(!1),u=n(!1),f=n(),y=n(""),v=n(),_=n(),t=n({organizationalStructureId:null,type:null,amount:null,remark:""}),T=n({amount:[{required:!0,message:"请输入金额",trigger:"blur"},{pattern:/^(?!0(\.0+)?$)(\d+(\.\d{1,2})?)$/,message:"请输入有效的正数，且最多两位小数",trigger:"blur"}],operationType:[{required:!0,message:"请选择加减款",trigger:"change"}]});async function x(o){try{d.value=!0,u.value=!0,o?(y.value="编辑",v.value=JSON.parse(o),_.value=v.value.organizationalStructureId,t.value.organizationalStructureId=v.value.organizationalStructureId):y.value="新增",u.value=!1}catch{}finally{u.value=!1}}async function D(){f.value&&f.value.validate(async o=>{if(o)try{u.value=!0,(await N.additionAndSubtraction(t.value)).status===1?(u.value=!1,I("fetch-data"),S.success({message:"操作成功",center:!0}),g()):S.warning({message:"出现错误请联系管理人员",center:!0})}catch{}finally{u.value=!1}})}const m=n(null),b=n(null),k=(o,e)=>{e&&(o==="加款"||o==="减款"?(m.value=e,t.value.operationType=e):(o==="待审金额"||o==="可用金额")&&(b.value=e,t.value.type=e))};function g(){Object.assign(t.value,{organizationalStructureId:null,type:null,amount:null,remark:""}),m.value=null,b.value=null,d.value=!1}return z({showEdit:x}),(o,e)=>{const c=s("el-form-item"),p=s("el-button"),V=s("el-input"),h=s("el-form"),j=s("el-dialog"),E=q("loading");return w((B(),P("div",null,[l(j,{modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=r=>d.value=r),title:"加减款","append-to-body":"","close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"35%",onClose:g},{footer:a(()=>[l(p,{onClick:g},{default:a(()=>[i(" 取消 ")]),_:1}),l(p,{type:"primary",onClick:D},{default:a(()=>[i(" 确定 ")]),_:1})]),default:a(()=>[l(h,{model:t.value,rules:T.value,ref_key:"formRef",ref:f,"label-width":"5rem",inline:!1},{default:a(()=>[l(c,{label:"ID"},{default:a(()=>[i(R(_.value),1)]),_:1}),l(c,{label:"加减款",prop:"operationType"},{default:a(()=>[U("div",null,[l(p,{type:m.value===1?"primary":"",size:"small",onClick:e[0]||(e[0]=r=>k("加款",1))},{default:a(()=>[i("加款 ")]),_:1},8,["type"]),l(p,{type:m.value===2?"primary":"",size:"small",onClick:e[1]||(e[1]=r=>k("减款",2))},{default:a(()=>[i("减款")]),_:1},8,["type"])])]),_:1}),l(c,{label:"金额",prop:"amount"},{default:a(()=>[l(V,{modelValue:t.value.amount,"onUpdate:modelValue":e[2]||(e[2]=r=>t.value.amount=r),modelModifiers:{number:!0},placeholder:"请输入金额"},null,8,["modelValue"])]),_:1}),l(c,{label:"说明",prop:""},{default:a(()=>[l(V,{modelValue:t.value.remark,"onUpdate:modelValue":e[3]||(e[3]=r=>t.value.remark=r),placeholder:"请输入说明"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])),[[E,u.value]])}}});export{J as _};
