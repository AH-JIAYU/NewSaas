
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as ce}from"./index-B0ZUQm5g.js";import{d as ue,aM as pe,r as E,l as ve,a1 as T,a as d,al as ge,o as f,b as me,C as p,f as l,w as n,g as _,aA as M,am as I,e as w,D as N,az as D,aE as P,i as h,j as K,aN as S,E as L,L as fe,aK as _e,aL as he,P as ye,aj as R}from"./index-TPKc4hfg.js";import Ce from"./index-BKhzQ453.js";import be from"./index-6uKy8Tgl.js";import{a as y}from"./tenantDictionary-3JVDw-yp.js";const ke=C=>(_e("data-v-9648a242"),C=C(),he(),C),Ee={class:"absolute-container"},Ie={class:"page-main"},we={class:"custom-tree-node"},Ne=["title"],De={class:"code"},Se={class:"actions"},Le={class:"dictionary-container"},ze={class:"dictionary-container"},Ve=ke(()=>p("div",{class:"empty"},"请在左侧新增或选择一个字典",-1)),xe=[Ve],U=ue({name:"PagesExampleDictionary",__name:"index",setup(C){const{pagination:v,getParams:G,onSizeChange:j,onCurrentChange:A,onSortChange:J}=pe(),z=E(),i=E({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),O=E(),a=E({loading:!1,search:{catalogueId:"",chineseName:""},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}});async function b(){i.value.loading=!0,a.value.search.catalogueId="";const e={...i.value.search},t=await y.list(e);i.value.tree=t.data,i.value.loading=!1}ve(()=>{b()}),T(()=>i.value.search,e=>{z.value.filter(e)});function F(e,t){return e?t.label.includes(e):!0}function V(e){i.value.currentData=e,i.value.dialog.parentId=(e==null?void 0:e.id)??"",i.value.dialog.id="",i.value.dialog.visible=!0}function q(e,t){i.value.currentNode=e,i.value.currentData=t,i.value.row=JSON.stringify(t),i.value.dialog.parentId=e.parent.data.id??"",i.value.dialog.id=t.id,i.value.dialog.visible=!0}function H(e,t){S.confirm(`确认删除「${t.chineseName}」吗？`,"确认信息").then(()=>{y.delete(t.id).then(()=>{L.success({message:"删除成功",center:!0});const s=e.parent,m=s.data.children||s.data,c=m.findIndex(k=>k.id===t.id);m.splice(c,1),i.value.tree=[...i.value.tree]})})}function Q(e){v.value.page=1,a.value.search.catalogueId=e.id}T(()=>a.value.search.catalogueId,()=>{r()});async function r(){a.value.loading=!0;const e={...G(),...a.value.search},t=await y.itemlist(e);a.value.loading=!1,a.value.dataList=t.data,a.value.dataList.forEach(s=>{s.enableLoading=!1}),v.value.total=t.data.length}function W(e){j(e).then(()=>r())}function X(e=1){A(e).then(()=>r())}function Y({prop:e,order:t}){J(e,t).then(()=>r())}function x(e){a.value.dialog.id="",a.value.dialog.visible=!0,a.value.dialog.level=1,e&&(a.value.dialog.parentId=e.id,a.value.dialog.level=Number(e.level)+1)}function Z(e){a.value.row=JSON.stringify(e),a.value.dialog.id=e.id,a.value.dialog.parentId=e.parentId,a.value.dialog.visible=!0}function ee(e){S.confirm(`确认删除「${e.chineseName}」吗？`,"确认信息").then(()=>{y.itemdelete([e.id]).then(()=>{r(),L.success({message:"删除成功",center:!0})})}).catch(()=>{})}function ae(e){const t=e.map(s=>s.id);S.confirm(`确认删除选中的 ${e.length} 条数据吗？`,"确认信息").then(()=>{y.itemdelete(t).then(()=>{r(),L.success({message:"删除成功",center:!0})})}).catch(()=>{})}return(e,t)=>{const s=d("ElButton"),m=d("ElButtonGroup"),c=fe,k=d("ElInput"),te=d("ElTree"),le=d("ElScrollbar"),ie=d("ElSpace"),g=d("ElTableColumn"),ne=d("ElTag"),oe=d("el-empty"),se=d("ElTable"),de=d("ElPagination"),re=ce,$=ge("loading");return f(),me("div",Ee,[p("div",Ie,[l(re,{"hide-left-side-toggle":""},{leftSide:n(()=>[l(m,{class:"btns"},{default:n(()=>[l(s,{type:"primary",class:"add",onClick:t[0]||(t[0]=o=>V())},{default:n(()=>[_(" 新增字典 ")]),_:1})]),_:1}),l(k,{modelValue:i.value.search.chineseName,"onUpdate:modelValue":t[1]||(t[1]=o=>i.value.search.chineseName=o),placeholder:"请输入关键词筛选字典",clearable:"",class:"search",onKeydown:M(b,["enter"])},{append:n(()=>[l(s,{onClick:b},{default:n(()=>[l(c,{name:"i-ep:search"})]),_:1})]),_:1},8,["modelValue"]),l(le,{class:"tree"},{default:n(()=>[I((f(),w(te,{ref_key:"dictionaryRef",ref:z,data:i.value.tree,"filter-node-method":F,"default-expand-all":"",onNodeClick:Q},{default:n(({node:o,data:u})=>[p("div",we,[p("div",{class:"label",title:o.label},N(u.chineseName),9,Ne),p("div",De,N(u.englishName),1),p("div",Se,[l(m,null,{default:n(()=>[l(s,{type:"primary",plain:"",size:"default",onClick:D(B=>V(u),["stop"])},{icon:n(()=>[l(c,{name:"i-ep:plus"})]),_:2},1032,["onClick"]),l(s,{type:"info",plain:"",size:"default",onClick:D(B=>q(o,u),["stop"])},{icon:n(()=>[l(c,{name:"i-ep:edit"})]),_:2},1032,["onClick"]),l(s,{type:"danger",plain:"",size:"default",onClick:D(B=>H(o,u),["stop"])},{icon:n(()=>[l(c,{name:"i-ep:delete"})]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])),[[$,i.value.loading]])]),_:1})]),default:n(()=>[I(p("div",Le,[l(ie,{wrap:""},{default:n(()=>[l(s,{type:"primary",onClick:t[2]||(t[2]=o=>x())},{icon:n(()=>[l(c,{name:"i-ep:plus"})]),_:1}),l(s,{type:"danger",disabled:!a.value.selectionDataList.length,onClick:t[3]||(t[3]=o=>ae(a.value.selectionDataList))},{icon:n(()=>[l(c,{name:"i-ep:delete"})]),_:1},8,["disabled"]),l(k,{modelValue:a.value.search.chineseName,"onUpdate:modelValue":t[4]||(t[4]=o=>a.value.search.chineseName=o),placeholder:"请输入关键词筛选字典项",clearable:"",style:{width:"200px"},onKeydown:M(r,["enter"])},null,8,["modelValue"]),l(s,{onClick:r},{icon:n(()=>[l(c,{name:"i-ep:search"})]),_:1})]),_:1}),I((f(),w(se,{ref_key:"dictionaryItemRef",ref:O,data:a.value.dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:Y,onSelectionChange:t[5]||(t[5]=o=>a.value.selectionDataList=o),"row-key":"id","default-expand-all":""},{empty:n(()=>[l(oe,{description:"暂无数据"})]),default:n(()=>[l(g,{type:"selection",align:"center",fixed:""}),l(g,{prop:"chineseName",label:"中文名称"}),l(g,{prop:"englishName",label:"英文名称"}),l(g,{prop:"remark",label:"备注"}),l(g,{label:"键值",align:"center",width:"150"},{default:n(o=>[l(ne,{type:"info"},{default:n(()=>[_(N(o.row.code),1)]),_:2},1024)]),_:1}),l(g,{label:"操作",width:"250",align:"center"},{default:n(o=>[l(s,{type:"primary",size:"small",plain:"",onClick:u=>x(o.row)},{default:n(()=>[_(" 新增子项 ")]),_:2},1032,["onClick"]),l(s,{type:"primary",size:"small",plain:"",onClick:u=>Z(o.row)},{default:n(()=>[_(" 编辑 ")]),_:2},1032,["onClick"]),l(s,{type:"danger",size:"small",plain:"",onClick:u=>ee(o.row)},{default:n(()=>[_(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,a.value.loading]]),l(de,{"current-page":h(v).page,total:h(v).total,"page-size":h(v).size,"page-sizes":h(v).sizes,layout:h(v).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:W,onCurrentChange:X},null,8,["current-page","total","page-size","page-sizes","layout"])],512),[[P,a.value.search.catalogueId]]),I(p("div",ze,xe,512),[[P,!a.value.search.catalogueId]])]),_:1}),i.value.dialog.visible?(f(),w(Ce,{key:0,id:i.value.dialog.id,modelValue:i.value.dialog.visible,"onUpdate:modelValue":t[6]||(t[6]=o=>i.value.dialog.visible=o),row:i.value.row,"parent-id":i.value.dialog.parentId,tree:i.value.tree,onGetList:b},null,8,["id","modelValue","row","parent-id","tree"])):K("",!0),a.value.dialog.visible?(f(),w(be,{key:1,id:a.value.dialog.id,modelValue:a.value.dialog.visible,"onUpdate:modelValue":t[7]||(t[7]=o=>a.value.dialog.visible=o),"catalogue-id":a.value.search.catalogueId,"parent-id":a.value.dialog.parentId,level:a.value.dialog.level,tree:i.value.tree,dataList:a.value.dataList,row:a.value.row,onSuccess:r},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):K("",!0)])])}}});typeof R=="function"&&R(U);const Ke=ye(U,[["__scopeId","data-v-9648a242"]]);export{Ke as default};
