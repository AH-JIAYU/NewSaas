
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ue,aN as pe,r as p,a3 as de,c as fe,n as _e,a as m,q as me,o as s,b as be,f as l,w as n,g as d,i as t,A as h,s as ve,e as i,aM as ge,y as _,j as r,z as y,N,aO as he,E as ye,b9 as ke,ba as Ce,_ as Ie,be as Te,ap as we,L as Se}from"./index-Bn1vWZLk.js";import{_ as Pe}from"./index-vGWXgTgK.js";import{_ as Ee}from"./index.vue_vue_type_style_index_0_lang-C_Kn-5y6.js";import ze from"./index-Cte327-u.js";import Be from"./index-C5eKe9s5.js";import{c as M}from"./user_cooperation-D63YTwBH.js";import Ne from"./index-DCfEswGN.js";import"./index-CKBKKC2I.js";import"./index-BETaCSs2.js";import"./department-CRTsECS1.js";const Re={class:"fontC-System"},xe={class:"fontC-System"},Le={class:"fontC-System"},je={class:"copyId tableSmall"},De={class:"id oneLine beInvitationTenantId"},Me={class:"tableBig"},$e={class:"flex-s"},Ae={class:"fontC-System"},Ue={class:"fontC-System"},Fe={class:"fontC-System"},He={class:"fontC-System"},qe=ue({name:"cooperation",__name:"index",setup(Qe){const{pagination:v,getParams:$,onSizeChange:A,onCurrentChange:U}=pe(),C=p(!1),B=p([]),R=p(),x=p(),F=p(),I=p(!1),T=p(!1),w=p(!1),S=p("default"),c=p([]),L=p(),P=p([{label:"合作商id",checked:!0,sortable:!0,prop:"beInvitationTenantId"},{label:"合作商名称",checked:!0,sortable:!0,prop:"beInvitationTenantName"},{label:"PM",checked:!0,sortable:!0,prop:"userName"},{label:"状态",checked:!0,sortable:!0,prop:"bindStatus"},{label:"价格比例",checked:!0,sortable:!0,prop:"priceRatio"},{label:"待审金额",checked:!0,sortable:!0,prop:"pendBalance"},{label:"可用金额",checked:!0,sortable:!0,prop:"availableBalance"},{label:"发送项目状态",checked:!0,sortable:!0,prop:"sendProjectType"},{label:"接收项目状态",checked:!0,sortable:!0,prop:"receiveProjectType"},{label:"负责部门/PM",checked:!0,sortable:!0,prop:"userName"}]),E=p();function H(a){a?E.value=a.id:E.value=""}function q(){R.value.showEdit()}function Q(a){he.prompt("是否确认进行解约?","终止合作",{confirmButtonText:"确认",cancelButtonText:"取消",inputPlaceholder:"说明",inputPattern:/^.{0,500}$/,inputErrorMessage:"不能超过500个字符",type:"warning"}).then(async o=>{const{data:{flag:b}}=await M.updateRescindTenant({beInvitationTenantId:a.beInvitationTenantId,remark:o.value});b&&ye({type:"success",message:"已终止合作"}),k()}).catch(()=>{})}function V(a){x.value.showEdit(a)}const O=de({});function G(a){A(a).then(()=>k())}function J(a=1){U(a).then(()=>k())}function z(){v.value.page=1,k()}async function k(){try{C.value=!0;const a={...$(),...O},{data:o}=await M.list(a);B.value=o.tenantBindInfoList,v.value.total=Number(o.total),C.value=!1}catch{}finally{C.value=!1}}function K(a){F.value=a}const W=fe(()=>{const a=B.value.filter(u=>u.bindStatus===2);let o=B.value.filter(u=>u.bindStatus===4);o=Array.from(new Map(o.map(u=>[u.beInvitationTenantId,u])).values());const b=a.map(u=>u.beInvitationTenantId);return o.forEach(u=>{b.includes(u.beInvitationTenantId)||a.push(u)}),a});function X(a,o){L.value.showEdit(a,o)}return _e(()=>{P.value.forEach(a=>{a.checked&&c.value.push(a.prop)}),z()}),(a,o)=>{const b=m("el-button"),u=Ee,Y=ke,Z=Ce,ee=m("el-row"),f=m("el-table-column"),g=m("el-text"),te=m("el-tooltip"),ne=Pe,ae=Ie,j=Te,oe=m("ElSpace"),le=m("el-empty"),se=m("el-table"),ie=m("ElPagination"),re=we,ce=me("loading");return s(),be("div",{class:N({"absolute-container":t(w)})},[l(re,null,{default:n(()=>[l(ee,null,{default:n(()=>[l(u,null,{default:n(()=>[l(b,{type:"primary",size:"default",onClick:q},{default:n(()=>[d(" 邀约公司 ")]),_:1})]),_:1}),l(Z,null,{default:n(()=>[l(b,{size:"default"},{default:n(()=>[d(" 导出 ")]),_:1}),l(Y,{border:t(I),"onUpdate:border":o[0]||(o[0]=e=>h(I)?I.value=e:null),tableAutoHeight:t(w),"onUpdate:tableAutoHeight":o[1]||(o[1]=e=>h(w)?w.value=e:null),checkList:t(c),"onUpdate:checkList":o[2]||(o[2]=e=>h(c)?c.value=e:null),columns:t(P),"onUpdate:columns":o[3]||(o[3]=e=>h(P)?P.value=e:null),"line-height":t(S),"onUpdate:lineHeight":o[4]||(o[4]=e=>h(S)?S.value=e:null),stripe:t(T),"onUpdate:stripe":o[5]||(o[5]=e=>h(T)?T.value=e:null),style:{"margin-left":"12px"},onQueryData:z},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),ve((s(),i(se,{border:t(I),data:t(W),size:t(S),stripe:t(T),onSelectionChange:K,"highlight-current-row":"",onCurrentChange:H},{empty:n(()=>[l(le,{image:t(ge),"image-size":300},null,8,["image"])]),default:n(()=>[l(f,{align:"left",type:"selection"}),t(c).includes("bindStatus")?(s(),i(f,{key:0,align:"left",prop:"bindStatus","show-overflow-tooltip":"",label:"状态",width:"100"},{default:n(({row:e})=>[_("div",Re,[e.bindStatus===2?(s(),i(g,{key:0,type:"success"},{default:n(()=>[d("合作")]),_:1})):r("",!0),e.bindStatus===4?(s(),i(g,{key:1,type:"danger"},{default:n(()=>[d("解约")]),_:1})):r("",!0)])]),_:1})):r("",!0),t(c).includes("bindStatus")?(s(),i(f,{key:1,align:"left",prop:"sendProjectType","show-overflow-tooltip":"",label:"发送项目状态",width:"120"},{default:n(({row:e})=>[_("div",xe,[e.sendProjectType===1?(s(),i(g,{key:0,type:"success"},{default:n(()=>[d("自动")]),_:1})):r("",!0),e.sendProjectType===2?(s(),i(g,{key:1,type:"danger"},{default:n(()=>[d("手动")]),_:1})):r("",!0)])]),_:1})):r("",!0),t(c).includes("receiveProjectType")?(s(),i(f,{key:2,align:"left",prop:"receiveProjectType","show-overflow-tooltip":"",label:"接收项目状态",width:"120"},{default:n(({row:e})=>[_("div",Le,[e.receiveProjectType===1?(s(),i(g,{key:0,type:"success"},{default:n(()=>[d("自动")]),_:1})):r("",!0),e.receiveProjectType===2?(s(),i(g,{key:1,type:"danger"},{default:n(()=>[d("手动")]),_:1})):r("",!0)])]),_:1})):r("",!0),t(c).includes("beInvitationTenantId")?(s(),i(f,{key:3,align:"left",prop:"beInvitationTenantId",width:"280",label:"合作商ID"},{default:n(({row:e})=>[_("div",je,[_("div",De,[l(te,{effect:"dark",content:e.beInvitationTenantId,placement:"top-start"},{default:n(()=>[d(y(e.beInvitationTenantId),1)]),_:2},1032,["content"])]),l(ne,{content:e.beInvitationTenantId,class:N({rowCopy:"rowCopy",current:e.id===t(E)})},null,8,["content","class"])])]),_:1})):r("",!0),t(c).includes("beInvitationTenantName")?(s(),i(f,{key:4,align:"left",prop:"beInvitationTenantName","show-overflow-tooltip":"",label:"合作商名称"},{default:n(({row:e})=>[_("div",Me,y(e.beInvitationTenantName),1)]),_:1})):r("",!0),t(c).includes("userName")?(s(),i(f,{key:5,align:"left",prop:"userName","show-overflow-tooltip":"",label:"负责部门/PM"},{default:n(({row:e})=>[_("div",$e,[_("div",Ae,y(e.userName),1),e.projectType!==2?(s(),i(ae,{key:0,onClick:D=>X(e,"chargeUserId"),class:N({edit:"edit",current:e.id===t(E)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])):r("",!0)])]),_:1})):r("",!0),t(c).includes("priceRatio")?(s(),i(f,{key:6,align:"left",prop:"priceRatio","show-overflow-tooltip":"",label:"价格比例"},{default:n(({row:e})=>[_("div",Ue,y(e.priceRatio)+"%",1)]),_:1})):r("",!0),t(c).includes("pendBalance")?(s(),i(f,{key:7,align:"left",prop:"pendBalance","show-overflow-tooltip":"",label:"待审金额"},{default:n(({row:e})=>[_("div",Fe,[l(j),d(y(e.pendBalance||0),1)])]),_:1})):r("",!0),t(c).includes("availableBalance")?(s(),i(f,{key:8,align:"left",prop:"availableBalance","show-overflow-tooltip":"",label:"可用金额"},{default:n(({row:e})=>[_("div",He,[l(j),d(y(e.availableBalance||0),1)])]),_:1})):r("",!0),l(f,{align:"left",fixed:"right",prop:"i",label:"操作",width:"200"},{default:n(({row:e})=>[l(oe,null,{default:n(()=>[e.bindStatus===2?(s(),i(b,{key:0,type:"danger",plain:"",size:"small",onClick:D=>Q(e)},{default:n(()=>[d(" 终止合作 ")]),_:2},1032,["onClick"])):r("",!0),l(b,{size:"small",type:"danger",onClick:D=>V(e)},{default:n(()=>[d(" 合作配置 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["border","data","size","stripe"])),[[ce,t(C)]]),l(ie,{"current-page":t(v).page,total:t(v).total,"page-size":t(v).size,"page-sizes":t(v).sizes,layout:t(v).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:G,onCurrentChange:J},null,8,["current-page","total","page-size","page-sizes","layout"]),l(ze,{ref_key:"editRef",ref:R,onFetchData:z},null,512),l(Be,{ref_key:"proportionRef",ref:x,onFetchData:z},null,512)]),_:1}),l(Ne,{ref_key:"QuickEditRef",ref:L,onFetchData:k},null,512)],2)}}}),tt=Se(qe,[["__scopeId","data-v-3978de8b"]]);export{tt as default};
