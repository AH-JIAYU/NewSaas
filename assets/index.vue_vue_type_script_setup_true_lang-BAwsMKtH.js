
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{u as F}from"./user_customer-Dy08fKKR.js";import{a as O}from"./project_settlement-Cmlg5S7T.js";import{d as R,r,D as q,a as s,o as p,b as f,f as a,w as o,F as A,g as c,G as T,a3 as I,a4 as k,e as G,ak as C}from"./index-D2AxB2YS.js";const H={style:{flex:"auto"}},Q=R({name:"SettlementEdit",__name:"index",emits:["success"],setup(J,{expose:P,emit:x}){const M=x,U=F(),b=r([]),V=r(!1),i=r(),u=r(),l=r({id:"",projectId:"",clientId:"",doMoneyPrice:"",settlementDone:"",systemDone:"",settlementPo:"",remark:"",status:null}),j=r({clientId:[{required:!0,message:"请选择所属客户",trigger:"change"}],doMoneyPrice:[{required:!0,message:"请选择所属客户",trigger:"blur"}]}),w=[{label:"待审核",value:1},{label:"已审核",value:2},{label:"已开票",value:3},{label:"已结算",value:4},{label:"已冻结",value:5}],d=r(!1);function S(){i.value&&i.value.validate(async v=>{if(v){V.value=!0;const{status:e}=await O.edit(l.value);e===1?(M("success"),V.value=!1,C.success({message:"操作成功",center:!0}),g()):C.error({message:"操作失败，请联系工作人员",center:!0})}})}async function B(v){u.value=JSON.parse(v),l.value.id=u.value.id,l.value.projectId=u.value.projectId,l.value.clientId=u.value.clientId,l.value.doMoneyPrice=u.value.projectAmount,l.value.settlementDone=u.value.settlementDone,l.value.systemDone=u.value.systemDone,l.value.settlementPo=u.value.settlementPo,l.value.remark=u.value.remark,l.value.status=u.value.status,d.value=!0}function g(){i.value.resetFields(),Object.assign(l.value,{id:"",projectId:"",clientId:"",doMoneyPrice:"",settlementDone:"",systemDone:"",settlementPo:"",remark:"",status:null}),d.value=!1}return q(async()=>{b.value=await U.getCustomerList()}),P({showEdit:B}),(v,e)=>{const E=s("el-text"),n=s("el-form-item"),_=s("el-option"),y=s("el-select"),m=s("el-input"),L=s("el-form"),D=s("el-button"),N=s("el-dialog");return p(),f("div",null,[a(N,{modelValue:d.value,"onUpdate:modelValue":e[13]||(e[13]=t=>d.value=t),title:"项目结算编辑",width:"600","before-close":g},{footer:o(()=>[A("div",H,[a(D,{type:"primary",onClick:S},{default:o(()=>[c(" 确定 ")]),_:1}),a(D,{onClick:e[12]||(e[12]=t=>d.value=!1)},{default:o(()=>[c(" 取消 ")]),_:1})])]),default:o(()=>[a(L,{ref_key:"formRef",ref:i,model:l.value,rules:j.value,"label-width":"100px",inline:!1},{default:o(()=>[a(n,{label:"项目ID"},{default:o(()=>[a(E,{class:"mx-1"},{default:o(()=>[c(T(l.value.projectId),1)]),_:1})]),_:1}),a(n,{prop:"clientId",label:"所属客户"},{default:o(()=>[a(y,{modelValue:l.value.clientId,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value.clientId=t),placeholder:"请选择所属客户",clearable:"",filterable:""},{default:o(()=>[(p(!0),f(I,null,k(b.value,t=>(p(),G(_,{key:t.tenantCustomerId,value:t.tenantCustomerId,label:t.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(n,{prop:"doMoneyPrice",label:"原价(美元)"},{default:o(()=>[a(m,{modelValue:l.value.doMoneyPrice,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.doMoneyPrice=t),placeholder:"",clearable:"",onChange:e[2]||(e[2]=()=>{})},null,8,["modelValue"])]),_:1}),a(n,{label:"系统完成数"},{default:o(()=>[a(m,{modelValue:l.value.systemDone,"onUpdate:modelValue":e[3]||(e[3]=t=>l.value.systemDone=t),placeholder:"",clearable:"",onChange:e[4]||(e[4]=()=>{})},null,8,["modelValue"])]),_:1}),a(n,{label:"结算完成数"},{default:o(()=>[a(m,{modelValue:l.value.settlementDone,"onUpdate:modelValue":e[5]||(e[5]=t=>l.value.settlementDone=t),placeholder:"",clearable:"",onChange:e[6]||(e[6]=()=>{})},null,8,["modelValue"])]),_:1}),a(n,{label:"结算PO号"},{default:o(()=>[a(m,{modelValue:l.value.settlementPo,"onUpdate:modelValue":e[7]||(e[7]=t=>l.value.settlementPo=t),placeholder:"",clearable:"",onChange:e[8]||(e[8]=()=>{})},null,8,["modelValue"])]),_:1}),a(n,{label:"备注"},{default:o(()=>[a(m,{modelValue:l.value.remark,"onUpdate:modelValue":e[9]||(e[9]=t=>l.value.remark=t),placeholder:"",clearable:"",onChange:e[10]||(e[10]=()=>{})},null,8,["modelValue"])]),_:1}),a(n,{label:"状态"},{default:o(()=>[a(y,{placeholder:"结算状态",modelValue:l.value.status,"onUpdate:modelValue":e[11]||(e[11]=t=>l.value.status=t),clearable:"",filterable:""},{default:o(()=>[(p(),f(I,null,k(w,t=>a(_,{key:t.value,value:t.value,label:t.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});export{Q as _};
