
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as w}from"./department-BZJZymwT.js";import{d as E,r as l,a3 as R,n as L,a as f,o as T,b as B,f as c,w as n,y as F,g as v,i as d,A as K,L as M}from"./index-BpBKh_da.js";const P={class:"flex-c"},q=E({__name:"index",emits:["userData"],setup(A,{expose:p,emit:_}){const t=l(!1);l([]);const h=l([]),m=l(),e=l({type:1,tenantStaffList:[],roleList:[],title:"",project:[],form:{chargeUserId:null,chargeUserName:""}}),U={children:"children",label:"name"},k=R({chargeUserId:[{required:!0,message:"请选择负责人",trigger:"change"}]});l(!1);async function I(o,a,r){const s=await w.list({name:""});s.data&&(h.value=s.data),t.value=!0,e.value.title=a,e.value.form.invitationType=2,r&&(e.value.project=r,e.value.form.chargeUserName=r.chargeUserName,e.value.form.chargeUserId=r.chargeUserId)}function y(){t.value=!1,i.value.resetFields()}const N=_,i=l();function b(){i.value.validate(o=>{if(o){let a={chargeUserId:e.value.form.chargeUserId,chargeUserName:e.value.form.chargeUserName,invitationType:e.value.form.invitationType};t.value=!1,N("userData",a)}})}L(async()=>{}),p({showEdit:I}),l();const x=(o,a)=>{a?(m.value.getCheckedKeys().forEach(s=>{s!==o.id&&m.value.setChecked(s,!1)}),e.value.form.chargeUserId=o.id,e.value.form.chargeUserName=o.name):(e.value.form.chargeUserId=[e.value.form.chargeUserId].filter(r=>r!==o.id),e.value.form.chargeUserId.length==0&&(e.value.form.chargeUserId="")),e.value.form.chargeUserId||(e.value.form.chargeUserName=""),console.log(e.value.form.chargeUserName,"data.value.form.chargeUserName"),console.log(e.value.form.chargeUserId,"data.value.form.chargeUserId")};return(o,a)=>{const r=f("el-tree-select"),s=f("el-form-item"),C=f("ElForm"),g=f("el-button"),V=f("el-dialog");return T(),B("div",null,[c(V,{modelValue:d(t),"onUpdate:modelValue":a[1]||(a[1]=u=>K(t)?t.value=u:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:"请选择项目负责人",class:"userClass"},{footer:n(()=>[F("div",P,[c(g,{onClick:y},{default:n(()=>[v(" 取消 ")]),_:1}),c(g,{type:"primary",onClick:b},{default:n(()=>[v(" 确认 ")]),_:1})])]),default:n(()=>[c(C,{ref_key:"formRef",ref:i,rules:d(k),model:d(e).form},{default:n(()=>[c(s,{label:"部门",prop:"chargeUserId"},{default:n(()=>[c(r,{placeholder:"请选择部门",ref_key:"treeRef",ref:m,modelValue:d(e).form.chargeUserId,"onUpdate:modelValue":a[0]||(a[0]=u=>d(e).form.chargeUserId=u),data:d(h),"check-strictly":"","show-checkbox":"","default-expand-all":"","node-key":"id",props:U,onCheckChange:x,"check-on-click-node":!0,"expand-on-click-node":!1},null,8,["modelValue","data"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}}}),z=M(q,[["__scopeId","data-v-c41b57ac"]]);export{z as default};
