
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as Ee}from"./index-Zau4TbUV.js";import{_ as He}from"./index-DBt7Bc-t.js";import{d as ze,aN as xe,r as s,l as Be,n as J,W as B,a as g,q as $e,o as r,b as S,y as v,f as n,w as l,g as h,az as Me,s as E,e as u,z as C,F as $,t as K,j as p,ay as M,ao as j,i as Ue,aM as Fe,N as Pe,aO as U,E as F,p as q,_ as Re,aH as Ge,aI as Te,L as Ze,am as W}from"./index-Je2rJzER.js";import{a as P}from"./department-DNz9uYTC.js";import{u as Ae}from"./department-B0LDTe8r.js";import{u as Oe}from"./position_manage-DFFCmV6-.js";import Je from"./index-DM_miybZ.js";import Ke from"./index-DlyPX1yS.js";import je from"./index-6hBp02Hn.js";import qe from"./index-B80HE0rJ.js";import We from"./index-BFJL7cBR.js";import"./index-BSRt9VPP.js";import"./position_manage-D_d0npLV.js";import"./tenantDictionary-CWGaztl1.js";import"./configuration_role-BD4Q9r-7.js";import"./tenant_role-BsoaOQhp.js";import"./configuration_manager-doJ_5k7m.js";const Q=w=>(Ge("data-v-0913a08c"),w=w(),Te(),w),Qe={class:"absolute-container"},Xe={class:"page-main"},Ye={class:"custom-tree-node"},ea=["title"],aa={class:"code"},ta={key:0,style:{"margin-right":"0.3rem"}},la={class:"actions"},ia={class:"dictionary-container"},oa={class:"copyId tableSmall"},na={class:"id oneLine idFont"},ra={style:{display:"flex","align-items":"center"}},sa={key:0,xmlns:"http://www.w3.org/2000/svg",style:{"margin-top":"2px","margin-right":"7px"},width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},ua=Q(()=>v("g",{id:"Group 18384"},[v("circle",{id:"Ellipse 105",cx:"10",cy:"10",r:"10",fill:"#F8BB4F"}),v("path",{id:"ç®¡",d:"M13.9946 9.3605V12.1892H7.43481V12.9031H14.6277V16.4995H13.3481V16.0146H7.43481V16.486H6.15517V9.3605H13.9946ZM7.43481 14.8831H13.3481V13.9133H7.43481V14.8831ZM7.43481 11.1655H12.7419V10.3842H7.43481V11.1655ZM15.8534 7.67677V10.2495H14.6008V8.75436H5.52209V10.2495H4.2694V7.67677H9.48222C9.37446 7.40738 9.25323 7.16492 9.13201 6.9494L10.2635 6.76083L10.0345 6.61266C10.6541 5.80447 11.1121 4.9424 11.3815 4.01298L12.6072 4.28238C12.5264 4.51136 12.4591 4.72688 12.3782 4.9424H16.1228V6.06039H13.9273C14.1428 6.35673 14.3179 6.65307 14.4661 6.92246L13.3346 7.34003C13.1191 6.90899 12.8631 6.47796 12.5668 6.06039H11.8799C11.6509 6.5049 11.3949 6.92246 11.1121 7.29962L10.4655 6.88206C10.5733 7.12451 10.6676 7.39391 10.7753 7.67677H15.8534ZM6.08782 6.06039C5.79149 6.54531 5.46821 7.00328 5.118 7.42085L4 6.72042C4.78125 5.88529 5.33351 4.96934 5.67026 3.99951L6.89601 4.26891C6.81519 4.4979 6.72091 4.72688 6.64009 4.9424H10.0345V6.06039H8.01401C8.25647 6.39714 8.47198 6.72042 8.63362 7.03022L7.46175 7.47473C7.23276 6.98981 6.97683 6.51837 6.6805 6.06039H6.08782Z",fill:"white"})],-1)),da=[ua],ca={class:"dictionary-container"},pa=Q(()=>v("div",{class:"empty"},"请在左侧新增或选择一个部门",-1)),va=[pa],X=ze({name:"department",__name:"list",setup(w){const{pagination:R,getParams:ma,onSizeChange:fa,onCurrentChange:ga,onSortChange:Y}=xe(),H=Oe(),G=s(),ee=Be(),ae=s([]),z=Ae(),te=s(),le=s([{label:"员工ID",prop:"id",sortable:!0,checked:!0},{label:"用户名",prop:"userName",sortable:!0,checked:!0},{label:"电话号码",prop:"phoneNumber",sortable:!0,checked:!0},{label:"邮箱",prop:"email",sortable:!0,checked:!0},{label:"部门",prop:"departmentId",sortable:!0,checked:!0},{label:"职位",prop:"positionId",sortable:!0,checked:!0},{label:"小组",prop:"groupId",sortable:!0,checked:!0},{label:"状态",prop:"active",sortable:!0,checked:!0}]),V=s(!1),ie=s(),T=s(),_=s({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),N=s(),oe=s(),i=s({loading:!1,tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],search:{page:1,limit:10,id:"",userName:"",active:null,departmentId:null},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}}),Z=s(),o=s({search:{name:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:"",isClick:!1},row:"",loading:!1}),m=s({search:{name:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:"",name:""},row:"",loading:!1});s();const d=s({loading:!1,search:{organizationalStructureId:""},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}});async function k(){try{o.value.loading=!0;const e={...o.value.search},t=await P.list(e);o.value.tree=t.data,o.value.loading=!1}catch{}finally{o.value.loading=!1}}J(()=>{k()}),B(()=>o.value.search,e=>{Z.value.filter(e)});function ne(e,t){return e?t.label.includes(e):!0}function re(e){o.value.currentData=e,o.value.dialog.parentId="",o.value.dialog.id="",o.value.dialog.visible=!0}function se(e){m.value.currentData=e,m.value.dialog.parentId=(e==null?void 0:e.id)??"",m.value.dialog.name=(e==null?void 0:e.name)??"",m.value.dialog.id="",m.value.dialog.visible=!0}function ue(e,t){o.value.currentNode=e,o.value.currentData=t,o.value.row=JSON.stringify(t),o.value.dialog.parentId=e.parent.data.id??"",o.value.dialog.id=t.id,o.value.dialog.visible=!0,d.value.search.organizationalStructureId&&(o.value.dialog.isClick=!0)}function de(e,t){U.confirm(`确认删除「${t.name}」吗？`,"确认信息").then(()=>{P.delete({id:t.id}).then(()=>{F.success({message:"删除成功",center:!0}),k()})})}function ce(e){R.value.page=1,e.id&&(i.value.dialog.parentId=e.id),d.value.search.organizationalStructureId=e.id}B(()=>d.value.search.organizationalStructureId,()=>{I()});async function I(){N.value=null;try{V.value=!0;const e={...d.value.search},t=await P.itemlist(e);t.data&&(V.value=!1,i.value.dataList=t.data,d.value.dataList.forEach(f=>{f.enableLoading=!1}),R.value.total=t.data.length||0)}catch{}finally{V.value=!1}}J(async()=>{try{_.value.loading=!0,ae.value=await ee.getCountry(),te.value=await(z==null?void 0:z.getDepartment())||[],G.value=await(H==null?void 0:H.getPositionManage())||[],le.value.forEach(e=>{e.checked&&i.value.checkList.push(e.prop)}),_.value.loading=!1}catch{}finally{_.value.loading=!1}}),B(()=>_.value.search,e=>{ie.value.filter(e)});function pe(e){return new Promise(t=>{U.confirm(`确认${e.active?"禁用":"启用"}「${e.userName}」吗？`,"确认信息").then(()=>{try{_.value.loading=!0,q.edit({id:e.id,email:e.email,phoneNumber:e.phoneNumber,userName:e.userName,country:e.country,role:e.role,positionId:e.positionId,organizationalStructureId:e.organizationalStructureId,active:!e.active}).then(()=>(F.success({message:`${e.active?"禁用":"启用"}成功`,center:!0}),I(),_.value.loading=!1,t(!0))).catch(()=>(_.value.loading=!1,t(!1)))}catch{}finally{_.value.loading=!1}}).catch(()=>t(!1))})}function ve({prop:e,order:t}){Y(e,t).then(()=>I())}function me(e){i.value.dialog.id="",i.value.dialog.visible=!0,i.value.dialog.level=1}const fe=e=>{N.value=e[0]};function ge(){if(N.value){const{userName:e,id:t}=N.value;U.confirm(`确认将「${e}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{q.reset({id:t}).then(()=>{F.success({message:"重置成功",center:!0}),I()})}).catch(()=>{})}}function he(e){i.value.row=JSON.stringify(e),i.value.dialog.id=e.id,i.value.dialog.visible=!0}function _e(e){T.value.showEdit(e)}const x=s();function ye(e){e?x.value=e.id:x.value=""}return(e,t)=>{const f=g("ElButton"),A=g("ElButtonGroup"),D=Re,be=g("ElInput"),Ce=g("ElTree"),ke=g("ElScrollbar"),Ie=g("ElSpace"),y=g("ElTableColumn"),Le=g("ElSwitch"),Se=g("el-tooltip"),we=He,b=g("el-text"),Ve=g("el-empty"),Ne=g("ElTable"),De=Ee,O=$e("loading");return r(),S("div",Qe,[v("div",Xe,[n(De,{"hide-left-side-toggle":""},{leftSide:l(()=>[n(A,{class:"btns"},{default:l(()=>[n(f,{type:"primary",class:"add",onClick:t[0]||(t[0]=a=>re())},{default:l(()=>[h(" 新增部门 ")]),_:1})]),_:1}),n(be,{modelValue:o.value.search.name,"onUpdate:modelValue":t[1]||(t[1]=a=>o.value.search.name=a),placeholder:"请输入关键词筛选",clearable:"",class:"search",onKeydown:Me(k,["enter"])},{append:l(()=>[n(f,{onClick:k},{default:l(()=>[n(D,{name:"i-ep:search"})]),_:1})]),_:1},8,["modelValue"]),n(ke,{class:"tree"},{default:l(()=>[E((r(),u(Ce,{ref_key:"dictionaryRef",ref:Z,data:o.value.tree,"filter-node-method":ne,"default-expand-all":"",onNodeClick:ce},{default:l(({node:a,data:c})=>[v("div",Ye,[v("div",{class:"label",title:a.label},C(c.name),9,ea),v("div",aa,[(r(!0),S($,null,K(c==null?void 0:c.organizationalStructurePersonList,L=>(r(),S($,{key:L.userId},[L.enableChargePerson==1?(r(),S("span",ta,C(L.userName),1)):p("",!0)],64))),128))]),v("div",la,[n(A,null,{default:l(()=>[n(f,{type:"primary",plain:"",size:"default",onClick:M(L=>se(c),["stop"])},{icon:l(()=>[n(D,{name:"i-ep:plus"})]),_:2},1032,["onClick"]),n(f,{type:"info",plain:"",size:"default",onClick:M(L=>ue(a,c),["stop"])},{icon:l(()=>[n(D,{name:"i-ep:edit"})]),_:2},1032,["onClick"]),n(f,{type:"danger",plain:"",size:"default",onClick:M(L=>de(a,c),["stop"])},{icon:l(()=>[n(D,{name:"i-ep:delete"})]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])),[[O,o.value.loading]])]),_:1})]),default:l(()=>[E(v("div",ia,[n(Ie,{wrap:""},{default:l(()=>[n(f,{type:"primary",onClick:t[2]||(t[2]=a=>me())},{default:l(()=>[h(" 新增员工 ")]),_:1}),n(f,{onClick:ge},{default:l(()=>[h(" 重置密码 ")]),_:1})]),_:1}),E((r(),u(Ne,{ref_key:"userItemRef",ref:oe,data:i.value.dataList,border:i.value.border,size:i.value.lineHeight,stripe:i.value.stripe,"highlight-current-row":"",height:"100%",onSortChange:ve,onSelectionChange:t[3]||(t[3]=a=>i.value.selectionDataList=a),"row-key":"id","default-expand-all":"",onSelect:fe,onCurrentChange:ye},{empty:l(()=>[n(Ve,{image:Ue(Fe),"image-size":300},null,8,["image"])]),default:l(()=>[n(y,{type:"selection",align:"left",fixed:""}),i.value.checkList.includes("active")?(r(),u(y,{key:0,align:"left",prop:"active",label:"状态"},{default:l(a=>[n(Le,{modelValue:a.row.active,"onUpdate:modelValue":c=>a.row.active=c,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>pe(a.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1})):p("",!0),i.value.checkList.includes("id")?(r(),u(y,{key:1,align:"left",width:"180",prop:"id",label:"员工ID"},{default:l(({row:a})=>[v("div",oa,[v("div",na,[n(Se,{effect:"dark",content:a.id,placement:"top-start"},{default:l(()=>[h(C(a.id),1)]),_:2},1032,["content"])]),n(we,{content:a.id,class:Pe({rowCopy:"rowCopy",current:a.id===x.value})},null,8,["content","class"])])]),_:1})):p("",!0),i.value.checkList.includes("userName")?(r(),u(y,{key:2,align:"left",width:"160",prop:"userName",label:"用户名"},{default:l(({row:a})=>[v("div",ra,[a.enableChargePerson===1?(r(),S("svg",sa,da)):p("",!0),n(b,{class:"tableBig"},{default:l(()=>[h(C(a.userName?a.userName:"-"),1)]),_:2},1024)])]),_:1})):p("",!0),i.value.checkList.includes("phoneNumber")?(r(),u(y,{key:3,align:"left",width:"170",prop:"phone",label:"电话号码"},{default:l(({row:a})=>[n(b,{class:"fontC-System"},{default:l(()=>[h(C(a.phoneNumber?a.phoneNumber:"-"),1)]),_:2},1024)]),_:1})):p("",!0),i.value.checkList.includes("email")?(r(),u(y,{key:4,align:"left",width:"180",prop:"email",label:"邮箱"},{default:l(({row:a})=>[n(b,{class:"fontC-System"},{default:l(()=>[h(C(a.email?a.email:"-"),1)]),_:2},1024)]),_:1})):p("",!0),i.value.checkList.includes("departmentId")?(r(),u(y,{key:5,align:"left",prop:"departmentId",label:"部门"},{default:l(({row:a})=>[n(b,{class:"fontC-System"},{default:l(()=>[h(C(a.organizationalStructureName?a.organizationalStructureName:"-"),1)]),_:2},1024)]),_:1})):p("",!0),i.value.checkList.includes("positionId")?(r(),u(y,{key:6,align:"left",prop:"positionId",label:"职位"},{default:l(({row:a})=>[a.positionId?(r(),u(b,{key:0,class:"fontC-System"},{default:l(()=>[(r(!0),S($,null,K(G.value,c=>(r(),u(b,null,{default:l(()=>[a.positionId===c.id?(r(),u(b,{key:0},{default:l(()=>[h(C(c.name?c.name:"-"),1)]),_:2},1024)):p("",!0)]),_:2},1024))),256))]),_:2},1024)):(r(),u(b,{key:1,class:"fontC-System"},{default:l(()=>[h("-")]),_:1}))]),_:1})):p("",!0),n(y,{label:"操作",fixed:"right",width:"200",align:"left"},{default:l(a=>[n(f,{type:"primary",size:"small",plain:"",onClick:c=>he(a.row)},{default:l(()=>[h(" 编辑 ")]),_:2},1032,["onClick"]),n(f,{type:"warning",size:"small",plain:"",onClick:c=>_e(a.row)},{default:l(()=>[h(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[O,V.value]])],512),[[j,d.value.search.organizationalStructureId]]),E(v("div",ca,va,512),[[j,!d.value.search.organizationalStructureId]])]),_:1}),o.value.dialog.visible?(r(),u(Je,{key:0,id:o.value.dialog.id,modelValue:o.value.dialog.visible,"onUpdate:modelValue":t[4]||(t[4]=a=>o.value.dialog.visible=a),row:o.value.row,"parent-id":o.value.dialog.parentId,tree:o.value.tree,isClick:o.value.dialog.isClick,onGetList:k,onGetItmelist:I},null,8,["id","modelValue","row","parent-id","tree","isClick"])):p("",!0),m.value.dialog.visible?(r(),u(Ke,{key:1,id:m.value.dialog.id,modelValue:m.value.dialog.visible,"onUpdate:modelValue":t[5]||(t[5]=a=>m.value.dialog.visible=a),row:m.value.row,"parent-id":m.value.dialog.parentId,name:m.value.dialog.name,tree:m.value.tree,onGetList:k},null,8,["id","modelValue","row","parent-id","name","tree"])):p("",!0),d.value.dialog.visible?(r(),u(je,{key:2,id:d.value.dialog.id,modelValue:d.value.dialog.visible,"onUpdate:modelValue":t[6]||(t[6]=a=>d.value.dialog.visible=a),"catalogue-id":d.value.search.organizationalStructureId,"parent-id":d.value.dialog.parentId,level:d.value.dialog.level,tree:o.value.tree,dataList:d.value.dataList,row:d.value.row,onSuccess:I},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):p("",!0),i.value.dialog.visible?(r(),u(qe,{key:3,id:i.value.dialog.id,modelValue:i.value.dialog.visible,"onUpdate:modelValue":t[7]||(t[7]=a=>i.value.dialog.visible=a),"catalogue-id":i.value.search.catalogueId,"parent-id":i.value.dialog.parentId,level:i.value.dialog.level,tree:_.value.tree,dataList:i.value.dataList,row:i.value.row,onSuccess:I,onGetList:k},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):p("",!0),n(We,{ref_key:"detailRef",ref:T},null,512)])])}}});typeof W=="function"&&W(X);const Ba=Ze(X,[["__scopeId","data-v-0913a08c"]]);export{Ba as default};
