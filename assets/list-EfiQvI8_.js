
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as de,r as h,O as pe,aN as ce,y as me,k as fe,G as x,J as ge,a as u,p as ve,o,b as L,f as n,w as t,aC as V,q as U,F as z,t as $,e as r,g as d,H as v,j as c,i as C,S as _e,N as be,aP as he,aQ as ke,aq as ye,aJ as Ce,aK as we,s as Le,ar as Ie,R as Ee}from"./index-Cv0hhvIB.js";import{_ as Be}from"./index.vue_vue_type_style_index_0_lang-ClwsRHCj.js";import{_ as Se}from"./index.vue_vue_type_script_setup_true_lang-p8Rq7eRZ.js";import{a as Ne}from"./financial_pm_log-DMouMiGW.js";import{_ as Ve}from"./index.vue_vue_type_script_setup_true_lang-SJfQEsEC.js";import ze from"./index-CRuW0Gld.js";import{u as $e}from"./position_manage-B0JWt3p4.js";import{u as De}from"./group_manage-D8f1z4ut.js";import{u as Pe}from"./useTabbar-Cn3cmtez.js";import"./index.vue_vue_type_script_setup_true_lang-DKfgo3Uh.js";import"./position_manage-D1WEz_75.js";import"./group_manage-KYLEgDj8.js";const He=w=>(Ce("data-v-e21be8e5"),w=w(),we(),w),Me=He(()=>Le("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),xe=de({name:"financial_pm_log",__name:"list",setup(w){const I=$e(),E=h(),B=De(),D=h();pe();const{pagination:b,getParams:F,onSizeChange:R,onCurrentChange:A,onSortChange:T}=ce();Pe(),me();const P=h(),H=h(),S=h([{label:"员工ID",prop:"id",sortable:!0,disableCheck:!1,checked:!0},{label:"用户名",prop:"userName",sortable:!0,disableCheck:!1,checked:!0},{label:"姓名",prop:"name",sortable:!0,disableCheck:!1,checked:!0},{label:"所属组",prop:"groupId",sortable:!0,disableCheck:!1,checked:!0},{label:"职位",prop:"positionId",sortable:!0,disableCheck:!1,checked:!0},{label:"待审提成",prop:"pendingBalance",sortable:!0,disableCheck:!1,checked:!0},{label:"可用提成",prop:"availableBalance",sortable:!0,disableCheck:!1,checked:!0}]),e=h({loading:!1,activeName:"myFinancial",tableAutoHeight:!1,border:!0,stripe:!1,lineHeight:"default",checkList:[],formMode:"drawer",formModeProps:{visible:!1,id:""},search:{page:1,limit:10,id:null,userName:"",name:"",positionId:null},batch:{enable:!1,selectionDataList:[]},dataList:[]});fe(async()=>{E.value=await(I==null?void 0:I.getPositionManage())||[],D.value=await(B==null?void 0:B.getGroupManage())||[],f(),e.value.formMode==="router"&&x.on("get-data-list",()=>{f()}),S.value.forEach(i=>{i.checked&&e.value.checkList.push(i.prop)})}),ge(()=>{e.value.formMode==="router"&&x.off("get-data-list")});function f(){e.value.loading=!0;const i={...F(),...e.value.search};Ne.list(i).then(a=>{e.value.loading=!1,e.value.dataList=a.data.data,b.value.total=+a.data.total})}function K(i){P.value.showEdit(JSON.stringify(i))}function J(i){H.value.showEdit(i)}function O(){Object.assign(e.value.search,{page:1,limit:10,id:null,userName:"",name:"",positionId:null}),f()}function j(i){R(i).then(()=>{e.value.search.limit=i,f()})}function g(i=1){A(i).then(()=>{e.value.search.page=i,f()})}function q({prop:i,order:a}){T(i,a).then(()=>f())}return(i,a)=>{const N=u("ElInput"),k=u("ElFormItem"),G=u("el-option"),Q=u("el-select"),M=be,y=u("ElButton"),W=u("ElForm"),X=Se,Y=u("ElDivider"),Z=Be,ee=u("el-button"),ae=he,le=ke,te=u("el-row"),ne=u("el-table-column"),m=u("ElTableColumn"),_=u("el-text"),oe=u("el-empty"),se=u("ElTable"),ie=u("ElPagination"),re=ye,ue=ve("loading");return o(),L("div",{class:_e({"absolute-container":e.value.tableAutoHeight})},[n(re,null,{default:t(()=>[n(X,{"show-toggle":!1},{default:t(({fold:l,toggle:p})=>[n(W,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:t(()=>[n(k,null,{default:t(()=>[n(N,{modelValue:e.value.search.id,"onUpdate:modelValue":a[0]||(a[0]=s=>e.value.search.id=s),placeholder:"员工ID",clearable:"",onKeydown:a[1]||(a[1]=V(s=>g(),["enter"])),onClear:a[2]||(a[2]=s=>g())},null,8,["modelValue"])]),_:1}),n(k,null,{default:t(()=>[n(N,{modelValue:e.value.search.userName,"onUpdate:modelValue":a[3]||(a[3]=s=>e.value.search.userName=s),placeholder:"用户名",clearable:"",onKeydown:a[4]||(a[4]=V(s=>g(),["enter"])),onClear:a[5]||(a[5]=s=>g())},null,8,["modelValue"])]),_:1}),n(k,null,{default:t(()=>[n(N,{modelValue:e.value.search.name,"onUpdate:modelValue":a[6]||(a[6]=s=>e.value.search.name=s),placeholder:"姓名",clearable:"",onKeydown:a[7]||(a[7]=V(s=>g(),["enter"])),onClear:a[8]||(a[8]=s=>g())},null,8,["modelValue"])]),_:1}),U(n(k,null,{default:t(()=>[n(Q,{modelValue:e.value.search.positionId,"onUpdate:modelValue":a[9]||(a[9]=s=>e.value.search.positionId=s),"value-key":"",placeholder:"职位",clearable:"",filterable:""},{default:t(()=>[(o(!0),L(z,null,$(E.value,s=>(o(),r(G,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:2},1536),[[Ie,!l]]),n(k,null,{default:t(()=>[n(y,{type:"primary",onClick:a[10]||(a[10]=s=>g())},{icon:t(()=>[n(M,{name:"i-ep:search"})]),default:t(()=>[d(" 筛选 ")]),_:1}),n(y,{onClick:O},{icon:t(()=>[Me]),default:t(()=>[d(" 重置 ")]),_:1}),n(y,{link:"",onClick:p},{icon:t(()=>[n(M,{name:l?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:t(()=>[d(" "+v(l?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),n(Y,{"border-style":"dashed"}),n(te,null,{default:t(()=>[n(Z),n(le,null,{default:t(()=>[n(ee,{size:"default"},{default:t(()=>[d(" 导出 ")]),_:1}),n(ae,{border:e.value.border,"onUpdate:border":a[11]||(a[11]=l=>e.value.border=l),tableAutoHeight:e.value.tableAutoHeight,"onUpdate:tableAutoHeight":a[12]||(a[12]=l=>e.value.tableAutoHeight=l),checkList:e.value.checkList,"onUpdate:checkList":a[13]||(a[13]=l=>e.value.checkList=l),columns:S.value,"onUpdate:columns":a[14]||(a[14]=l=>S.value=l),"line-height":e.value.lineHeight,"onUpdate:lineHeight":a[15]||(a[15]=l=>e.value.lineHeight=l),stripe:e.value.stripe,"onUpdate:stripe":a[16]||(a[16]=l=>e.value.stripe=l),style:{"margin-left":"12px"},onQueryData:f},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),U((o(),r(se,{border:e.value.border,size:e.value.lineHeight,stripe:e.value.stripe,class:"my-4",data:e.value.dataList,"highlight-current-row":"",height:"100%",onSortChange:q,onSelectionChange:a[17]||(a[17]=l=>e.value.batch.selectionDataList=l)},{empty:t(()=>[n(oe,{class:"vab-data-empty",description:"暂无数据"})]),default:t(()=>[n(ne,{align:"center",type:"selection"}),e.value.batch.enable?(o(),r(m,{key:0,type:"selection","show-overflow-tooltip":"",align:"center",fixed:""})):c("",!0),e.value.checkList.includes("id")?(o(),r(m,{key:1,"show-overflow-tooltip":"",align:"center",prop:"id",label:"员工ID"},{default:t(({row:l})=>[n(_,null,{default:t(()=>[d(v(l.id?l.id:"-"),1)]),_:2},1024)]),_:1})):c("",!0),e.value.checkList.includes("userName")?(o(),r(m,{key:2,"show-overflow-tooltip":"",align:"center",prop:"userName",label:"用户名"},{default:t(({row:l})=>[d(v(l.userName?l.userName:"-"),1)]),_:1})):c("",!0),e.value.checkList.includes("name")?(o(),r(m,{key:3,"show-overflow-tooltip":"",align:"center",prop:"name",label:"姓名"},{default:t(({row:l})=>[d(v(l.name?l.name:"-"),1)]),_:1})):c("",!0),e.value.checkList.includes("groupId")?(o(),r(m,{key:4,"show-overflow-tooltip":"",align:"center",prop:"groupId",width:"150",label:"所属组"},{default:t(({row:l})=>[l.groupId?(o(),r(_,{key:0},{default:t(()=>[(o(!0),L(z,null,$(D.value,p=>(o(),r(_,null,{default:t(()=>[l.groupId===p.id?(o(),r(_,{key:0},{default:t(()=>[d(v(p.name?p.name:"-"),1)]),_:2},1024)):c("",!0)]),_:2},1024))),256))]),_:2},1024)):(o(),r(_,{key:1},{default:t(()=>[d("-")]),_:1}))]),_:1})):c("",!0),e.value.checkList.includes("positionId")?(o(),r(m,{key:5,"show-overflow-tooltip":"",align:"center",prop:"positionId",width:"150",label:"职位"},{default:t(({row:l})=>[(o(!0),L(z,null,$(E.value,p=>(o(),r(_,null,{default:t(()=>[l.positionId===p.id?(o(),r(_,{key:0},{default:t(()=>[d(v(p.name?p.name:"-"),1)]),_:2},1024)):c("",!0)]),_:2},1024))),256))]),_:1})):c("",!0),e.value.checkList.includes("pendingBalance")?(o(),r(m,{key:6,"show-overflow-tooltip":"",align:"center",prop:"pendingBalance",label:"待审提成"},{default:t(({row:l})=>[d(v(l.pendingBalance?l.pendingBalance:"-"),1)]),_:1})):c("",!0),e.value.checkList.includes("availableBalance")?(o(),r(m,{key:7,"show-overflow-tooltip":"",align:"center",prop:"availableBalance",label:"可用提成"},{default:t(({row:l})=>[d(v(l.availableBalance?l.availableBalance:"-"),1)]),_:1})):c("",!0),n(m,{fixed:"right",align:"center",width:"200",label:"操作"},{default:t(({row:l})=>[n(y,{type:"primary",size:"small",plain:"",onClick:p=>J(l)},{default:t(()=>[d(" 财务日志 ")]),_:2},1032,["onClick"]),n(y,{type:"primary",size:"small",plain:"",onClick:p=>K(l)},{default:t(()=>[d(" 加减款 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","size","stripe","data"])),[[ue,e.value.loading]]),n(ie,{"current-page":C(b).page,total:C(b).total,"page-size":C(b).size,"page-sizes":C(b).sizes,layout:C(b).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:j,onCurrentChange:g},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),n(Ve,{ref_key:"plusMinusPaymentsRef",ref:P,onFetchData:f},null,512),n(ze,{ref_key:"financeLogRef",ref:H},null,512)],2)}}}),We=Ee(xe,[["__scopeId","data-v-e21be8e5"]]);export{We as default};
