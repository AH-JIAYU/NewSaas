
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Y,aD as Q,r as f,a as c,o as P,b as W,f as l,w as a,g as d,i,s as X,ao as ee,y as r,A as I,e as te,j as re,E as j,_ as oe,aH as ae,aI as le,L as ie}from"./index-CudKXuRP.js";import{a as R}from"./user_cooperation-ic70Enjc.js";import{u as ne}from"./index-DprfT1qD.js";import{a as se}from"./department-24awlDjj.js";import"./index-BxNhSkg0.js";import"./index-B0kNE5gc.js";const s=h=>(ae("data-v-44ce8251"),h=h(),le(),h),ce=s(()=>r("div",{style:{display:"flex","align-items":"center"}},[r("span",{style:{display:"inline-block",width:"8px",height:"8px",background:"#FF8181","border-radius":"50%","margin-right":"4px"}}),r("span",{style:{"font-weight":"700","font-size":"0.9375rem"}},"项目分配方式")],-1)),de={style:{color:"#333"}},ue=s(()=>r("div",null,"自动：您所创建的项目，自动分配给该合作商",-1)),pe=s(()=>r("div",null,"手动：您所创建的项目，需要手动分配给该合作商",-1)),fe=s(()=>r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},[r("g",{id:"Frame"},[r("path",{id:"Vector",d:"M10.7144 2.29102L7.86262 6.33368H10.1102V7.22737H7.4919V8.45818H10.1102V9.36304H7.4919V11.1552H6.14483V9.36304H3.43073V8.45818H6.14483V7.22737H3.43073V6.33368H5.74639L2.92188 2.29102H4.44067C5.76051 4.29873 6.56174 5.57235 6.84586 6.11089H6.8731C6.96943 5.88906 7.23309 5.44246 7.66315 4.77109L9.27828 2.29102H10.7144Z",fill:"#777777"})])],-1)),me=s(()=>r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"20",viewBox:"0 0 48 20",fill:"none"},[r("g",{id:"Frame 3476009"},[r("rect",{x:"0.433594",y:"0.96875",width:"47.5681",height:"18.0643",rx:"9.03217",fill:"#D9D9D9","fill-opacity":"0.4"}),r("g",{id:"äººæ°å¸"},[r("path",{id:"Vector",d:"M39.3087 8.27942V12.5804C39.3087 13.0424 39.2097 13.2954 38.8577 13.4274C38.4947 13.5704 37.9117 13.5814 37.0207 13.5704C36.9767 13.3394 36.8447 12.9874 36.7347 12.7564C37.4387 12.7784 38.0547 12.7784 38.2417 12.7674C38.4177 12.7674 38.4727 12.7234 38.4727 12.5584V9.07142H35.8107V14.9564H34.9747V9.07142H32.4337V13.7024H31.6087V8.27942H34.9747V6.48642C33.5997 6.57442 32.2137 6.61842 30.9377 6.64042C30.9267 6.40942 30.8277 6.10142 30.7617 5.90342C33.7977 5.82642 37.5267 5.61742 39.6717 5.23242L40.0017 5.98042C38.8687 6.17842 37.3947 6.32142 35.8107 6.43142V8.27942H39.3087Z",fill:"#777777"}),r("path",{id:"Vector_2",d:"M21.4684 10.3361H24.5814C24.4824 9.80809 24.3944 9.25809 24.3614 8.67509H21.4684V10.3361ZM27.5954 6.26609H21.4684V7.90509H27.5954V6.26609ZM29.2234 11.1061H25.6374C26.2094 12.8551 27.2214 14.0541 28.2004 14.0431C28.5194 14.0321 28.6514 13.5921 28.7064 12.4371C28.8934 12.6021 29.2014 12.7561 29.4214 12.8221C29.2894 14.4281 28.9594 14.8461 28.1564 14.8461C26.6824 14.8571 25.4174 13.2951 24.7794 11.1061H21.4684V13.8561L24.1084 13.2181C24.1084 13.4381 24.1524 13.8011 24.1964 13.9661C21.2044 14.7691 20.7974 14.8681 20.5334 15.0331C20.4674 14.8131 20.2914 14.4501 20.1484 14.2851C20.3464 14.1861 20.6324 13.9331 20.6324 13.4821V5.49609H28.4094V8.67509H25.1974C25.2304 9.25809 25.3184 9.80809 25.4394 10.3361H29.2234V11.1061Z",fill:"#777777"}),r("path",{id:"Vector_3",d:"M12.9656 4.96875H13.8676C13.8566 5.36475 13.8456 5.91475 13.7906 6.56375C13.9556 7.87275 14.6156 12.4707 18.4986 14.1978C18.2676 14.3848 18.0256 14.6598 17.9046 14.8908C15.1546 13.6038 13.9776 10.8868 13.4496 8.84075C12.9436 11.0408 11.7776 13.5048 9.09359 14.9348C8.95059 14.7148 8.68659 14.4728 8.43359 14.2968C12.9986 11.9868 12.9326 6.64075 12.9656 4.96875Z",fill:"#777777"})])])],-1)),he=s(()=>r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},[r("g",{id:"Arrow-right (ç®­å¤´å³)"},[r("rect",{width:"20",height:"20",rx:"10",fill:"#409EFF"}),r("g",{id:"Group 18368"},[r("path",{id:"Vector",d:"M15 10H5",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),r("path",{id:"Vector_2",d:"M11.668 6.66602L15.0013 9.99935L11.668 13.3327",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})])])],-1)),ge=s(()=>r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},[r("g",{id:"Frame"},[r("path",{id:"Vector",d:"M8.37697 6.99714L7.83483 6.87143V3.99571C8.65197 4.10571 9.15483 4.61643 9.2334 5.245C9.24126 5.33143 9.31983 5.39429 9.40626 5.39429H10.3648C10.467 5.39429 10.5455 5.30786 10.5377 5.20571C10.4041 3.87 9.31197 3.01357 7.84268 2.87214V2.17286C7.84268 2.07857 7.76411 2 7.66983 2H7.06483C6.97054 2 6.89197 2.07857 6.89197 2.17286V2.88C5.3834 3.01357 4.19697 3.85429 4.19697 5.41786C4.19697 6.86357 5.26554 7.56286 6.38126 7.83L6.90768 7.96357V11.02C5.96483 10.8943 5.43054 10.3914 5.32054 9.70786C5.30483 9.62929 5.23411 9.56643 5.14768 9.56643H4.1734C4.07126 9.56643 3.99268 9.65286 4.00054 9.755C4.09483 10.9336 4.99054 12.0179 6.89197 12.1514V12.8271C6.89197 12.9214 6.97054 13 7.06483 13H7.66983C7.76411 13 7.84268 12.9214 7.84268 12.8271L7.83483 12.1514C9.5084 12.0021 10.7105 11.1064 10.7105 9.49571C10.7105 8.00286 9.76768 7.335 8.37697 6.99714ZM6.91554 6.65143C6.79768 6.62 6.69554 6.58857 6.5934 6.54143C5.87054 6.28214 5.53268 5.85786 5.53268 5.31571C5.53268 4.53786 6.12197 4.09786 6.91554 3.99571V6.65143ZM7.83483 11.02V8.16L8.0234 8.20714C9.03697 8.51357 9.37483 8.94571 9.37483 9.59786C9.37483 10.4386 8.74626 10.9414 7.83483 11.02Z",fill:"#C6C6C6"})])],-1)),ve=s(()=>r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"37",height:"20",viewBox:"0 0 37 20",fill:"none"},[r("g",{id:"Frame 3476010"},[r("rect",{x:"-0.0078125",y:"0.972656",width:"37.0079",height:"18.0543",rx:"9.02717",fill:"#E3F1FF"}),r("g",{id:"ç¾å"},[r("path",{id:"Vector",d:"M27.9111 5.875V6.656H20.1671V5.875H27.9111ZM26.2611 14.081H27.6801C28.1201 14.081 28.1861 13.795 28.2411 12.112C28.4281 12.266 28.7801 12.409 29.0001 12.475C28.9121 14.345 28.6921 14.862 27.7351 14.862H26.1621C25.1831 14.862 24.9191 14.576 24.9191 13.641V9.725H22.8621C22.6531 12.079 22.1251 14.004 19.5951 15.027C19.4961 14.829 19.2651 14.532 19.0781 14.389C21.4211 13.498 21.8281 11.782 21.9931 9.725H19.2101V8.933H28.8351V9.725H25.7441V13.63C25.7441 14.004 25.8321 14.081 26.2611 14.081Z",fill:"#409EFF"}),r("path",{id:"Vector_2",d:"M17.7822 12.1117H13.7782C14.5702 13.3327 16.0112 14.0257 18.0132 14.2677C17.8482 14.4547 17.6172 14.7847 17.5182 15.0267C15.2962 14.6637 13.8112 13.7837 12.9642 12.1997C12.4142 13.6407 11.2372 14.5427 8.42119 15.0267C8.35519 14.8177 8.14619 14.4767 7.99219 14.2897C10.5222 13.9267 11.6002 13.2337 12.0952 12.1117H8.44319V11.3747H12.3372C12.4032 11.1107 12.4472 10.8247 12.4802 10.5277H8.16819V9.80166H12.5792V8.87766H9.15819V8.16266H12.5792V7.27166H8.61919V6.53466H10.8742C10.6982 6.14966 10.3572 5.64366 10.0272 5.25866L10.7312 4.97266C11.1382 5.39066 11.5232 5.96266 11.6992 6.35866L11.3032 6.53466H14.1962C14.5262 6.08366 14.9112 5.43466 15.1422 4.97266L15.9782 5.22566C15.7142 5.67666 15.3842 6.14966 15.0982 6.53466H17.4082V7.27166H13.3932V8.16266H16.9132V8.87766H13.3932V9.80166H17.9142V10.5277H13.3272C13.2942 10.8247 13.2502 11.1107 13.1952 11.3747H17.7822V12.1117Z",fill:"#409EFF"})])])],-1)),_e=s(()=>r("div",null,"自动：您所创建的项目，自动分配给该合作商",-1)),ye=s(()=>r("div",null,"手动：您所创建的项目，需要手动分配给该合作商",-1)),Ce={style:{display:"flex"}},Ve=s(()=>r("div",null,"自动：合作商分配给您的项目，全部自动接收",-1)),He=s(()=>r("div",null,"手动：合作商分配给您的项目，手动选择接收",-1)),xe=Y({__name:"index",emits:["fetch-data"],setup(h,{expose:N,emit:F}){const w=Q().currencyType,g=f(),L=F,m=f(!1),_=f(),y=f(1),e=f({form:{},rules:{priceRatio:[{required:!0,message:"请输入价格比例",trigger:"blur"},{type:"number",trigger:"blur",validator:(t,o,u)=>{if(/^(100|[1-9]?\d)$/.test(o)==!1)return u(new Error("请输入 0 到 100 之间的数字"));u()}}],sendProjectType:[{required:!0,message:"请选择发送项目",trigger:"change"}],receiveProjectType:[{required:!0,message:"请选择接收项目",trigger:"change"}],exchangeRate:[{required:!0,message:"请输入汇率",trigger:"blur"},{pattern:/^(?!0(\.0+)?$)(\d+(\.\d{1,2})?)$/,message:"请输入一个有效的数字，不能小于0，最多保留两位小数",trigger:"blur"}]}}),M={children:"children",label:"name"},T=f([]);f();const C=f();async function S(t){e.value.form.chargeUserId="",e.value.form.id=t.id,e.value.form.exchangeRate=t.exchangeRate,t.currencyType==="USD"?g.value=1:t.currencyType==="CNY"&&(g.value=2),e.value.form.priceRatio=t.priceRatio,e.value.form.sendProjectType=t.sendProjectType?[t.sendProjectType]:null,e.value.form.receiveProjectType=t.receiveProjectType?[t.receiveProjectType]:null,e.value.form.chargeUserName=t.userName,e.value.form.invitationType=t.invitationType,e.value.form.chargeUserId=t.userId;const o=await se.list({name:""});o.data&&(T.value=o.data),m.value=!0}const B=(t,o)=>{o?(C.value.getCheckedKeys().forEach(p=>{p!==t.id&&C.value.setChecked(p,!1)}),e.value.form.chargeUserId=t.id,e.value.form.chargeUserName=t.name):(e.value.form.chargeUserId=[e.value.form.chargeUserId].filter(u=>u!==t.id),e.value.form.chargeUserId.length==0&&(e.value.form.chargeUserId="")),e.value.form.chargeUserId||(e.value.form.chargeUserName="")};function U(){m.value=!1,e.value.form={},_.value.resetFields()}const E=f();async function Z(t){await R.updateInvitationBindUser({id:e.value.form.id,chargeUserId:t.chargeUserId,invitationType:t.invitationType,chargeUserName:t.chargeUserName,sendProjectType:t.sendProjectType,receiveProjectType:t.receiveProjectType})}async function D(){await R.updateInvitationBind({id:e.value.form.id,priceRatio:e.value.form.priceRatio,exchangeRate:e.value.form.exchangeRate}),j.success({message:"修改成功",center:!0})}async function A(){_.value.validate(t=>{if(t){let o=JSON.parse(JSON.stringify(e.value.form));if(w===g.value&&(o.exchangeRate=1),Array.isArray(o.chargeUserId)&&(o.chargeUserId=o.chargeUserId[0]),o.receiveProjectType==1&&!o.chargeUserId){j.warning({message:"请选择部门",center:!0});return}o.sendProjectType=e.value.form.sendProjectType.length!=0?e.value.form.sendProjectType[0]:null,o.receiveProjectType=e.value.form.receiveProjectType.length!=0?e.value.form.receiveProjectType[0]:null,o.invitationType=2,o.receiveProjectType==2&&(e.value.form.chargeUserId=null,e.value.form.chargeUserName="",o.chargeUserId=null,o.chargeUserName="",o.invitationType=""),Z(o),D(),setTimeout(()=>{L("fetch-data")},1e3),U()}})}const q=t=>{Array.isArray(t)&&t.length>1&&(e.value.form.sendProjectType=[t[t.length-1]])},$=t=>{Array.isArray(t)&&t.length>1&&(e.value.form.receiveProjectType=[t[t.length-1]])};function K(t){e.value.form.chargeUserId=t.chargeUserId,e.value.form.invitationType=t.invitationType,e.value.form.chargeUserName=t.chargeUserName}return N({showEdit:S}),(t,o)=>{const u=c("el-input"),p=c("el-form-item"),V=oe,H=c("el-tooltip"),x=c("el-col"),z=c("el-row"),v=c("el-checkbox"),k=c("el-checkbox-group"),J=c("el-tree-select"),O=c("ElForm"),b=c("el-button"),G=c("el-dialog");return P(),W("div",null,[l(G,{modelValue:i(m),"onUpdate:modelValue":o[6]||(o[6]=n=>I(m)?m.value=n:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"40%",title:"合作配置",class:"hezuoDrawer"},{footer:a(()=>[l(b,{onClick:U},{default:a(()=>[d(" 关闭 ")]),_:1}),l(b,{type:"primary",onClick:A},{default:a(()=>[d(" 确认 ")]),_:1})]),default:a(()=>[l(O,{ref_key:"formRef",ref:_,rules:i(e).rules,model:i(e).form,"label-width":"7rem",labelPosition:"right"},{default:a(()=>[l(p,{label:"价格比例",prop:"priceRatio"},{default:a(()=>[l(u,{modelValue:i(e).form.priceRatio,"onUpdate:modelValue":o[0]||(o[0]=n=>i(e).form.priceRatio=n),clearable:""},{append:a(()=>[d("%")]),_:1},8,["modelValue"])]),_:1}),l(p,{"label-width":"7.5rem"},{label:a(()=>[ce]),_:1}),X(l(p,{prop:"exchangeRate","label-width":"7rem"},{label:a(()=>[r("span",de,[l(H,{effect:"dark",placement:"top-start"},{content:a(()=>[ue,pe]),default:a(()=>[l(V,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1}),d(" 汇率比例 ")])]),default:a(()=>[l(z,{class:"radiusInput",style:{margin:"0"},gutter:20},{default:a(()=>[l(x,{style:{padding:"0"},span:11},{default:a(()=>[l(u,{style:{border:"none"},modelValue:i(y),"onUpdate:modelValue":o[1]||(o[1]=n=>I(y)?y.value=n:null),disabled:"",placeholder:""},{prefix:a(()=>[fe]),suffix:a(()=>[me]),_:1},8,["modelValue"])]),_:1}),l(x,{style:{display:"flex","justify-content":"center","align-items":"center",padding:"0"},span:2},{default:a(()=>[he]),_:1}),l(x,{style:{padding:"0"},span:11},{default:a(()=>[l(u,{style:{border:"none"},modelValue:i(e).form.exchangeRate,"onUpdate:modelValue":o[2]||(o[2]=n=>i(e).form.exchangeRate=n),placeholder:"请输入换算金额",clearable:""},{prefix:a(()=>[ge]),suffix:a(()=>[ve]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},512),[[ee,i(w)!==i(g)]]),l(p,{prop:"sendProjectType","label-width":"7rem"},{label:a(()=>[r("span",null,[l(H,{effect:"dark",placement:"top-start"},{content:a(()=>[_e,ye]),default:a(()=>[l(V,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1}),d(" 发送项目 ")])]),default:a(()=>[l(k,{modelValue:i(e).form.sendProjectType,"onUpdate:modelValue":o[3]||(o[3]=n=>i(e).form.sendProjectType=n),onChange:q},{default:a(()=>[l(v,{value:1},{default:a(()=>[d(" 自动 ")]),_:1}),l(v,{value:2},{default:a(()=>[d(" 手动 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),r("div",Ce,[l(p,{prop:"receiveProjectType",style:{"margin-right":"1.5625rem"}},{label:a(()=>[r("span",null,[l(H,{effect:"dark",placement:"top-start"},{content:a(()=>[Ve,He]),default:a(()=>[l(V,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1}),d(" 接收项目 ")])]),default:a(()=>[l(k,{modelValue:i(e).form.receiveProjectType,"onUpdate:modelValue":o[4]||(o[4]=n=>i(e).form.receiveProjectType=n),onChange:$},{default:a(()=>[l(v,{value:1},{default:a(()=>[d(" 自动 ")]),_:1}),l(v,{value:2},{default:a(()=>[d(" 手动 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),i(e).form.receiveProjectType==1?(P(),te(J,{key:0,placeholder:"请选择部门",ref_key:"treeRef",ref:C,modelValue:i(e).form.chargeUserId,"onUpdate:modelValue":o[5]||(o[5]=n=>i(e).form.chargeUserId=n),data:i(T),"check-strictly":"","show-checkbox":"","default-expand-all":"","node-key":"id",props:M,onCheckChange:B,"check-on-click-node":!0,style:{width:"15.625rem"},"expand-on-click-node":!1},null,8,["modelValue","data"])):re("",!0)])]),_:1},8,["rules","model"])]),_:1},8,["modelValue"]),l(ne,{ref_key:"userRef",ref:E,onUserData:K},null,512)])}}}),Re=ie(xe,[["__scopeId","data-v-44ce8251"]]);export{Re as default};
