
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ee,aH as ae,r as te,G as ne,H as P,J as le,a as i,al as oe,o as c,b as se,f as t,w as n,az as M,g as r,I as ie,e as p,j as k,am as re,i as b,R as ue,aI as z,ak as V,N as de,s as ce,aF as me,aG as pe,l as fe,_ as ge,q as L}from"./index-B-WyHrk1.js";import{_ as ve}from"./index.vue_vue_type_script_setup_true_lang-CJmP7dHX.js";import he from"./index-D0U7pbb9.js";import{a as E}from"./index.vue_vue_type_script_setup_true_lang-BQuC0rIT.js";import{u as be}from"./useTabbar-CQMbR5EN.js";import"./role-NZM5g8CD.js";const _e=_=>(me("data-v-2a89366c"),_=_(),pe(),_),Ce=_e(()=>fe("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),I=ee({name:"PagesExampleManagerList",__name:"list",setup(_){const{pagination:f,getParams:B,onSizeChange:D,onCurrentChange:T,onSortChange:U}=ae(),x=be(),e=te({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,id:""},search:{account:"",name:"",mobile:""},batch:{enable:!0,selectionDataList:[]},dataList:[]});ne(()=>{u(),e.value.formMode==="router"&&P.on("get-data-list",()=>{u()})}),le(()=>{e.value.formMode==="router"&&P.off("get-data-list")});function u(){e.value.loading=!0;const l={...B(),...e.value.search.account&&{account:e.value.search.account},...e.value.search.name&&{name:e.value.search.name},...e.value.search.mobile&&{mobile:e.value.search.mobile}};E.list(l).then(a=>{e.value.loading=!1,e.value.dataList=a.data.list,e.value.dataList.forEach(h=>{h.statusLoading=!1}),f.value.total=a.data.total})}function F(){Object.assign(e.value.search,{account:"",name:"",mobile:"",sex:""}),u()}function N(l){D(l).then(()=>u())}function d(l=1){T(l).then(()=>u())}function G({prop:l,order:a}){U(l,a).then(()=>u())}function H(){e.value.formMode==="router"?x.open({name:"pagesExampleGeneralManagerCreate"}):(e.value.formModeProps.id="",e.value.formModeProps.visible=!0)}function K(l){e.value.formMode==="router"?x.open({name:"pagesExampleGeneralManagerEdit",params:{id:l.id}}):(e.value.formModeProps.id=l.id,e.value.formModeProps.visible=!0)}function R(l){return new Promise(a=>{z.confirm(`确认${l.status?"禁用":"启用"}「${l.account}」吗？`,"确认信息").then(()=>{l.statusLoading=!0,E.changeStatus({id:l.id,status:!l.status}).then(()=>(l.statusLoading=!1,V.success({message:`模拟${l.status?"禁用":"启用"}成功`,center:!0}),a(!0))).catch(()=>(l.statusLoading=!1,a(!1)))}).catch(()=>a(!1))})}function j(l){z.confirm(`确认将「${l.account}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{E.passwordReset(l.id).then(()=>{V.success({message:"模拟重置成功",center:!0})})}).catch(()=>{})}function A(l){z.confirm(`确认删除「${l.account}」用户吗？`,"确认信息").then(()=>{E.delete(l.id).then(()=>{u(),V.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}return(l,a)=>{const h=i("ElInput"),C=i("ElFormItem"),y=de,g=i("ElButton"),q=i("ElForm"),J=ve,O=i("ElDivider"),S=i("ElSpace"),m=i("ElTableColumn"),w=i("ElTag"),Q=i("ElSwitch"),$=i("el-button"),W=i("ElTable"),X=i("ElPagination"),Y=ce,Z=oe("loading");return c(),se("div",{class:ue({"absolute-container":e.value.tableAutoHeight})},[t(Y,null,{default:n(()=>[t(J,{"show-toggle":!1},{default:n(({fold:o,toggle:v})=>[t(q,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:n(()=>[t(C,null,{default:n(()=>[t(h,{modelValue:e.value.search.account,"onUpdate:modelValue":a[0]||(a[0]=s=>e.value.search.account=s),placeholder:"请输入帐号，支持模糊查询",clearable:"",onKeydown:a[1]||(a[1]=M(s=>d(),["enter"])),onClear:a[2]||(a[2]=s=>d())},null,8,["modelValue"])]),_:1}),t(C,null,{default:n(()=>[t(h,{modelValue:e.value.search.name,"onUpdate:modelValue":a[3]||(a[3]=s=>e.value.search.name=s),placeholder:"请输入姓名，支持模糊查询",clearable:"",onKeydown:a[4]||(a[4]=M(s=>d(),["enter"])),onClear:a[5]||(a[5]=s=>d())},null,8,["modelValue"])]),_:1}),t(C,null,{default:n(()=>[t(h,{modelValue:e.value.search.mobile,"onUpdate:modelValue":a[6]||(a[6]=s=>e.value.search.mobile=s),placeholder:"请输入手机号",clearable:"",onKeydown:a[7]||(a[7]=M(s=>d(),["enter"])),onClear:a[8]||(a[8]=s=>d())},null,8,["modelValue"])]),_:1}),t(C,null,{default:n(()=>[t(g,{type:"primary",onClick:a[9]||(a[9]=s=>d())},{icon:n(()=>[t(y,{name:"i-ep:search"})]),default:n(()=>[r(" 筛选 ")]),_:1}),t(g,{onClick:F},{icon:n(()=>[Ce]),default:n(()=>[r(" 重置 ")]),_:1}),t(g,{disabled:"",link:"",onClick:v},{icon:n(()=>[t(y,{name:o?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:n(()=>[r(" "+ie(o?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),t(O,{"border-style":"dashed"}),t(S,{wrap:""},{default:n(()=>[t(g,{type:"primary",size:"default",onClick:H},{icon:n(()=>[t(y,{name:"i-ep:plus"})]),default:n(()=>[r(" 新增用户 ")]),_:1}),e.value.batch.enable?(c(),p(g,{key:0,size:"default",disabled:!e.value.batch.selectionDataList.length},{default:n(()=>[r(" 批量操作 ")]),_:1},8,["disabled"])):k("",!0)]),_:1}),re((c(),p(W,{class:"my-4",data:e.value.dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:G,onSelectionChange:a[10]||(a[10]=o=>e.value.batch.selectionDataList=o)},{default:n(()=>[e.value.batch.enable?(c(),p(m,{key:0,type:"selection",align:"center",fixed:""})):k("",!0),t(m,{prop:"account",sortable:"",label:"帐号"}),t(m,{prop:"name",label:"姓名",width:"100",align:"center"}),t(m,{prop:"sex",label:"性别",width:"100",align:"center"},{default:n(o=>[o.row.sex===1?(c(),p(w,{key:0,type:"success",size:"small"},{default:n(()=>[r(" 男 ")]),_:1})):o.row.sex===0?(c(),p(w,{key:1,type:"warning",size:"small"},{default:n(()=>[r(" 女 ")]),_:1})):(c(),p(w,{key:2,type:"info",size:"small"},{default:n(()=>[r(" 保密 ")]),_:1}))]),_:1}),t(m,{prop:"mobile",label:"手机号",width:"150",align:"center"}),t(m,{label:"状态",width:"100",align:"center"},{default:n(o=>[t(Q,{modelValue:o.row.status,"onUpdate:modelValue":v=>o.row.status=v,loading:o.row.statusLoading,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>R(o.row)},null,8,["modelValue","onUpdate:modelValue","loading","before-change"])]),_:1}),t(m,{label:"操作",width:"250",align:"center",fixed:"right"},{default:n(o=>[t(S,null,{default:n(()=>[t(g,{type:"primary",size:"small",plain:"",onClick:v=>K(o.row)},{default:n(()=>[r(" 编辑 ")]),_:2},1032,["onClick"]),t($,{type:"primary",plain:"",size:"small",onClick:v=>j(o.row)},{default:n(()=>[r(" 重置密码 ")]),_:2},1032,["onClick"]),t($,{type:"danger",plain:"",size:"small",onClick:v=>A(o.row)},{default:n(()=>[r(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Z,e.value.loading]]),t(X,{"current-page":b(f).page,total:b(f).total,"page-size":b(f).size,"page-sizes":b(f).sizes,layout:b(f).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:d,onSizeChange:N},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e.value.formMode==="dialog"||e.value.formMode==="drawer"?(c(),p(he,{key:0,id:e.value.formModeProps.id,modelValue:e.value.formModeProps.visible,"onUpdate:modelValue":a[11]||(a[11]=o=>e.value.formModeProps.visible=o),mode:e.value.formMode,onSuccess:u},null,8,["id","modelValue","mode"])):k("",!0)],2)}}});typeof L=="function"&&L(I);const Ve=ge(I,[["__scopeId","data-v-2a89366c"]]);export{Ve as default};
