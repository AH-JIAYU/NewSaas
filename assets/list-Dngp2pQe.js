
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{k as H,d as be,aK as ve,r as s,n as he,a as n,an as ke,o as f,b as w,f as e,w as l,ak as N,F as D,p as ye,g as o,B as u,e as R,i as g,O as we,aL as Ce,E as Y,J as Se,aM as Ie,aN as ze,aj as xe,aH as Ee,aI as Be,A as Te,al as De,N as Ue}from"./index-ZCXpFWW9.js";import{_ as Ve}from"./index.vue_vue_type_script_setup_true_lang-WdbbWnHZ.js";import{_ as Le}from"./index.vue_vue_type_style_index_0_lang-DThlzoRm.js";import{_ as $e}from"./index.vue_vue_type_script_setup_true_lang-C01pGGqC.js";import{U as Ae}from"./user_supplier-DcU2uPtr.js";import"./user_supplier-7vTdUwtU.js";const U={list:c=>H.post("bill/getTenantSupplierBillList",c),changestatus:c=>H.post("bill/updateTenantSupplierBill",c)},Fe=c=>(Ee("data-v-1dd3424f"),c=c(),Be(),c),Me=Fe(()=>Te("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Pe=be({name:"FinanceSupplierSettlementIndex",__name:"list",setup(c){const j=Ae(),{getParams:O,pagination:d,onSizeChange:q,onCurrentChange:J}=ve(),K=s(""),V=s(!0);s();const C=s(!1),L=s([]),S=s(!0);s(!1);const I=s("default"),z=s(!1),Q=s([]),$=["待收票","待支付","已支付","已拒绝"],G=j.payMethod,A=s([{label:"项目ID",prop:"ID",sortable:!0,disableCheck:!0,checked:!0}]),r=s({supplierId:"",billStatus:"",time:[],beginTime:"",endTime:""}),F=s([]);function W(i){Q.value=i}function X(){Object.assign(r.value,{supplierId:0,billStatus:0,time:[],beginTime:"",endTime:""})}function Z(i){q(i).then(()=>b())}function x(i=1){J(i).then(()=>b())}async function b(){V.value=!0;const i={...O(),...r.value},a=await U.list(i);F.value=a.data.tenantSupplierBillInfoList,d.value.total=a.data.total,V.value=!1}async function E(i,a){a===3?Ce.prompt("请说明拒绝的理由","说明",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/.{2,}/,inputErrorMessage:"请输理由-最少2为字符"}).then(async v=>{(await U.changestatus({id:i,type:a,notes:v.value})).status===1&&Y.success({message:"操作成功"}),b()}):((await U.changestatus({id:i,type:a})).status===1&&Y.success({message:"操作成功"}),b())}return he(()=>{b()}),(i,a)=>{const v=n("el-input"),h=n("el-form-item"),ee=n("el-date-picker"),te=n("el-option"),le=n("el-select"),M=Se,B=n("ElButton"),ae=n("ElFormItem"),ne=n("el-form"),oe=$e,se=n("ElDivider"),ie=Le,k=n("el-button"),ue=Ie,re=ze,P=n("el-row"),_=n("el-col"),m=n("el-table-column"),T=Ve,pe=n("ElTableColumn"),ce=n("el-empty"),me=n("el-table"),de=n("ElPagination"),_e=xe,fe=ke("loading");return f(),w("div",{class:we({"absolute-container":C.value})},[e(_e,null,{default:l(()=>[e(oe,{"show-toggle":!1},{default:l(({fold:t,toggle:y})=>[e(ne,{model:r.value,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:l(()=>[e(h,{label:""},{default:l(()=>[e(v,{modelValue:r.value.supplierId,"onUpdate:modelValue":a[0]||(a[0]=p=>r.value.supplierId=p),clearable:"",placeholder:"供应商ID"},null,8,["modelValue"])]),_:1}),N(e(h,null,{default:l(()=>[e(ee,{modelValue:r.value.time,"onUpdate:modelValue":a[1]||(a[1]=p=>r.value.time=p),type:"datetimerange","unlink-panels":"","range-separator":"-","start-placeholder":"创建开始日期","end-placeholder":"创建结束日期","value-format":"YYYY-MM-DD hh:mm:ss",size:"default"},null,8,["modelValue"])]),_:2},1536),[[De,!t]]),e(h,{label:""},{default:l(()=>[e(le,{modelValue:r.value.billStatus,"onUpdate:modelValue":a[2]||(a[2]=p=>r.value.billStatus=p),placeholder:"状态",clearable:"",filterable:""},{default:l(()=>[(f(),w(D,null,ye($,(p,ge)=>e(te,{key:p,label:p,value:ge+1},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(ae,null,{default:l(()=>[e(B,{type:"primary",onClick:a[3]||(a[3]=p=>x())},{icon:l(()=>[e(M,{name:"i-ep:search"})]),default:l(()=>[o(" 筛选 ")]),_:1}),e(B,{onClick:X},{icon:l(()=>[Me]),default:l(()=>[o(" 重置 ")]),_:1}),e(B,{disabled:"",link:"",onClick:y},{icon:l(()=>[e(M,{name:t?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:l(()=>[o(" "+u(t?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),e(se,{"border-style":"dashed"}),e(P,{gutter:24},{default:l(()=>[e(ie),e(re,null,{default:l(()=>[e(k,{size:"default",onClick:a[4]||(a[4]=()=>{})},{default:l(()=>[o(" 导出 ")]),_:1}),e(ue,{border:S.value,"onUpdate:border":a[5]||(a[5]=t=>S.value=t),tableAutoHeight:C.value,"onUpdate:tableAutoHeight":a[6]||(a[6]=t=>C.value=t),checkList:L.value,"onUpdate:checkList":a[7]||(a[7]=t=>L.value=t),columns:A.value,"onUpdate:columns":a[8]||(a[8]=t=>A.value=t),"line-height":I.value,"onUpdate:lineHeight":a[9]||(a[9]=t=>I.value=t),stripe:z.value,"onUpdate:stripe":a[10]||(a[10]=t=>z.value=t),style:{"margin-left":"12px"},onQueryData:x},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),N((f(),R(me,{ref_key:"tableSortRef",ref:K,style:{"margin-top":"10px"},"row-key":"id",data:F.value,border:S.value,size:I.value,stripe:z.value,onSelectionChange:W},{empty:l(()=>[e(ce,{description:"暂无数据"})]),default:l(()=>[e(m,{type:"expand"},{default:l(t=>[e(P,{gutter:20,style:{margin:"10px 0"}},{default:l(()=>[e(_,{span:1}),e(_,{span:3},{default:l(()=>[o(" 付款方式: "+u(g(G)[t.row.billStatus-1].label),1)]),_:2},1024),e(_,{span:3},{default:l(()=>[o("账户名称: "+u(t.row.accountName),1)]),_:2},1024),e(_,{span:3},{default:l(()=>[o("收款账号: "+u(t.row.collectionAccount),1)]),_:2},1024),e(_,{span:3},{default:l(()=>[o("银行名称: "+u(t.row.bankName),1)]),_:2},1024),e(_,{span:3},{default:l(()=>[o("结算周期: "+u(t.row.settlementCycle),1)]),_:2},1024)]),_:2},1024)]),_:1}),e(m,{prop:"supplierId","show-overflow-tooltip":"",align:"center",label:"供应商ID"}),e(m,{prop:"billTime","show-overflow-tooltip":"",align:"center",label:"账单日期"}),e(m,{prop:"billAmount","show-overflow-tooltip":"",align:"center",label:"账单金额"},{default:l(({row:t})=>[o(u(t.billAmount||0),1),e(T)]),_:1}),e(m,{prop:"taxesFees","show-overflow-tooltip":"",align:"center",label:"税费"},{default:l(({row:t})=>[o(u(t.taxesFees||0),1),e(T)]),_:1}),e(m,{prop:"payAmount","show-overflow-tooltip":"",align:"center",label:"实付金额"},{default:l(({row:t})=>[o(u(t.payAmount||0),1),e(T)]),_:1}),e(pe,{align:"center","show-overflow-tooltip":"",prop:"",label:"状态"},{default:l(({row:t})=>[o(u($[t.billStatus-1]),1)]),_:1}),e(m,{align:"center",label:"操作",width:"170"},{default:l(({row:t})=>[t.billStatus===1?(f(),R(k,{key:0,size:"small",plain:"",type:"primary",onClick:y=>E(t.id,1)},{default:l(()=>[o(" 确认收票 ")]),_:2},1032,["onClick"])):t.billStatus===2?(f(),w(D,{key:1},[e(k,{size:"small",plain:"",onClick:y=>E(t.id,2)},{default:l(()=>[o(" 支付 ")]),_:2},1032,["onClick"]),e(k,{size:"small",plain:"",type:"danger",onClick:y=>E(t.id,3)},{default:l(()=>[o(" 拒绝 ")]),_:2},1032,["onClick"])],64)):(f(),w(D,{key:2},[o("- ")],64))]),_:1})]),_:1},8,["data","border","size","stripe"])),[[fe,!1]]),e(de,{"current-page":g(d).page,total:g(d).total,"page-size":g(d).size,"page-sizes":g(d).sizes,layout:g(d).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:Z,onCurrentChange:x},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1})],2)}}}),qe=Ue(Pe,[["__scopeId","data-v-1dd3424f"]]);export{qe as default};
