
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as je,aN as Ce,r as p,Z as Le,n as we,a as k,q as ze,o as s,b as B,f as l,w as t,e as i,j as r,g as n,i as h,aM as ie,y as g,z as d,N as x,s as xe,E as N,aO as V,bb as Re,bc as De,be as Ue,_ as Ee,an as Be,L as Te}from"./index-BaoGh0WK.js";import{_ as Ae}from"./index-DJDkmI6K.js";import{_ as Me}from"./index.vue_vue_type_style_index_0_lang-D4AaJJLM.js";import{_ as Pe}from"./index--qq7_kYC.js";import{u as $e,o as He,a as R}from"./index-DE6hPIXM.js";import{a as Ve}from"./index-DERcIzGw.js";import Oe from"./index-Bvw2G4Mz.js";import"./index-DEZua92N.js";import"./clipboard-DOl3wlTH.js";import"./index.vue_vue_type_script_setup_true_lang-QFze73GC.js";import"./sortable.esm-C0-Qcoum.js";import"./apiLoading-DiALs-Sk.js";import"./projectManagement-C6f9_rDT.js";import"./user_cooperation-BI_h7kOH.js";import"./survey_vip_department-CEEaLWlV.js";import"./user_supplier-D7isVsv0.js";import"./user_supplier-BdVfDPve.js";import"./survey_vipGroup-DSFwKbsE.js";import"./survey_vipGroup-BvC1-c8B.js";import"./position_manage-BiKKjdT6.js";import"./index-BaVGQxRv.js";import"./department-CZPCRYoy.js";import"./configuration_role-wsqZg9Ee.js";import"./tenant_role-D25vAMpP.js";import"./configuration_manager-DhG8iXNO.js";const Fe={class:"tableBig"},Qe={key:0,class:"tableBig"},qe={key:1,class:"copyId tableSmall"},Ze={class:"id oneLine projectId",style:{"font-size":"12px"}},Ge={key:0,class:"tableBig"},Je={key:1,class:"copyId tableSmall"},Ke={class:"id oneLine projectId",style:{"font-size":"12px"}},We={class:"flex-c"},Xe={class:"oneLine",style:{width:"calc(100% - 1.25rem)"}},Ye={class:"tableBig overflow"},et={class:"tableBig"},tt={class:"tableBig"},at={class:"copyId tableSmall"},lt={class:"id oneLine projectId"},ot={class:"tableBig oneLine"},nt={class:"copyId tableSmall"},st={class:"id oneLine projectId"},it=je({name:"outsource",__name:"list",setup(rt){const re=$e(),{pagination:_,getParams:ue,onSizeChange:ce,onCurrentChange:pe}=Ce(),de=p(),P=p(),me=p(),m=p(!0),C=p(!1),O=p(),I=p({selectList:[]}),D=p(!1),u=p([]),F=p(),Q=p(),q=p("formSearch-outsource"),L=p("default"),w=p(!1),U=p([{sotrtable:!0,checked:!0,label:"合作商ID",prop:"tenantId"},{sotrtable:!0,checked:!0,label:"接收状态",prop:"receiveStatus"},{sotrtable:!0,checked:!0,label:"PM",prop:"userName"},{sotrtable:!0,checked:!0,label:"合作商名称",prop:"tenantName"},{sotrtable:!0,checked:!0,label:"分配",prop:"allocationType"},{sotrtable:!0,checked:!0,label:"项目价",prop:"doMoneyPrice"},{sotrtable:!0,checked:!0,label:"项目ID",prop:"projectId"},{sotrtable:!0,checked:!0,label:"项目名称",prop:"projectName"},{sotrtable:!0,checked:!0,label:"参与/完成/配额/限量",prop:"participationNumber"},{sotrtable:!0,checked:!0,label:"状态",prop:"projectStatus"}]),S=Le({projectId:"",tenantId:"",tenantName:"",projectStatus:[],receiveStatus:"",type:1}),T=p([]);function Z(o){O.value.showEdit(o,S.type===2?1:0)}function G(o){ce(o).then(()=>b())}function z(o=1){pe(o).then(()=>b())}function J(){Object.assign(S,{tenantId:"",tenantName:"",projectStatus:[],type:1}),b()}async function b(){try{m.value=!0;const o={...ue(),...S};if(S.type===1){const a=await R.list(o);T.value=a.data.projectAllocationInfoList,_.value.total=a.data.total}else{const a=await R.meList(o);T.value=a.data.projectMeAllocationInfoList,_.value.total=a.data.total}m.value=!1}catch{}finally{m.value=!1}}we(()=>{U.value.forEach(o=>{o.checked&&u.value.push(o.prop)}),b(),F.value=[{index:1,show:!0,type:"input",modelName:"projectId",placeholder:"项目ID"},{index:2,show:!0,type:"input",modelName:"tenantId",placeholder:"合作商ID"},{index:3,show:!0,type:"input",modelName:"tenantName",placeholder:"合作商名称"},{index:4,show:!0,type:"select",modelName:"projectStatus",placeholder:"项目状态",option:"projectStatus",optionLabel:"label",optionValue:"value",multiple:!0}],Q.value=[{index:1,show:!0,type:"input",modelName:"projectId",placeholder:"项目ID"},{index:2,show:!0,type:"input",modelName:"tenantId",placeholder:"合作商ID"},{index:3,show:!0,type:"input",modelName:"tenantName",placeholder:"合作商名称"},{index:4,show:!0,type:"select",modelName:"projectStatus",placeholder:"项目状态",option:"projectStatus",optionLabel:"label",optionValue:"value",multiple:!0},{index:5,show:!0,type:"select",modelName:"receiveStatus",placeholder:"接收状态",option:"receiveStatus",optionLabel:"label",optionValue:"value"}]});const fe=[{value:1,label:"自动（已接收）"},{value:2,label:"手动（未接收）"}],K={projectStatus:()=>re.projectStatusList.map((o,a)=>({label:o,value:a+1})),receiveStatus:()=>fe},j=p();function W(o){o?j.value=o.projectId:j.value=""}const $=p();function ve(){const o=P.value.getSelectionRows();if(o.length==0){N.warning({message:"请选择一个项目",center:!0});return}else{let a=o.length;o.forEach(y=>{y.receiveStatus==1&&a++}),a!=o.length?N.warning({message:"已接收的项目不能再次接收，请重新选择",center:!0}):(I.value.receivingMode="批量接收",I.value.selectList=o,$.value.showEdit("","接收",o))}}function ye(){const o=P.value.getSelectionRows();if(o.length==0){N.warning({message:"请选择一个项目",center:!0});return}else{let a=o.length;o.forEach(y=>{y.receiveStatus==2&&a++}),a!=o.length?N.warning({message:"未接收的项目不能取消接收，请重新选择",center:!0}):V.confirm("确认取消接收吗？","确认信息").then(()=>{try{m.value=!0;let y=[];o.forEach(f=>{y.push(f.id)});let A={type:2,idList:y};R.updateReceiveStatus(A).then(()=>{m.value=!1,b(),N.success({message:"取消接收成功",center:!0})})}catch{}finally{m.value=!1}}).catch(()=>{})}}function X(o){I.value.selectList=[o],$.value.showEdit("","接收",[o])}function ge(o){V.confirm("确认取消接收吗？","确认信息").then(()=>{try{m.value=!0;let a={type:2,idList:[o.id]};R.updateReceiveStatus(a).then(()=>{m.value=!1,b(),N.success({message:"取消接收成功",center:!0})})}catch{}finally{m.value=!1}}).catch(()=>{})}function _e(o){I.value.chargeUserId=o.chargeUserId,I.value.invitationType=o.invitationType,I.value.chargeUserName=o.chargeUserName;let a=[];I.value.selectList.forEach(y=>{a.push(y.id)});try{m.value=!0;let y={type:1,idList:a,userId:o.chargeUserId,userName:o.chargeUserName,allocationType:o.invitationType};R.updateReceiveStatus(y).then(()=>{m.value=!1,b(),N.success({message:"接收成功",center:!0})})}catch{}finally{m.value=!1}}const he=o=>{V.confirm("确认拒绝项目吗？","确认信息").then(()=>{try{m.value=!0;let a={type:3,idList:[o.id]};R.updateReceiveStatus(a).then(()=>{m.value=!1,b(),N.success({message:"拒绝成功",center:!0})})}catch{}finally{m.value=!1}}).catch(()=>{})};return(o,a)=>{const y=Pe,A=k("ElDivider"),f=k("el-button"),Y=Me,ee=Re,te=De,ae=k("el-row"),c=k("el-table-column"),v=k("el-text"),M=Ae,H=k("el-tooltip"),be=Ue,ke=Ee,le=k("el-empty"),oe=k("el-table"),ne=k("ElPagination"),se=k("el-tab-pane"),Se=k("el-tabs"),Ne=Be,Ie=ze("loading");return s(),B("div",{class:x({"absolute-container":D.value})},[l(Ne,null,{default:t(()=>[l(Se,{modelValue:S.type,"onUpdate:modelValue":a[14]||(a[14]=e=>S.type=e),onTabChange:b},{default:t(()=>[l(se,{label:"接收项目",name:1},{default:t(()=>[S.type===1?(s(),i(y,{key:0,formSearchList:Q.value,formSearchName:q.value,onCurrentChange:z,onOnReset:J,model:S,formOption:K},null,8,["formSearchList","formSearchName","model"])):r("",!0),l(A,{"border-style":"dashed"}),l(ae,{gutter:24},{default:t(()=>[l(Y,null,{default:t(()=>[l(f,{type:"primary",size:"default",onClick:ve},{default:t(()=>[n(" 接收项目 ")]),_:1}),l(f,{size:"default",onClick:ye},{default:t(()=>[n(" 取消接收 ")]),_:1})]),_:1}),l(te,null,{default:t(()=>[l(f,{size:"default",onClick:a[0]||(a[0]=()=>{})},{default:t(()=>[n(" 导出 ")]),_:1}),l(ee,{border:C.value,"onUpdate:border":a[1]||(a[1]=e=>C.value=e),tableAutoHeight:D.value,"onUpdate:tableAutoHeight":a[2]||(a[2]=e=>D.value=e),checkList:u.value,"onUpdate:checkList":a[3]||(a[3]=e=>u.value=e),columns:U.value,"onUpdate:columns":a[4]||(a[4]=e=>U.value=e),"line-height":L.value,"onUpdate:lineHeight":a[5]||(a[5]=e=>L.value=e),stripe:w.value,"onUpdate:stripe":a[6]||(a[6]=e=>w.value=e),style:{"margin-left":"12px"},onQueryData:z},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),l(oe,{ref_key:"tableSortRef2",ref:P,style:{"margin-top":"10px"},"row-key":"id",data:T.value,border:C.value,size:L.value,"highlight-current-row":"",stripe:w.value,onCurrentChange:W},{empty:t(()=>[l(le,{image:h(ie),"image-size":300},null,8,["image"])]),default:t(()=>[l(c,{align:"left",type:"selection"}),u.value.includes("projectStatus")?(s(),i(c,{key:0,"show-overflow-tooltip":"",prop:"projectStatus",align:"left",label:"状态",width:"140"},{default:t(({row:e})=>[g("span",Fe,[e.projectStatus===1?(s(),i(v,{key:0,type:"primary"},{default:t(()=>[n(" 进行中(在线)")]),_:1})):e.projectStatus===2?(s(),i(v,{key:1,type:"warning"},{default:t(()=>[n(" 已完成(审核通过)")]),_:1})):e.projectStatus===3?(s(),i(v,{key:2,type:"info"},{default:t(()=>[n(" 离线")]),_:1})):r("",!0)])]),_:1})):r("",!0),u.value.includes("receiveStatus")?(s(),i(c,{key:1,"show-overflow-tooltip":"",prop:"receiveStatus",align:"left",label:"接收状态",width:"140"},{default:t(({row:e})=>[e.receiveStatus==2?(s(),i(v,{key:0,style:{color:"rgb(251, 104, 104)"},class:"oneLine",type:"danger"},{default:t(()=>[n("未接收")]),_:1})):r("",!0),e.receiveStatus==1?(s(),i(v,{key:1,style:{color:"rgb(3, 194, 57)"},class:"oneLine",type:"success"},{default:t(()=>[n("已接收")]),_:1})):r("",!0)]),_:1})):r("",!0),l(c,{"show-overflow-tooltip":"",prop:"tenantName",align:"left",label:"合作商",width:"200"},{default:t(({row:e})=>[u.value.includes("tenantName")?(s(),B("div",Qe,d(e.tenantName),1)):r("",!0),u.value.includes("tenantId")?(s(),B("div",qe,[g("div",Ze,d(e.tenantId),1),l(M,{content:e.tenantId,class:x({rowCopy:"rowCopy",current:e.projectId===j.value})},null,8,["content","class"])])):r("",!0)]),_:1}),l(c,{"show-overflow-tooltip":"",prop:"projectName",align:"left",label:"项目",width:"200"},{default:t(({row:e})=>[u.value.includes("projectName")?(s(),B("div",Ge,d(e.projectName),1)):r("",!0),u.value.includes("projectId")?(s(),B("div",Je,[g("div",Ke,[l(H,{effect:"dark",content:e.projectId,placement:"top-start"},{default:t(()=>[n(d(e.projectId),1)]),_:2},1032,["content"])]),l(M,{content:e.projectId,class:x({rowCopy:"rowCopy",current:e.projectId===j.value})},null,8,["content","class"])])):r("",!0)]),_:1}),u.value.includes("allocationType")?(s(),i(c,{key:2,align:"left",label:"分配",width:"120"},{default:t(({row:e})=>[e.allocationType===1?(s(),i(f,{key:0,class:"tableBut",size:"small",type:"danger",plain:""},{default:t(()=>[n("自动分配")]),_:1})):e.allocationType===2?(s(),i(f,{key:1,class:"tableBut",size:"small",type:"danger"},{default:t(()=>[n("供应商")]),_:1})):e.allocationType===3?(s(),i(f,{key:2,class:"tableBut",size:"small",type:"success"},{default:t(()=>[n("部门")]),_:1})):e.allocationType===4?(s(),i(f,{key:3,class:"tableBut",size:"small",type:"primary"},{default:t(()=>[n("合作商")]),_:1})):(s(),i(f,{key:4,size:"small",class:"tableBut"},{default:t(()=>[n(" 未分配")]),_:1}))]),_:1})):r("",!0),u.value.includes("doMoneyPrice")?(s(),i(c,{key:3,"show-overflow-tooltip":"",align:"left",label:"项目价",width:"120"},{default:t(({row:e})=>[g("div",null,[l(be),n(d(e.doMoneyPrice||0),1)])]),_:1})):r("",!0),u.value.includes("participationNumber")?(s(),i(c,{key:4,"show-overflow-tooltip":"",prop:"participationNumber",align:"left",label:"参数",width:"300"},{default:t(({row:e})=>[l(v,{style:{color:"rgb(251, 104, 104)"},class:"oneLine",type:"danger"},{default:t(()=>[n("参与: "+d(e.participationNumber||0),1)]),_:2},1024),n("   "),l(v,{style:{color:"rgb(3, 194, 57)"},class:"oneLine",type:"success"},{default:t(()=>[n("完成: "+d(e.doneNumber||0),1)]),_:2},1024),n("   "),l(v,{style:{color:"rgb(255, 172, 84)"},class:"oneLine",type:"warning"},{default:t(()=>[n("配额: "+d(e.num||0),1)]),_:2},1024),n("   "),l(v,{style:{color:"rgb(170, 170, 170)"},class:"oneLine",type:"info"},{default:t(()=>[n("限量: "+d(e.limitedQuantity||"-"),1)]),_:2},1024)]),_:1})):r("",!0),u.value.includes("userName")?(s(),i(c,{key:5,"show-overflow-tooltip":"",prop:"userName",align:"left",label:"负责人",width:"140"},{default:t(({row:e})=>[g("div",We,[g("div",Xe,[l(H,{class:"box-item",effect:"dark",content:e.userName,placement:"top-start"},{default:t(()=>[g("div",Ye,d(e.userName?e.userName:"-"),1)]),_:2},1032,["content"])]),e.receiveStatus==1?(s(),i(ke,{key:0,onClick:E=>X(e),class:x({edit:"edit",current:e.projectId===j.value}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])):r("",!0)])]),_:1})):r("",!0),l(c,{align:"left",fixed:"right",label:"操作",width:"220"},{default:t(({row:e})=>[e.receiveStatus==2?(s(),i(f,{key:0,plain:"",type:"primary",size:"small",onClick:E=>X(e)},{default:t(()=>[n(" 接收 ")]),_:2},1032,["onClick"])):r("",!0),e.receiveStatus==1?(s(),i(f,{key:1,plain:"",type:"primary",size:"small",onClick:E=>ge(e)},{default:t(()=>[n(" 取消接收 ")]),_:2},1032,["onClick"])):r("",!0),e.receiveStatus==2?(s(),i(f,{key:2,down:"",plain:"",type:"danger",size:"small",onClick:E=>he(e)},{default:t(()=>[n(" 拒绝 ")]),_:2},1032,["onClick"])):r("",!0),l(f,{type:"warning",plain:"",size:"small",onClick:E=>Z(e)},{default:t(()=>[n(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"]),l(ne,{"current-page":h(_).page,total:h(_).total,"page-size":h(_).size,"page-sizes":h(_).sizes,layout:h(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:G,onCurrentChange:z},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),l(se,{label:"外包项目",name:2},{default:t(()=>[S.type===2?(s(),i(y,{key:0,formSearchList:F.value,formSearchName:q.value,onCurrentChange:z,onOnReset:J,model:S,formOption:K},null,8,["formSearchList","formSearchName","model"])):r("",!0),l(A,{"border-style":"dashed"}),l(ae,{gutter:24},{default:t(()=>[l(Y),l(te,null,{default:t(()=>[l(f,{size:"default",onClick:a[7]||(a[7]=()=>{})},{default:t(()=>[n(" 导出 ")]),_:1}),l(ee,{border:C.value,"onUpdate:border":a[8]||(a[8]=e=>C.value=e),tableAutoHeight:D.value,"onUpdate:tableAutoHeight":a[9]||(a[9]=e=>D.value=e),checkList:u.value,"onUpdate:checkList":a[10]||(a[10]=e=>u.value=e),columns:U.value,"onUpdate:columns":a[11]||(a[11]=e=>U.value=e),"line-height":L.value,"onUpdate:lineHeight":a[12]||(a[12]=e=>L.value=e),stripe:w.value,"onUpdate:stripe":a[13]||(a[13]=e=>w.value=e),style:{"margin-left":"12px"},onQueryData:z},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),xe((s(),i(oe,{ref_key:"tableSortRef",ref:de,style:{"margin-top":"10px"},"row-key":"id",data:T.value,border:C.value,size:L.value,stripe:w.value,"highlight-current-row":"",onCurrentChange:W},{empty:t(()=>[l(le,{image:h(ie),"image-size":300},null,8,["image"])]),default:t(()=>[l(c,{align:"left",type:"selection"}),u.value.includes("projectStatus")?(s(),i(c,{key:0,"show-overflow-tooltip":"",prop:"receiveStatus",align:"left",width:"140",label:"状态"},{default:t(({row:e})=>[g("span",et,[e.projectStatus===1?(s(),i(v,{key:0,type:"primary"},{default:t(()=>[n(" 进行中(在线)")]),_:1})):e.projectStatus===2?(s(),i(v,{key:1,type:"warning"},{default:t(()=>[n(" 已完成(审核通过)")]),_:1})):e.projectStatus===3?(s(),i(v,{key:2,type:"info"},{default:t(()=>[n(" 离线")]),_:1})):r("",!0)])]),_:1})):r("",!0),u.value.includes("tenantName")?(s(),i(c,{key:1,"show-overflow-tooltip":"",prop:"tenantName",align:"left",label:"合作商名称"},{default:t(({row:e})=>[g("div",tt,d(e.tenantName),1)]),_:1})):r("",!0),u.value.includes("tenantId")?(s(),i(c,{key:2,"show-overflow-tooltip":"",prop:"tenantId",align:"left",width:"280",label:"合作商ID"},{default:t(({row:e})=>[g("div",at,[g("div",lt,d(e.tenantId),1),l(M,{content:e.tenantId,class:x({rowCopy:"rowCopy",current:e.projectId===j.value})},null,8,["content","class"])])]),_:1})):r("",!0),u.value.includes("projectName")?(s(),i(c,{key:3,"show-overflow-tooltip":"",prop:"projectName",align:"left",label:"项目名称"},{default:t(({row:e})=>[g("div",ot,d(e.projectName),1)]),_:1})):r("",!0),u.value.includes("projectId")?(s(),i(c,{key:4,"show-overflow-tooltip":"",prop:"projectId",align:"left",width:"280",label:"项目ID"},{default:t(({row:e})=>[g("div",nt,[g("div",st,[l(H,{effect:"dark",content:e.projectId,placement:"top-start"},{default:t(()=>[n(d(e.projectId),1)]),_:2},1032,["content"])]),l(M,{content:e.projectId,class:x({rowCopy:"rowCopy",current:e.projectId===j.value})},null,8,["content","class"])])]),_:1})):r("",!0),u.value.includes("participationNumber")?(s(),i(c,{key:5,"show-overflow-tooltip":"",prop:"participationNumber",align:"left",label:"参数",width:"300"},{default:t(({row:e})=>[l(v,{style:{color:"rgb(251, 104, 104)"},class:"oneLine",type:"danger"},{default:t(()=>[n("参与: "+d(e.participationNumber||0),1)]),_:2},1024),n("   "),l(v,{style:{color:"rgb(3, 194, 57)"},class:"oneLine",type:"success"},{default:t(()=>[n("完成: "+d(e.doneNumber||0),1)]),_:2},1024),n("   "),l(v,{style:{color:"rgb(255, 172, 84)"},class:"oneLine",type:"warning"},{default:t(()=>[n("配额: "+d(e.num||0),1)]),_:2},1024),n("   "),l(v,{style:{color:"rgb(170, 170, 170)"},class:"oneLine",type:"info"},{default:t(()=>[n("限量: "+d(e.limitedQuantity||"-"),1)]),_:2},1024)]),_:1})):r("",!0),l(c,{align:"left",fixed:"right",label:"操作",width:"170"},{default:t(({row:e})=>[l(f,{type:"primary",plain:"",size:"small",onClick:E=>Z(e)},{default:t(()=>[n(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[Ie,m.value]]),l(ne,{"current-page":h(_).page,total:h(_).total,"page-size":h(_).size,"page-sizes":h(_).sizes,layout:h(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:G,onCurrentChange:z},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1})]),_:1},8,["modelValue"]),l(Ve,{ref_key:"addAllocationEditRef",ref:me,onFetchData:b},null,512),l(He,{ref_key:"editRef",ref:O,onFetchData:b},null,512)]),_:1}),l(Oe,{ref_key:"userRef",ref:$,onUserData:_e},null,512)],2)}}}),Et=Te(it,[["__scopeId","data-v-f611598d"]]);export{Et as default};
