
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ne,r as g,J as ie,aO as se,y as re,k as ue,z as D,C as ce,a as u,p as pe,o as i,b as L,f as l,w as t,g as c,q as de,e as s,i as b,aN as me,j as p,s as x,A as h,F as E,t as M,O as fe,aQ as ge,aR as he,ap as _e,M as be}from"./index-BZHzFsqK.js";import{_ as ve}from"./index-D4TP2loM.js";import{_ as ke}from"./index.vue_vue_type_style_index_0_lang-Cc8tUOW7.js";import{_ as ye}from"./index-CNPIX_O7.js";import{a as Ce}from"./financial_pm_log-H5G9wmgI.js";import{_ as Le}from"./index.vue_vue_type_script_setup_true_lang-BeWfygQk.js";import we from"./index-CWv9wZ_R.js";import{u as Be}from"./position_manage-D54kpG27.js";import{u as Ne}from"./group_manage-CJK7J9mY.js";import{u as Ie}from"./useTabbar-DuMZEdk9.js";import"./index-i-qSCPp-.js";import"./index.vue_vue_type_script_setup_true_lang-AwLN4ZYG.js";import"./sortable.esm-C0-Qcoum.js";import"./position_manage-BVXcPauQ.js";import"./group_manage-yOvaxDdL.js";const Se={class:"copyId tableSmall"},ze={class:"id oneLine"},De=ne({name:"financial_pm_log",__name:"list",setup(xe){const v=Be(),k=g(),y=Ne(),w=g();ie();const{pagination:_,getParams:P,onSizeChange:H,onCurrentChange:R,onSortChange:A}=se();Ie(),re();const B=g(),N=g(),I=g(),F=g("formSearch-financial_pm_log"),C=g([{label:"员工ID",prop:"id",sortable:!0,disableCheck:!1,checked:!0},{label:"用户名",prop:"userName",sortable:!0,disableCheck:!1,checked:!0},{label:"姓名",prop:"name",sortable:!0,disableCheck:!1,checked:!0},{label:"所属组",prop:"groupId",sortable:!0,disableCheck:!1,checked:!0},{label:"职位",prop:"positionId",sortable:!0,disableCheck:!1,checked:!0},{label:"待审提成",prop:"pendingBalance",sortable:!0,disableCheck:!1,checked:!0},{label:"可用提成",prop:"availableBalance",sortable:!0,disableCheck:!1,checked:!0}]),e=g({loading:!1,activeName:"myFinancial",tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],formMode:"drawer",formModeProps:{visible:!1,id:""},search:{page:1,limit:10,id:null,userName:"",name:"",positionId:null},batch:{enable:!1,selectionDataList:[]},dataList:[]});function f(){try{e.value.loading=!0;const n={...P(),...e.value.search};Ce.list(n).then(o=>{e.value.loading=!1,e.value.dataList=o.data.data,_.value.total=+o.data.total})}catch{}finally{e.value.loading=!1}}function T(n){B.value.showEdit(JSON.stringify(n))}function U(n){N.value.showEdit(n)}function O(){Object.assign(e.value.search,{page:1,limit:10,id:null,userName:"",name:"",positionId:null}),f()}function $(n){H(n).then(()=>{e.value.search.limit=n,f()})}function S(n=1){R(n).then(()=>{e.value.search.page=n,f()})}function V({prop:n,order:o}){A(n,o).then(()=>f())}ue(async()=>{k.value=await(v==null?void 0:v.getPositionManage())||[],w.value=await(y==null?void 0:y.getGroupManage())||[],f(),e.value.formMode==="router"&&D.on("get-data-list",()=>{f()}),C.value.forEach(n=>{n.checked&&e.value.checkList.push(n.prop)}),I.value=[{index:1,show:!0,type:"input",modelName:"id",placeholder:"员工ID"},{index:2,show:!0,type:"input",modelName:"userName",placeholder:"用户名"},{index:3,show:!0,type:"input",modelName:"name",placeholder:"姓名"},{index:4,show:!0,type:"select",modelName:"positionId",placeholder:"职位",option:"positionId",optionLabel:"name",optionValue:"id"}]});const j={positionId:()=>k.value};return ce(()=>{e.value.formMode==="router"&&D.off("get-data-list")}),(n,o)=>{const J=ye,Q=u("ElDivider"),q=ke,G=u("el-button"),K=ge,W=he,X=u("el-row"),Y=u("el-table-column"),d=u("ElTableColumn"),Z=ve,r=u("el-text"),z=u("ElButton"),ee=u("el-empty"),ae=u("ElTable"),te=u("ElPagination"),le=_e,oe=pe("loading");return i(),L("div",{class:fe({"absolute-container":e.value.tableAutoHeight})},[l(le,null,{default:t(()=>[l(J,{formSearchList:I.value,formSearchName:F.value,onCurrentChange:S,onOnReset:O,model:e.value.search,formOption:j},null,8,["formSearchList","formSearchName","model"]),l(Q,{"border-style":"dashed"}),l(X,null,{default:t(()=>[l(q),l(W,null,{default:t(()=>[l(G,{size:"default"},{default:t(()=>[c(" 导出 ")]),_:1}),l(K,{border:e.value.border,"onUpdate:border":o[0]||(o[0]=a=>e.value.border=a),tableAutoHeight:e.value.tableAutoHeight,"onUpdate:tableAutoHeight":o[1]||(o[1]=a=>e.value.tableAutoHeight=a),checkList:e.value.checkList,"onUpdate:checkList":o[2]||(o[2]=a=>e.value.checkList=a),columns:C.value,"onUpdate:columns":o[3]||(o[3]=a=>C.value=a),"line-height":e.value.lineHeight,"onUpdate:lineHeight":o[4]||(o[4]=a=>e.value.lineHeight=a),stripe:e.value.stripe,"onUpdate:stripe":o[5]||(o[5]=a=>e.value.stripe=a),style:{"margin-left":"12px"},onQueryData:f},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),de((i(),s(ae,{border:e.value.border,size:e.value.lineHeight,stripe:e.value.stripe,class:"my-4",data:e.value.dataList,"highlight-current-row":"",height:"100%",onSortChange:V,onSelectionChange:o[6]||(o[6]=a=>e.value.batch.selectionDataList=a)},{empty:t(()=>[l(ee,{image:b(me),"image-size":300},null,8,["image"])]),default:t(()=>[l(Y,{align:"left",type:"selection"}),e.value.batch.enable?(i(),s(d,{key:0,type:"selection","show-overflow-tooltip":"",align:"left",fixed:""})):p("",!0),e.value.checkList.includes("id")?(i(),s(d,{key:1,"show-overflow-tooltip":"",align:"left",prop:"id",label:"员工ID"},{default:t(({row:a})=>[x("div",Se,[x("div",ze,"ID: "+h(a.id),1),l(Z,{class:"copy",content:a.id},null,8,["content"])])]),_:1})):p("",!0),e.value.checkList.includes("userName")?(i(),s(d,{key:2,"show-overflow-tooltip":"",align:"left",prop:"userName",label:"用户名"},{default:t(({row:a})=>[l(r,{class:"tableBig"},{default:t(()=>[c(h(a.userName?a.userName:"-"),1)]),_:2},1024)]),_:1})):p("",!0),e.value.checkList.includes("name")?(i(),s(d,{key:3,"show-overflow-tooltip":"",align:"left",prop:"name",label:"姓名"},{default:t(({row:a})=>[l(r,{class:"tableBig"},{default:t(()=>[c(h(a.name?a.name:"-"),1)]),_:2},1024)]),_:1})):p("",!0),e.value.checkList.includes("groupId")?(i(),s(d,{key:4,"show-overflow-tooltip":"",align:"left",prop:"groupId",width:"150",label:"所属组"},{default:t(({row:a})=>[a.groupId?(i(),s(r,{key:0},{default:t(()=>[(i(!0),L(E,null,M(w.value,m=>(i(),s(r,null,{default:t(()=>[a.groupId===m.id?(i(),s(r,{key:0},{default:t(()=>[l(r,{class:"tableBig"},{default:t(()=>[c(h(m.name?m.name:"-"),1)]),_:2},1024)]),_:2},1024)):p("",!0)]),_:2},1024))),256))]),_:2},1024)):(i(),s(r,{key:1},{default:t(()=>[c("-")]),_:1}))]),_:1})):p("",!0),e.value.checkList.includes("positionId")?(i(),s(d,{key:5,"show-overflow-tooltip":"",align:"left",prop:"positionId",width:"150",label:"职位"},{default:t(({row:a})=>[(i(!0),L(E,null,M(k.value,m=>(i(),s(r,null,{default:t(()=>[a.positionId===m.id?(i(),s(r,{key:0},{default:t(()=>[l(r,{class:"tableBig"},{default:t(()=>[c(h(m.name?m.name:"-"),1)]),_:2},1024)]),_:2},1024)):p("",!0)]),_:2},1024))),256))]),_:1})):p("",!0),e.value.checkList.includes("pendingBalance")?(i(),s(d,{key:6,"show-overflow-tooltip":"",align:"left",prop:"pendingBalance",label:"待审提成"},{default:t(({row:a})=>[l(r,{class:"tableBig"},{default:t(()=>[c(h(a.pendingBalance?a.pendingBalance:"-"),1)]),_:2},1024)]),_:1})):p("",!0),e.value.checkList.includes("availableBalance")?(i(),s(d,{key:7,"show-overflow-tooltip":"",align:"left",prop:"availableBalance",label:"可用提成"},{default:t(({row:a})=>[l(r,{class:"tableBig"},{default:t(()=>[c(h(a.availableBalance?a.availableBalance:"-"),1)]),_:2},1024)]),_:1})):p("",!0),l(d,{fixed:"right",align:"left",width:"200",label:"操作"},{default:t(({row:a})=>[l(z,{type:"primary",size:"small",plain:"",onClick:m=>U(a)},{default:t(()=>[c(" 财务日志 ")]),_:2},1032,["onClick"]),l(z,{type:"warning",size:"small",plain:"",onClick:m=>T(a)},{default:t(()=>[c(" 加减款 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","size","stripe","data"])),[[oe,e.value.loading]]),l(te,{"current-page":b(_).page,total:b(_).total,"page-size":b(_).size,"page-sizes":b(_).sizes,layout:b(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:$,onCurrentChange:S},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),l(Le,{ref_key:"plusMinusPaymentsRef",ref:B,onFetchData:f},null,512),l(we,{ref_key:"financeLogRef",ref:N},null,512)],2)}}}),qe=be(De,[["__scopeId","data-v-02675c6f"]]);export{qe as default};
