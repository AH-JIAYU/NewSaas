
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as X}from"./index-D4PmVMMx.js";import{a as Y}from"./department-BwDFgjFU.js";import{d as Z,r as m,a as c,o as p,b,f as i,w as l,y as u,g as k,i as s,A as S,F as j,t as T,z as U,e as x,j as $,p as ee,aH as te,aI as ae,L as le}from"./index-BJV8hziD.js";const C=g=>(te("data-v-1b38b346"),g=g(),ae(),g),se=C(()=>u("span",{class:"project-name"},"项目",-1)),ne={class:"project-content"},oe={style:{display:"flex"}},ce={style:{"font-weight":"500"}},de={style:{"margin-left":"10px"}},ie=C(()=>u("span",{class:"custom-tab-label"},"部门",-1)),ue=C(()=>u("div",{style:{color:"#333333","font-weight":"500","font-size":"14px","margin-bottom":"10px"}}," 分配部门 ",-1)),re=C(()=>u("span",{class:"custom-tab-label",style:{"margin-left":"20px"}},"员工",-1)),pe={class:"flex-c"},fe=Z({__name:"index",emits:["userData"],setup(g,{expose:D,emit:B}){const f=m(!1),d=m([]),L=m([]),h=m(),t=m({type:1,tenantStaffList:[],roleList:[],title:"",project:[]}),K={children:"children",label:"name"};async function w(e,a,o){await A(),t.value.type=1,f.value=!0,d.value=[];const r=await Y.list({name:""});r.data&&(L.value=r.data),e&&(e.invitationType==1?e.chargeUserId&&(t.value.roleList=[e.chargeUserId],t.value.chargeUserName=e.chargeUserName):e.invitationType==2&&(d.value=[e.chargeUserId],t.value.chargeUserName=e.chargeUserName)),t.value.title=a,o&&(t.value.project=o)}const A=async()=>{const e=await ee.getTenantStaffList();t.value.tenantStaffList=e.data};function E(){f.value=!1}const R=(e,a)=>{a?(h.value.getCheckedKeys().forEach(r=>{r!==e.id&&h.value.setChecked(r,!1)}),d.value=[e.id]):d.value=d.value.filter(o=>o!==e.id),d.value.length&&(t.value.roleList=[])},z=()=>{},F=e=>{Array.isArray(e)&&e.length>1&&(t.value.roleList=[e[e.length-1]]),t.value.roleList.length!=0&&(d.value=[],h.value.setCheckedKeys([]))};D({showEdit:w});const H=B;function P(){let e="",a=null,o=null;t.value.roleList[0]&&(e=t.value.tenantStaffList.find(v=>v.id===t.value.roleList[0]).userName,a=t.value.roleList[0],o=1),d.value[0]&&(e=h.value.getCheckedNodes().map(v=>v.name)[0],a=d.value[0],o=2);let r={chargeUserId:a,chargeUserName:e,invitationType:o};f.value=!1,H("userData",r)}const y=m([]),q=e=>{y.value=e};return(e,a)=>{const o=c("el-badge"),r=X,N=c("el-collapse-item"),v=c("el-collapse"),G=c("el-tree"),J=c("el-text"),I=c("el-tab-pane"),M=c("el-checkbox"),O=c("el-checkbox-group"),Q=c("el-tabs"),V=c("el-button"),W=c("el-dialog");return p(),b("div",null,[i(W,{modelValue:s(f),"onUpdate:modelValue":a[3]||(a[3]=n=>S(f)?f.value=n:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:s(t).title,class:"userClass"},{footer:l(()=>[u("div",pe,[i(V,{onClick:E},{default:l(()=>[k(" 取消 ")]),_:1}),i(V,{type:"primary",onClick:P},{default:l(()=>[k(" 确认 ")]),_:1})])]),default:l(()=>[u("div",null,[i(v,{modelValue:s(y),"onUpdate:modelValue":a[0]||(a[0]=n=>S(y)?y.value=n:null),onChange:q},{default:l(()=>[i(N,{name:"1"},{title:l(()=>[se,i(o,{value:s(t).project.length,max:99,class:"item"},null,8,["value"])]),default:l(()=>[u("div",ne,[(p(!0),b(j,null,T(s(t).project,n=>(p(),b("div",{key:n.id},[u("div",oe,[u("span",ce,U(n.tenantName),1),u("span",de,"ID:"+U(n.tenantId),1),i(r,{content:n.tenantId},null,8,["content"])])]))),128))])]),_:1})]),_:1},8,["modelValue"])]),i(Q,{modelValue:s(t).type,"onUpdate:modelValue":a[2]||(a[2]=n=>s(t).type=n),onTabChange:z,class:"tabs-user"},{default:l(()=>[i(I,{label:"部门",name:1},{label:l(()=>[ie]),default:l(()=>[ue,s(L).length>0?(p(),x(G,{key:0,style:{"max-width":"600px"},ref_key:"treeRef",ref:h,disabled:!0,data:s(L),"show-checkbox":"","check-strictly":"","node-key":"id","default-expanded-keys":[],"default-checked-keys":s(d),"default-expand-all":"",props:K,onCheckChange:R,"check-on-click-node":!0,"expand-on-click-node":!1},null,8,["data","default-checked-keys"])):(p(),x(J,{key:1},{default:l(()=>[k("暂无数据")]),_:1}))]),_:1}),i(I,{name:2},{label:l(()=>[re]),default:l(()=>{var n;return[(n=s(t).tenantStaffList)!=null&&n.length?(p(),x(O,{key:0,onChange:F,modelValue:s(t).roleList,"onUpdate:modelValue":a[1]||(a[1]=_=>s(t).roleList=_)},{default:l(()=>[(p(!0),b(j,null,T(s(t).tenantStaffList,_=>(p(),x(M,{key:_.id,value:_.id,label:_.userName},{default:l(()=>[k(U(_.userName),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])):$("",!0)]}),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"])])}}}),ve=le(fe,[["__scopeId","data-v-1b38b346"]]);export{ve as u};
