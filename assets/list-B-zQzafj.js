
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Se,r as c,aM as De,a3 as we,n as Ee,a as u,q as xe,s as T,o as s,b as x,f as t,w as e,F,t as H,e as p,aq as ze,g as i,z as _,i as S,aL as Be,j as d,N as Ve,aN as Ie,E as $e,_ as Le,b8 as Ne,b9 as Re,bd as Ue,ap as Ae,aG as Te,aH as Fe,y as He,L as Me}from"./index-CyYYGH_S.js";import{_ as Pe}from"./index.vue_vue_type_style_index_0_lang-DiVepNz4.js";import{_ as Oe}from"./index.vue_vue_type_script_setup_true_lang-C4wom5ZZ.js";import{_ as Ye,a as j}from"./index.vue_vue_type_script_setup_true_lang-D3Yr6J6u.js";import{u as qe}from"./user_customer-D9I50-Hb.js";import"./index.vue_vue_type_script_setup_true_lang-DMbYAnUJ.js";import"./index.vue_vue_type_script_setup_true_lang-GjyiPJOG.js";import"./index-DRY3v-j3.js";import"./user_customer-1NxeKsBn.js";import"./index-2GFjmCja.js";import"./department--7JQulh1.js";import"./position_manage-CxVgwWor.js";import"./configuration_role-Dis58IEI.js";import"./tenant_role-8afPGeLd.js";import"./configuration_manager-GnCTNOKy.js";import"./configuration_siteSetting-BY-Bqx3J.js";import"./configuration_site_setting-yDf5xR5_.js";import"./apiLoading-DmzGen-9.js";import"./stagedData-CVNsQu2Q.js";const je=D=>(Te("data-v-dbe48b55"),D=D(),Fe(),D),Ge=je(()=>He("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Je=Se({name:"invoice",__name:"list",setup(D){const G=qe(),M=c([]),{pagination:C,onSizeChange:J,onCurrentChange:Q,onSortChange:Qe}=De(),K=c(""),P=c([]),b=c(!0),z=c(),B=c(!1),m=c([]),V=c(!1);c(!1);const I=c("default"),$=c(!1),W=c([]),X=[{lable:"未收款",value:1},{lable:"部分收款",value:2},{lable:"已完结",value:3},{lable:"坏账",value:4}],y=c(null),g=c([]),Z=[{lable:"开票日期",value:1},{lable:"收款日期",value:2}],L=c([{label:"客户简称",prop:"tenantCustomerShortName",sortable:!0,disableCheck:!1,checked:!0},{label:"发票编号",prop:"invoiceCode",sortable:!0,disableCheck:!1,checked:!0},{label:"金额",prop:"invoiceAmount",sortable:!0,disableCheck:!1,checked:!0},{label:"手续费(税)",prop:"invoiceTax",sortable:!0,disableCheck:!1,checked:!0},{label:"实收款",prop:"actualReceipts",sortable:!0,disableCheck:!1,checked:!0},{label:"开票日期",prop:"invoiceDate",sortable:!0,disableCheck:!1,checked:!0},{label:"收款日期",prop:"paymentDate",sortable:!0,disableCheck:!1,checked:!0},{label:"状态",prop:"invoiceStatus",sortable:!0,disableCheck:!1,checked:!0},{label:"备注",prop:"remark",sortable:!0,disableCheck:!1,checked:!0}]),r=we({page:1,limit:10,tenantCustomerId:"",invoiceStatus:null,invoiceDateStart:"",invoiceDateEnd:"",paymentDateStart:"",paymentDateEnd:""});function ee(){z.value.showEdit("")}function te(o){z.value.showEdit(JSON.stringify(o))}function le(o){Ie.confirm(`确认删除「${o.tenantCustomerShortName}」这条数据吗？`,"确认信息").then(()=>{try{b.value=!0,j.delete({id:o.id}).then(()=>{b.value=!1,k(),$e.success({message:"删除成功",center:!0})})}catch{}finally{b.value=!1}}).catch(()=>{})}function ae(o){W.value=o}function oe(){Object.assign(r,{page:1,limit:10,tenantCustomerId:"",invoiceStatus:null,invoiceDateStart:"",invoiceDateEnd:"",paymentDateStart:"",paymentDateEnd:""}),y.value=null,k()}const ne=o=>{y.value=o,g.value=[],r.invoiceDateStart="",r.invoiceDateEnd="",r.paymentDateStart="",r.paymentDateEnd="",h()},se=()=>{y.value===1?(r.invoiceDateStart=g.value[0],r.invoiceDateEnd=g.value[1]):(r.paymentDateStart=g.value[0],r.paymentDateEnd=g.value[1]),h()};function ie(o){J(o).then(()=>{r.limit=o,k()})}function h(o=1){Q(o).then(()=>{r.page=o,k()})}async function k(){try{b.value=!0,M.value=await G.getCustomerList();const{data:o}=await j.list(r);P.value=o.data,C.value.total=parseInt(o.total)||0,b.value=!1}catch{}finally{b.value=!1}}return Ee(()=>{L.value.forEach(o=>{o.checked&&m.value.push(o.prop)}),k()}),(o,a)=>{const re=u("el-option"),N=u("el-select"),w=u("el-form-item"),O=u("ElOption"),ue=u("el-date-picker"),Y=Le,R=u("ElButton"),ce=u("ElFormItem"),pe=u("el-form"),de=Oe,me=u("ElDivider"),E=u("el-button"),fe=Pe,ve=Ne,_e=Re,be=u("el-row"),v=u("el-table-column"),f=u("el-text"),U=Ue,ge=u("ElTableColumn"),he=u("el-empty"),Ce=u("el-table"),ye=u("ElPagination"),ke=Ae,q=xe("loading");return T((s(),x("div",{class:Ve({"absolute-container":B.value})},[t(ke,null,{default:e(()=>[t(de,{"show-toggle":!1},{default:e(({fold:l,toggle:A})=>[t(pe,{model:r.select,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:e(()=>[t(w,{label:""},{default:e(()=>[t(N,{modelValue:r.tenantCustomerId,"onUpdate:modelValue":a[0]||(a[0]=n=>r.tenantCustomerId=n),placeholder:"客户简称",clearable:"",filterable:"",onChange:a[1]||(a[1]=n=>h())},{default:e(()=>[(s(!0),x(F,null,H(M.value,n=>(s(),p(re,{key:n.tenantCustomerId,value:n.tenantCustomerId,label:n.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(w,{label:""},{default:e(()=>[t(N,{modelValue:r.invoiceStatus,"onUpdate:modelValue":a[2]||(a[2]=n=>r.invoiceStatus=n),placeholder:"发票状态",clearable:"",filterable:"",onChange:a[3]||(a[3]=n=>h())},{default:e(()=>[(s(),x(F,null,H(X,n=>t(O,{label:n.lable,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(w,{label:""},{default:e(()=>[t(N,{modelValue:y.value,"onUpdate:modelValue":a[4]||(a[4]=n=>y.value=n),placeholder:"时间类型",clearable:"",filterable:"",onChange:ne},{default:e(()=>[(s(),x(F,null,H(Z,n=>t(O,{label:n.lable,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),T(t(w,null,{default:e(()=>[t(ue,{modelValue:g.value,"onUpdate:modelValue":a[5]||(a[5]=n=>g.value=n),disabled:!y.value,"value-format":"YYYY-MM-DD hh:mm:ss",type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:"",size:"",onChange:se},null,8,["modelValue","disabled"])]),_:2},1536),[[ze,!l]]),t(ce,null,{default:e(()=>[t(R,{type:"primary",onClick:a[6]||(a[6]=n=>h())},{icon:e(()=>[t(Y,{name:"i-ep:search"})]),default:e(()=>[i(" 筛选 ")]),_:1}),t(R,{onClick:oe},{icon:e(()=>[Ge]),default:e(()=>[i(" 重置 ")]),_:1}),t(R,{link:"",onClick:A},{icon:e(()=>[t(Y,{name:l?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:e(()=>[i(" "+_(l?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),t(me,{"border-style":"dashed"}),t(be,{gutter:24},{default:e(()=>[t(fe,null,{default:e(()=>[t(E,{style:{"margin-right":"10px"},type:"primary",size:"default",onClick:ee},{default:e(()=>[i(" 新增发票 ")]),_:1})]),_:1}),t(_e,null,{default:e(()=>[t(E,{size:"default",onClick:a[7]||(a[7]=()=>{})},{default:e(()=>[i(" 导出 ")]),_:1}),t(ve,{border:V.value,"onUpdate:border":a[8]||(a[8]=l=>V.value=l),tableAutoHeight:B.value,"onUpdate:tableAutoHeight":a[9]||(a[9]=l=>B.value=l),checkList:m.value,"onUpdate:checkList":a[10]||(a[10]=l=>m.value=l),columns:L.value,"onUpdate:columns":a[11]||(a[11]=l=>L.value=l),"line-height":I.value,"onUpdate:lineHeight":a[12]||(a[12]=l=>I.value=l),stripe:$.value,"onUpdate:stripe":a[13]||(a[13]=l=>$.value=l),style:{"margin-left":"12px"},onQueryData:h},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),T((s(),p(Ce,{ref_key:"tableSortRef",ref:K,style:{"margin-top":"10px"},"row-key":"id",data:P.value,border:V.value,class:"my-4",size:I.value,stripe:$.value,onSelectionChange:ae},{empty:e(()=>[t(he,{image:S(Be),"image-size":300},null,8,["image"])]),default:e(()=>[t(v,{align:"left",type:"selection"}),m.value.includes("tenantCustomerShortName")?(s(),p(v,{key:0,prop:"tenantCustomerShortName","show-overflow-tooltip":"",align:"left",width:"100",label:"客户简称"},{default:e(({row:l})=>[t(f,{class:"fontColor tableBig"},{default:e(()=>[i(_(l.tenantCustomerShortName),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceCode")?(s(),p(v,{key:1,prop:"invoiceCode","show-overflow-tooltip":"",align:"left",label:"发票编号"},{default:e(({row:l})=>[t(f,{class:"fontColor"},{default:e(()=>[i(_(l.invoiceCode),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceAmount")?(s(),p(v,{key:2,prop:"invoiceAmount","show-overflow-tooltip":"",align:"left",label:"金额"},{default:e(({row:l})=>[t(U),t(f,{class:"fontColor tableBig"},{default:e(()=>[i(_(l.invoiceAmount||0),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceTax")?(s(),p(v,{key:3,prop:"invoiceTax","show-overflow-tooltip":"",align:"left",label:"手续费(税)"},{default:e(({row:l})=>[t(U),t(f,{class:"fontColor tableBig"},{default:e(()=>[i(_(l.invoiceTax||0),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("actualReceipts")?(s(),p(v,{key:4,prop:"actualReceipts","show-overflow-tooltip":"",align:"left",label:"实收款"},{default:e(({row:l})=>[t(U),t(f,{class:"fontColor tableBig"},{default:e(()=>[i(_(l.actualReceipts||0),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceDate")?(s(),p(v,{key:5,prop:"invoiceDate","show-overflow-tooltip":"",align:"left",width:"180",label:"开票日期"},{default:e(({row:l})=>[t(f,{class:"fontColor"},{default:e(()=>[i(_(l.invoiceDate),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("paymentDate")?(s(),p(v,{key:6,prop:"paymentDate","show-overflow-tooltip":"",align:"left",width:"180",label:"收款日期"},{default:e(({row:l})=>[t(f,{class:"fontColor"},{default:e(()=>[i(_(l.paymentDate),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceStatus")?(s(),p(ge,{key:7,align:"left","show-overflow-tooltip":"",prop:"invoiceStatus",label:"状态"},{default:e(({row:l})=>[l.invoiceStatus===1?(s(),p(f,{key:0,class:"mx-1 color1 tableBig"},{default:e(()=>[i("未收款")]),_:1})):d("",!0),l.invoiceStatus===2?(s(),p(f,{key:1,class:"mx-1 color2 tableBig"},{default:e(()=>[i("部分收款")]),_:1})):d("",!0),l.invoiceStatus===3?(s(),p(f,{key:2,class:"mx-1 color3 tableBig"},{default:e(()=>[i("已完结")]),_:1})):d("",!0),l.invoiceStatus===4?(s(),p(f,{key:3,class:"mx-1 color4 tableBig"},{default:e(()=>[i("坏账")]),_:1})):d("",!0)]),_:1})):d("",!0),m.value.includes("remark")?(s(),p(v,{key:8,prop:"remark",align:"left",label:"备注"},{default:e(({row:l})=>[t(f,{class:"mx-1 tableBig"},{default:e(()=>[i(_(l.remark),1)]),_:2},1024)]),_:1})):d("",!0),t(v,{align:"left",fixed:"right",label:"操作",width:"170"},{default:e(({row:l})=>[t(E,{size:"small",plain:"",type:"primary",onClick:A=>te(l)},{default:e(()=>[i(" 编辑 ")]),_:2},1032,["onClick"]),t(E,{size:"small",plain:"",type:"danger",onClick:A=>le(l)},{default:e(()=>[i(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[q,!1]]),t(ye,{"current-page":S(C).page,total:S(C).total,"page-size":S(C).size,"page-sizes":S(C).sizes,layout:S(C).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:h,onSizeChange:ie},null,8,["current-page","total","page-size","page-sizes","layout"]),t(Ye,{onSuccess:k,ref_key:"editRef",ref:z},null,512)]),_:1})],2)),[[q,b.value]])}}}),vt=Me(Je,[["__scopeId","data-v-dbe48b55"]]);export{vt as default};
