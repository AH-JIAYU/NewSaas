
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as re,aB as ue,aj as pe,l as ie,ac as de,r as T,c as f,$ as C,n as me,a0 as ce,a as c,o as b,b as h,f as e,w as l,i as s,bb as fe,v as m,A as _,F as N,t as k,g as v,e as V,j as x,aO as be,E as ve,_ as ye,aI as ge,aJ as Te,M as _e}from"./index-BZvN0JzH.js";import Se from"./index-DbpBiKl_.js";import{U as Le}from"./user_supplier-5iPndO69.js";import{u as Ve}from"./configuration_supplierLevel-7Qfrgcyr.js";import{u as Ie}from"./user_customer-DIa-vJT0.js";import{a as j}from"./user_supplier-CiPXFTGx.js";import"./apiLoading-DRKsIy8c.js";const we="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAZCAYAAAArK+5dAAAAAXNSR0IArs4c6QAAAmBJREFUSEvFlU9IFHEUxz9vxjRpvdSmERJEdIgyD0LQH3CsIArqYgoeInZWD9ElCEKJ/lASXqLoarMVQcEKgXaLNsdLXapDfxQkgkAoNRJkI4mdfbXrbJg76y5LS+847/3e5/ve7735CRU2qXB+SgLsv6tb0imaENZlBQnTpslk4qRMFhNYENARV3NmniMI/SLsDEykTKhyaXaK4fHL8jMTYzm6T8Ebi8qLRS0BdmBQG1IGIyLs8oO+qTCB8tWvICzKNoW1/vFR06Mr0SPTVkyTQLVrS3UgwBrURkxeAg0KM8DN2RDXxzsXFS41y9GzKpwTqAfm0h4thsnHTIxrS1Z8XgWWo2cQbgBv+cEe97RkFBU0K64hkjwHmoD3wPYVARlnm6Pt4ToeDwWoDiLtdbRulfAK2JrzF6yg2FQU8rc52qyLELNoBeVCWh0dFuFY5QB39KgoI4GAw7e0JrQBLbXvgeP9QBu8Bb4EAqyYzgGrXVtqy21RdtFiqoUAWQdCrRuRhXIhVkzvAzWuLZ1/7UGObHo0J3rkTbmA5ef+LFoOIMr50ahcqxgA5bMblY2VA2QyK31uVAb+BSSvRX7SFGm63W65Vwqk9bZ2GAbHwyFOLB/zPIAqF0W4gpJCGHBtubDizy6mV1F6f78bVQa0PLPl9dL4PMD6EFWzSXqBfj/wE8LDtEf8u8e7zLc1JjtMoUuFLqDRH+8+N5Lf1qWAURWMsYi0+gtzUMER2FSkTR+AU64tT4PiVnyTO+JaPTPPITFoV2G3KJt9tVMoCVUe1dfxZKhTvEIiSnr0S7no/wb4BVAj4RpK1TCfAAAAAElFTkSuQmCC",E=I=>(ge("data-v-217fc56c"),I=I(),Te(),I),Ae={class:"card-header"},Ce={style:{display:"flex","justify-content":"space-between","align-items":"center",padding:"0 1rem"}},he=E(()=>m("div",{class:"i-ic:round-plus w-1.3em h-1.3em"},null,-1)),xe=E(()=>m("div",{class:"i-ic:round-plus w-1.3em h-1.3em"},null,-1)),Ee={class:"card-header"},Ue=E(()=>m("br",null,null,-1)),Ne=E(()=>m("div",null,[v(" 为供应商设定筛选条件，更精准匹配合适项目"),m("br"),v(" 例：仅选中【客户1】，该供应商只能做【客户1】的项目 ")],-1)),ke=re({__name:"index",props:{leftTab:Object,tabIndex:Number},setup(I){const B=ue(),{t:n}=pe(),G=Le(),H=Ve();Ie();const O=ie(),Z=de("validateTopTabs"),R=T();T(!1);const t=I,P=T(null);T({});const $=[{label:n("supplier.new.company"),value:"company"},{label:n("supplier.new.personal"),value:"personal"}];f(()=>n("supplier.new.USD")),f(()=>n("supplier.new.CNY"));const S=C({supplierAccord:[{required:!0,message:f(()=>n("supplier.new.enterSuppllierName")),trigger:"blur"},{min:2,max:50,message:f(()=>n("supplier.new.2to50")),trigger:"blur"}],memberLevelId:[{required:!0,message:f(()=>n("supplier.new.memberLevelSelect")),trigger:"change"}],subordinateCountryId:[{required:!0,message:f(()=>n("supplier.new.areaSelect")),trigger:"change"}],supplierLevelId:[{required:!0,message:f(()=>n("supplier.new.supplierLevelSelect")),trigger:"change"}],type:[{required:!0,message:f(()=>n("supplier.new.supplierTypeSelect")),trigger:"change"}]}),ee=(r,a,u)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(t.leftTab.supplierPhone)?u():u(new Error(n("supplier.new.legalPhoneNumber")))},le=(r,a,u)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t.leftTab.emailAddress)?u():u(new Error(n("supplier.new.legalEmail")))},q=r=>{r&&(t.leftTab.countryType=r==="343"?1:2,r==="343"?(t.leftTab.tenantSupplierId||(t.leftTab.currencyType=B.currencyType===1?"USD":"CNY"),S.emailAddress&&delete S.emailAddress,S.supplierPhone=[{required:!0,message:f(()=>n("supplier.new.enterPhoneNumber")),trigger:"blur"},{validator:ee,trigger:"blur"}]):(t.leftTab.tenantSupplierId||(t.leftTab.currencyType=B.currencyType===1?"USD":"CNY"),S.supplierPhone&&delete S.supplierPhone,S.emailAddress=[{required:!0,message:f(()=>n("supplier.new.enterEmail")),trigger:"blur"},{validator:le,trigger:"blur"}]))};t.leftTab.relevanceCountryIdList?console.log(t.leftTab.relevanceCountryIdList):t.leftTab.relevanceCountryIdList=[];const F=()=>{R.value.showEdit()},D=C({checked:!1,relatedCustomers:[],payMethod:G.payMethod,countryList:[],supplierLevelList:[]}),y=C({updateTenantSupplierCustomerInfoList:[],countryList:[]}),M=T("basicSettings"),z=async()=>{D.supplierLevelList=await H.getLevelNameList(),q(t.leftTab.subordinateCountryId)},Q=T([]);T([]);const w=T([]),K=(r,a)=>r?a.label&&a.label.toLowerCase().includes(r.toLowerCase()):!0,te=r=>{r.forEach(a=>{Q.value.push({label:a.chineseName,key:a.id,initial:a.code})})};C({customerShortName:"",customerStatus:2,antecedentQuestionnaire:null}),me(async()=>{w.value=[];const{data:r}=await j.getCustomerCooperation({}),a=(r==null?void 0:r.getCustomerInfoLists)||[],u=(r==null?void 0:r.getCooperationInfoLists)||[];a.length!=0&&a.forEach(d=>{w.value.push({label:d.customerName,key:d.customerId,type:1})}),u.length!=0&&u.forEach(d=>{w.value.push({label:d.tenantName,key:d.tenantId,type:2})}),t.leftTab.updateTenantSupplierCustomerInfoList?t.leftTab.updateTenantSupplierCustomerInfoList.length&&t.leftTab.updateTenantSupplierCustomerInfoList.forEach(d=>{y.updateTenantSupplierCustomerInfoList.push(d.tenantCustomerId)}):(t.leftTab.updateTenantSupplierCustomerInfoList=[],y.updateTenantSupplierCustomerInfoList=[]),y.countryList=await O.getCountry(),await z(),te(y.countryList)}),ce(()=>{Z(P.value)});const ae=()=>{const r=y.updateTenantSupplierCustomerInfoList.map(a=>{const u=w.value.find(d=>d.key===a);return u?{type:u.type,tenantCustomerId:u.key}:null}).filter(Boolean);t.leftTab.updateTenantSupplierCustomerInfoList=r},ne=()=>{be.confirm(`确认将「${t.leftTab.supplierAccord}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{j.supplierResetPassword({supplierId:t.leftTab.tenantSupplierId}).then(()=>{ve.success({message:"重置密码成功",center:!0})})}).catch(()=>{})};return(r,a)=>{const u=c("el-option"),d=c("el-select"),p=c("el-form-item"),i=c("el-col"),g=c("el-input"),X=c("el-button"),L=c("el-row"),U=c("el-tooltip"),W=c("el-card"),A=c("ElSwitch"),J=ye,Y=c("el-transfer"),oe=c("el-tab-pane"),se=c("el-tabs");return b(),h("div",null,[e(se,{modelValue:M.value,"onUpdate:modelValue":a[17]||(a[17]=o=>M.value=o)},{default:l(()=>[e(oe,{label:s(n)("supplier.new.basicSettings"),name:"basicSettings"},{default:l(()=>[e(s(fe),{ref_key:"formRef",ref:P,rules:s(S),model:t.leftTab,"label-width":"100px","validate-on-rule-change":!1},{default:l(()=>[e(W,{class:"box-card"},{header:l(()=>[m("div",Ae,[m("span",null,_(s(n)("supplier.new.basicInformation")),1)])]),default:l(()=>[e(L,{gutter:10},{default:l(()=>[e(i,{span:8},{default:l(()=>[e(p,{label:s(n)("supplier.new.supplierType"),prop:"type"},{default:l(()=>[e(d,{modelValue:t.leftTab.type,"onUpdate:modelValue":a[0]||(a[0]=o=>t.leftTab.type=o),"value-key":"",placeholder:"",clearable:"",filterable:""},{default:l(()=>[(b(),h(N,null,k($,o=>e(u,{key:o.value,label:o.label,value:o.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:s(n)("supplier.new.supplierAccord"),prop:"supplierAccord"},{default:l(()=>[e(g,{modelValue:t.leftTab.supplierAccord,"onUpdate:modelValue":a[1]||(a[1]=o=>t.leftTab.supplierAccord=o),clearable:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:s(n)("supplier.new.supplierLevel"),prop:"supplierLevelId"},{default:l(()=>[e(d,{clearable:"",filterable:"",modelValue:t.leftTab.supplierLevelId,"onUpdate:modelValue":a[2]||(a[2]=o=>t.leftTab.supplierLevelId=o)},{empty:l(()=>[m("div",Ce,[v(_(s(n)("supplier.new.nodata"))+" ",1),e(X,{type:"primary",link:"",size:"small",onClick:F},{default:l(()=>[v(_(s(n)("supplier.new.quickAdd"))+" ",1),he]),_:1})])]),default:l(()=>[(b(!0),h(N,null,k(s(D).supplierLevelList,o=>(b(),V(u,{key:o.tenantSupplierLevelId,value:o.tenantSupplierLevelId,label:o.levelNameOrAdditionRatio},null,8,["value","label"]))),128)),e(X,{size:"small",class:"buttonClass",onClick:F},{default:l(()=>[v(_(s(n)("supplier.new.quickAdd"))+" ",1),xe]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(L,{gutter:10},{default:l(()=>[e(i,{span:8},{default:l(()=>[e(p,{label:s(n)("supplier.new.area"),prop:"subordinateCountryId"},{default:l(()=>[e(d,{clearable:"",filterable:"",modelValue:t.leftTab.subordinateCountryId,"onUpdate:modelValue":a[3]||(a[3]=o=>t.leftTab.subordinateCountryId=o),onChange:q},{default:l(()=>[(b(!0),h(N,null,k(s(y).countryList,o=>(b(),V(u,{key:o.id,value:o.id,label:o.chineseName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:s(n)("supplier.new.supplierName")},{default:l(()=>[e(g,{clearable:"",modelValue:t.leftTab.supplierName,"onUpdate:modelValue":a[4]||(a[4]=o=>t.leftTab.supplierName=o)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:s(n)("supplier.new.supplierPhone"),prop:"supplierPhone"},{default:l(()=>[e(g,{clearable:"",modelValue:t.leftTab.supplierPhone,"onUpdate:modelValue":a[5]||(a[5]=o=>t.leftTab.supplierPhone=o)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(L,{gutter:10},{default:l(()=>[e(i,{span:8},{default:l(()=>[e(p,{label:s(n)("supplier.new.emailAddress"),prop:"emailAddress"},{default:l(()=>[e(g,{clearable:"",modelValue:t.leftTab.emailAddress,"onUpdate:modelValue":a[6]||(a[6]=o=>t.leftTab.emailAddress=o)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:s(n)("supplier.new.settlementCycle")},{default:l(()=>[e(d,{modelValue:t.leftTab.settlementCycle,"onUpdate:modelValue":a[7]||(a[7]=o=>t.leftTab.settlementCycle=o)},{default:l(()=>[e(u,{label:"net 30",value:30}),e(u,{label:"net 60",value:60}),e(u,{label:"net 90",value:90}),e(u,{label:"net 180",value:180})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(i,{span:8},{default:l(()=>[e(p,{label:"初始密码"},{default:l(()=>[e(g,{clearable:"",value:"123456",disabled:"",style:{width:"80%"}}),t.leftTab.tenantSupplierId?(b(),V(U,{key:0,effect:"dark",content:"重置密码",placement:"top-start"},{default:l(()=>[m("img",{src:we,alt:"",style:{"margin-left":"10px",cursor:"pointer"},onClick:ne})]),_:1})):x("",!0)]),_:1})]),_:1}),e(i,{span:8},{default:l(()=>[t.leftTab.type==="company"?(b(),V(p,{key:0,label:s(n)("supplier.new.companyName")},{default:l(()=>[e(g,{clearable:"",modelValue:t.leftTab.companyName,"onUpdate:modelValue":a[8]||(a[8]=o=>t.leftTab.companyName=o)},null,8,["modelValue"])]),_:1},8,["label"])):x("",!0)]),_:1})]),_:1}),e(L,{gutter:10},{default:l(()=>[e(i,{span:8},{default:l(()=>[t.leftTab.type==="company"?(b(),V(p,{key:0,label:s(n)("supplier.new.legalPersonName"),prop:""},{default:l(()=>[e(g,{clearable:"",modelValue:t.leftTab.legalPersonName,"onUpdate:modelValue":a[9]||(a[9]=o=>t.leftTab.legalPersonName=o)},null,8,["modelValue"])]),_:1},8,["label"])):x("",!0)]),_:1}),e(i,{span:8},{default:l(()=>[t.leftTab.type==="company"?(b(),V(p,{key:0,label:s(n)("supplier.new.taxID"),prop:""},{default:l(()=>[e(g,{clearable:"",modelValue:t.leftTab.taxID,"onUpdate:modelValue":a[10]||(a[10]=o=>t.leftTab.taxID=o)},null,8,["modelValue"])]),_:1},8,["label"])):x("",!0)]),_:1})]),_:1})]),_:1}),e(W,{class:"box-card"},{header:l(()=>[m("div",Ee,[m("span",null,_(s(n)("supplier.new.permissionInformation")),1)])]),default:l(()=>[e(L,{gutter:10},{default:l(()=>[e(i,{span:3},{default:l(()=>[e(p,{label:s(n)("supplier.new.surveySystem")},{default:l(()=>[e(A,{modelValue:t.leftTab.surveySystem,"onUpdate:modelValue":a[11]||(a[11]=o=>t.leftTab.surveySystem=o),"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":s(n)("common.enable"),"inactive-text":s(n)("common.disable")},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])]),_:1}),e(i,{span:3},{default:l(()=>[e(p,{label:"B2B"},{default:l(()=>[e(A,{modelValue:t.leftTab.b2bStatus,"onUpdate:modelValue":a[12]||(a[12]=o=>t.leftTab.b2bStatus=o),"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":s(n)("common.enable"),"inactive-text":s(n)("common.disable")},null,8,["modelValue","active-text","inactive-text"])]),_:1})]),_:1}),e(i,{span:4},{default:l(()=>[e(p,{label:"B2C"},{default:l(()=>[e(A,{modelValue:t.leftTab.b2cStatus,"onUpdate:modelValue":a[13]||(a[13]=o=>t.leftTab.b2cStatus=o),"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":s(n)("common.enable"),"inactive-text":s(n)("common.disable")},null,8,["modelValue","active-text","inactive-text"])]),_:1})]),_:1}),e(i,{span:3},{default:l(()=>[e(p,{label:s(n)("supplier.new.surveyStatus")},{default:l(()=>[e(A,{modelValue:t.leftTab.supplierStatus,"onUpdate:modelValue":a[14]||(a[14]=o=>t.leftTab.supplierStatus=o),"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":s(n)("common.enable"),"inactive-text":s(n)("common.disable")},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])]),_:1})]),_:1}),e(L,{gutter:24},{default:l(()=>[e(i,{span:11},{default:l(()=>[m("div",null,[e(p,null,{label:l(()=>[m("div",null,[e(U,{class:"tooltips",placement:"top"},{content:l(()=>[m("div",null,[v(_(s(n)("supplier.new.tips1")),1),Ue,v(" "+_(s(n)("supplier.new.example")),1)])]),default:l(()=>[e(J,{class:"SvgIcon2",name:"i-ri:question-line"})]),_:1}),v(" "+_(s(n)("supplier.new.authorizationArea")),1)])]),_:1})]),e(Y,{style:{"margin-left":"1.875rem"},modelValue:t.leftTab.relevanceCountryIdList,"onUpdate:modelValue":a[15]||(a[15]=o=>t.leftTab.relevanceCountryIdList=o),filterable:"","filter-method":K,"filter-placeholder":s(n)("supplier.new.enterQueryCountry"),data:Q.value,titles:[s(n)("supplier.new.unselectedCountry"),s(n)("supplier.new.selectedCountries")]},null,8,["modelValue","filter-placeholder","data","titles"])]),_:1}),e(i,{span:11},{default:l(()=>[m("div",null,[e(p,null,{label:l(()=>[m("div",null,[e(U,{class:"tooltips",placement:"top"},{content:l(()=>[Ne]),default:l(()=>[e(J,{class:"SvgIcon2",name:"i-ri:question-line"})]),_:1}),v(" 分配客户 ")])]),_:1})]),e(Y,{style:{"margin-left":"1.875rem"},modelValue:s(y).updateTenantSupplierCustomerInfoList,"onUpdate:modelValue":a[16]||(a[16]=o=>s(y).updateTenantSupplierCustomerInfoList=o),filterable:"","filter-method":K,"filter-placeholder":"输入查询客户",data:w.value,onChange:ae,titles:["未选择客户","已分配客户"]},null,8,["modelValue","data"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["label"])]),_:1},8,["modelValue"]),e(Se,{ref_key:"EditRef",ref:R,onQueryData:z},null,512)])}}}),ze=_e(ke,[["__scopeId","data-v-217fc56c"]]);export{ze as default};
