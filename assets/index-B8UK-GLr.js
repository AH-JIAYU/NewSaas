
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as be,aN as ve,r as u,Z as A,c as we,n as ke,a as s,q as Ce,o as r,b as K,f as a,w as e,i as t,ay as M,F as Ie,t as xe,e as p,g as i,z as g,A as k,s as G,aM as je,aG as Ne,j as y,y as U,N as Le,_ as Se,ba as ze,bb as Te,an as De,aH as Ee,aI as Re,L as Ve}from"./index-BIHh3pBK.js";import{_ as Ue}from"./index.vue_vue_type_style_index_0_lang-Cdvu4scz.js";import{_ as Fe}from"./index.vue_vue_type_script_setup_true_lang-CUDUXZ7X.js";import{q as Be,a as O}from"./index-DoBENTxX.js";import{u as qe}from"./user_customer-BFHnR5Rc.js";/* empty css                      */import"./user_customer-D4ZSKTZX.js";const Q=I=>(Ee("data-v-68128979"),I=I(),Re(),I),He=Q(()=>U("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Pe=Q(()=>U("br",null,null,-1)),$e={class:"tableBig"},Ae=be({name:"preInvestigationRecords",__name:"index",setup(I){const Z=qe(),{getParams:J,pagination:d,onSizeChange:W,onCurrentChange:X}=ve(),x=u(!1),F=u([]);u("");const f=u([]),j=u(!1),N=u(!1),L=u("default"),S=u(!1),Y=u();u("formSearch-preInvestigationRecords");const z=u([{prop:"projectId",label:"项目ID",sortable:!0,checked:!0},{prop:"projectName",label:"项目名称",sortable:!0,checked:!0},{prop:"allocationType",label:"分配类型",sortable:!0,checked:!0},{prop:"passNumber",label:"通过数/提交数",sortable:!0,checked:!0},{prop:"passRate",label:"通过率",sortable:!0,checked:!0}]),c=A({projectId:"",projectName:"",allocationType:[]}),B=u(),h=A({allocationTypeList:["未分配","供应商","内部站"],surveyStatusList:["完成","被甄别","配额满","安全终止","未完成"],viceStatusList:["待审","免审","过IR","时间果断","超时完成","超量完成","审核成功","审核失败","数据冻结","时间段过载","ip不一致","id重复参与","和解"],customerList:[],vipList:[],vipGroupList:[],tenantSupplierList:[],expandedRows:[]});function ee(){c.pageNo=1,C()}function te(n){W(n).then(()=>C())}function ae(n=1){X(n).then(()=>C())}async function q(n){const l=h.expandedRows.indexOf(n.id);if(l!==-1?h.expandedRows.splice(l,1):h.expandedRows.push(n.id),!n.children){const w=await O.childList({projectId:n.projectId});n.children=w.data.projectScreenMemberChildInfoList}}function oe(n){B.value.showEdit(n)}const v=we(()=>F.value.filter(l=>!!(l.projectId.includes(c.projectId)||l.projectName.includes(c.projectName)||c.allocationType===l.allocationType)).slice((d.value.page-1)*d.value.size,d.value.page*d.value.size));async function C(){try{x.value=!0;const n={...J(),...c},{data:l,status:w}=await O.list(n);l&&w===1&&(F.value=l.projectSurveyScreenInfoList,d.value.total=l.projectSurveyScreenInfoList.length),x.value=!1}catch{}finally{x.value=!1}}function le(){Object.assign(c,{projectId:"",projectName:"",allocationType:""}),C()}return ke(async()=>{h.customerList=await Z.getCustomerList(),z.value.forEach(n=>{n.checked&&f.value.push(n.prop)}),C(),Y.value=[{index:1,show:!0,type:"input",modelName:"projectId",placeholder:"项目ID"},{index:2,show:!0,type:"input",modelName:"projectName",placeholder:"项目名称"},{index:3,show:!0,type:"select",modelName:"allocationType",placeholder:"分配类型",option:"allocationType",optionLabel:"label",optionValue:"value",multiple:!0}]}),(n,l)=>{const w=s("ElInput"),T=s("ElFormItem"),ne=s("el-option"),se=s("el-select"),H=Se,D=s("ElButton"),ie=s("ElForm"),re=Fe,ce=s("ElDivider"),pe=Ue,P=s("el-button"),ue=ze,de=Te,me=s("el-row"),b=s("el-table-column"),E=s("el-text"),R=s("ElTableColumn"),$=s("el-table"),V=s("el-tag"),fe=s("el-empty"),_e=s("ElPagination"),ye=De,ge=Ce("loading");return r(),K("div",{class:Le({"absolute-container":t(S)})},[a(ye,null,{default:e(()=>[a(re,{"show-toggle":!1},{default:e(({fold:o,toggle:m})=>[a(ie,{model:t(c),size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:e(()=>[a(T,null,{default:e(()=>[a(w,{modelValue:t(c).projectId,"onUpdate:modelValue":l[0]||(l[0]=_=>t(c).projectId=_),placeholder:"项目ID",clearable:"",onKeydown:M(t(v),["enter"]),onClear:t(v)},null,8,["modelValue","onKeydown","onClear"])]),_:1}),a(T,null,{default:e(()=>[a(w,{modelValue:t(c).projectName,"onUpdate:modelValue":l[1]||(l[1]=_=>t(c).projectName=_),placeholder:"项目名称",clearable:"",onKeydown:M(t(v),["enter"]),onClear:t(v)},null,8,["modelValue","onKeydown","onClear"])]),_:1}),a(T,null,{default:e(()=>[a(se,{modelValue:t(c).allocationType,"onUpdate:modelValue":l[2]||(l[2]=_=>t(c).allocationType=_),"value-key":"",placeholder:"分配类型",clearable:"",filterable:""},{default:e(()=>[(r(!0),K(Ie,null,xe(t(h).allocationTypeList,(_,he)=>(r(),p(ne,{key:_,label:_,value:he+1},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(T,null,{default:e(()=>[a(D,{type:"primary",onClick:t(v)},{icon:e(()=>[a(H,{name:"i-ep:search"})]),default:e(()=>[i(" 筛选 ")]),_:1},8,["onClick"]),a(D,{onClick:le},{icon:e(()=>[He]),default:e(()=>[i(" 重置 ")]),_:1}),a(D,{link:"",onClick:m},{icon:e(()=>[a(H,{name:o?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:e(()=>[i(" "+g(o?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),a(ce,{"border-style":"dashed"}),a(me,null,{default:e(()=>[a(pe),a(de,null,{default:e(()=>[a(P,{size:"default"},{default:e(()=>[i(" 导出 ")]),_:1}),a(ue,{border:t(j),"onUpdate:border":l[3]||(l[3]=o=>k(j)?j.value=o:null),tableAutoHeight:t(S),"onUpdate:tableAutoHeight":l[4]||(l[4]=o=>k(S)?S.value=o:null),checkList:t(f),"onUpdate:checkList":l[5]||(l[5]=o=>k(f)?f.value=o:null),columns:t(z),"onUpdate:columns":l[6]||(l[6]=o=>k(z)?z.value=o:null),"line-height":t(L),"onUpdate:lineHeight":l[7]||(l[7]=o=>k(L)?L.value=o:null),stripe:t(N),"onUpdate:stripe":l[8]||(l[8]=o=>k(N)?N.value=o:null),style:{"margin-left":"12px"},onQueryData:ee},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),G((r(),p($,{border:t(j),data:t(v),size:t(L),stripe:t(N),"row-key":"id","expand-row-keys":t(h).expandedRows,onExpandChange:q},{empty:e(()=>[a(fe,{image:t(je),"image-size":300},null,8,["image"])]),default:e(()=>[a(b,{type:"expand",width:"55"},{default:e(o=>[a($,{data:o.row.children,"highlight-current-row":"",class:"hide-table-header",border:"",height:"100%"},{default:e(()=>[a(b,{width:"55"}),a(b,{width:"300",prop:"memberChildName",label:"名称+ID",align:"left"},{default:e(m=>[a(E,{class:"fontC-System"},{default:e(()=>[i(g(m.row.memberChildName),1)]),_:2},1024),Pe,G(a(E,{type:"danger",class:"fontC-System"},{default:e(()=>[i("随机id:"+g(m.row.randomIdentityId),1)]),_:2},1536),[[Ne,m.row.randomIdentityId]])]),_:1}),a(R,{prop:"status",label:"状态",align:"left"},{default:e(m=>[m.row.status===1?(r(),p(E,{key:0,type:"success",class:"fontC-System"},{default:e(()=>[i("前置问卷通过")]),_:1})):(r(),p(E,{key:1,type:"danger",class:"fontC-System"},{default:e(()=>[i("前置问卷未通过")]),_:1}))]),_:1}),a(R,{width:"200",align:"left",fixed:"right",label:"操作"},{default:e(m=>[a(D,{type:"primary",size:"small",plain:"",onClick:_=>oe(m.row)},{default:e(()=>[i(" 查看问卷详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:2},1032,["data"])]),_:1}),t(f).includes("projectId")?(r(),p(b,{key:0,width:"300",align:"left",prop:"projectId","show-overflow-tooltip":"",label:"项目ID"})):y("",!0),t(f).includes("projectName")?(r(),p(b,{key:1,align:"left",prop:"projectName","show-overflow-tooltip":"",label:"项目名称"},{default:e(({row:o})=>[U("div",$e,g(o.projectName),1)]),_:1})):y("",!0),t(f).includes("allocationType")?(r(),p(b,{key:2,align:"left","show-overflow-tooltip":"",width:"100",label:"分配类型"},{default:e(({row:o})=>[o.allocationType===1?(r(),p(V,{key:0,effect:"plain",type:"info",class:"mx-1"},{default:e(()=>[i("未分配")]),_:1})):y("",!0),o.allocationType===2?(r(),p(V,{key:1,effect:"dark",style:{"background-color":"#fb6868",border:"none"},class:"mx-1",type:"primary"},{default:e(()=>[i("供应商")]),_:1})):y("",!0),o.allocationType===3?(r(),p(V,{key:2,effect:"dark",style:{"background-color":"#05c9be",border:"none"},class:"mx-1",type:"warning"},{default:e(()=>[i("内部站")]),_:1})):y("",!0),o.allocationType===4?(r(),p(V,{key:3,effect:"dark",style:{"background-color":"#ffac54",border:"none"},class:"mx-1",type:"warning"},{default:e(()=>[i("合作商")]),_:1})):y("",!0)]),_:1})):y("",!0),t(f).includes("passNumber")?(r(),p(b,{key:3,align:"left","show-overflow-tooltip":"",label:"通过数/提交数"},{default:e(({row:o})=>[i(g(o.passNumber||0)+"/ "+g(o.submitNumber||0),1)]),_:1})):y("",!0),t(f).includes("passRate")?(r(),p(R,{key:4,align:"left","show-overflow-tooltip":"",prop:"passRate",label:"通过率"},{default:e(({row:o})=>[i(g(o.passRate+"%"),1)]),_:1})):y("",!0),a(R,{align:"left","show-overflow-tooltip":"",prop:"",fixed:"right",label:"操作",width:"200"},{default:e(({row:o})=>[a(P,{plain:"",type:"primary",size:"small",onClick:m=>q(o)},{default:e(()=>[i(g(t(h).expandedRows.includes(o.id)?"收起":"展开"),1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","data","size","stripe","expand-row-keys"])),[[ge,t(x)]]),a(_e,{"current-page":t(d).page,total:t(d).total,"page-size":t(d).size,"page-sizes":t(d).sizes,layout:t(d).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:te,onCurrentChange:ae},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),a(Be,{ref_key:"questionnaireDetailsRef",ref:B},null,512)],2)}}}),We=Ve(Ae,[["__scopeId","data-v-68128979"]]);export{We as default};
