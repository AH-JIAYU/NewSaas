
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as we,r as p,aM as Ee,$ as xe,n as ze,a as c,q as J,s as S,o as n,b as z,f as a,w as e,F,t as H,e as r,aH as Ie,g as i,A as _,i as D,aN as Ve,j as d,O as $e,aO as Re,E as Ae,_ as Be,aP as Ne,aQ as Te,be as Ue,ao as Le,aI as Me,aJ as Fe,v as He,M as Pe}from"./index-puGejJ6c.js";import{_ as Oe}from"./index.vue_vue_type_style_index_0_lang-CZKVSSDz.js";import{_ as Ye}from"./index.vue_vue_type_script_setup_true_lang-BqyJygVi.js";import{_ as je,a as Q}from"./index.vue_vue_type_script_setup_true_lang-BesafTlU.js";import{u as qe}from"./user_customer-DvOINNsm.js";import"./index-iPUX9fzH.js";import"./index.vue_vue_type_script_setup_true_lang-39t_ijWr.js";import"./index-BUCbtqtY.js";import"./index-CUmVAZCa.js";import"./index-SAQW-vwF.js";import"./clipboard-H53ocpNK.js";import"./index-CFfB7R5X.js";import"./department-seGLeyJu.js";import"./position_manage-Cb_w8K_K.js";import"./configuration_role-CgE4XECS.js";import"./tenant_role-DD26ESSk.js";import"./configuration_manager-wNI0w8HH.js";import"./configuration_siteSetting-BNl6df_X.js";import"./configuration_site_setting-C_W066o8.js";import"./apiLoading-Do9_i-IR.js";import"./stagedData-A7GL_opg.js";const Je=w=>(Me("data-v-e055c630"),w=w(),Fe(),w),Qe=Je(()=>He("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Ge=we({name:"invoice",__name:"list",setup(w){const G=qe(),P=p([]),{pagination:C,onSizeChange:K,onCurrentChange:W,onSortChange:Ke}=Ee(),X=p(""),O=p([]),b=p(!0),I=p(),V=p(!1),m=p([]),$=p(!0);p(!1);const R=p("default"),A=p(!0),Z=p([]),ee=[{lable:"未收款",value:1},{lable:"部分收款",value:2},{lable:"已完结",value:3},{lable:"坏账",value:4}],y=p(null),g=p([]),te=[{lable:"开票日期",value:1},{lable:"收款日期",value:2}],B=p([{label:"客户简称",prop:"tenantCustomerShortName",sortable:!0,disableCheck:!1,checked:!0},{label:"发票编号",prop:"invoiceCode",sortable:!0,disableCheck:!1,checked:!0},{label:"发票金额",prop:"invoiceAmount",sortable:!0,disableCheck:!1,checked:!0},{label:"手续费(税)",prop:"invoiceTax",sortable:!0,disableCheck:!1,checked:!0},{label:"实收款",prop:"actualReceipts",sortable:!0,disableCheck:!1,checked:!0},{label:"开票日期",prop:"invoiceDate",sortable:!0,disableCheck:!1,checked:!0},{label:"收款日期",prop:"paymentDate",sortable:!0,disableCheck:!1,checked:!0},{label:"状态",prop:"invoiceStatus",sortable:!0,disableCheck:!1,checked:!0},{label:"备注",prop:"remark",sortable:!0,disableCheck:!1,checked:!0}]),u=xe({page:1,limit:10,tenantCustomerId:"",invoiceStatus:[],invoiceDateStart:"",invoiceDateEnd:"",paymentDateStart:"",paymentDateEnd:""});function ae(){I.value.showEdit("")}function le(o){I.value.showEdit(JSON.stringify(o))}function oe(o){Re.confirm(`确认删除「${o.tenantCustomerShortName}」这条数据吗？`,"确认信息").then(()=>{try{b.value=!0,Q.delete({id:o.id}).then(()=>{b.value=!1,k(),Ae.success({message:"删除成功",center:!0})})}catch{}finally{b.value=!1}}).catch(()=>{})}function ne(o){Z.value=o}function se(){Object.assign(u,{page:1,limit:10,tenantCustomerId:"",invoiceStatus:[],invoiceDateStart:"",invoiceDateEnd:"",paymentDateStart:"",paymentDateEnd:""}),y.value=null,k()}const ie=o=>{y.value=o,g.value=[],u.invoiceDateStart="",u.invoiceDateEnd="",u.paymentDateStart="",u.paymentDateEnd="",h()},re=()=>{y.value===1?(u.invoiceDateStart=g.value[0],u.invoiceDateEnd=g.value[1]):(u.paymentDateStart=g.value[0],u.paymentDateEnd=g.value[1]),h()};function ue(o){K(o).then(()=>{u.limit=o,k()})}function h(o=1){W(o).then(()=>{u.page=o,k()})}async function k(){try{b.value=!0,P.value=await G.getCustomerList();const{data:o}=await Q.list(u);O.value=o.data,C.value.total=parseInt(o.total)||0,b.value=!1}catch{}finally{b.value=!1}}return ze(()=>{B.value.forEach(o=>{o.checked&&m.value.push(o.prop)}),k()}),(o,l)=>{const ce=c("el-option"),N=c("el-select"),E=c("el-form-item"),Y=c("ElOption"),pe=c("el-date-picker"),j=Be,T=c("ElButton"),de=c("ElFormItem"),me=c("el-form"),fe=Ye,ve=c("ElDivider"),x=c("el-button"),_e=Oe,be=Ne,ge=Te,he=c("el-row"),f=c("el-text"),v=c("el-table-column"),U=Ue,Ce=c("ElTableColumn"),ye=c("el-empty"),ke=c("el-table"),Se=c("ElPagination"),De=Le,L=J("auth"),q=J("loading");return S((n(),z("div",{class:$e({"absolute-container":V.value})},[a(De,null,{default:e(()=>[a(fe,{"show-toggle":!1},{default:e(({fold:t,toggle:M})=>[a(me,{model:u.select,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:e(()=>[a(E,{label:""},{default:e(()=>[a(N,{modelValue:u.tenantCustomerId,"onUpdate:modelValue":l[0]||(l[0]=s=>u.tenantCustomerId=s),placeholder:"客户简称",clearable:"",filterable:"",onChange:l[1]||(l[1]=s=>h())},{default:e(()=>[(n(!0),z(F,null,H(P.value,s=>(n(),r(ce,{key:s.tenantCustomerId,value:s.tenantCustomerId,label:s.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(E,{label:""},{default:e(()=>[a(N,{modelValue:u.invoiceStatus,"onUpdate:modelValue":l[2]||(l[2]=s=>u.invoiceStatus=s),placeholder:"发票状态",clearable:"",filterable:"",onChange:l[3]||(l[3]=s=>h()),multiple:!0},{default:e(()=>[(n(),z(F,null,H(ee,s=>a(Y,{label:s.lable,value:s.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(E,{label:""},{default:e(()=>[a(N,{modelValue:y.value,"onUpdate:modelValue":l[4]||(l[4]=s=>y.value=s),placeholder:"时间类型",clearable:"",filterable:"",onChange:ie},{default:e(()=>[(n(),z(F,null,H(te,s=>a(Y,{label:s.lable,value:s.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),S(a(E,null,{default:e(()=>[a(pe,{modelValue:g.value,"onUpdate:modelValue":l[5]||(l[5]=s=>g.value=s),disabled:!y.value,"value-format":"YYYY-MM-DD hh:mm:ss",type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:"",size:"",onChange:re},null,8,["modelValue","disabled"])]),_:2},1536),[[Ie,!t]]),a(de,null,{default:e(()=>[a(T,{type:"primary",onClick:l[6]||(l[6]=s=>h())},{icon:e(()=>[a(j,{name:"i-ep:search"})]),default:e(()=>[i(" 筛选 ")]),_:1}),a(T,{onClick:se},{icon:e(()=>[Qe]),default:e(()=>[i(" 重置 ")]),_:1}),a(T,{link:"",onClick:M},{icon:e(()=>[a(j,{name:t?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:e(()=>[i(" "+_(t?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),a(ve,{"border-style":"dashed"}),a(he,{gutter:24},{default:e(()=>[a(_e,null,{default:e(()=>[S((n(),r(x,{style:{"margin-right":"10px"},type:"primary",size:"default",onClick:ae},{default:e(()=>[i(" 新增发票 ")]),_:1})),[[L,"invoice-insert-insertTenantInvoice"]])]),_:1}),a(ge,null,{default:e(()=>[a(x,{size:"default",onClick:l[7]||(l[7]=()=>{})},{default:e(()=>[i(" 导出 ")]),_:1}),a(be,{border:$.value,"onUpdate:border":l[8]||(l[8]=t=>$.value=t),tableAutoHeight:V.value,"onUpdate:tableAutoHeight":l[9]||(l[9]=t=>V.value=t),checkList:m.value,"onUpdate:checkList":l[10]||(l[10]=t=>m.value=t),columns:B.value,"onUpdate:columns":l[11]||(l[11]=t=>B.value=t),"line-height":R.value,"onUpdate:lineHeight":l[12]||(l[12]=t=>R.value=t),stripe:A.value,"onUpdate:stripe":l[13]||(l[13]=t=>A.value=t),style:{"margin-left":"12px"},onQueryData:h},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),S((n(),r(ke,{ref_key:"tableSortRef",ref:X,style:{"margin-top":"10px"},"row-key":"id",data:O.value,border:$.value,class:"my-4",size:R.value,stripe:A.value,onSelectionChange:ne},{empty:e(()=>[a(ye,{image:D(Ve),"image-size":300},null,8,["image"])]),default:e(()=>[m.value.includes("tenantCustomerShortName")?(n(),r(v,{key:0,prop:"tenantCustomerShortName","show-overflow-tooltip":"",align:"left",width:"100",label:"客户简称"},{default:e(({row:t})=>[a(f,{class:"fontColor tableBig"},{default:e(()=>[i(_(t.tenantCustomerShortName),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceCode")?(n(),r(v,{key:1,prop:"invoiceCode","show-overflow-tooltip":"",align:"left",label:"发票编号"},{default:e(({row:t})=>[a(f,{class:"fontColor"},{default:e(()=>[i(_(t.invoiceCode),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceAmount")?(n(),r(v,{key:2,prop:"invoiceAmount","show-overflow-tooltip":"",align:"left",label:"发票金额"},{default:e(({row:t})=>[a(U),a(f,{class:"fontColor"},{default:e(()=>[i(_(t.invoiceAmount||0),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceTax")?(n(),r(v,{key:3,prop:"invoiceTax","show-overflow-tooltip":"",align:"left",label:"手续费(税)"},{default:e(({row:t})=>[a(U),a(f,{class:"fontColor"},{default:e(()=>[i(_(t.invoiceTax||0),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("actualReceipts")?(n(),r(v,{key:4,prop:"actualReceipts","show-overflow-tooltip":"",align:"left",label:"实收款"},{default:e(({row:t})=>[a(U),a(f,{class:"fontColor"},{default:e(()=>[i(_(t.actualReceipts||0),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceDate")?(n(),r(v,{key:5,prop:"invoiceDate","show-overflow-tooltip":"",align:"left",width:"180",label:"开票日期"},{default:e(({row:t})=>[a(f,{class:"fontColor"},{default:e(()=>[i(_(t.invoiceDate),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("paymentDate")?(n(),r(v,{key:6,prop:"paymentDate","show-overflow-tooltip":"",align:"left",width:"180",label:"收款日期"},{default:e(({row:t})=>[a(f,{class:"fontColor"},{default:e(()=>[i(_(t.paymentDate),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceStatus")?(n(),r(Ce,{key:7,align:"left","show-overflow-tooltip":"",prop:"invoiceStatus",label:"状态"},{default:e(({row:t})=>[t.invoiceStatus===1?(n(),r(f,{key:0,class:"mx-1 color1 fontC-System"},{default:e(()=>[i("未收款")]),_:1})):d("",!0),t.invoiceStatus===2?(n(),r(f,{key:1,class:"mx-1 color2 fontC-System"},{default:e(()=>[i("部分收款")]),_:1})):d("",!0),t.invoiceStatus===3?(n(),r(f,{key:2,class:"mx-1 color3 fontC-System"},{default:e(()=>[i("已完结")]),_:1})):d("",!0),t.invoiceStatus===4?(n(),r(f,{key:3,class:"mx-1 color4 fontC-System"},{default:e(()=>[i("坏账")]),_:1})):d("",!0)]),_:1})):d("",!0),m.value.includes("remark")?(n(),r(v,{key:8,prop:"remark",align:"left",label:"备注"},{default:e(({row:t})=>[a(f,{class:"mx-1 fontC-System"},{default:e(()=>[i(_(t.remark?t.remark:"-"),1)]),_:2},1024)]),_:1})):d("",!0),a(v,{align:"left",fixed:"right",label:"操作",width:"170"},{default:e(({row:t})=>[S((n(),r(x,{size:"small",plain:"",type:"primary",onClick:M=>le(t)},{default:e(()=>[i(" 编辑 ")]),_:2},1032,["onClick"])),[[L,"invoice-update-updateById"]]),S((n(),r(x,{size:"small",plain:"",type:"danger",onClick:M=>oe(t)},{default:e(()=>[i(" 删除 ")]),_:2},1032,["onClick"])),[[L,"invoice-delete-deleteById"]])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[q,!1]]),a(Se,{"current-page":D(C).page,total:D(C).total,"page-size":D(C).size,"page-sizes":D(C).sizes,layout:D(C).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:h,onSizeChange:ue},null,8,["current-page","total","page-size","page-sizes","layout"]),a(je,{onSuccess:k,ref_key:"editRef",ref:I},null,512)]),_:1})],2)),[[q,b.value]])}}}),gt=Pe(Ge,[["__scopeId","data-v-e055c630"]]);export{gt as default};
