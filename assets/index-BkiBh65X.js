
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Ae,aN as Ue,r as c,Z as De,n as Qe,a as d,q as Y,o as s,e as i,w as o,f as a,y as p,i as t,s as k,g,A as b,aM as Re,j as m,z as C,N as S,b as ee,t as Pe,F as Te,E as te,aO as $e,p as je,ba as Fe,bb as Me,_ as Be,bd as He,an as qe,L as Oe}from"./index-CdX1SWvD.js";import{_ as Ze}from"./index-D6-QzyWY.js";import{_ as Ge}from"./index.vue_vue_type_style_index_0_lang-BX74NFCb.js";import{_ as Je}from"./index-CBC7IjCF.js";import Ke from"./index-Dqn-UCia.js";import We from"./index-BYMoXc5J.js";import Xe from"./index-D7xWzthj.js";import Ye from"./index-DX51pola.js";import{s as oe}from"./apiLoading-CHn7qRD1.js";import{u as et}from"./user_customer-Bmkq1bh4.js";import{a as M}from"./user_customer-B5I6Tr6F.js";import tt from"./index-BJ7v02v3.js";import"./index-BFQ6v3bL.js";import"./clipboard-kKOjHgUA.js";import"./index.vue_vue_type_script_setup_true_lang-C9PPQVEO.js";import"./sortable.esm-C0-Qcoum.js";import"./index.vue_vue_type_script_setup_true_lang-YDrdTO4E.js";import"./index-iIjwdml9.js";import"./index-CDCSjnfM.js";import"./department-BZ6Etd8f.js";import"./position_manage-BkVuNIcL.js";import"./configuration_role-Cx8RzPtk.js";import"./tenant_role-DOLJ2eXz.js";import"./configuration_manager-fPh-4Uc3.js";import"./configuration_siteSetting-CncxpLV1.js";import"./configuration_site_setting-DodUJ0sS.js";import"./stagedData-AY2DKJud.js";import"./index.vue_vue_type_script_setup_true_lang-Bxg_ena7.js";import"./index-DnzPIMLP.js";import"./user_cooperation-DniXzOSP.js";import"./index-DepCjHwa.js";import"./index-BdrWTvKv.js";import"./index-zzI6aMoj.js";import"./index-v76oRNED.js";import"./index-CxsTRKus.js";const ot={class:"flex-c tableBig"},nt={class:"oneLine"},at={class:"flex-c tableBig"},lt={class:"oneLine",style:{width:"calc(100% - 20px)"}},st={class:"copyId tableSmall"},rt={class:"oneLine projectId"},it={class:"flex-c"},ct={class:"oneLine",style:{width:"calc(100% - 20px)"}},ut={style:{display:"inline-block"},class:"fontC-System"},dt={key:0,class:"fontC-System"},mt={class:"fontC-System"},pt=Ae({name:"customer",__name:"index",setup(ft){const ne=et(),{pagination:v,getParams:ae,onSizeChange:le,onCurrentChange:se}=Ue(),B=c([]),w=c(!1),H=c([]),V=c(),q=c(),O=c(),Z=c(),y=c(),re=c(),x=c(!1),I=c(!1),N=c(!1),E=c("default"),u=c([]),G=c(),ie=c("formSearch-customer"),L=c([{label:"客户编码",checked:!0,sortable:!0,prop:"tenantCustomerId"},{label:"客户名称",checked:!0,sortable:!0,prop:"customerAccord"},{label:"客户简称",checked:!0,sortable:!0,prop:"customerShortName"},{label:"PM",checked:!0,sortable:!0,prop:"chargeId"},{label:"关联项目数",checked:!0,sortable:!0,prop:"projectNumber"},{label:"客户状态",checked:!0,sortable:!0,prop:"customerStatus"},{label:"前置问卷",checked:!0,sortable:!0,prop:"antecedentQuestionnaire"},{label:"风险控制",checked:!0,sortable:!0,prop:"riskControl"},{label:"客户营业限额/月",checked:!0,sortable:!0,prop:"turnover"},{label:"审核率Min值",checked:!0,sortable:!0,prop:"rateAudit"}]);function ce(){V.value.showEdit()}function ue(n){V.value.showEdit(n)}async function A(n,l,R){const P={status:n,operationalType:l,tenantCustomerId:R},{status:_}=await oe(M.changestatus(P));_===1&&te.success({message:"修改成功"}),ne.customer=null,f()}function de(n){q.value.showEdit(n)}function me(n){n?y.value=n.tenantCustomerId:y.value=""}function J(n,l){O.value.showEdit(n,l)}function pe(n){Z.value.showEdit(n)}function fe(n){$e.confirm("您确定要删除当前项吗?","确认信息").then(async()=>{const{status:l}=await oe(M.delete({tenantCustomerId:n.tenantCustomerId}));l===1&&te.success({message:"删除成功"}),f()}).catch(()=>{})}const U=De({customerShortName:"",customerStatus:null,antecedentQuestionnaire:null}),_e=async()=>{const{data:n}=await je.getTenantStaffList();B.value=n};function he(n){le(n).then(()=>D())}function K(n=1){se(n).then(()=>D())}function ge(){Object.assign(U,{customerShortName:"",customerStatus:null,antecedentQuestionnaire:null}),f()}function f(){v.value.page=1,D()}async function D(){try{w.value=!0;const n={...ae(),...U},{data:l}=await M.list(n);H.value=l.getTenantCustomerInfoList,v.value.total=Number(l.total),w.value=!1}catch{}finally{w.value=!1}}function ve(n){re.value=n}Qe(async()=>{await _e(),L.value.forEach(n=>{n.checked&&u.value.push(n.prop)}),f(),G.value=[{index:1,show:!0,type:"input",modelName:"customerShortName",placeholder:"客户简称"},{index:2,show:!0,type:"select",modelName:"customerStatus",placeholder:"客户状态",option:"customerStatus",optionLabel:"label",optionValue:"value"},{index:3,show:!0,type:"select",modelName:"antecedentQuestionnaire",placeholder:"前置问卷",option:"antecedentQuestionnaire",optionLabel:"label",optionValue:"value"}]});const be={customerStatus:()=>[{label:"禁用",value:1},{label:"启用",value:2}],antecedentQuestionnaire:()=>[{label:"禁用",value:1},{label:"启用",value:2}]},Q=c("first");return(n,l)=>{const R=Je,P=d("ElDivider"),_=d("el-button"),Ce=Ge,ye=Fe,ke=Me,Se=d("el-row"),T=d("ElSwitch"),$=d("ElTableColumn"),W=Ze,h=d("el-table-column"),j=Be,F=d("el-text"),we=He,xe=d("ElSpace"),Ie=d("el-empty"),Ne=d("el-table"),Ee=d("ElPagination"),X=d("el-tab-pane"),Le=d("el-tabs"),ze=qe,z=Y("auth"),Ve=Y("loading");return s(),i(ze,null,{default:o(()=>[a(Le,{modelValue:t(Q),"onUpdate:modelValue":l[6]||(l[6]=e=>b(Q)?Q.value=e:null),class:"demo-tabs"},{default:o(()=>[a(X,{label:"我的客户",name:"first"},{default:o(()=>[p("div",{class:S({"absolute-container":t(N)})},[a(R,{formSearchList:t(G),formSearchName:t(ie),onCurrentChange:K,onOnReset:ge,model:t(U),formOption:be},null,8,["formSearchList","formSearchName","model"]),a(P,{"border-style":"dashed"}),a(Se,null,{default:o(()=>[a(Ce,null,{default:o(()=>[k((s(),i(_,{type:"primary",size:"default",onClick:ce},{default:o(()=>[g(" 新增 ")]),_:1})),[[z,"customer-get-addTenantCustomer"]])]),_:1}),a(ke,null,{default:o(()=>[a(_,{size:"default"},{default:o(()=>[g(" 导出 ")]),_:1}),a(ye,{border:t(x),"onUpdate:border":l[0]||(l[0]=e=>b(x)?x.value=e:null),tableAutoHeight:t(N),"onUpdate:tableAutoHeight":l[1]||(l[1]=e=>b(N)?N.value=e:null),checkList:t(u),"onUpdate:checkList":l[2]||(l[2]=e=>b(u)?u.value=e:null),columns:t(L),"onUpdate:columns":l[3]||(l[3]=e=>b(L)?L.value=e:null),"line-height":t(E),"onUpdate:lineHeight":l[4]||(l[4]=e=>b(E)?E.value=e:null),stripe:t(I),"onUpdate:stripe":l[5]||(l[5]=e=>b(I)?I.value=e:null),style:{"margin-left":"12px"},onQueryData:f},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),k((s(),i(Ne,{border:t(x),data:t(H),size:t(E),stripe:t(I),onSelectionChange:ve,"highlight-current-row":"",onCurrentChange:me},{empty:o(()=>[a(Ie,{image:t(Re),"image-size":300},null,8,["image"])]),default:o(()=>[t(u).includes("customerStatus")?(s(),i($,{key:0,align:"left","show-overflow-tooltip":"",prop:"customerStatus",label:"客户状态",width:"84"},{default:o(({row:e})=>[a(T,{modelValue:e.customerStatus,"onUpdate:modelValue":r=>e.customerStatus=r,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:r=>A(r,1,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):m("",!0),t(u).includes("customerAccord")?(s(),i(h,{key:1,align:"left",prop:"customerAccord","show-overflow-tooltip":"",label:"客户名称",width:"150"},{default:o(({row:e})=>[p("div",ot,[p("div",nt,C(e.customerAccord),1),a(W,{content:e.customerAccord,class:S({rowCopy:"rowCopy",current:e.tenantCustomerId===t(y)})},null,8,["content","class"])])]),_:1})):m("",!0),t(u).includes("customerShortName")?(s(),i(h,{key:2,align:"left",prop:"customerShortName","show-overflow-tooltip":"",label:"客户简称",width:"150"},{default:o(({row:e})=>[p("div",at,[p("div",lt,C(e.customerShortName),1),a(j,{onClick:r=>J(e,"customerShortName"),class:S({edit:"edit",current:e.tenantCustomerId===t(y)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):m("",!0),t(u).includes("tenantCustomerId")?(s(),i(h,{key:3,align:"left",prop:"tenantCustomerId","show-overflow-tooltip":"",label:"客户编码",width:"150"},{default:o(({row:e})=>[p("div",st,[p("div",rt,C(e.tenantCustomerId),1),a(W,{content:e.tenantCustomerId,class:S({rowCopy:"rowCopy",current:e.tenantCustomerId===t(y)})},null,8,["content","class"])])]),_:1})):m("",!0),t(u).includes("chargeId")?(s(),i(h,{key:4,align:"left",prop:"chargeId","show-overflow-tooltip":"",label:"PM"},{default:o(({row:e})=>[p("div",it,[p("div",ct,[(s(!0),ee(Te,null,Pe(t(B),r=>(s(),i(F,{key:r.id},{default:o(()=>[r.id===e.chargeId?(s(),i(F,{key:0,class:"fontC-System"},{default:o(()=>[g(C(r.userName),1)]),_:2},1024)):m("",!0)]),_:2},1024))),128))]),a(j,{onClick:r=>J(e,"chargeId"),class:S({edit:"edit",current:e.tenantCustomerId===t(y)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):m("",!0),t(u).includes("projectNumber")?(s(),i(h,{key:5,align:"left",prop:"turnover","show-overflow-tooltip":"",label:"关联项目数"},{default:o(({row:e})=>[p("span",ut,C(e.projectNumber||0),1),e.projectNumber?(s(),i(_,{key:0,text:"",type:"primary",size:"small",class:"p-1",onClick:r=>pe(e)},{default:o(()=>[a(j,{name:"mdi:cursor-default-click",size:"16px",color:"#409eff"})]),_:2},1032,["onClick"])):m("",!0)]),_:1})):m("",!0),t(u).includes("antecedentQuestionnaire")?(s(),i($,{key:6,align:"left","show-overflow-tooltip":"",prop:"antecedentQuestionnaire",label:"前置问卷"},{default:o(({row:e})=>[a(T,{modelValue:e.antecedentQuestionnaire,"onUpdate:modelValue":r=>e.antecedentQuestionnaire=r,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:r=>A(r,2,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):m("",!0),t(u).includes("riskControl")?(s(),i($,{key:7,align:"left","show-overflow-tooltip":"",prop:"riskControl",label:"风险控制"},{default:o(({row:e})=>[a(T,{modelValue:e.riskControl,"onUpdate:modelValue":r=>e.riskControl=r,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:r=>A(r,3,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):m("",!0),t(u).includes("turnover")?(s(),i(h,{key:8,align:"left",prop:"turnover","show-overflow-tooltip":"",label:"客户营业限额/月"},{default:o(({row:e})=>[e.turnover>0?(s(),ee("div",dt,[a(we),g(C(e.turnover),1)])):(s(),i(F,{key:1,class:"fontC-System"},{default:o(()=>[g("-")]),_:1}))]),_:1})):m("",!0),t(u).includes("rateAudit")?(s(),i(h,{key:9,align:"left",prop:"rateAudit","show-overflow-tooltip":"",label:"审核率Min值"},{default:o(({row:e})=>[p("div",mt,C(e.rateAudit?e.rateAudit:"-"),1)]),_:1})):m("",!0),a(h,{align:"left",fixed:"right",prop:"i",label:"操作",width:"200"},{default:o(({row:e})=>[a(xe,null,{default:o(()=>[k((s(),i(_,{size:"small",plain:"",type:"primary",onClick:r=>ue(e)},{default:o(()=>[g(" 编辑 ")]),_:2},1032,["onClick"])),[[z,"customer-update-updateTenantCustomer"]]),k((s(),i(_,{type:"warning",plain:"",size:"small",onClick:r=>de(e)},{default:o(()=>[g(" 详情 ")]),_:2},1032,["onClick"])),[[z,"customer-get-getTenantCustomerInfo"]]),k((s(),i(_,{type:"danger",plain:"",size:"small",onClick:r=>fe(e)},{default:o(()=>[g(" 删除 ")]),_:2},1032,["onClick"])),[[z,"customer-delete-deleteTenantCustomer"]])]),_:2},1024)]),_:1})]),_:1},8,["border","data","size","stripe"])),[[Ve,t(w)]]),a(Ee,{"current-page":t(v).page,total:t(v).total,"page-size":t(v).size,"page-sizes":t(v).sizes,layout:t(v).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:he,onCurrentChange:K},null,8,["current-page","total","page-size","page-sizes","layout"]),a(Ke,{ref_key:"editRef",ref:V,onFetchData:f},null,512),a(We,{ref_key:"QuickEditRef",ref:O,onFetchData:f},null,512),a(Xe,{ref_key:"AssociatedProjectsRef",ref:Z,onFetchData:f},null,512),a(Ye,{ref_key:"checkRef",ref:q,onFetchData:f},null,512)],2)]),_:1}),a(X,{label:"合作商户",name:"second"},{default:o(()=>[a(tt)]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Kt=Oe(pt,[["__scopeId","data-v-a1f34086"]]);export{Kt as default};
