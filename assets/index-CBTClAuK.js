
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as ge}from"./index-5PN0skIk.js";import{d as he,r as D,aO as ve,l as _e,a3 as R,b as c,q as ye,o as k,e as be,g as n,w as d,h as I,t as v,j as i,H as N,ay as $,s as w,aq as A,f as S,aN as Ce,k as B,I as Ee,aP as z,E as L,aB as De,N as ke,aI as Ie,aJ as Ve,R as xe,ao as q}from"./index-C-pApz5G.js";import Se from"./index-hfvdEiMu.js";import ze from"./index-CTDgi8rW.js";import{_ as Le}from"./index.vue_vue_type_script_setup_true_lang-DbRnTdbr.js";import{a as C}from"./dictionary-G7C7rM5v.js";const Ne=V=>(Ie("data-v-4bc94369"),V=V(),Ve(),V),$e={class:"absolute-container"},we={class:"page-main"},Be={class:"custom-tree-node"},Te=["title"],Pe={class:"code"},Ue={class:"actions"},Me={class:"dictionary-container"},Re={class:"dictionary-container"},Ae=Ne(()=>v("div",{class:"empty"},"请在左侧新增或选择一个字典",-1)),qe=[Ae],G=he({name:"PagesExampleDictionary",__name:"index",setup(V){const T=D(),a=D({search:"",tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""}}),{pagination:p,getParams:H,onSizeChange:j,onCurrentChange:F,onSortChange:J}=ve();p.value.size=20,p.value.sizes=[20,50,100];const O=D(),l=D({loading:!1,search:{dictionaryId:"",title:""},dataList:[],selectionDataList:[],dialog:{visible:!1,id:""}});function P(){l.value.search.dictionaryId="",C.list().then(e=>{a.value.tree=e.data})}_e(()=>{P()}),R(()=>a.value.search,e=>{T.value.filter(e)});function K(e,t){return e?t.label.includes(e):!0}function U(e){a.value.currentData=e,a.value.dialog.parentId=(e==null?void 0:e.id)??"",a.value.dialog.id="",a.value.dialog.visible=!0}function Q(e,t){a.value.currentNode=e,a.value.currentData=t,a.value.dialog.parentId=e.parent.data.id??"",a.value.dialog.id=t.id,a.value.dialog.visible=!0}function W(e,t){z.confirm(`确认删除「${t.label}」吗？`,"确认信息").then(()=>{C.delete(t.id).then(()=>{L.success({message:"模拟删除成功",center:!0});const r=e.parent,u=r.data.children||r.data,s=u.findIndex(m=>m.id===t.id);u.splice(s,1),a.value.tree=[...a.value.tree]})})}function X(e){a.value.currentData?(a.value.currentData.children||(a.value.currentData.children=[]),a.value.currentData.children.push({id:e.id,label:e.label,code:e.code})):a.value.tree.push({id:e.id,label:e.label,code:e.code})}function Y(e,t){if(a.value.currentNode&&a.value.currentData)if((a.value.currentNode.parent.data.id??"")===t)a.value.currentData.label=e.label,a.value.currentData.code=e.code;else{const r=a.value.currentNode.parent,u=r.data.children||r.data,s=u.findIndex(m=>m.id===e.id);if(u[s].label=e.label,u[s].code=e.code,t){const m=(_,x)=>{for(const b in _){if(_[b].id===x)return _[b];if(_[b].children){const g=m(_[b].children,x);if(g)return g}}},y=m(a.value.tree,t);y.children||(y.children=[]),y.children.push(u[s])}else a.value.tree.push(u[s]);u.splice(s,1)}}function Z(e){p.value.page=1,l.value.search.dictionaryId=e.id}R(()=>l.value.search.dictionaryId,()=>{f()});function f(){try{l.value.loading=!0;const e={...H(),dictionary_id:l.value.search.dictionaryId,...l.value.search.title&&{title:l.value.search.title}};C.itemList(e).then(t=>{l.value.loading=!1,l.value.dataList=t.data.list,l.value.dataList.forEach(r=>{r.enableLoading=!1}),p.value.total=t.data.total})}catch{}finally{l.value.loading=!1}}function ee(e){return new Promise(t=>{z.confirm(`确认${e.enable?"禁用":"启用"}「${e.name}」吗？`,"确认信息").then(()=>{e.enableLoading=!0,C.itemChangeEnable({id:e.id,enable:!e.enable}).then(()=>(e.enableLoading=!1,L.success({message:`模拟${e.enable?"禁用":"启用"}成功`,center:!0}),t(!0))).catch(()=>(e.enableLoading=!1,t(!1)))}).catch(()=>t(!1))})}function te(e){j(e).then(()=>f())}function ae(e=1){F(e).then(()=>f())}function ne({prop:e,order:t}){J(e,t).then(()=>f())}function ie(){l.value.dialog.id="",l.value.dialog.visible=!0}function le(e){l.value.dialog.id=e.id,l.value.dialog.visible=!0}function oe(e){z.confirm(`确认删除「${e.name}」吗？`,"确认信息").then(()=>{C.itemDelete(e.id).then(()=>{f(),L.success({message:"删除成功",center:!0})})}).catch(()=>{})}function de(e){z.confirm(`确认删除选中的 ${e.length} 条数据吗？`,"确认信息").then(()=>{C.itemDelete(e.map(t=>t.id)).then(()=>{f(),L.success({message:"删除成功",center:!0})})}).catch(()=>{})}const E=D(!1);return(e,t)=>{const r=c("ElButton"),u=De,s=ke,m=c("ElButtonGroup"),y=c("ElInput"),_=c("ElTree"),x=c("ElScrollbar"),b=c("ElSpace"),g=c("ElTableColumn"),re=c("ElTag"),se=c("ElSwitch"),ce=c("el-empty"),ue=c("ElTable"),pe=c("ElPagination"),me=ge,fe=ye("loading");return k(),be("div",$e,[n(u,{title:"字典管理",content:"页面数据为 Mock 示例数据，非真实数据。"},{default:d(()=>[n(r,{onClick:t[0]||(t[0]=o=>E.value=!0)},{default:d(()=>[I(" 使用示例 ")]),_:1})]),_:1}),v("div",we,[n(me,{"hide-left-side-toggle":""},{leftSide:d(()=>[n(m,{class:"btns"},{default:d(()=>[n(r,{type:"primary",class:"add",onClick:t[1]||(t[1]=o=>U())},{default:d(()=>[I(" 新增字典 ")]),_:1}),n(r,{onClick:P},{icon:d(()=>[n(s,{name:"i-ep:refresh"})]),_:1})]),_:1}),n(y,{modelValue:i(a).search,"onUpdate:modelValue":t[2]||(t[2]=o=>i(a).search=o),placeholder:"请输入关键词筛选字典",clearable:"",class:"search"},null,8,["modelValue"]),n(x,{class:"tree"},{default:d(()=>[n(_,{ref_key:"dictionaryRef",ref:T,data:i(a).tree,"filter-node-method":K,"default-expand-all":"",onNodeClick:Z},{default:d(({node:o,data:h})=>[v("div",Be,[v("div",{class:"label",title:o.label},N(o.label),9,Te),v("div",Pe,N(h.code),1),v("div",Ue,[n(m,null,{default:d(()=>[n(r,{type:"primary",plain:"",size:"default",onClick:$(M=>U(h),["stop"])},{icon:d(()=>[n(s,{name:"i-ep:plus"})]),_:2},1032,["onClick"]),n(r,{type:"info",plain:"",size:"default",onClick:$(M=>Q(o,h),["stop"])},{icon:d(()=>[n(s,{name:"i-ep:edit"})]),_:2},1032,["onClick"]),n(r,{type:"danger",plain:"",size:"default",onClick:$(M=>W(o,h),["stop"])},{icon:d(()=>[n(s,{name:"i-ep:delete"})]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])]),_:1})]),default:d(()=>[w(v("div",Me,[n(b,{wrap:""},{default:d(()=>[n(r,{type:"primary",onClick:ie},{icon:d(()=>[n(s,{name:"i-ep:plus"})]),_:1}),n(r,{type:"danger",disabled:!i(l).selectionDataList.length,onClick:t[3]||(t[3]=o=>de(i(l).selectionDataList))},{icon:d(()=>[n(s,{name:"i-ep:delete"})]),_:1},8,["disabled"]),n(y,{modelValue:i(l).search.title,"onUpdate:modelValue":t[4]||(t[4]=o=>i(l).search.title=o),placeholder:"请输入关键词筛选字典项",clearable:"",style:{width:"200px"}},null,8,["modelValue"]),n(r,{onClick:f},{icon:d(()=>[n(s,{name:"i-ep:search"})]),_:1})]),_:1}),w((k(),S(ue,{ref_key:"dictionaryItemRef",ref:O,data:i(l).dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:ne,onSelectionChange:t[5]||(t[5]=o=>i(l).selectionDataList=o)},{empty:d(()=>[n(ce,{image:i(Ce),"image-size":300},null,8,["image"])]),default:d(()=>[n(g,{type:"selection",align:"center",fixed:""}),n(g,{prop:"name",label:"名称"}),n(g,{label:"键值",align:"center",width:"150"},{default:d(o=>[n(re,{type:"info"},{default:d(()=>[I(N(o.row.value),1)]),_:2},1024)]),_:1}),n(g,{label:"状态",width:"100",align:"center"},{default:d(o=>[n(se,{modelValue:o.row.enable,"onUpdate:modelValue":h=>o.row.enable=h,loading:o.row.enableLoading,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>ee(o.row)},null,8,["modelValue","onUpdate:modelValue","loading","before-change"])]),_:1}),n(g,{label:"操作",width:"200",align:"center"},{default:d(o=>[n(r,{type:"primary",size:"small",plain:"",onClick:h=>le(o.row)},{default:d(()=>[I(" 编辑 ")]),_:2},1032,["onClick"]),n(r,{type:"danger",size:"small",plain:"",onClick:h=>oe(o.row)},{default:d(()=>[I(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[fe,i(l).loading]]),n(pe,{"current-page":i(p).page,total:i(p).total,"page-size":i(p).size,"page-sizes":i(p).sizes,layout:i(p).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:te,onCurrentChange:ae},null,8,["current-page","total","page-size","page-sizes","layout"])],512),[[A,i(l).search.dictionaryId]]),w(v("div",Re,qe,512),[[A,!i(l).search.dictionaryId]])]),_:1}),i(a).dialog.visible?(k(),S(Se,{key:0,id:i(a).dialog.id,modelValue:i(a).dialog.visible,"onUpdate:modelValue":t[6]||(t[6]=o=>i(a).dialog.visible=o),"parent-id":i(a).dialog.parentId,tree:i(a).tree,onAddNode:X,onEditNode:Y},null,8,["id","modelValue","parent-id","tree"])):B("",!0),i(l).dialog.visible?(k(),S(ze,{key:1,id:i(l).dialog.id,modelValue:i(l).dialog.visible,"onUpdate:modelValue":t[7]||(t[7]=o=>i(l).dialog.visible=o),"dictionary-id":i(l).search.dictionaryId,tree:i(a).tree,onSuccess:f},null,8,["id","modelValue","dictionary-id","tree"])):B("",!0),i(E)?(k(),S(Le,{key:2,modelValue:i(E),"onUpdate:modelValue":t[8]||(t[8]=o=>Ee(E)?E.value=o:null)},null,8,["modelValue"])):B("",!0)])])}}});typeof q=="function"&&q(G);const Ke=xe(G,[["__scopeId","data-v-4bc94369"]]);export{Ke as default};
