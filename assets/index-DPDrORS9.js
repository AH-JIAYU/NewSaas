
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Q,r as p,c as W,a as s,o as i,b as f,f as o,w as n,g as c,i as l,F as X,t as Y,e as _,y as d,z as I,j as v,A as Z,E as L,_ as ee,aH as te,aI as oe,aE as ae,L as ne}from"./index-CgGiKMhT.js";import{c as E}from"./user_cooperation-DbmetJsM.js";import{_ as re}from"./index.vue_vue_type_script_setup_true_lang-CElZmdO1.js";import"./department-DMxm4WQF.js";const S=g=>(te("data-v-9c0886f9"),g=g(),oe(),g),le={style:{float:"left"}},se={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"0.8125rem"}},ie={key:0},ce={key:1},de={key:3,style:{display:"flex"},class:"inviteDialog"},me={slot:"label",style:{"margin-right":"15px"}},ue=S(()=>d("span",{style:{color:"#F56C6C"}},"*",-1)),pe={slot:"label",style:{"margin-right":"15px"}},fe=S(()=>d("span",{style:{color:"#F56C6C"}},"*",-1)),_e=Q({__name:"index",emits:["fetch-data"],setup(g,{expose:R,emit:D}){const F=D,m=p(!1);p("");const T=p(),e=p({form:{},tenantUserList:[],tenantStaffList:[],chargeUserId:null,departmentId:null,chargeUserName:"",rules:{beInvitationTenantId:[{required:!0,message:"请选择租户",trigger:"change"}],priceRatio:[{required:!0,message:"请输入价格比例",trigger:"blur"}],sendProjectType:[{required:!0,message:"请选择发送项目",trigger:"change"}],receiveProjectType:[{required:!0,message:"请选择接收项目",trigger:"change"}]}});async function q(){await A(),m.value=!0}async function A(){const t=await E.getTenantUserList({});e.value.tenantUserList=t.data.tenantUserInfoList}const U=W(()=>{const t=e.value.tenantUserList.find(a=>a.tenantId===e.value.form.beInvitationTenantId);return t?(e.value.form.tenantName=t.name,e.value.form.phoneOrEmail=ae.local.get("account"),[t]):[]});function k(){m.value=!1,e.value.form={},T.value.resetFields()}async function w(){T.value.validate(t=>{if(t){let a=JSON.parse(JSON.stringify(e.value.form));a.sendProjectType=e.value.form.sendProjectType.length!=0?e.value.form.sendProjectType[0]:null,a.receiveProjectType=e.value.form.receiveProjectType.length!=0?e.value.form.receiveProjectType[0]:null,a.receiveProjectType==2&&(e.value.form.chargeUserId=null,e.value.form.chargeUserName="",e.value.form.invitationType="",a.chargeUserId=null,a.chargeUserName="",a.invitationType=""),E.addInvitationBind(a).then(y=>{y.status==-1?L.success({message:y.error,center:!0}):(L.success({message:"发送成功",center:!0}),F("fetch-data"),k())})}})}R({showEdit:q});const j=p();function B(){let t={chargeUserId:e.value.form.chargeUserId,invitationType:e.value.form.invitationType,chargeUserName:e.value.form.chargeUserName};j.value.showEdit(t)}function O(t){e.value.form.chargeUserId=t.chargeUserId,e.value.form.invitationType=t.invitationType,e.value.form.chargeUserName=t.chargeUserName}const z=t=>{Array.isArray(t)&&t.length>1&&(e.value.form.sendProjectType=[t[t.length-1]])},J=t=>{Array.isArray(t)&&t.length>1&&(e.value.form.receiveProjectType=[t[t.length-1]])},K=t=>{t.preventDefault()};return(t,a)=>{const y=s("el-option"),$=s("el-select"),u=s("el-form-item"),h=s("el-table-column"),H=s("el-table"),P=s("el-input"),x=ee,N=s("el-tooltip"),b=s("el-checkbox"),C=s("el-checkbox-group"),M=s("ElForm"),V=s("el-button"),G=s("el-dialog");return i(),f("div",null,[o(G,{modelValue:l(m),"onUpdate:modelValue":a[5]||(a[5]=r=>Z(m)?m.value=r:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:"邀约公司"},{footer:n(()=>[o(V,{onClick:k},{default:n(()=>[c(" 关闭 ")]),_:1}),o(V,{type:"primary",onClick:w},{default:n(()=>[c(" 发送邀约 ")]),_:1})]),default:n(()=>[o(M,{ref_key:"formRef",ref:T,rules:l(e).rules,model:l(e).form,"label-width":"7rem",labelPosition:"left"},{default:n(()=>[o(u,{label:"公司名称",prop:"beInvitationTenantId"},{default:n(()=>[o($,{modelValue:l(e).form.beInvitationTenantId,"onUpdate:modelValue":a[0]||(a[0]=r=>l(e).form.beInvitationTenantId=r),clearable:""},{default:n(()=>[(i(!0),f(X,null,Y(l(e).tenantUserList,r=>(i(),_(y,{key:r.tenantId,value:r.tenantId,label:r.tenantName},{default:n(()=>[d("span",le,I(r.tenantName),1),d("span",se,I(r.tenantId),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(U).length?(i(),_(H,{key:0,data:l(U),border:"",stripe:"",style:{"margin-bottom":"18px"}},{default:n(()=>[o(h,{prop:"name",label:"用户名"}),o(h,{prop:"tenantName",label:"公司名称"}),o(h,{prop:"country",label:"区域"}),o(h,{label:"电子邮箱/手机号"},{default:n(({row:r})=>[r.phone?(i(),f("span",ie,I(r.phone),1)):(i(),f("span",ce,I(r.email),1))]),_:1})]),_:1},8,["data"])):v("",!0),l(e).form.beInvitationTenantId?(i(),_(u,{key:1,label:"价格比例",prop:"priceRatio"},{default:n(()=>[o(P,{modelValue:l(e).form.priceRatio,"onUpdate:modelValue":a[1]||(a[1]=r=>l(e).form.priceRatio=r),clearable:""},{append:n(()=>[c("%")]),_:1},8,["modelValue"])]),_:1})):v("",!0),l(e).form.beInvitationTenantId?(i(),_(u,{key:2,label:"项目分配方式","label-width":"7rem"})):v("",!0),l(e).form.beInvitationTenantId?(i(),f("div",de,[o(u,{prop:"sendProjectType"},{default:n(()=>[d("span",me,[o(N,{effect:"dark",content:"1111111",placement:"top-start"},{default:n(()=>[o(x,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1}),ue,c(" 发送项目 ")]),o(C,{modelValue:l(e).form.sendProjectType,"onUpdate:modelValue":a[2]||(a[2]=r=>l(e).form.sendProjectType=r),onChange:z},{default:n(()=>[o(b,{value:1},{default:n(()=>[c(" 自动 ")]),_:1}),o(b,{value:2},{default:n(()=>[c(" 手动 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(u,{prop:"receiveProjectType",style:{"margin-left":"40px"}},{default:n(()=>[d("span",pe,[o(N,{effect:"dark",content:"1111111",placement:"top-start"},{default:n(()=>[o(x,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1}),fe,c(" 接收项目 ")]),o(C,{modelValue:l(e).form.receiveProjectType,"onUpdate:modelValue":a[3]||(a[3]=r=>l(e).form.receiveProjectType=r),onChange:J},{default:n(()=>[o(b,{value:1},{default:n(()=>[c(" 自动 ")]),_:1}),o(b,{value:2},{default:n(()=>[c(" 手动 ")]),_:1})]),_:1},8,["modelValue"])]),_:1})])):v("",!0),l(e).form.receiveProjectType&&l(e).form.receiveProjectType[0]==1?(i(),_(P,{key:4,placeholder:"请选择接收项目负责人",onKeydown:K,onClick:B,modelValue:l(e).form.chargeUserName,"onUpdate:modelValue":a[4]||(a[4]=r=>l(e).form.chargeUserName=r)},null,8,["modelValue"])):v("",!0)]),_:1},8,["rules","model"])]),_:1},8,["modelValue"]),o(re,{ref_key:"userRef",ref:j,onUserData:O},null,512)])}}}),be=ne(_e,[["__scopeId","data-v-9c0886f9"]]);export{be as default};
