
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as re,aO as pe,r as s,a5 as q,c as ce,l as ue,b as u,q as de,o as i,e as me,g as l,w as o,j as e,h as r,I as b,s as B,f as p,aN as fe,H as v,aq as _e,k as _,S as he,aQ as ge,aR as ye,ap as be,aI as ve,aJ as we,t as ke,R as Ie}from"./index-DVhsY0JD.js";import{_ as Ce}from"./index.vue_vue_type_style_index_0_lang-DVwz6MO4.js";import{_ as xe}from"./index-kPqt3ZH9.js";import{_ as Le,a as $}from"./index.vue_vue_type_script_setup_true_lang-B9pbA4Mo.js";import{u as Ne}from"./user_customer-X4h_rKqF.js";import"./index.vue_vue_type_script_setup_true_lang-DwV7rWIN.js";import"./sortable.esm-C0-Qcoum.js";/* empty css                      */import"./user_customer-BVjRuEmv.js";const Se=k=>(ve("data-v-06fe3005"),k=k(),we(),k),je=Se(()=>ke("br",null,null,-1)),Re=re({name:"preInvestigationRecords",__name:"index",setup(k){const O=Ne(),{getParams:V,pagination:c,onSizeChange:A,onCurrentChange:F}=pe(),I=s(!1),T=s([]);s("");const d=s([]),C=s(!1),x=s(!1),L=s("default"),N=s(!1),z=s(),M=s("formSearch-preInvestigationRecords"),S=s([{prop:"projectId",label:"项目ID",sortable:!0,checked:!0},{prop:"projectName",label:"项目名称",sortable:!0,checked:!0},{prop:"allocationType",label:"分配类型",sortable:!0,checked:!0},{prop:"passNumber",label:"通过数/提交数",sortable:!0,checked:!0},{prop:"passRate",label:"通过率",sortable:!0,checked:!0}]),m=q({projectId:"",projectName:"",allocationType:""}),D=s(),h=q({allocationTypeList:["未分配","供应商","会员组"],surveyStatusList:["完成","被甄别","配额满","安全终止","未完成"],viceStatusList:["待审","免审","过IR","时间果断","超时完成","超量完成","审核成功","审核失败","数据冻结","时间段过载","ip不一致","id重复参与","和解"],customerList:[],vipList:[],vipGroupList:[],tenantSupplierList:[],expandedRows:[]});function Q(){m.pageNo=1,w()}function G(n){A(n).then(()=>w())}function E(n=1){F(n).then(()=>w())}async function H(n){const a=h.expandedRows.indexOf(n.id);if(a!==-1?h.expandedRows.splice(a,1):h.expandedRows.push(n.id),!n.children){const R=await $.childList({projectId:n.projectId});n.children=R.data.projectScreenMemberChildInfoList}}function J(n){D.value.showEdit(n)}const K=ce(()=>T.value.filter(a=>{if(a.projectId.includes(m.projectId)&&a.projectName.includes(m.projectName)&&(!m.allocationType||a.allocationType===m.allocationType))return!0}).slice((c.value.page-1)*c.value.size,c.value.page*c.value.size));async function w(){try{I.value=!0;const n={...V(),...m},{data:a}=await $.list(n);T.value=a.projectSurveyScreenInfoList,c.value.total=a.projectSurveyScreenInfoList.length,I.value=!1}catch{}finally{I.value=!1}}function W(){Object.assign(m,{projectId:"",projectName:"",allocationType:""}),w()}ue(async()=>{h.customerList=await O.getCustomerList(),S.value.forEach(n=>{n.checked&&d.value.push(n.prop)}),w(),z.value=[{index:1,show:!0,type:"input",modelName:"projectId",placeholder:"项目ID"},{index:2,show:!0,type:"input",modelName:"projectName",placeholder:"项目名称"},{index:3,show:!0,type:"select",modelName:"allocationType",placeholder:"分配类型",option:"allocationType",optionLabel:"label",optionValue:"value"}]});const X={allocationType:()=>h.allocationTypeList.map((n,a)=>({label:n,value:a+1}))};return(n,a)=>{const R=xe,Y=u("ElDivider"),Z=Ce,P=u("el-button"),ee=ge,te=ye,ae=u("el-row"),g=u("el-table-column"),y=u("el-text"),j=u("ElTableColumn"),oe=u("ElButton"),U=u("el-table"),le=u("el-empty"),ne=u("ElPagination"),se=be,ie=de("loading");return i(),me("div",{class:he({"absolute-container":e(N)})},[l(se,null,{default:o(()=>[l(R,{formSearchList:e(z),formSearchName:e(M),onCurrentChange:E,onOnReset:W,model:e(m),formOption:X},null,8,["formSearchList","formSearchName","model"]),l(Y,{"border-style":"dashed"}),l(ae,null,{default:o(()=>[l(Z),l(te,null,{default:o(()=>[l(P,{size:"default"},{default:o(()=>[r(" 导出 ")]),_:1}),l(ee,{border:e(C),"onUpdate:border":a[0]||(a[0]=t=>b(C)?C.value=t:null),tableAutoHeight:e(N),"onUpdate:tableAutoHeight":a[1]||(a[1]=t=>b(N)?N.value=t:null),checkList:e(d),"onUpdate:checkList":a[2]||(a[2]=t=>b(d)?d.value=t:null),columns:e(S),"onUpdate:columns":a[3]||(a[3]=t=>b(S)?S.value=t:null),"line-height":e(L),"onUpdate:lineHeight":a[4]||(a[4]=t=>b(L)?L.value=t:null),stripe:e(x),"onUpdate:stripe":a[5]||(a[5]=t=>b(x)?x.value=t:null),style:{"margin-left":"12px"},onQueryData:Q},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),B((i(),p(U,{border:e(C),data:e(K),size:e(L),stripe:e(x),"row-key":"id","expand-row-keys":e(h).expandedRows,onExpandChange:H},{empty:o(()=>[l(le,{image:e(fe),"image-size":300},null,8,["image"])]),default:o(()=>[l(g,{type:"expand",width:"55"},{default:o(t=>[l(U,{data:t.row.children,"highlight-current-row":"",class:"hide-table-header",border:"",height:"100%"},{default:o(()=>[l(g,{width:"55"}),l(g,{width:"300",prop:"memberChildName",label:"名称+ID",align:"left"},{default:o(f=>[l(y,null,{default:o(()=>[r(v(f.row.memberChildName),1)]),_:2},1024),je,B(l(y,{type:"danger"},{default:o(()=>[r("随机id:"+v(f.row.randomIdentityId),1)]),_:2},1536),[[_e,f.row.randomIdentityId]])]),_:1}),l(j,{prop:"status",label:"状态",align:"left"},{default:o(f=>[f.row.status===1?(i(),p(y,{key:0,type:"success"},{default:o(()=>[r("前置问卷通过")]),_:1})):(i(),p(y,{key:1,type:"danger"},{default:o(()=>[r("前置问卷未通过")]),_:1}))]),_:1}),l(j,{width:"200",align:"left",fixed:"right",label:"操作"},{default:o(f=>[l(oe,{type:"primary",size:"small",plain:"",onClick:Te=>J(f.row)},{default:o(()=>[r(" 查看问卷详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:2},1032,["data"])]),_:1}),e(d).includes("projectId")?(i(),p(g,{key:0,width:"300",align:"left",prop:"projectId","show-overflow-tooltip":"",label:"项目ID"})):_("",!0),e(d).includes("projectName")?(i(),p(g,{key:1,align:"left",prop:"projectName","show-overflow-tooltip":"",label:"项目名称"})):_("",!0),e(d).includes("allocationType")?(i(),p(g,{key:2,align:"left","show-overflow-tooltip":"",width:"100",label:"分配类型"},{default:o(({row:t})=>[t.allocationType===3?(i(),p(y,{key:0,type:"primary"},{default:o(()=>[r("会员组")]),_:1})):_("",!0),t.allocationType===2?(i(),p(y,{key:1,type:"success"},{default:o(()=>[r("供应商")]),_:1})):_("",!0),t.allocationType===1?(i(),p(y,{key:2,type:"warning"},{default:o(()=>[r("未分配")]),_:1})):_("",!0)]),_:1})):_("",!0),e(d).includes("passNumber")?(i(),p(g,{key:3,align:"left","show-overflow-tooltip":"",label:"通过数/提交数"},{default:o(({row:t})=>[r(v(t.passNumber||0)+"/ "+v(t.submitNumber||0),1)]),_:1})):_("",!0),e(d).includes("passRate")?(i(),p(j,{key:4,align:"left","show-overflow-tooltip":"",prop:"passRate",label:"通过率"},{default:o(({row:t})=>[r(v(t.passRate+"%"),1)]),_:1})):_("",!0),l(j,{align:"left","show-overflow-tooltip":"",prop:"",fixed:"right",label:"操作",width:"200"},{default:o(({row:t})=>[l(P,{plain:"",type:"primary",size:"small",onClick:f=>H(t)},{default:o(()=>[r(v(e(h).expandedRows.includes(t.id)?"收起":"展开"),1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","data","size","stripe","expand-row-keys"])),[[ie,e(I)]]),l(ne,{"current-page":e(c).page,total:e(c).total,"page-size":e(c).size,"page-sizes":e(c).sizes,layout:e(c).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:G,onCurrentChange:E},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),l(Le,{ref_key:"questionnaireDetailsRef",ref:D},null,512)],2)}}}),Oe=Ie(Re,[["__scopeId","data-v-06fe3005"]]);export{Oe as default};
