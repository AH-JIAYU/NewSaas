
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as Y}from"./index-DJKeF4wo.js";import{a as Z}from"./department-DGbjn1Vh.js";import{d as $,r as m,a as c,o as u,b as g,f as i,w as l,y as p,g as b,i as s,A as S,F as j,t as T,z as U,j as D,e as x,p as ee,aH as te,aI as ae,L as le}from"./index-CtlW-OTR.js";const C=y=>(te("data-v-b979ce82"),y=y(),ae(),y),se={key:0},ne=C(()=>p("span",{class:"project-name"},"项目",-1)),oe={class:"project-content"},ce={style:{display:"flex"}},de={style:{"font-weight":"500"}},ie={style:{"margin-left":"10px"}},re=C(()=>p("span",{class:"custom-tab-label"},"部门",-1)),ue=C(()=>p("div",{style:{color:"#333333","font-weight":"500","font-size":"14px","margin-bottom":"10px"}}," 分配部门 ",-1)),pe=C(()=>p("span",{class:"custom-tab-label",style:{"margin-left":"20px"}},"员工",-1)),fe={class:"flex-c"},_e=$({__name:"index",emits:["userData"],setup(y,{expose:B,emit:K}){const f=m(!1),d=m([]),L=m([]),h=m(),t=m({type:1,tenantStaffList:[],roleList:[],title:"",project:[]}),w={children:"children",label:"name"};async function A(e,a,o){await E(),t.value.type=1,f.value=!0,d.value=[];const r=await Z.list({name:""});r.data&&(L.value=r.data),e&&(e.invitationType==1?e.chargeUserId&&(t.value.roleList=[e.chargeUserId],t.value.chargeUserName=e.chargeUserName):e.invitationType==2&&(d.value=[e.chargeUserId],t.value.chargeUserName=e.chargeUserName)),t.value.title=a,o&&(t.value.project=o)}const E=async()=>{const e=await ee.getTenantStaffList();t.value.tenantStaffList=e.data};function R(){f.value=!1}const z=(e,a)=>{a?(h.value.getCheckedKeys().forEach(r=>{r!==e.id&&h.value.setChecked(r,!1)}),d.value=[e.id]):d.value=d.value.filter(o=>o!==e.id),d.value.length&&(t.value.roleList=[])},F=()=>{},H=e=>{Array.isArray(e)&&e.length>1&&(t.value.roleList=[e[e.length-1]]),t.value.roleList.length!=0&&(d.value=[],h.value.setCheckedKeys([]))};B({showEdit:A});const P=K;function q(){let e="",a=null,o=null;t.value.roleList[0]&&(e=t.value.tenantStaffList.find(v=>v.id===t.value.roleList[0]).userName,a=t.value.roleList[0],o=1),d.value[0]&&(e=h.value.getCheckedNodes().map(v=>v.name)[0],a=d.value[0],o=2);let r={chargeUserId:a,chargeUserName:e,invitationType:o};f.value=!1,P("userData",r)}const k=m([]),G=e=>{k.value=e};return(e,a)=>{const o=c("el-badge"),r=Y,N=c("el-collapse-item"),v=c("el-collapse"),J=c("el-tree"),M=c("el-text"),I=c("el-tab-pane"),O=c("el-checkbox"),Q=c("el-checkbox-group"),W=c("el-tabs"),V=c("el-button"),X=c("el-dialog");return u(),g("div",null,[i(X,{modelValue:s(f),"onUpdate:modelValue":a[3]||(a[3]=n=>S(f)?f.value=n:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:s(t).title,class:"userClass"},{footer:l(()=>[p("div",fe,[i(V,{onClick:R},{default:l(()=>[b(" 取消 ")]),_:1}),i(V,{type:"primary",onClick:q},{default:l(()=>[b(" 确认 ")]),_:1})])]),default:l(()=>[s(t).project.length!=0?(u(),g("div",se,[i(v,{modelValue:s(k),"onUpdate:modelValue":a[0]||(a[0]=n=>S(k)?k.value=n:null),onChange:G},{default:l(()=>[i(N,{name:"1"},{title:l(()=>[ne,i(o,{value:s(t).project.length,max:99,class:"item"},null,8,["value"])]),default:l(()=>[p("div",oe,[(u(!0),g(j,null,T(s(t).project,n=>(u(),g("div",{key:n.id},[p("div",ce,[p("span",de,U(n.tenantName),1),p("span",ie,"ID:"+U(n.tenantId),1),i(r,{content:n.tenantId},null,8,["content"])])]))),128))])]),_:1})]),_:1},8,["modelValue"])])):D("",!0),i(W,{modelValue:s(t).type,"onUpdate:modelValue":a[2]||(a[2]=n=>s(t).type=n),onTabChange:F,class:"tabs-user"},{default:l(()=>[i(I,{label:"部门",name:1},{label:l(()=>[re]),default:l(()=>[ue,s(L).length>0?(u(),x(J,{key:0,style:{"max-width":"600px"},ref_key:"treeRef",ref:h,disabled:!0,data:s(L),"show-checkbox":"","check-strictly":"","node-key":"id","default-expanded-keys":[],"default-checked-keys":s(d),"default-expand-all":"",props:w,onCheckChange:z,"check-on-click-node":!0,"expand-on-click-node":!1},null,8,["data","default-checked-keys"])):(u(),x(M,{key:1},{default:l(()=>[b("暂无数据")]),_:1}))]),_:1}),i(I,{name:2},{label:l(()=>[pe]),default:l(()=>{var n;return[(n=s(t).tenantStaffList)!=null&&n.length?(u(),x(Q,{key:0,onChange:H,modelValue:s(t).roleList,"onUpdate:modelValue":a[1]||(a[1]=_=>s(t).roleList=_)},{default:l(()=>[(u(!0),g(j,null,T(s(t).tenantStaffList,_=>(u(),x(O,{key:_.id,value:_.id,label:_.userName},{default:l(()=>[b(U(_.userName),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])):D("",!0)]}),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"])])}}}),ge=le(_e,[["__scopeId","data-v-b979ce82"]]);export{ge as u};
