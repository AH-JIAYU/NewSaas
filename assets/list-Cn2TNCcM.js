
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as L,d as ee,a1 as le,r as m,l as ae,b as i,q as te,s as oe,o as ne,e as se,g as e,w as l,S as ue,j as ie,bk as re,t as g,h as c,H as de,E as x,a0 as me,aB as pe,ap as fe,aI as ve,aJ as ce,R as _e}from"./index-ODJju0Ft.js";import{u as ge}from"./index-BbInNSLR.js";import be from"./index-DOXGgKvW.js";import"./clipboard-BXhx2kXG.js";const q={list:()=>L.post("tenant-web-config/getTenantWebConfig"),edit:d=>L.post("tenant-web-config/updateTenantWebConfig",d)},ye={getTenantLogo:d=>L.post("tenant-logo/getTenantLogo",d),uploadLogo:d=>L.post("tenant-logo/upload",d)},V=d=>(ve("data-v-3180f7a8"),d=d(),ce(),d),Ve=V(()=>g("div",{class:"el-upload__tip"}," 支持上传JPG/JPEG/PNG图片，小于10MB ",-1)),we=["src"],he=V(()=>g("span",{class:"red"},null,-1)),xe=V(()=>g("span",{style:{"margin-right":"10px"}},"已生效",-1)),Le=V(()=>g("span",{class:"green"},null,-1)),Ee=V(()=>g("span",{style:{"margin-right":"10px"}},"未生效",-1)),Ne=ee({name:"site_setting",__name:"list",setup(d){const b=le(),O=m(),R="https://saas-api.surveysaas.com/tenant-logo/upload",{toClipboard:z}=ge(),k=m("基本设置"),v=m(!1),_=m(),t=m({id:"",registerOffOrOn:!0,registerExamineOffOrOn:!1,keyWords:"",webName:"",topLevelDomainName:"",defaultPriceRatio:null,taxRate:null,minimumAmount:null,phone:"",email:"",qqCode:"",address:""}),w=m({webName:[{required:!0,message:"请输入网站名称",trigger:"blur"}],topLevelDomainName:[{required:!1,message:"请输入顶级域名",trigger:"submit"},{validator:(n,a,r)=>{new RegExp("^(?!-)[A-Za-z0-9-]{1,63}(?<!-)(?:\\.[A-Za-z0-9-]{1,63}(?<!-))*\\.[A-Za-z]{2,}$").test(a)?r():r(new Error("请输入合法的域名"))},trigger:"submit"}],phone:[{required:!1,trigger:"submit",message:"请输入手机号"},{validator:(n,a,r)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(t.value.phone)?r():r(new Error("请输入合法手机号"))},trigger:"submit"}],email:[{required:!1,trigger:"submit",message:"请输入邮箱"},{validator:(n,a,r)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t.value.email)?r():r(new Error("请输入合法邮箱"))},trigger:"submit"}]});ae(()=>{v.value=!0,b.logo&&(f.value=[{name:"logo",url:b.logo}]),E(),v.value=!1});async function E(){try{const{data:n}=await q.list();t.value=n||t.value}catch{}finally{v.value=!1}}const I=async()=>{var a;f.value=[];const n=await ye.getTenantLogo();n.data&&(b.setLogo(n.data.logoUrl),f.value.push({name:"file",url:(a=n==null?void 0:n.data)==null?void 0:a.logoUrl}))},S=()=>{O.value.showEdit()},A=()=>{const n=t.value.personalizedDomainName;z(n),x({type:"success",message:"复制成功"})},M=b.token,W=m({Token:M}),P=m(""),N=m(!1),f=m([]),$=async()=>{x.success({message:"删除成功",center:!0}),b.delLogo()},B=(n,a)=>{n.status===-1?(me.error(n.error,{zIndex:2e3}),f.value=f.value.filter(r=>r.name!==a.name)):I()},Z=async()=>{x.warning({message:"只能上传一个,删除原文件后重新上传",center:!0})},G=n=>{P.value=n.url,N.value=!0};function D(){(t.value.email===""||t.value.email===null)&&(w.value.email=[],_.value.clearValidate("email")),(t.value.phone===""||t.value.phone===null)&&(w.value.phone=[],_.value.clearValidate("phone")),(t.value.topLevelDomainName===""||t.value.topLevelDomainName===null)&&(w.value.topLevelDomainName=[],_.value.clearValidate("topLevelDomainName")),_.value&&_.value.validate(n=>{if(n)try{v.value=!0,q.edit(t.value).then(a=>{v.value=!1,a.status===1&&(E(),x.success({message:"修改成功",center:!0}))})}catch{}finally{v.value=!1}})}return(n,a)=>{const r=pe,h=i("el-icon"),J=i("el-upload"),j=i("el-dialog"),F=i("ElFormItem"),s=i("el-col"),T=i("el-switch"),u=i("el-form-item"),p=i("el-input"),H=i("el-text"),y=i("el-button"),U=i("el-row"),C=i("el-tab-pane"),Q=i("el-form"),K=i("el-tabs"),X=fe,Y=te("loading");return oe((ne(),se("div",null,[e(r,{title:"站点设置管理"}),e(X,null,{default:l(()=>[e(K,{modelValue:k.value,"onUpdate:modelValue":a[13]||(a[13]=o=>k.value=o)},{default:l(()=>[e(Q,{ref_key:"formRef",ref:_,model:t.value,rules:w.value,"label-width":"100px","label-position":"right",inline:!1},{default:l(()=>[e(C,{label:"基础设置",name:"基本设置"},{default:l(()=>[e(U,{gutter:20},{default:l(()=>[e(s,{span:24},{default:l(()=>[e(F,{style:{display:"flex","justify-content":"center","align-items":"center"},label:"网址Logo"},{default:l(()=>[e(J,{class:ue({hide_box:f.value.length}),"file-list":f.value,"onUpdate:fileList":a[0]||(a[0]=o=>f.value=o),headers:W.value,action:R,"list-type":"picture-card",limit:1,"on-preview":G,"on-remove":$,"on-success":B,"on-exceed":Z},{tip:l(()=>[Ve]),default:l(()=>[e(h,{class:"el-icon--upload"},{default:l(()=>[e(ie(re))]),_:1})]),_:1},8,["class","file-list","headers"]),e(j,{modelValue:N.value,"onUpdate:modelValue":a[1]||(a[1]=o=>N.value=o),style:{"z-index":"1000",transform:"translate(0)",position:"relative"}},{default:l(()=>[g("img",{"w-full":"",src:P.value,alt:"Preview Image"},null,8,we)]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:3},{default:l(()=>[e(u,{label:"注册开关"},{default:l(()=>[e(T,{modelValue:t.value.registerOffOrOn,"onUpdate:modelValue":a[2]||(a[2]=o=>t.value.registerOffOrOn=o),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:6},{default:l(()=>[e(u,{label:"注册审核"},{default:l(()=>[e(T,{modelValue:t.value.registerExamineOffOrOn,"onUpdate:modelValue":a[3]||(a[3]=o=>t.value.registerExamineOffOrOn=o),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"网站名称",prop:"webName"},{default:l(()=>[e(p,{modelValue:t.value.webName,"onUpdate:modelValue":a[4]||(a[4]=o=>t.value.webName=o),style:{width:"18rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"keyWords"},{default:l(()=>[e(p,{modelValue:t.value.keyWords,"onUpdate:modelValue":a[5]||(a[5]=o=>t.value.keyWords=o),style:{width:"18rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"个性化域名",prop:""},{default:l(()=>[e(H,{class:"mx-1"},{default:l(()=>[c(de(t.value.personalizedDomainName),1)]),_:1}),e(y,{class:"copy",type:"primary",link:"",onClick:A},{default:l(()=>[c("复制")]),_:1})]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"顶级域名",prop:"topLevelDomainName"},{default:l(()=>[e(p,{modelValue:t.value.topLevelDomainName,"onUpdate:modelValue":a[6]||(a[6]=o=>t.value.topLevelDomainName=o),style:{width:"8rem"}},null,8,["modelValue"]),he,xe,Le,Ee,e(y,{class:"copy",onClick:S,type:"primary",link:""},{default:l(()=>[c("解析记录")]),_:1})]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,null,{default:l(()=>[e(y,{type:"primary",onClick:D},{default:l(()=>[c(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(C,{label:"高级设置",name:"高级设置"},{default:l(()=>[e(U,{gutter:20},{default:l(()=>[e(s,{span:24},{default:l(()=>[e(u,{label:"最低结算金额",prop:""},{default:l(()=>[e(p,{modelValue:t.value.minimumAmount,"onUpdate:modelValue":a[7]||(a[7]=o=>t.value.minimumAmount=o),modelModifiers:{number:!0},style:{width:"18rem"},placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"供应商税点",prop:""},{default:l(()=>[e(p,{modelValue:t.value.taxRate,"onUpdate:modelValue":a[8]||(a[8]=o=>t.value.taxRate=o),modelModifiers:{number:!0},style:{width:"18rem"},placeholder:""},{append:l(()=>[c("%")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,null,{default:l(()=>[e(y,{type:"primary",onClick:D},{default:l(()=>[c(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(C,{label:"联系我们",name:"联系我们"},{default:l(()=>[e(U,{gutter:20},{default:l(()=>[e(s,{span:24},{default:l(()=>[e(u,{label:"电子邮箱",prop:"email"},{default:l(()=>[e(p,{style:{width:"18rem"},modelValue:t.value.email,"onUpdate:modelValue":a[9]||(a[9]=o=>t.value.email=o),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"手机号码",prop:"phone"},{default:l(()=>[e(p,{style:{width:"18rem"},modelValue:t.value.phone,"onUpdate:modelValue":a[10]||(a[10]=o=>t.value.phone=o),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"QQ号码",prop:""},{default:l(()=>[e(p,{style:{width:"18rem"},modelValue:t.value.qqCode,"onUpdate:modelValue":a[11]||(a[11]=o=>t.value.qqCode=o),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,{label:"公司地址",prop:""},{default:l(()=>[e(p,{style:{width:"18rem"},modelValue:t.value.address,"onUpdate:modelValue":a[12]||(a[12]=o=>t.value.address=o),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:l(()=>[e(u,null,{default:l(()=>[e(y,{type:"primary",onClick:D},{default:l(()=>[c("确认")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]),_:1}),e(be,{ref_key:"recordRef",ref:O,onFetchData:E},null,512)])),[[Y,v.value]])}}}),qe=_e(Ne,[["__scopeId","data-v-3180f7a8"]]);export{qe as default};
