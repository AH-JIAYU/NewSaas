
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as oe,O as ne,aO as le,r as M,y as ie,l as se,G as D,J as re,b as s,q as de,o as _,e as ce,g as t,w as n,j as a,az as V,h as f,H as g,s as me,f as y,aN as ue,k as S,t as d,S as I,aP as pe,E as fe,N as _e,ap as ge,aI as he,aJ as be,R as ve}from"./index-CfmU-pu3.js";import{_ as Ce}from"./index-DogEUXOi.js";import{_ as ye}from"./index.vue_vue_type_script_setup_true_lang-CHTqDO9P.js";import{_ as ke}from"./index.vue_vue_type_script_setup_true_lang-DOjijZ7x.js";import{a as $}from"./configuration_role-BVEVVJVs.js";import Ee from"./index-DUMqTkFM.js";import{u as Me}from"./useTabbar-C6FeXdnQ.js";import"./index-ocDIEdH9.js";import"./index-DKGDwHDm.js";const Se=h=>(he("data-v-2c800bef"),h=h(),be(),h),we=Se(()=>d("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),xe={class:"copyId tableSmall"},ze={class:"id oneLine"},Be={class:"tableBig"},Pe={class:"tableBig"},De={class:"flex-s"},Ve={class:"oneLine tableBig",style:{width:"calc(100% - 20px)"}},Ie=oe({name:"role",__name:"list",setup(h){const w=ne(),{pagination:c,onSizeChange:N,onCurrentChange:R,onSortChange:T}=le(),x=Me(),z=M(),k=M(),b=ie(),e=M({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,id:"",row:{}},search:{id:null,name:""},batch:{enable:!1,selectionDataList:[]},dataList:[]});function L(o){o?k.value=o.id:k.value=""}function O(o,i){z.value.showEdit(o,i)}se(()=>{r(),e.value.formMode==="router"&&D.on("get-data-list",()=>{r()})}),re(()=>{e.value.formMode==="router"&&D.off("get-data-list")});function r(){try{e.value.loading=!0;const o={...e.value.search};$.list(o).then(i=>{e.value.loading=!1,e.value.dataList=i.data,c.value.total=i.data.length})}catch{}finally{e.value.loading=!1}}function U({prop:o,order:i}){T(o,i).then(()=>r())}function j(o){N(o).then(()=>{e.value.search.limit=o,r()})}function v(o=1){R(o).then(()=>{r()})}function F(){Object.assign(e.value.search,{id:null,name:""}),r()}function H(){e.value.formMode==="router"?b.settings.tabbar.enable&&b.settings.tabbar.mergeTabsBy!=="activeMenu"?x.open({name:"multilevel_menu_exampleRoleCreate"}):w.push({name:"multilevel_menu_exampleRoleCreate"}):(e.value.formModeProps.id="",e.value.formModeProps.visible=!0)}function J(o){e.value.formMode==="router"?b.settings.tabbar.enable&&b.settings.tabbar.mergeTabsBy!=="activeMenu"?x.open({name:"multilevel_menu_exampleRoleEdit",params:{id:o.id}}):w.push({name:"multilevel_menu_exampleRoleEdit",params:{id:o.id}}):(e.value.formModeProps.id=o.id,e.value.formModeProps.row=JSON.stringify(o),e.value.formModeProps.visible=!0)}function K(o){pe.confirm(`确认删除「${o.roleName}」吗？`,"确认信息").then(()=>{$.delete({id:o.id}).then(()=>{r(),fe.success({message:"删除成功",center:!0})})}).catch(()=>{})}return(o,i)=>{const B=s("el-input"),P=s("el-form-item"),E=_e,m=s("ElButton"),Q=s("ElFormItem"),q=s("el-form"),A=ye,G=s("ElDivider"),W=s("ElSpace"),u=s("ElTableColumn"),X=Ce,Y=s("el-empty"),Z=s("ElTable"),ee=s("ElPagination"),te=ge,ae=de("loading");return _(),ce("div",{class:I({"absolute-container":a(e).tableAutoHeight})},[t(te,null,{default:n(()=>[t(A,{"show-toggle":!1},{default:n(({fold:l,toggle:C})=>[t(q,{model:a(e).search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:n(()=>[t(P,{label:""},{default:n(()=>[t(B,{modelValue:a(e).search.id,"onUpdate:modelValue":i[0]||(i[0]=p=>a(e).search.id=p),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"角色ID",onKeydown:i[1]||(i[1]=V(p=>v(),["enter"]))},null,8,["modelValue"])]),_:1}),t(P,{label:""},{default:n(()=>[t(B,{modelValue:a(e).search.name,"onUpdate:modelValue":i[2]||(i[2]=p=>a(e).search.name=p),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"角色名称",onKeydown:i[3]||(i[3]=V(p=>v(),["enter"]))},null,8,["modelValue"])]),_:1}),t(Q,null,{default:n(()=>[t(m,{type:"primary",onClick:i[4]||(i[4]=p=>v())},{icon:n(()=>[t(E,{name:"i-ep:search"})]),default:n(()=>[f(" 筛选 ")]),_:1}),t(m,{onClick:F},{icon:n(()=>[we]),default:n(()=>[f(" 重置 ")]),_:1}),t(m,{link:"",onClick:C},{icon:n(()=>[t(E,{name:l?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:n(()=>[f(" "+g(l?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),t(G,{"border-style":"dashed"}),t(W,{wrap:""},{default:n(()=>[t(m,{type:"primary",size:"default",onClick:H},{default:n(()=>[f(" 新增角色管理 ")]),_:1})]),_:1}),me((_(),y(Z,{class:"my-4",data:a(e).dataList,stripe:"","highlight-current-row":"",height:"100%",onSortChange:U,border:"",onSelectionChange:i[5]||(i[5]=l=>a(e).batch.selectionDataList=l),onCurrentChange:L},{empty:n(()=>[t(Y,{image:a(ue),"image-size":300},null,8,["image"])]),default:n(()=>[a(e).batch.enable?(_(),y(u,{key:0,type:"selection",align:"center",fixed:""})):S("",!0),t(u,{prop:"id",align:"center",label:"角色ID"},{default:n(({row:l})=>[d("div",xe,[d("div",ze,"ID: "+g(l.id),1),t(X,{class:"copy",content:l.id},null,8,["content"])])]),_:1}),t(u,{prop:"roleName",align:"center",label:"角色名称"},{default:n(({row:l})=>[d("div",Be,g(l.roleName),1)]),_:1}),t(u,{prop:"count",align:"center",label:"账户数"},{default:n(({row:l})=>[d("div",Pe,g(l.count),1)]),_:1}),t(u,{prop:"remark",align:"center",label:"备注"},{default:n(({row:l})=>[d("div",De,[d("div",Ve,g(l.remark?l.remark:"-"),1),l.projectType!==2?(_(),y(E,{key:0,onClick:C=>O(l,"remark"),class:I({edit:"edit",current:l.id===a(k)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])):S("",!0)])]),_:1}),t(u,{label:"操作",width:"250",align:"center",fixed:"right"},{default:n(l=>[t(m,{type:"primary",size:"small",plain:"",onClick:C=>J(l.row)},{default:n(()=>[f(" 编辑 ")]),_:2},1032,["onClick"]),t(m,{type:"danger",size:"small",plain:"",onClick:C=>K(l.row)},{default:n(()=>[f(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ae,a(e).loading]]),t(ee,{"current-page":a(c).page,total:a(c).total,"page-size":a(c).size,"page-sizes":a(c).sizes,layout:a(c).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:j,onCurrentChange:v},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),a(e).formMode==="dialog"||a(e).formMode==="drawer"?(_(),y(ke,{key:0,id:a(e).formModeProps.id,modelValue:a(e).formModeProps.visible,"onUpdate:modelValue":i[6]||(i[6]=l=>a(e).formModeProps.visible=l),row:a(e).formModeProps.row,mode:a(e).formMode,onSuccess:r},null,8,["id","modelValue","row","mode"])):S("",!0),t(Ee,{ref_key:"QuickEditRef",ref:z,onFetchData:r},null,512)],2)}}}),He=ve(Ie,[["__scopeId","data-v-2c800bef"]]);export{He as default};
