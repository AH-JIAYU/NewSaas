
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Le,r as m,l as Ve,aN as He,n as Ne,W as Se,a as s,q as xe,o as i,b as y,y as g,f as n,j as p,w as o,s as we,az as M,F as P,t as R,g as u,i as k,aM as ze,e as d,z as b,N as Ee,p as x,aO as F,E as $,_ as De,bb as Ue,an as Be,aH as Me,aI as Pe,L as Re,am as T}from"./index-CMNRXjnW.js";import{_ as Fe}from"./index-dMvD4s2f.js";import{u as $e}from"./position_manage-R79-cKsL.js";import Te from"./index-DguCDenQ.js";import Ae from"./index-DvyLPvbD.js";import"./index-DBAqJkxp.js";import"./position_manage-JUjvV6yT.js";import"./department-CUVvNEoS.js";import"./configuration_role-D_dlmPB_.js";import"./tenant_role-Dtsi6G_X.js";import"./configuration_manager-bD898B6b.js";import"./department-BD2EpZ0d.js";const Ze=C=>(Me("data-v-3746d302"),C=C(),Pe(),C),je={class:"absolute-container"},Ke={class:"page-main"},Oe={class:"leftTree"},qe={key:0,class:"leftData",span:3},Ge={class:"dataForm-container"},Je={class:"copyId tableSmall"},Qe={class:"id oneLine idFont"},We={style:{display:"flex","align-items":"center"}},Xe={key:0,xmlns:"http://www.w3.org/2000/svg",style:{"margin-top":"2px","margin-right":"7px"},width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},Ye=Ze(()=>g("g",{id:"Group 18384"},[g("circle",{id:"Ellipse 105",cx:"10",cy:"10",r:"10",fill:"#F8BB4F"}),g("path",{id:"ç®¡",d:"M13.9946 9.3605V12.1892H7.43481V12.9031H14.6277V16.4995H13.3481V16.0146H7.43481V16.486H6.15517V9.3605H13.9946ZM7.43481 14.8831H13.3481V13.9133H7.43481V14.8831ZM7.43481 11.1655H12.7419V10.3842H7.43481V11.1655ZM15.8534 7.67677V10.2495H14.6008V8.75436H5.52209V10.2495H4.2694V7.67677H9.48222C9.37446 7.40738 9.25323 7.16492 9.13201 6.9494L10.2635 6.76083L10.0345 6.61266C10.6541 5.80447 11.1121 4.9424 11.3815 4.01298L12.6072 4.28238C12.5264 4.51136 12.4591 4.72688 12.3782 4.9424H16.1228V6.06039H13.9273C14.1428 6.35673 14.3179 6.65307 14.4661 6.92246L13.3346 7.34003C13.1191 6.90899 12.8631 6.47796 12.5668 6.06039H11.8799C11.6509 6.5049 11.3949 6.92246 11.1121 7.29962L10.4655 6.88206C10.5733 7.12451 10.6676 7.39391 10.7753 7.67677H15.8534ZM6.08782 6.06039C5.79149 6.54531 5.46821 7.00328 5.118 7.42085L4 6.72042C4.78125 5.88529 5.33351 4.96934 5.67026 3.99951L6.89601 4.26891C6.81519 4.4979 6.72091 4.72688 6.64009 4.9424H10.0345V6.06039H8.01401C8.25647 6.39714 8.47198 6.72042 8.63362 7.03022L7.46175 7.47473C7.23276 6.98981 6.97683 6.51837 6.6805 6.06039H6.08782Z",fill:"white"})],-1)),et=[Ye],A=Le({name:"user",__name:"index",setup(C){const L=$e(),w=m(),Z=Ve(),j=m([]),{pagination:h,getParams:tt,onSizeChange:K,onCurrentChange:O,onSortChange:q}=He(),V=m([{label:"员工ID",prop:"id",sortable:!0,checked:!0},{label:"用户名",prop:"userName",sortable:!0,checked:!0},{label:"电话号码",prop:"phoneNumber",sortable:!0,checked:!0},{label:"邮箱",prop:"email",sortable:!0,checked:!0},{label:"部门",prop:"departmentId",sortable:!0,checked:!0},{label:"角色",prop:"role",sortable:!0,checked:!0},{label:"职位",prop:"positionId",sortable:!0,checked:!0},{label:"小组",prop:"groupId",sortable:!0,checked:!0},{label:"状态",prop:"active",sortable:!0,checked:!0}]),G=[{label:"启用",value:!0},{label:"禁用",value:!1}],J={children:"children",label:"name"},Q=m(),z=m(),c=m({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),H=m(),W=m(),e=m({loading:!1,tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],search:{page:1,limit:10,id:"",userName:"",active:null,departmentId:null},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}}),X=m();async function r(){const a={...e.value.search},l=await x.list(a);l.data&&(e.value.dataList=l.data.data,h.value.total=+l.data.total)}Ne(async()=>{try{c.value.loading=!0,j.value=await Z.getCountry(),w.value=await(L==null?void 0:L.getPositionManage())||[],r(),V.value.forEach(a=>{a.checked&&e.value.checkList.push(a.prop)}),c.value.loading=!1}catch{}finally{c.value.loading=!1}}),Se(()=>c.value.search,a=>{Q.value.filter(a)});function Y(a){return new Promise(l=>{F.confirm(`确认${a.active?"禁用":"启用"}「${a.userName}」吗？`,"确认信息").then(()=>{try{c.value.loading=!0,x.edit({id:a.id,email:a.email,phoneNumber:a.phoneNumber,userName:a.userName,country:a.country,role:a.role,positionId:a.positionId,organizationalStructureId:a.organizationalStructureId,active:!a.active}).then(()=>($.success({message:`${a.active?"禁用":"启用"}成功`,center:!0}),r(),c.value.loading=!1,l(!0))).catch(()=>(c.value.loading=!1,l(!1)))}catch{}finally{c.value.loading=!1}}).catch(()=>l(!1))})}function ee(a){var l;h.value.page=1,(l=a==null?void 0:a.children)!=null&&l.length?(e.value.search.id="",e.value.search.departmentId=a.id,r()):(e.value.search.id=a.id,e.value.search.departmentId="",r())}function te(a){K(a).then(()=>{e.value.search.limit=a,r()})}function ae(a=1){O(a).then(()=>{e.value.search.page=a,r()})}function le({prop:a,order:l}){q(a,l).then(()=>r())}function ne(a){e.value.dialog.id="",e.value.dialog.visible=!0,e.value.dialog.level=1,a&&(e.value.dialog.parentId=a.id,e.value.dialog.level=Number(a.level)+1)}const oe=a=>{H.value=a[0]};function ie(){if(H.value){const{userName:a,id:l}=H.value;F.confirm(`确认将「${a}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{x.reset({id:l}).then(()=>{$.success({message:"重置成功",center:!0}),r()})}).catch(()=>{})}}function se(a){e.value.row=JSON.stringify(a),e.value.dialog.id=a.id,e.value.dialog.parentId=a.parentId,e.value.dialog.visible=!0}function re(a){z.value.showEdit(a)}function ue(){Object.assign(e.value.search,{id:"",userName:"",departmentId:null,active:null}),r()}const N=m();function de(a){a?N.value=a.id:N.value=""}return(a,l)=>{const E=s("el-tree"),D=s("ElInput"),ce=s("el-option"),pe=s("el-select"),U=De,I=s("ElButton"),me=s("ElSpace"),S=s("el-button"),B=s("el-col"),fe=Ue,ve=s("el-row"),f=s("ElTableColumn"),ge=s("ElSwitch"),he=s("el-tooltip"),_e=Fe,v=s("el-text"),be=s("el-empty"),ye=s("ElTable"),ke=s("ElPagination"),Ce=Be,Ie=xe("loading");return i(),y("div",je,[g("div",Ke,[g("div",Oe,[c.value.tree.length?(i(),y("div",qe,[n(E,{style:{"max-width":"37.5rem","min-height":"45.4375rem",padding:"10px"},data:c.value.tree,ref_key:"treeRef",ref:X,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,props:J,onNodeClick:ee},null,8,["data"])])):p("",!0),n(Ce,null,{default:o(()=>[we((i(),y("div",Ge,[n(me,null,{default:o(()=>[n(D,{modelValue:e.value.search.id,"onUpdate:modelValue":l[0]||(l[0]=t=>e.value.search.id=t),placeholder:"员工ID",clearable:"",style:{width:"12.5rem"},onKeydown:M(r,["enter"])},null,8,["modelValue"]),n(D,{modelValue:e.value.search.userName,"onUpdate:modelValue":l[1]||(l[1]=t=>e.value.search.userName=t),placeholder:"用户名",clearable:"",style:{width:"12.5rem"},onKeydown:M(r,["enter"])},null,8,["modelValue"]),n(pe,{modelValue:e.value.search.active,"onUpdate:modelValue":l[2]||(l[2]=t=>e.value.search.active=t),"value-key":"",placeholder:"状态",style:{width:"12.5rem"},clearable:"",filterable:"",onChange:r},{default:o(()=>[(i(),y(P,null,R(G,t=>n(ce,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),n(I,{type:"primary",onClick:r},{icon:o(()=>[n(U,{name:"i-ep:search"})]),_:1}),n(I,{onClick:ue},{icon:o(()=>[n(U,{name:"i-ep:refresh"})]),_:1})]),_:1}),n(ve,{style:{"margin-bottom":"0.3125rem"},gutter:24},{default:o(()=>[n(B,{style:{"margin-bottom":"1.5625rem"},span:10},{default:o(()=>[n(S,{type:"primary",size:"default",onClick:ne},{default:o(()=>[u(" 新增 ")]),_:1}),n(S,{type:"primary",size:"default",onClick:ie},{default:o(()=>[u(" 重置密码 ")]),_:1})]),_:1}),n(B,{style:{display:"flex","justify-content":"flex-end"},span:14},{default:o(()=>[n(S,{size:"default",onClick:l[3]||(l[3]=()=>{})},{default:o(()=>[u(" 导出 ")]),_:1}),n(fe,{border:e.value.border,"onUpdate:border":l[4]||(l[4]=t=>e.value.border=t),tableAutoHeight:e.value.tableAutoHeight,"onUpdate:tableAutoHeight":l[5]||(l[5]=t=>e.value.tableAutoHeight=t),checkList:e.value.checkList,"onUpdate:checkList":l[6]||(l[6]=t=>e.value.checkList=t),columns:V.value,"onUpdate:columns":l[7]||(l[7]=t=>V.value=t),"line-height":e.value.lineHeight,"onUpdate:lineHeight":l[8]||(l[8]=t=>e.value.lineHeight=t),stripe:e.value.stripe,"onUpdate:stripe":l[9]||(l[9]=t=>e.value.stripe=t),style:{"margin-left":"0.75rem"},onQueryData:r},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),n(ye,{ref_key:"userItemRef",ref:W,data:e.value.dataList,border:e.value.border,size:e.value.lineHeight,stripe:e.value.stripe,"highlight-current-row":"",height:"100%",onSortChange:le,onCurrentChange:de,onSelectionChange:l[10]||(l[10]=t=>e.value.selectionDataList=t),"row-key":"id","default-expand-all":"",onSelect:oe},{empty:o(()=>[n(be,{image:k(ze),"image-size":300},null,8,["image"])]),default:o(()=>[n(f,{type:"selection",align:"left",fixed:""}),e.value.checkList.includes("active")?(i(),d(f,{key:0,align:"left",prop:"active",label:"状态",width:"84"},{default:o(t=>[n(ge,{modelValue:t.row.active,"onUpdate:modelValue":_=>t.row.active=_,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>Y(t.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1})):p("",!0),e.value.checkList.includes("id")?(i(),d(f,{key:1,align:"left",width:"280",prop:"id",label:"员工ID"},{default:o(({row:t})=>[g("div",Je,[g("div",Qe,[n(he,{effect:"dark",content:t.id,placement:"top-start"},{default:o(()=>[u(b(t.id),1)]),_:2},1032,["content"])]),n(_e,{content:t.id,class:Ee({rowCopy:"rowCopy",current:t.id===N.value})},null,8,["content","class"])])]),_:1})):p("",!0),e.value.checkList.includes("userName")?(i(),d(f,{key:2,align:"left",prop:"userName",label:"用户名"},{default:o(({row:t})=>[n(v,{class:"tableBig"},{default:o(()=>[u(b(t.userName?t.userName:"-"),1)]),_:2},1024)]),_:1})):p("",!0),e.value.checkList.includes("phoneNumber")?(i(),d(f,{key:3,align:"left",width:"170",prop:"phone",label:"电话号码"},{default:o(({row:t})=>[n(v,{class:"fontC-System"},{default:o(()=>[u(b(t.phoneNumber?t.phoneNumber:"-"),1)]),_:2},1024)]),_:1})):p("",!0),e.value.checkList.includes("email")?(i(),d(f,{key:4,align:"left",width:"180",prop:"email",label:"邮箱"},{default:o(({row:t})=>[n(v,{class:"fontC-System"},{default:o(()=>[u(b(t.email?t.email:"-"),1)]),_:2},1024)]),_:1})):p("",!0),e.value.checkList.includes("departmentId")?(i(),d(f,{key:5,align:"left",prop:"departmentId",label:"部门"},{default:o(({row:t})=>[g("div",We,[t.enableChargePerson===1?(i(),y("svg",Xe,et)):p("",!0),n(v,{class:"fontC-System"},{default:o(()=>[u(b(t.organizationalStructureName?t.organizationalStructureName:"-"),1)]),_:2},1024)])]),_:1})):p("",!0),e.value.checkList.includes("role")?(i(),d(f,{key:6,align:"left",prop:"role",label:"角色"},{default:o(({row:t})=>[n(v,{class:"fontC-System"},{default:o(()=>[u(b(t.role?t.role:"-"),1)]),_:2},1024)]),_:1})):p("",!0),e.value.checkList.includes("positionId")?(i(),d(f,{key:7,align:"left",prop:"positionId",label:"职位"},{default:o(({row:t})=>[t.positionId?(i(),d(v,{key:0,class:"fontC-System"},{default:o(()=>[(i(!0),y(P,null,R(w.value,_=>(i(),d(v,null,{default:o(()=>[t.positionId===_.id?(i(),d(v,{key:0},{default:o(()=>[u(b(_.name?_.name:"-"),1)]),_:2},1024)):p("",!0)]),_:2},1024))),256))]),_:2},1024)):(i(),d(v,{key:1,class:"fontC-System"},{default:o(()=>[u("-")]),_:1}))]),_:1})):p("",!0),n(f,{label:"操作",fixed:"right",width:"200",align:"left"},{default:o(t=>[n(I,{type:"primary",size:"small",plain:"",onClick:_=>se(t.row)},{default:o(()=>[u(" 编辑 ")]),_:2},1032,["onClick"]),n(I,{type:"warning",size:"small",plain:"",onClick:_=>re(t.row)},{default:o(()=>[u(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"]),n(ke,{"current-page":k(h).page,total:k(h).total,"page-size":k(h).size,"page-sizes":k(h).sizes,layout:k(h).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:te,onCurrentChange:ae},null,8,["current-page","total","page-size","page-sizes","layout"])])),[[Ie,c.value.loading]])]),_:1})]),e.value.dialog.visible?(i(),d(Te,{key:0,id:e.value.dialog.id,modelValue:e.value.dialog.visible,"onUpdate:modelValue":l[11]||(l[11]=t=>e.value.dialog.visible=t),"catalogue-id":e.value.search.catalogueId,"parent-id":e.value.dialog.parentId,level:e.value.dialog.level,tree:c.value.tree,dataList:e.value.dataList,row:e.value.row,onSuccess:r},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):p("",!0),n(Ae,{ref_key:"detailRef",ref:z},null,512)])])}}});typeof T=="function"&&T(A);const ft=Re(A,[["__scopeId","data-v-3746d302"]]);export{ft as default};
