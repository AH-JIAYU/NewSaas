
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as $}from"./financial_pm_log-5b4HcwxP.js";import{d as w,r as n,a2 as s,al as B,a3 as E,a as P,i as R,f as l,w as a,g as i,t as U,b as q,ai as S}from"./index-Dfh_jK84.js";const J=w({__name:"index",emits:["fetch-data"],setup(M,{expose:C,emit:z}){const I=z,d=n(!1),u=n(!1),p=n(),y=n(""),v=n(),_=n(),t=n({organizationalStructureId:null,type:null,amount:null,remark:""}),x=n({amount:[{required:!0,message:"请输入金额",trigger:"blur"},{pattern:/^(?!0(\.0+)?$)(\d+(\.\d{1,2})?)$/,message:"请输入有效的正数，且最多两位小数",trigger:"blur"}],type:[{required:!0,message:"请选择加减款",trigger:"change"}]});async function D(o){try{d.value=!0,u.value=!0,o?(y.value="编辑",v.value=JSON.parse(o),_.value=v.value.organizationalStructureId,t.value.organizationalStructureId=v.value.organizationalStructureId):y.value="新增",u.value=!1}catch{}finally{u.value=!1}}async function h(){p.value&&p.value.validate(async o=>{if(o)try{u.value=!0,(await $.additionAndSubtraction(t.value)).status===1?(u.value=!1,I("fetch-data"),S.success({message:"操作成功",center:!0}),g()):S.warning({message:"出现错误请联系管理人员",center:!0})}catch{}finally{u.value=!1}})}const m=n(null),b=n(null),k=(o,e)=>{e&&(o==="加款"||o==="减款"?(m.value=e,t.value.type=e):(o==="待审金额"||o==="可用金额")&&(b.value=e,t.value.type=e))};function g(){Object.assign(t.value,{organizationalStructureId:null,type:null,amount:null,remark:""}),m.value=null,b.value=null,d.value=!1}return C({showEdit:D}),(o,e)=>{const c=s("el-form-item"),f=s("el-button"),V=s("el-input"),j=s("el-form"),N=s("el-dialog"),T=B("loading");return E((P(),R("div",null,[l(N,{modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=r=>d.value=r),title:"加减款","append-to-body":"","close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"35%",onClose:g},{footer:a(()=>[l(f,{onClick:g},{default:a(()=>[i(" 取消 ")]),_:1}),l(f,{type:"primary",onClick:h},{default:a(()=>[i(" 确定 ")]),_:1})]),default:a(()=>[l(j,{model:t.value,rules:x.value,ref_key:"formRef",ref:p,"label-width":"5rem",inline:!1},{default:a(()=>[l(c,{label:"ID"},{default:a(()=>[i(U(_.value),1)]),_:1}),l(c,{label:"加减款",prop:"type"},{default:a(()=>[q("div",null,[l(f,{type:m.value===1?"primary":"",size:"small",onClick:e[0]||(e[0]=r=>k("加款",1))},{default:a(()=>[i("加款 ")]),_:1},8,["type"]),l(f,{type:m.value===2?"primary":"",size:"small",onClick:e[1]||(e[1]=r=>k("减款",2))},{default:a(()=>[i("减款")]),_:1},8,["type"])])]),_:1}),l(c,{label:"金额",prop:"amount"},{default:a(()=>[l(V,{modelValue:t.value.amount,"onUpdate:modelValue":e[2]||(e[2]=r=>t.value.amount=r),modelModifiers:{number:!0},placeholder:"请输入金额"},null,8,["modelValue"])]),_:1}),l(c,{label:"说明",prop:""},{default:a(()=>[l(V,{modelValue:t.value.remark,"onUpdate:modelValue":e[3]||(e[3]=r=>t.value.remark=r),placeholder:"请输入说明"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])),[[T,u.value]])}}});export{J as _};
