
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{x as T,d as ie,X as ue,r as m,k as re,a as r,p as de,q as me,o as C,b as x,f as e,w as l,s as d,g as _,A as M,j as pe,O as ce,E as N,W as ve,aB as fe,_ as _e,ap as ge,aI as ye,aJ as Ve,M as be}from"./index-BE57dBdt.js";import{a as k}from"./configuration_site_setting-v2L2zpLF.js";import{u as he}from"./index-CezvntXQ.js";import we from"./index-B32bnvqJ.js";import{u as Ce}from"./configuration_siteSetting-BNvN2o6q.js";import"./clipboard-CQsYhxn3.js";import"./index-CXbN8nEH.js";import"./index-BUX3OLo9.js";import"./index-DJdExjCM.js";const xe={getTenantLogo:c=>T.post("tenant-logo/getTenantLogo",c),uploadLogo:c=>T.post("tenant-logo/upload",c)},g=c=>(ye("data-v-009d18d1"),c=c(),Ve(),c),Ne={class:"domainNames"},Le={class:"domainName"},qe={class:"domainName"},Ee={key:0},De={key:0},Oe=g(()=>d("span",{class:"green"},null,-1)),Se=g(()=>d("span",{style:{"margin-right":"10px"}},"已生效",-1)),Ue=[Oe,Se],ke={key:1},Pe=g(()=>d("span",{class:"red"},null,-1)),Qe=g(()=>d("span",{style:{"margin-right":"10px"}},"未生效",-1)),ze=[Pe,Qe],Ie=g(()=>d("span",{style:{"margin-left":"1.625rem",color:"#606266","font-size":"14px"}},"网址Logo",-1)),Ae=g(()=>d("svg",{xmlns:"http://www.w3.org/2000/svg",width:"80",height:"80",viewBox:"0 0 80 80",fill:"none"},[d("g",{id:"Frame"},[d("path",{id:"Vector",d:"M64.2018 37.4596C64.2018 37.4596 63.7118 21.3346 50.5768 18.1296C37.4418 14.9246 31.1118 28.7646 30.9818 29.1596C30.8518 29.5546 30.2068 29.3746 30.2068 29.3746C29.1568 28.3796 24.5268 26.0946 19.6618 29.0246C14.8018 31.9546 16.5618 37.5196 16.5618 37.5196C16.5618 37.5196 9.35676 36.9346 5.66176 48.0596C1.97176 59.1946 14.9168 62.3496 14.9168 62.3496H36.6468V50.5046H32.2968H31.9168H31.6218V50.4846C31.3718 50.4846 31.1718 50.2846 31.1718 50.0296C31.1718 49.8796 31.2518 49.7496 31.3718 49.6646L40.2768 40.2996C40.4018 40.1596 40.5768 40.0646 40.7818 40.0646C40.9918 40.0646 41.1768 40.1696 41.3018 40.3246L50.1418 49.6146C50.1568 49.6246 50.1718 49.6396 50.1868 49.6546L50.2718 49.7446H50.2418C50.2868 49.8246 50.3168 49.8946 50.3168 49.9896C50.3168 50.2696 50.0918 50.4996 49.8068 50.4996C49.7968 50.4996 49.7968 50.4896 49.7868 50.4896V50.5096H44.9968V62.3546H64.7218C64.7218 62.3546 74.1268 59.9996 74.9568 50.2896C75.7968 40.5796 64.2018 37.4596 64.2018 37.4596Z",fill:"#409EFF"})])],-1)),Re=g(()=>d("div",{class:"el-upload__text"}," 支持点击拖拽上传 ",-1)),Te=g(()=>d("div",{style:{color:"#47a2ff"},class:"el-upload__text"}," 支持上传JPG/JPEG/PNG图片，小于10MB ",-1)),Me=["src"],He=ie({name:"site_setting",__name:"list",setup(c){const H=Ce(),v=ue(),P=m(),W="https://saas-api.surveysaas.com/api/tenant-logo/upload",{toClipboard:$}=he(),Q=m("基本设置"),y=m(!1),V=m(),z=m(!1),I=m(),a=m({id:"",registerOffOrOn:!0,registerExamineOffOrOn:!1,keyWords:"",description:"",webName:"",topLevelDomainName:"",defaultPriceRatio:null,taxRate:null,minimumAmount:null,phone:"",email:"",qqCode:"",address:""}),h=m({webName:[{required:!0,message:"请输入网站名称",trigger:"blur"}],topLevelDomainName:[{required:!1,message:"请输入顶级域名",trigger:"blur"},{validator:(o,t,u)=>{new RegExp("^(?!-)[A-Za-z0-9-]{1,63}(?<!-)(?:\\.[A-Za-z0-9-]{1,63}(?<!-))*\\.[A-Za-z]{2,}$").test(t)?u():u(new Error("请输入合法的域名"))},trigger:"submit"}],phone:[{required:!1,trigger:"blur",message:"请输入手机号"},{validator:(o,t,u)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(a.value.phone)?u():u(new Error("请输入合法手机号"))},trigger:"blur"}],email:[{required:!1,trigger:"blur",message:"请输入邮箱"},{validator:(o,t,u)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a.value.email)?u():u(new Error("请输入合法邮箱"))},trigger:"blur"}],qqCode:[{required:!1,trigger:"blur",message:"请输入QQ号码"},{validator:(o,t,u)=>{/^[1-9][0-9]{4,14}$/.test(t)?u():u(new Error("请输入合法QQ号（5到15位数字，不能以0开头）"))},trigger:"blur"}],address:[{required:!1,message:"请输入内容",trigger:"blur"},{max:50,message:"最多输入 50 字",trigger:"blur"}]});re(()=>{y.value=!0,v.logo&&(f.value=[{name:"logo",url:v.logo}]),L(),y.value=!1});async function L(){try{const{data:o}=await k.list();if(H.setSiteConfig(o),o&&(a.value=o||a.value,I.value=a.value,v.setWebName(o.webName),v.setDescription(o.description),v.setkeyWords(o.keyWords)),a.value.topLevelDomainName!==""&&a.value.topLevelDomainName!==null){const t=await k.getTenantWebConfigQueryAnalysis({url:a.value.topLevelDomainName});z.value=t.data.success,a.value.isAnalysis=t.data.success}}catch{}finally{y.value=!1}}const B=async()=>{var t;f.value=[];const o=await xe.getTenantLogo();o.data&&(v.setLogo(o.data.logoUrl),f.value.push({name:"file",url:(t=o==null?void 0:o.data)==null?void 0:t.logoUrl}))},Z=()=>{P.value.showEdit(I.value)},F=()=>{const o=a.value.personalizedDomainName;$(o),N({type:"success",message:"复制成功"})},G=v.token,J=m({Token:G}),A=m(""),q=m(!1),f=m([]),j=async()=>{N.success({message:"删除成功",center:!0}),v.delLogo()},X=(o,t)=>{o.status===-1?(ve.error(o.error,{zIndex:2e3}),f.value=f.value.filter(u=>u.name!==t.name)):B()},K=async()=>{N.warning({message:"只能上传一个,删除原文件后重新上传",center:!0})},Y=o=>{A.value=o.url,q.value=!0};function E(){(a.value.email===""||a.value.email===null)&&(h.value.email=[],V.value.clearValidate("email")),(a.value.phone===""||a.value.phone===null)&&(h.value.phone=[],V.value.clearValidate("phone")),(a.value.qqCode===""||a.value.qqCode===null)&&(h.value.qqCode=[],V.value.clearValidate("qqCode")),(a.value.topLevelDomainName===""||a.value.topLevelDomainName===null)&&(h.value.topLevelDomainName=[],V.value.clearValidate("topLevelDomainName")),V.value&&V.value.validate(async o=>{if(o)try{y.value=!0,a.value.topLevelDomainName&&(a.value.topLevelDomainName=a.value.topLevelDomainName.replace(/^https?:\/\//,""));const t=await k.edit(a.value);y.value=!1,t.status===1&&(L(),N.success({message:"修改成功",center:!0}))}catch(t){console.log("error",t)}finally{y.value=!1}})}return(o,t)=>{const u=fe,b=r("el-switch"),i=r("el-form-item"),n=r("el-col"),p=r("el-input"),D=_e,O=r("el-tooltip"),R=r("el-text"),w=r("el-button"),ee=r("el-upload"),le=r("el-dialog"),ae=r("ElFormItem"),S=r("el-row"),U=r("el-tab-pane"),te=r("el-form"),oe=r("el-tabs"),se=ge,ne=de("loading");return me((C(),x("div",null,[e(u,{title:"站点设置管理"}),e(se,null,{default:l(()=>[e(oe,{modelValue:Q.value,"onUpdate:modelValue":t[13]||(t[13]=s=>Q.value=s)},{default:l(()=>[e(te,{ref_key:"formRef",ref:V,model:a.value,rules:h.value,"label-width":"100px","label-position":"right",inline:!1},{default:l(()=>[e(U,{label:"基础设置",name:"基本设置"},{default:l(()=>[e(S,{gutter:20},{default:l(()=>[e(n,{span:3},{default:l(()=>[e(i,{label:"注册开关"},{default:l(()=>[e(b,{modelValue:a.value.registerOffOrOn,"onUpdate:modelValue":t[0]||(t[0]=s=>a.value.registerOffOrOn=s),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:6},{default:l(()=>[e(i,{label:"注册审核"},{default:l(()=>[e(b,{modelValue:a.value.registerExamineOffOrOn,"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.registerExamineOffOrOn=s),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(i,{label:"网站名称",prop:"webName"},{default:l(()=>[e(p,{modelValue:a.value.webName,"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.webName=s),style:{width:"22.4375rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(i,{label:"网站关键字"},{default:l(()=>[d("div",Ne,[e(O,{class:"tooltips",content:"网站关键字",placement:"top"},{default:l(()=>[e(D,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})]),e(p,{modelValue:a.value.keyWords,"onUpdate:modelValue":t[3]||(t[3]=s=>a.value.keyWords=s),style:{width:"22.4375rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(i,{label:"网站描述"},{default:l(()=>[d("div",Le,[e(O,{class:"tooltips",content:"网站描述",placement:"top"},{default:l(()=>[e(D,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})]),e(p,{modelValue:a.value.description,"onUpdate:modelValue":t[4]||(t[4]=s=>a.value.description=s),style:{width:"22.4375rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(i,{label:"个性化域名",prop:""},{default:l(()=>[e(R,{class:"mx-1"},{default:l(()=>[_(M(a.value.personalizedDomainName),1)]),_:1}),e(w,{class:"copy",type:"primary",plain:"",size:"small",onClick:F},{default:l(()=>[_("复制")]),_:1})]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(i,{label:"顶级域名",prop:"topLevelDomainName"},{default:l(()=>[d("div",qe,[e(O,{class:"tooltips",content:"顶级域名",placement:"top"},{default:l(()=>[e(D,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})]),e(R,{class:"mx-1"},{default:l(()=>[_(M(a.value.topLevelDomainName),1)]),_:1}),a.value.topLevelDomainName?(C(),x("div",Ee,[z.value?(C(),x("div",De,Ue)):(C(),x("div",ke,ze))])):pe("",!0),e(w,{class:"copy",onClick:Z,type:"primary",size:"small",plain:""},{default:l(()=>[_("CNAME配置")]),_:1})]),_:1})]),_:1}),e(n,{style:{"margin-bottom":"1rem"},span:24},{default:l(()=>[Ie]),_:1}),e(n,{span:24},{default:l(()=>[e(ae,{style:{display:"flex","justify-content":"center","align-items":"center"},label:""},{default:l(()=>[e(ee,{class:ce({hide_box:f.value.length}),drag:"","file-list":f.value,"onUpdate:fileList":t[5]||(t[5]=s=>f.value=s),headers:J.value,action:W,"list-type":"picture-card",limit:1,"on-preview":Y,"on-remove":j,"on-success":X,"on-exceed":K},{default:l(()=>[Ae,Re,Te]),_:1},8,["class","file-list","headers"]),e(le,{modelValue:q.value,"onUpdate:modelValue":t[6]||(t[6]=s=>q.value=s),style:{"z-index":"1000",transform:"translate(0)",position:"relative"}},{default:l(()=>[d("img",{"w-full":"",src:A.value,alt:"Preview Image"},null,8,Me)]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(i,null,{default:l(()=>[e(w,{type:"primary",onClick:E},{default:l(()=>[_(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(U,{label:"高级设置",name:"高级设置"},{default:l(()=>[e(S,{gutter:20},{default:l(()=>[e(n,{span:24},{default:l(()=>[e(i,{label:"最低结算金额",prop:""},{default:l(()=>[e(p,{modelValue:a.value.minimumAmount,"onUpdate:modelValue":t[7]||(t[7]=s=>a.value.minimumAmount=s),modelModifiers:{number:!0},style:{width:"22.4375rem"},placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(i,{label:"供应商税点",prop:""},{default:l(()=>[e(p,{modelValue:a.value.taxRate,"onUpdate:modelValue":t[8]||(t[8]=s=>a.value.taxRate=s),modelModifiers:{number:!0},style:{width:"22.4375rem"},placeholder:""},{append:l(()=>[_("%")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(i,null,{default:l(()=>[e(w,{type:"primary",onClick:E},{default:l(()=>[_(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(U,{label:"联系我们",name:"联系我们"},{default:l(()=>[e(S,{gutter:20},{default:l(()=>[e(n,{span:24},{default:l(()=>[e(i,{label:"电子邮箱",prop:"email"},{default:l(()=>[e(p,{style:{width:"22.4375rem"},modelValue:a.value.email,"onUpdate:modelValue":t[9]||(t[9]=s=>a.value.email=s),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(i,{label:"手机号码",prop:"phone"},{default:l(()=>[e(p,{style:{width:"22.4375rem"},modelValue:a.value.phone,"onUpdate:modelValue":t[10]||(t[10]=s=>a.value.phone=s),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(i,{label:"QQ号码",prop:"qqCode"},{default:l(()=>[e(p,{style:{width:"22.4375rem"},modelValue:a.value.qqCode,"onUpdate:modelValue":t[11]||(t[11]=s=>a.value.qqCode=s),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(i,{label:"公司地址",prop:"address"},{default:l(()=>[e(p,{style:{width:"22.4375rem"},modelValue:a.value.address,"onUpdate:modelValue":t[12]||(t[12]=s=>a.value.address=s),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(i,null,{default:l(()=>[e(w,{type:"primary",onClick:E},{default:l(()=>[_("确认")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]),_:1}),e(we,{ref_key:"recordRef",ref:P,onFetchData:L},null,512)])),[[ne,y.value]])}}}),al=be(He,[["__scopeId","data-v-009d18d1"]]);export{al as default};
