
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{u as F}from"./user_customer-Dm_k1mfz.js";import{a as O}from"./project_settlement-CqOSVUWK.js";import{d as R,r,k as A,a as s,p as H,q as T,o as c,b as f,f as a,w as o,s as J,g as b,H as $,F as I,t as k,e as z,E as C}from"./index-BpCZv0AG.js";const G={style:{flex:"auto"}},Y=R({name:"SettlementEdit",__name:"index",emits:["success"],setup(K,{expose:P,emit:x}){const M=x,U=F(),V=r([]),i=r(!1),v=r(),n=r(),l=r({id:"",projectId:"",clientId:"",doMoneyPrice:"",settlementDone:"",systemDone:"",settlementPo:"",remark:"",status:null}),w=r({clientId:[{required:!0,message:"请选择所属客户",trigger:"change"}],doMoneyPrice:[{required:!0,message:"请选择所属客户",trigger:"blur"}]}),j=[{label:"待审核",value:1},{label:"已审核",value:2},{label:"已开票",value:3},{label:"已结算",value:4},{label:"已冻结",value:5}],d=r(!1);function S(){v.value&&v.value.validate(async p=>{if(p){i.value=!0;const{status:e}=await O.edit(l.value);e===1?(M("success"),i.value=!1,C.success({message:"操作成功",center:!0}),g()):(i.value=!1,C.error({message:"操作失败，请联系工作人员",center:!0}))}})}async function E(p){n.value=JSON.parse(p),l.value.id=n.value.id,l.value.projectId=n.value.projectId,l.value.clientId=n.value.clientId,l.value.doMoneyPrice=n.value.projectAmount,l.value.settlementDone=n.value.settlementDone,l.value.systemDone=n.value.systemDone,l.value.settlementPo=n.value.settlementPo,l.value.remark=n.value.remark,l.value.status=n.value.status,d.value=!0}function g(){v.value.resetFields(),Object.assign(l.value,{id:"",projectId:"",clientId:"",doMoneyPrice:"",settlementDone:"",systemDone:"",settlementPo:"",remark:"",status:null}),d.value=!1}return A(async()=>{V.value=await U.getCustomerList()}),P({showEdit:E}),(p,e)=>{const B=s("el-text"),u=s("el-form-item"),_=s("el-option"),y=s("el-select"),m=s("el-input"),L=s("el-form"),D=s("el-button"),N=s("el-dialog"),q=H("loading");return T((c(),f("div",null,[a(N,{modelValue:d.value,"onUpdate:modelValue":e[13]||(e[13]=t=>d.value=t),title:"项目结算编辑",width:"600","before-close":g},{footer:o(()=>[J("div",G,[a(D,{onClick:e[12]||(e[12]=t=>d.value=!1)},{default:o(()=>[b(" 取消 ")]),_:1}),a(D,{type:"primary",onClick:S},{default:o(()=>[b(" 确定 ")]),_:1})])]),default:o(()=>[a(L,{ref_key:"formRef",ref:v,model:l.value,rules:w.value,"label-width":"100px",inline:!1},{default:o(()=>[a(u,{label:"项目ID"},{default:o(()=>[a(B,{class:"mx-1"},{default:o(()=>[b($(l.value.projectId),1)]),_:1})]),_:1}),a(u,{prop:"clientId",label:"所属客户"},{default:o(()=>[a(y,{modelValue:l.value.clientId,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value.clientId=t),placeholder:"请选择所属客户",clearable:"",filterable:""},{default:o(()=>[(c(!0),f(I,null,k(V.value,t=>(c(),z(_,{key:t.tenantCustomerId,value:t.tenantCustomerId,label:t.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{prop:"doMoneyPrice",label:"原价"},{default:o(()=>[a(m,{modelValue:l.value.doMoneyPrice,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.doMoneyPrice=t),placeholder:"",clearable:"",onChange:e[2]||(e[2]=()=>{})},null,8,["modelValue"])]),_:1}),a(u,{label:"系统完成数"},{default:o(()=>[a(m,{modelValue:l.value.systemDone,"onUpdate:modelValue":e[3]||(e[3]=t=>l.value.systemDone=t),placeholder:"",clearable:"",onChange:e[4]||(e[4]=()=>{})},null,8,["modelValue"])]),_:1}),a(u,{label:"结算完成数"},{default:o(()=>[a(m,{modelValue:l.value.settlementDone,"onUpdate:modelValue":e[5]||(e[5]=t=>l.value.settlementDone=t),placeholder:"",clearable:"",onChange:e[6]||(e[6]=()=>{})},null,8,["modelValue"])]),_:1}),a(u,{label:"结算PO号"},{default:o(()=>[a(m,{modelValue:l.value.settlementPo,"onUpdate:modelValue":e[7]||(e[7]=t=>l.value.settlementPo=t),placeholder:"",clearable:"",onChange:e[8]||(e[8]=()=>{})},null,8,["modelValue"])]),_:1}),a(u,{label:"备注"},{default:o(()=>[a(m,{modelValue:l.value.remark,"onUpdate:modelValue":e[9]||(e[9]=t=>l.value.remark=t),placeholder:"",clearable:"",onChange:e[10]||(e[10]=()=>{})},null,8,["modelValue"])]),_:1}),a(u,{label:"状态"},{default:o(()=>[a(y,{placeholder:"结算状态",modelValue:l.value.status,"onUpdate:modelValue":e[11]||(e[11]=t=>l.value.status=t),clearable:"",filterable:""},{default:o(()=>[(c(),f(I,null,k(j,t=>a(_,{key:t.value,value:t.value,label:t.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])),[[q,i.value]])}}});export{Y as _};
