
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ae,O as oe,aN as ne,y as se,r as C,k as re,G as x,J as ie,a as u,p as ue,o as r,b as ce,f as o,w as a,aC as E,g as n,H as b,q as de,e as i,j as d,i as g,S as pe,b9 as me,N as fe,aP as be,aQ as _e,aq as ge,aJ as he,aK as ve,s as ye,R as ke}from"./index-BaLgkNXx.js";import{_ as Ce}from"./index.vue_vue_type_script_setup_true_lang-wYCiKfRi.js";import{_ as Ie}from"./index.vue_vue_type_style_index_0_lang-Bn58Pfcb.js";import{_ as we}from"./index.vue_vue_type_script_setup_true_lang-Bh-sdYrF.js";import{a as Le}from"./financial_log-DUCmOCmB.js";import{_ as Te}from"./index.vue_vue_type_script_setup_true_lang-g1nclINg.js";import Ee from"./index-ck--J_e8.js";import{u as Se}from"./useTabbar-DWdI2ZDV.js";import"./user_supplier-DnmsXYZh.js";const $e=y=>(he("data-v-d5a4bec1"),y=y(),ve(),y),ze=$e(()=>ye("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),De=ae({name:"financial_log",__name:"list",setup(y){const{format:S}=me();oe();const{pagination:h,getParams:H,onSizeChange:P,onCurrentChange:V,onSortChange:A}=ne();Se(),se();const $=C(),z=C(),I=C([{label:"供应商ID/内部调查站",prop:"typeId",sortable:!0,disableCheck:!1,checked:!0},{label:"项目ID",prop:"projectId",sortable:!0,disableCheck:!1,checked:!0},{label:"类型",prop:"type",sortable:!0,disableCheck:!1,checked:!0},{label:"说明",prop:"remark",sortable:!0,disableCheck:!1,checked:!0},{label:"变动前",prop:"beforeBalance",sortable:!0,disableCheck:!1,checked:!0},{label:"加减款",prop:"addAndSubtraction",sortable:!0,disableCheck:!1,checked:!0},{label:"变动后",prop:"afterBalance",sortable:!0,disableCheck:!1,checked:!0},{label:"时间",prop:"createTime",sortable:!0,disableCheck:!1,checked:!0}]),e=C({loading:!1,activeName:"myFinancial",tableAutoHeight:!1,border:!0,stripe:!1,lineHeight:"default",checkList:[],formMode:"drawer",formModeProps:{visible:!1,id:""},search:{page:1,limit:10,clientId:null,projectId:null,departmentId:null,groupId:null,userId:null,type:null,operationType:null,balanceType:null},batch:{enable:!1,selectionDataList:[]},dataList:[]});re(()=>{m(),e.value.formMode==="router"&&x.on("get-data-list",()=>{m()}),I.value.forEach(s=>{s.checked&&e.value.checkList.push(s.prop)})}),ie(()=>{e.value.formMode==="router"&&x.off("get-data-list")});function m(){e.value.loading=!0;const s={...H(),...e.value.search};Le.list(s).then(t=>{e.value.loading=!1,e.value.dataList=t.data.itemList,console.log("res",t),h.value.total=+t.data.total})}function M(s){$.value.showEdit(JSON.stringify(s))}function U(s){z.value.showEdit(s)}function j(){Object.assign(e.value.search,{page:1,limit:10,clientId:null,projectId:null,departmentId:null,groupId:null,userId:null,type:null,operationType:null,balanceType:null}),m()}function F(s){P(s).then(()=>{e.value.search.limit=s,m()})}function f(s=1){V(s).then(()=>{e.value.search.page=s,m()})}function N({prop:s,order:t}){A(s,t).then(()=>m())}return(s,t)=>{const w=u("ElInput"),k=u("ElFormItem"),D=fe,v=u("ElButton"),R=u("ElForm"),K=we,J=u("ElDivider"),O=Ie,q=u("el-button"),Q=be,G=_e,W=u("el-row"),X=u("el-table-column"),p=u("ElTableColumn"),_=u("el-text"),L=Ce,B=u("el-tag"),Y=u("el-empty"),Z=u("ElTable"),ee=u("ElPagination"),te=ge,le=ue("loading");return r(),ce("div",{class:pe({"absolute-container":e.value.tableAutoHeight})},[o(te,null,{default:a(()=>[o(K,{"show-toggle":!1},{default:a(({fold:l,toggle:T})=>[o(R,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:a(()=>[o(k,null,{default:a(()=>[o(w,{modelValue:e.value.search.supplierId,"onUpdate:modelValue":t[0]||(t[0]=c=>e.value.search.supplierId=c),placeholder:"员工ID",clearable:"",onKeydown:t[1]||(t[1]=E(c=>f(),["enter"])),onClear:t[2]||(t[2]=c=>f())},null,8,["modelValue"])]),_:1}),o(k,null,{default:a(()=>[o(w,{modelValue:e.value.search.projectId,"onUpdate:modelValue":t[3]||(t[3]=c=>e.value.search.projectId=c),placeholder:"用户名",clearable:"",onKeydown:t[4]||(t[4]=E(c=>f(),["enter"])),onClear:t[5]||(t[5]=c=>f())},null,8,["modelValue"])]),_:1}),o(k,null,{default:a(()=>[o(w,{modelValue:e.value.search.projectId,"onUpdate:modelValue":t[6]||(t[6]=c=>e.value.search.projectId=c),placeholder:"姓名",clearable:"",onKeydown:t[7]||(t[7]=E(c=>f(),["enter"])),onClear:t[8]||(t[8]=c=>f())},null,8,["modelValue"])]),_:1}),o(k,null,{default:a(()=>[o(v,{type:"primary",onClick:t[9]||(t[9]=c=>f())},{icon:a(()=>[o(D,{name:"i-ep:search"})]),default:a(()=>[n(" 筛选 ")]),_:1}),o(v,{onClick:j},{icon:a(()=>[ze]),default:a(()=>[n(" 重置 ")]),_:1}),o(v,{link:"",disabled:"",onClick:T},{icon:a(()=>[o(D,{name:l?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:a(()=>[n(" "+b(l?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),o(J,{"border-style":"dashed"}),o(W,null,{default:a(()=>[o(O),o(G,null,{default:a(()=>[o(q,{size:"default"},{default:a(()=>[n(" 导出 ")]),_:1}),o(Q,{border:e.value.border,"onUpdate:border":t[10]||(t[10]=l=>e.value.border=l),tableAutoHeight:e.value.tableAutoHeight,"onUpdate:tableAutoHeight":t[11]||(t[11]=l=>e.value.tableAutoHeight=l),checkList:e.value.checkList,"onUpdate:checkList":t[12]||(t[12]=l=>e.value.checkList=l),columns:I.value,"onUpdate:columns":t[13]||(t[13]=l=>I.value=l),"line-height":e.value.lineHeight,"onUpdate:lineHeight":t[14]||(t[14]=l=>e.value.lineHeight=l),stripe:e.value.stripe,"onUpdate:stripe":t[15]||(t[15]=l=>e.value.stripe=l),style:{"margin-left":"12px"},onQueryData:m},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),de((r(),i(Z,{border:e.value.border,size:e.value.lineHeight,stripe:e.value.stripe,class:"my-4",data:e.value.dataList,"highlight-current-row":"",height:"100%",onSortChange:N,onSelectionChange:t[16]||(t[16]=l=>e.value.batch.selectionDataList=l)},{empty:a(()=>[o(Y,{class:"vab-data-empty",description:"暂无数据"})]),default:a(()=>[o(X,{align:"center",type:"selection"}),e.value.batch.enable?(r(),i(p,{key:0,type:"selection","show-overflow-tooltip":"",align:"center",fixed:""})):d("",!0),e.value.checkList.includes("typeId")?(r(),i(p,{key:1,"show-overflow-tooltip":"",align:"center",prop:"",width:"180",label:"员工ID"},{default:a(({row:l})=>[l.typeId==1?(r(),i(_,{key:0},{default:a(()=>[n("内部调查站")]),_:1})):(r(),i(_,{key:1},{default:a(()=>[n(b(l.typeId?l.typeId:"-"),1)]),_:2},1024))]),_:1})):d("",!0),e.value.checkList.includes("type")?(r(),i(p,{key:2,"show-overflow-tooltip":"",align:"center",prop:"",label:"用户名"},{default:a(({row:l})=>[l.type==1?(r(),i(_,{key:0},{default:a(()=>[n("待审金额")]),_:1})):d("",!0),l.type==2?(r(),i(_,{key:1},{default:a(()=>[n("可用金额")]),_:1})):d("",!0)]),_:1})):d("",!0),e.value.checkList.includes("remark")?(r(),i(p,{key:3,"show-overflow-tooltip":"",align:"center",prop:"remark",label:"姓名"},{default:a(({row:l})=>[o(_,{class:"mx-1"},{default:a(()=>[n(b(l.remark?l.remark:"-"),1)]),_:2},1024)]),_:1})):d("",!0),e.value.checkList.includes("beforeBalance")?(r(),i(p,{key:4,"show-overflow-tooltip":"",align:"center",prop:"beforeBalance",width:"150",label:"所属组"},{default:a(({row:l})=>[o(L),n(b(l.beforeBalance||0),1)]),_:1})):d("",!0),e.value.checkList.includes("addAndSubtraction")?(r(),i(p,{key:5,"show-overflow-tooltip":"",align:"center",prop:"addAndSubtraction",width:"150",label:"职位"},{default:a(({row:l})=>[l.operationType===2?(r(),i(_,{key:0,type:"danger",class:"mx-1"},{default:a(()=>[n("- "),o(L),n(b(Math.abs(l.addAndSubtraction)),1)]),_:2},1024)):(r(),i(_,{key:1,type:"success",class:"mx-1"},{default:a(()=>[n(" + "),o(L),n(b(Math.abs(l.addAndSubtraction)),1)]),_:2},1024))]),_:1})):d("",!0),e.value.checkList.includes("createTime")?(r(),i(p,{key:6,"show-overflow-tooltip":"",align:"center",prop:"createTime",label:"待审提成"},{default:a(({row:l})=>[o(B,{effect:"plain",type:"info"},{default:a(()=>[n(b(g(S)(l.createTime)),1)]),_:2},1024)]),_:1})):d("",!0),e.value.checkList.includes("createTime")?(r(),i(p,{key:7,"show-overflow-tooltip":"",align:"center",prop:"createTime",label:"可用提成"},{default:a(({row:l})=>[o(B,{effect:"plain",type:"info"},{default:a(()=>[n(b(g(S)(l.createTime)),1)]),_:2},1024)]),_:1})):d("",!0),e.value.checkList.includes("createTime")?(r(),i(p,{key:8,align:"center",width:"200",label:"操作"},{default:a(({row:l})=>[o(v,{type:"primary",size:"small",plain:"",onClick:T=>U(l)},{default:a(()=>[n(" 财务日志 ")]),_:2},1032,["onClick"]),o(v,{type:"primary",size:"small",plain:"",onClick:T=>M(l)},{default:a(()=>[n(" 加减款 ")]),_:2},1032,["onClick"])]),_:1})):d("",!0)]),_:1},8,["border","size","stripe","data"])),[[le,e.value.loading]]),o(ee,{"current-page":g(h).page,total:g(h).total,"page-size":g(h).size,"page-sizes":g(h).sizes,layout:g(h).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:F,onCurrentChange:f},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),o(Te,{ref_key:"plusMinusPaymentsRef",ref:$,onFetchData:m},null,512),o(Ee,{ref_key:"financeLogRef",ref:z},null,512)],2)}}}),Fe=ke(De,[["__scopeId","data-v-d5a4bec1"]]);export{Fe as default};
