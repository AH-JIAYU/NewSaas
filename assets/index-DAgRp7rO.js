
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ve,aM as he,r as p,a2 as O,c as ye,D as we,a as i,al as Ie,o as u,b as U,f as e,w as l,i as t,am as y,a3 as K,a4 as Q,e as c,g as m,G as D,l as w,j as I,P as ke,L as Ce,aO as Le,aP as Se,p as Ve,aK as xe,aL as je,F as ze,aE as k,_ as Ee}from"./index-BQdTqJhu.js";import{_ as De}from"./index.vue_vue_type_style_index_0_lang-DVv9xbbp.js";import{_ as Ne}from"./index.vue_vue_type_script_setup_true_lang-CIaQfcj4.js";import{_ as Re,a as J}from"./index.vue_vue_type_script_setup_true_lang-N8NNb7Hd.js";import{u as Ue}from"./user_customer-DWFgz7Xk.js";/* empty css                      */import"./user_customer-AGUjGM6s.js";const Pe=C=>(xe("data-v-826ec5e9"),C=C(),je(),C),Fe=Pe(()=>ze("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Me=ve({name:"RecordSurveyIndex",__name:"index",setup(C){const W=Ue(),{getParams:X,pagination:d,onSizeChange:Y,onCurrentChange:Z}=he(),N=p(!1),P=p([]);p("");const _=p([]),L=p(!0),S=p(!1),V=p("default"),x=p(!1),j=p([{prop:"projectId",label:"项目id",sortable:!0,checked:!0},{prop:"projectName",label:"项目名称/客户简称",sortable:!0,checked:!0},{prop:"allocationType",label:"分配类型",sortable:!0,checked:!0},{prop:"passNumber",label:"通过数/提交数",sortable:!0,checked:!0},{prop:"passRate",label:"通过率",sortable:!0,checked:!0}]),s=O({memberId:"",memberGroupId:"",projectId:"",projectName:"",customerId:"",ip:"",surveyStatus:""}),F=p(),f=O({allocationTypeList:["未分配","供应商","会员组"],surveyStatusList:["完成/待审核","被甄别","配额满","安全终止","未完成"],viceStatusList:["待审","免审","过IR","时间果断","超时完成","超量完成","审核成功","审核失败","数据冻结","时间段过载","ip不一致","id重复参与"],customerList:[],vipList:[],vipGroupList:[],tenantSupplierList:[],expandedRows:[]});function ee(){s.pageNo=1,R()}function te(r){Y(r)}function M(r=1){Z(r)}async function T(r){const a=f.expandedRows.indexOf(r.id);if(a!==-1?f.expandedRows.splice(a,1):f.expandedRows.push(r.id),!r.children){const b=await J.childList({projectId:r.projectId});r.children=b.data.projectScreenMemberChildInfoList}}function le(r){F.value.showEdit(r)}const ae=ye(()=>P.value.slice((d.value.page-1)*d.value.size,d.value.page*d.value.size));async function R(){N.value=!0;const r={...X(),...s},{data:a}=await J.list(r);P.value=a.projectSurveyScreenInfoList,d.value.total=a.projectSurveyScreenInfoList.length,N.value=!1}function oe(){Object.assign(s,{memberId:"",memberGroupId:"",projectId:"",projectName:"",customerId:"",ip:"",surveyStatus:""}),R()}return we(async()=>{f.customerList=await W.getCustomerList(),j.value.forEach(r=>{r.checked&&_.value.push(r.prop)}),R()}),(r,a)=>{const b=i("el-input"),g=i("el-form-item"),$=i("el-option"),B=i("el-select"),G=Ce,z=i("ElButton"),ne=i("ElFormItem"),se=i("ElForm"),re=Ne,ie=i("ElDivider"),ue=De,H=i("el-button"),de=Le,pe=Se,ce=i("el-row"),v=i("el-table-column"),A=i("el-text"),E=i("ElTableColumn"),q=i("el-table"),me=i("el-empty"),_e=i("ElPagination"),fe=Ve,be=Ie("loading");return u(),U("div",{class:ke({"absolute-container":t(x)})},[e(fe,null,{default:l(()=>[e(re,{"show-toggle":!1},{default:l(({fold:o,toggle:h})=>[e(se,{model:t(s),size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:l(()=>[e(g,{label:""},{default:l(()=>[e(b,{modelValue:t(s).memberId,"onUpdate:modelValue":a[0]||(a[0]=n=>t(s).memberId=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"会员ID"},null,8,["modelValue"])]),_:1}),y(e(g,{label:""},{default:l(()=>[e(b,{modelValue:t(s).memberGroupId,"onUpdate:modelValue":a[1]||(a[1]=n=>t(s).memberGroupId=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"会员ID"},null,8,["modelValue"])]),_:2},1536),[[k,!o]]),e(g,{label:""},{default:l(()=>[e(b,{modelValue:t(s).projectId,"onUpdate:modelValue":a[2]||(a[2]=n=>t(s).projectId=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"项目ID"},null,8,["modelValue"])]),_:1}),y(e(g,{label:""},{default:l(()=>[e(b,{modelValue:t(s).name,"onUpdate:modelValue":a[3]||(a[3]=n=>t(s).name=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"项目名称"},null,8,["modelValue"])]),_:2},1536),[[k,!o]]),y(e(g,{label:""},{default:l(()=>[e(B,{modelValue:t(s).projectName,"onUpdate:modelValue":a[4]||(a[4]=n=>t(s).projectName=n),clearable:"",placeholder:"客户简称"},{default:l(()=>[(u(!0),U(K,null,Q(t(f).customerList,n=>(u(),c($,{key:n.tenantCustomerId,value:n.tenantCustomerId,label:n.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:2},1536),[[k,!o]]),y(e(g,{label:""},{default:l(()=>[e(b,{modelValue:t(s).ip,"onUpdate:modelValue":a[5]||(a[5]=n=>t(s).ip=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"IP地址"},null,8,["modelValue"])]),_:2},1536),[[k,!o]]),y(e(g,{label:""},{default:l(()=>[e(B,{modelValue:t(s).surveyStatus,"onUpdate:modelValue":a[6]||(a[6]=n=>t(s).surveyStatus=n),clearable:"",placeholder:"调查状态"},{default:l(()=>[(u(!0),U(K,null,Q(t(f).surveyStatusList,(n,ge)=>(u(),c($,{label:n,value:ge+1},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:2},1536),[[k,!o]]),e(ne,null,{default:l(()=>[e(z,{type:"primary",onClick:a[7]||(a[7]=n=>M())},{icon:l(()=>[e(G,{name:"i-ep:search"})]),default:l(()=>[m(" 筛选 ")]),_:1}),e(z,{onClick:oe},{icon:l(()=>[Fe]),default:l(()=>[m(" 重置 ")]),_:1}),e(z,{link:"",onClick:h},{icon:l(()=>[e(G,{name:o?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:l(()=>[m(" "+D(o?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),e(ie,{"border-style":"dashed"}),e(ce,null,{default:l(()=>[e(ue),e(pe,null,{default:l(()=>[e(H,{size:"default"},{default:l(()=>[m(" 导出 ")]),_:1}),e(de,{border:t(L),"onUpdate:border":a[8]||(a[8]=o=>w(L)?L.value=o:null),tableAutoHeight:t(x),"onUpdate:tableAutoHeight":a[9]||(a[9]=o=>w(x)?x.value=o:null),checkList:t(_),"onUpdate:checkList":a[10]||(a[10]=o=>w(_)?_.value=o:null),columns:t(j),"onUpdate:columns":a[11]||(a[11]=o=>w(j)?j.value=o:null),"line-height":t(V),"onUpdate:lineHeight":a[12]||(a[12]=o=>w(V)?V.value=o:null),stripe:t(S),"onUpdate:stripe":a[13]||(a[13]=o=>w(S)?S.value=o:null),style:{"margin-left":"12px"},onQueryData:ee},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),y((u(),c(q,{border:t(L),data:t(ae),size:t(V),stripe:t(S),"row-key":"id","expand-row-keys":t(f).expandedRows,onExpandChange:T},{empty:l(()=>[e(me,{class:"vab-data-empty",description:"暂无数据"})]),default:l(()=>[e(v,{type:"expand",width:"55"},{default:l(o=>[e(q,{data:o.row.children,"highlight-current-row":"",class:"hide-table-header",border:"",height:"100%"},{default:l(()=>[e(v,{width:"55"}),e(v,{width:"300",prop:"memberChildName",label:"名称+ID",align:"center"}),e(E,{prop:"status",label:"状态",align:"center"},{default:l(h=>[h.row.status===1?(u(),c(A,{key:0,type:"success"},{default:l(()=>[m("前置问卷通过")]),_:1})):(u(),c(A,{key:1,type:"danger"},{default:l(()=>[m("前置问卷未通过")]),_:1}))]),_:1}),e(E,{width:"200",align:"center",fixed:"right",label:"操作"},{default:l(h=>[e(z,{type:"primary",size:"small",plain:"",onClick:n=>le(h.row)},{default:l(()=>[m(" 查看问卷详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:2},1032,["data"])]),_:1}),t(_).includes("projectId")?(u(),c(v,{key:0,width:"300",align:"center",prop:"projectId","show-overflow-tooltip":"",label:"项目ID"})):I("",!0),t(_).includes("projectName")?(u(),c(v,{key:1,align:"center",prop:"projectName","show-overflow-tooltip":"",label:"项目名称/客户简称"})):I("",!0),t(_).includes("allocationType")?(u(),c(v,{key:2,align:"center","show-overflow-tooltip":"",label:"分配类型"},{default:l(({row:o})=>[m(D(t(f).allocationTypeList[o.allocationType-1]),1)]),_:1})):I("",!0),t(_).includes("passNumber")?(u(),c(v,{key:3,align:"center","show-overflow-tooltip":"",label:"通过数/提交数"},{default:l(({row:o})=>[m(D(o.passNumber||0)+"/ "+D(o.submitNumber||0),1)]),_:1})):I("",!0),t(_).includes("passRate")?(u(),c(E,{key:4,align:"center","show-overflow-tooltip":"",prop:"passRate",label:"通过率"})):I("",!0),e(E,{align:"center","show-overflow-tooltip":"",prop:"",label:"操作",width:"200"},{default:l(({row:o})=>[e(H,{plain:"",type:"primary",size:"small",onClick:h=>T(o)},{default:l(()=>[m(" 展开 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","data","size","stripe","expand-row-keys"])),[[be,t(N)]]),e(_e,{"current-page":t(d).page,total:t(d).total,"page-size":t(d).size,"page-sizes":t(d).sizes,layout:t(d).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:te,onCurrentChange:M},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e(Re,{ref_key:"questionnaireDetailsRef",ref:F},null,512)],2)}}}),Oe=Ee(Me,[["__scopeId","data-v-826ec5e9"]]);export{Oe as default};
