
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{k as $,d as me,W as pe,r as d,n as ce,a as u,q as fe,s as ve,o as x,b as N,f as e,w as a,y as m,g,z as F,j as _e,N as ge,E as C,a4 as ye,U as he,av as be,_ as Ve,ap as we,aH as Ce,aI as xe,L as Ne}from"./index-0p_DLa4T.js";import{a as O}from"./configuration_site_setting-xULfQmed.js";import{u as Le}from"./index-ijTI4ykH.js";import De from"./index-DVzKpRV1.js";import{u as Ee}from"./configuration_siteSetting-YAsOXSDf.js";import"./clipboard-BE1spmIc.js";import"./index-kfATZ1lI.js";import"./index-DoFjYdO0.js";import"./index-DNP9EpJm.js";const qe={getTenantLogo:f=>$.post("tenant-logo/getTenantLogo",f),uploadLogo:f=>$.post("tenant-logo/upload",f)},y=f=>(Ce("data-v-73dfdfa7"),f=f(),xe(),f),Ue={class:"domainNames"},ke={class:"domainName"},Oe={key:0},ze={key:0},Se=y(()=>m("span",{class:"green"},null,-1)),Pe=y(()=>m("span",{style:{"margin-right":"10px"}},"已生效",-1)),Qe=[Se,Pe],Ie={key:1},Re=y(()=>m("span",{class:"red"},null,-1)),Ae=y(()=>m("span",{style:{"margin-right":"10px"}},"未生效",-1)),Te=[Re,Ae],He=y(()=>m("span",{style:{"margin-left":"1.625rem",color:"#606266","font-size":"14px"}},"网址Logo",-1)),$e=y(()=>m("svg",{xmlns:"http://www.w3.org/2000/svg",width:"80",height:"80",viewBox:"0 0 80 80",fill:"none"},[m("g",{id:"Frame"},[m("path",{id:"Vector",d:"M64.2018 37.4596C64.2018 37.4596 63.7118 21.3346 50.5768 18.1296C37.4418 14.9246 31.1118 28.7646 30.9818 29.1596C30.8518 29.5546 30.2068 29.3746 30.2068 29.3746C29.1568 28.3796 24.5268 26.0946 19.6618 29.0246C14.8018 31.9546 16.5618 37.5196 16.5618 37.5196C16.5618 37.5196 9.35676 36.9346 5.66176 48.0596C1.97176 59.1946 14.9168 62.3496 14.9168 62.3496H36.6468V50.5046H32.2968H31.9168H31.6218V50.4846C31.3718 50.4846 31.1718 50.2846 31.1718 50.0296C31.1718 49.8796 31.2518 49.7496 31.3718 49.6646L40.2768 40.2996C40.4018 40.1596 40.5768 40.0646 40.7818 40.0646C40.9918 40.0646 41.1768 40.1696 41.3018 40.3246L50.1418 49.6146C50.1568 49.6246 50.1718 49.6396 50.1868 49.6546L50.2718 49.7446H50.2418C50.2868 49.8246 50.3168 49.8946 50.3168 49.9896C50.3168 50.2696 50.0918 50.4996 49.8068 50.4996C49.7968 50.4996 49.7968 50.4896 49.7868 50.4896V50.5096H44.9968V62.3546H64.7218C64.7218 62.3546 74.1268 59.9996 74.9568 50.2896C75.7968 40.5796 64.2018 37.4596 64.2018 37.4596Z",fill:"#409EFF"})])],-1)),Fe=y(()=>m("div",{class:"el-upload__text"}," 支持点击拖拽上传 ",-1)),Me=y(()=>m("div",{style:{color:"#47a2ff"},class:"el-upload__text"}," 支持上传JPG/JPEG/PNG图片，小于10MB ",-1)),We=["src"],je=me({name:"site_setting",__name:"list",setup(f){const M=Ee(),v=pe(),z=d(),W="https://saas-api.surveysaas.com/api/tenant-logo/upload",{toClipboard:j}=Le(),S=d("基本设置"),h=d(!1),b=d(),P=d(!1),L=d(),t=d({id:"",registerOffOrOn:!0,registerExamineOffOrOn:!1,keyWords:"",description:"",webName:"",topLevelDomainName:"",defaultPriceRatio:null,taxRate:null,minimumAmount:null,phone:"",email:"",qqCode:"",address:""}),V=d({webName:[{required:!0,message:"请输入网站名称",trigger:"blur"}],topLevelDomainName:[{required:!1,message:"请输入顶级域名",trigger:"blur"},{validator:(o,l,s)=>{new RegExp("^(?!-)[A-Za-z0-9-]{1,63}(?<!-)(?:\\.[A-Za-z0-9-]{1,63}(?<!-))*\\.[A-Za-z]{2,}$").test(l)?s():s(new Error("请输入合法的域名"))},trigger:"submit"}],phone:[{required:!1,trigger:"blur",message:"请输入手机号"},{validator:(o,l,s)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(t.value.phone)?s():s(new Error("请输入合法手机号"))},trigger:"blur"}],email:[{required:!1,trigger:"blur",message:"请输入邮箱"},{validator:(o,l,s)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t.value.email)?s():s(new Error("请输入合法邮箱"))},trigger:"blur"}],qqCode:[{required:!1,trigger:"blur",message:"请输入QQ号码"},{validator:(o,l,s)=>{/^[1-9][0-9]{4,14}$/.test(l)?s():s(new Error("请输入合法QQ号（5到15位数字，不能以0开头）"))},trigger:"blur"}],address:[{required:!1,message:"请输入内容",trigger:"blur"},{max:50,message:"最多输入 50 字",trigger:"blur"}]});ce(()=>{h.value=!0,v.logo&&(p.value=[{name:"logo",url:v.logo}]),D(),h.value=!1});async function D(){try{const{data:o}=await O.list();if(M.setSiteConfig(o),o&&(t.value=o||t.value,L.value=t.value,v.setWebName(o.webName),v.setDescription(o.description),v.setkeyWords(o.keyWords)),t.value.topLevelDomainName!==""&&t.value.topLevelDomainName!==null){const l=await O.getTenantWebConfigQueryAnalysis({url:t.value.topLevelDomainName});P.value=l.data.success,t.value.isAnalysis=l.data.success}}catch{}finally{h.value=!1}}const B=async()=>{var l;p.value=[];const o=await qe.getTenantLogo();o.data&&(v.setLogo(o.data.logoUrl),p.value.push({name:"file",url:(l=o==null?void 0:o.data)==null?void 0:l.logoUrl}))},Z=()=>{z.value.showEdit(L.value)},G=()=>{const o=t.value.personalizedDomainName;j(o),C({type:"success",message:"复制成功"})},J=v.token,K=d({Token:J}),Q=d(""),E=d(!1),I=d(),p=d([]),X=async()=>{C.success({message:"删除成功",center:!0}),v.delLogo()},Y=(o,l)=>(l.value=l.filter(s=>s.uid!==o.uid),!0),ee=(o,l)=>{const s=[".jpg",".jpeg",".png"],_=o.name.slice((o.name.lastIndexOf(".")-1>>>0)+2).toLowerCase();if(!s.includes(`.${_}`))return p.value=[],ye(()=>{p.value=[]}),C({type:"warning",message:"上传文件类型不正确，仅支持 jpg、jpeg 和 png 格式。"})},ae=(o,l)=>{o.status===-1?(he.error(o.error,{zIndex:2e3}),p.value=p.value.filter(s=>s.name!==l.name)):B()},le=async()=>{C.warning({message:"只能上传一个,删除原文件后重新上传",center:!0})},te=o=>{Q.value=o.url,E.value=!0};function q(){(t.value.email===""||t.value.email===null)&&(V.value.email=[],b.value.clearValidate("email")),(t.value.phone===""||t.value.phone===null)&&(V.value.phone=[],b.value.clearValidate("phone")),(t.value.qqCode===""||t.value.qqCode===null)&&(V.value.qqCode=[],b.value.clearValidate("qqCode")),(t.value.topLevelDomainName===""||t.value.topLevelDomainName===null)&&(V.value.topLevelDomainName=[],b.value.clearValidate("topLevelDomainName")),b.value&&b.value.validate(async o=>{if(o)try{h.value=!0,t.value.topLevelDomainName&&(t.value.topLevelDomainName=t.value.topLevelDomainName.replace(/^https?:\/\//,"")),p.value.length&&I.value.submit();const l=await O.edit(t.value);h.value=!1,l.status===1&&(D(),C.success({message:"修改成功",center:!0}))}catch(l){console.log("error",l)}finally{h.value=!1}})}return(o,l)=>{var H;const s=be,_=u("el-switch"),r=u("el-form-item"),i=u("el-col"),c=u("el-input"),R=Ve,A=u("el-tooltip"),T=u("el-text"),w=u("el-button"),oe=u("el-upload"),ne=u("el-dialog"),se=u("ElFormItem"),U=u("el-row"),k=u("el-tab-pane"),ie=u("el-form"),re=u("el-tabs"),ue=we,de=fe("loading");return ve((x(),N("div",null,[e(s,{title:"站点设置管理"}),e(ue,null,{default:a(()=>[e(re,{modelValue:S.value,"onUpdate:modelValue":l[13]||(l[13]=n=>S.value=n)},{default:a(()=>[e(ie,{ref_key:"formRef",ref:b,model:t.value,rules:V.value,"label-width":"100px","label-position":"right",inline:!1},{default:a(()=>[e(k,{label:"基础设置",name:"基本设置"},{default:a(()=>[e(U,{gutter:20},{default:a(()=>[e(i,{span:3},{default:a(()=>[e(r,{label:"注册开关"},{default:a(()=>[e(_,{modelValue:t.value.registerOffOrOn,"onUpdate:modelValue":l[0]||(l[0]=n=>t.value.registerOffOrOn=n),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:6},{default:a(()=>[e(r,{label:"注册审核"},{default:a(()=>[e(_,{modelValue:t.value.registerExamineOffOrOn,"onUpdate:modelValue":l[1]||(l[1]=n=>t.value.registerExamineOffOrOn=n),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:a(()=>[e(r,{label:"网站名称",prop:"webName"},{default:a(()=>[e(c,{modelValue:t.value.webName,"onUpdate:modelValue":l[2]||(l[2]=n=>t.value.webName=n),style:{width:"22.4375rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:a(()=>[e(r,{label:"网站关键字"},{default:a(()=>[m("div",Ue,[e(A,{class:"tooltips",content:"设定网站关键字，在浏览器中输入该关键字即可搜索到该网站",placement:"top"},{default:a(()=>[e(R,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})]),e(c,{modelValue:t.value.keyWords,"onUpdate:modelValue":l[3]||(l[3]=n=>t.value.keyWords=n),style:{width:"22.4375rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:a(()=>[e(r,{label:"网站描述"},{default:a(()=>[m("div",ke,[e(A,{class:"tooltips",content:"描述该网址功能及意义，可对外宣传使用",placement:"top"},{default:a(()=>[e(R,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})]),e(c,{modelValue:t.value.description,"onUpdate:modelValue":l[4]||(l[4]=n=>t.value.description=n),style:{width:"22.4375rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:a(()=>[e(r,{label:"个性化域名",prop:""},{default:a(()=>[e(T,{class:"mx-1"},{default:a(()=>[g(F(t.value.personalizedDomainName),1)]),_:1}),e(w,{class:"copy",type:"primary",plain:"",size:"small",onClick:G},{default:a(()=>[g("复制")]),_:1})]),_:1})]),_:1}),e(i,{span:24},{default:a(()=>[e(r,{label:"顶级域名",prop:"topLevelDomainName"},{default:a(()=>[e(T,{class:"mx-1"},{default:a(()=>[g(F(t.value.topLevelDomainName),1)]),_:1}),t.value.topLevelDomainName?(x(),N("div",Oe,[P.value?(x(),N("div",ze,Qe)):(x(),N("div",Ie,Te))])):_e("",!0),e(w,{class:"copy",onClick:Z,type:"primary",size:"small",plain:""},{default:a(()=>[g("CNAME配置")]),_:1})]),_:1})]),_:1}),e(i,{style:{"margin-bottom":"1rem"},span:24},{default:a(()=>[He]),_:1}),e(i,{span:24},{default:a(()=>[e(se,{style:{display:"flex","justify-content":"center","align-items":"center"},label:""},{default:a(()=>[e(oe,{class:ge({hide_box:p.value.length}),ref_key:"uploadRef",ref:I,drag:"","file-list":p.value,"onUpdate:fileList":l[5]||(l[5]=n=>p.value=n),headers:K.value,action:W,"auto-upload":!1,"list-type":"picture-card",limit:1,"on-preview":te,"on-remove":X,"on-success":ae,"on-change":ee,"on-exceed":le,"before-remove":Y},{default:a(()=>[$e,Fe,Me]),_:1},8,["class","file-list","headers"]),e(ne,{modelValue:E.value,"onUpdate:modelValue":l[6]||(l[6]=n=>E.value=n),style:{"z-index":"1000",transform:"translate(0)",position:"relative"}},{default:a(()=>[m("img",{"w-full":"",src:Q.value,alt:"Preview Image"},null,8,We)]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:a(()=>[e(r,null,{default:a(()=>[e(w,{type:"primary",onClick:q},{default:a(()=>[g(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{label:"高级设置",name:"高级设置"},{default:a(()=>[e(U,{gutter:20},{default:a(()=>[e(i,{span:24},{default:a(()=>[e(r,{label:"最低结算金额",prop:""},{default:a(()=>[e(c,{modelValue:t.value.minimumAmount,"onUpdate:modelValue":l[7]||(l[7]=n=>t.value.minimumAmount=n),modelModifiers:{number:!0},style:{width:"22.4375rem"},placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:a(()=>[e(r,{label:"供应商税点",prop:""},{default:a(()=>[e(c,{modelValue:t.value.taxRate,"onUpdate:modelValue":l[8]||(l[8]=n=>t.value.taxRate=n),modelModifiers:{number:!0},style:{width:"22.4375rem"},placeholder:""},{append:a(()=>[g("%")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:a(()=>[e(r,null,{default:a(()=>[e(w,{type:"primary",onClick:q},{default:a(()=>[g(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{label:"联系我们",name:"联系我们"},{default:a(()=>[e(U,{gutter:20},{default:a(()=>[e(i,{span:24},{default:a(()=>[e(r,{label:"电子邮箱",prop:"email"},{default:a(()=>[e(c,{style:{width:"22.4375rem"},modelValue:t.value.email,"onUpdate:modelValue":l[9]||(l[9]=n=>t.value.email=n),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:a(()=>[e(r,{label:"手机号码",prop:"phone"},{default:a(()=>[e(c,{style:{width:"22.4375rem"},modelValue:t.value.phone,"onUpdate:modelValue":l[10]||(l[10]=n=>t.value.phone=n),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:a(()=>[e(r,{label:"QQ号码",prop:"qqCode"},{default:a(()=>[e(c,{style:{width:"22.4375rem"},modelValue:t.value.qqCode,"onUpdate:modelValue":l[11]||(l[11]=n=>t.value.qqCode=n),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:a(()=>[e(r,{label:"公司地址",prop:"address"},{default:a(()=>[e(c,{style:{width:"22.4375rem"},modelValue:t.value.address,"onUpdate:modelValue":l[12]||(l[12]=n=>t.value.address=n),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:a(()=>[e(r,null,{default:a(()=>[e(w,{type:"primary",onClick:q},{default:a(()=>[g("确认")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]),_:1}),e(De,{ref_key:"recordRef",ref:z,onFetchData:D,personalizedDomainName:(H=L.value)==null?void 0:H.personalizedDomainName},null,8,["personalizedDomainName"])])),[[de,h.value]])}}}),sa=Ne(je,[["__scopeId","data-v-73dfdfa7"]]);export{sa as default};
