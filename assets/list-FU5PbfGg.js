
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as oe,aF as ne,r as le,B as se,C as D,G as ie,a as s,ai as re,o as c,b as ue,f as t,w as o,av as M,g as r,D as de,e as f,j as k,aj as ce,i as _,O as me,aG as V,aq as x,K as pe,q as fe,ax as ge,ay as ve,l as he,_ as _e,p as $}from"./index-DQumISPN.js";import{_ as be}from"./index.vue_vue_type_script_setup_true_lang-CI9vxT2y.js";import Ee from"./index-BtvqGDc3.js";import{a as C}from"./index.vue_vue_type_script_setup_true_lang-CVMTCv3Q.js";import{u as we}from"./useTabbar-B7dQRT9e.js";import"./role-IA7-I9MZ.js";const Ce=b=>(ge("data-v-f6d90aa4"),b=b(),ve(),b),ye=Ce(()=>he("div",{class:"i-grommet-icons:power-reset w-1em h-1em"},null,-1)),L=oe({name:"PagesExampleManagerList",__name:"list",setup(b){const{pagination:g,getParams:B,onSizeChange:I,onCurrentChange:T,onSortChange:U}=ne(),z=we(),e=le({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,id:""},search:{account:"",name:"",mobile:""},batch:{enable:!0,selectionDataList:[]},dataList:[]});se(()=>{u(),e.value.formMode==="router"&&D.on("get-data-list",()=>{u()})}),ie(()=>{e.value.formMode==="router"&&D.off("get-data-list")});function u(){e.value.loading=!0;const n={...B(),...e.value.search.account&&{account:e.value.search.account},...e.value.search.name&&{name:e.value.search.name},...e.value.search.mobile&&{mobile:e.value.search.mobile}};C.list(n).then(a=>{e.value.loading=!1,e.value.dataList=a.data.list,e.value.dataList.forEach(h=>{h.statusLoading=!1}),g.value.total=a.data.total})}function F(){Object.assign(e.value.search,{account:"",name:"",mobile:"",sex:""}),u()}function K(n){I(n).then(()=>u())}function d(n=1){T(n).then(()=>u())}function G({prop:n,order:a}){U(n,a).then(()=>u())}function N(){e.value.formMode==="router"?z.open({name:"pagesExampleGeneralManagerCreate"}):(e.value.formModeProps.id="",e.value.formModeProps.visible=!0)}function j(n){e.value.formMode==="router"?z.open({name:"pagesExampleGeneralManagerEdit",params:{id:n.id}}):(e.value.formModeProps.id=n.id,e.value.formModeProps.visible=!0)}function O(n){return new Promise(a=>{V.confirm(`确认${n.status?"禁用":"启用"}「${n.account}」吗？`,"确认信息").then(()=>{n.statusLoading=!0,C.changeStatus({id:n.id,status:!n.status}).then(()=>(n.statusLoading=!1,x.success({message:`模拟${n.status?"禁用":"启用"}成功`,center:!0}),a(!0))).catch(()=>(n.statusLoading=!1,a(!1)))}).catch(()=>a(!1))})}function R(n){V.confirm(`确认将「${n.account}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{C.passwordReset(n.id).then(()=>{x.success({message:"模拟重置成功",center:!0})})}).catch(()=>{})}function q(n){V.confirm(`确认删除「${n.account}」用户吗？`,"确认信息").then(()=>{C.delete(n.id).then(()=>{u(),x.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}function A(n,a){switch(n){case"resetPassword":R(a);break;case"delete":q(a);break}}return(n,a)=>{const h=s("ElInput"),E=s("ElFormItem"),w=pe,m=s("ElButton"),H=s("ElForm"),J=be,Q=s("ElDivider"),P=s("ElSpace"),p=s("ElTableColumn"),y=s("ElTag"),W=s("ElSwitch"),S=s("ElDropdownItem"),X=s("ElDropdownMenu"),Y=s("ElDropdown"),Z=s("ElTable"),ee=s("ElPagination"),ae=fe,te=re("loading");return c(),ue("div",{class:me({"absolute-container":e.value.tableAutoHeight})},[t(ae,null,{default:o(()=>[t(J,{"show-toggle":!1},{default:o(({fold:l,toggle:v})=>[t(H,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:o(()=>[t(E,null,{default:o(()=>[t(h,{modelValue:e.value.search.account,"onUpdate:modelValue":a[0]||(a[0]=i=>e.value.search.account=i),placeholder:"请输入帐号，支持模糊查询",clearable:"",onKeydown:a[1]||(a[1]=M(i=>d(),["enter"])),onClear:a[2]||(a[2]=i=>d())},null,8,["modelValue"])]),_:1}),t(E,null,{default:o(()=>[t(h,{modelValue:e.value.search.name,"onUpdate:modelValue":a[3]||(a[3]=i=>e.value.search.name=i),placeholder:"请输入姓名，支持模糊查询",clearable:"",onKeydown:a[4]||(a[4]=M(i=>d(),["enter"])),onClear:a[5]||(a[5]=i=>d())},null,8,["modelValue"])]),_:1}),t(E,null,{default:o(()=>[t(h,{modelValue:e.value.search.mobile,"onUpdate:modelValue":a[6]||(a[6]=i=>e.value.search.mobile=i),placeholder:"请输入手机号",clearable:"",onKeydown:a[7]||(a[7]=M(i=>d(),["enter"])),onClear:a[8]||(a[8]=i=>d())},null,8,["modelValue"])]),_:1}),t(E,null,{default:o(()=>[t(m,{type:"primary",onClick:a[9]||(a[9]=i=>d())},{icon:o(()=>[t(w,{name:"i-ep:search"})]),default:o(()=>[r(" 筛选 ")]),_:1}),t(m,{onClick:F},{icon:o(()=>[ye]),default:o(()=>[r(" 重置 ")]),_:1}),t(m,{disabled:"",link:"",onClick:v},{icon:o(()=>[t(w,{name:l?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:o(()=>[r(" "+de(l?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),t(Q,{"border-style":"dashed"}),t(P,{wrap:""},{default:o(()=>[t(m,{type:"primary",size:"default",onClick:N},{icon:o(()=>[t(w,{name:"i-ep:plus"})]),default:o(()=>[r(" 新增用户 ")]),_:1}),e.value.batch.enable?(c(),f(m,{key:0,size:"default",disabled:!e.value.batch.selectionDataList.length},{default:o(()=>[r(" 批量操作 ")]),_:1},8,["disabled"])):k("",!0)]),_:1}),ce((c(),f(Z,{class:"my-4",data:e.value.dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:G,onSelectionChange:a[10]||(a[10]=l=>e.value.batch.selectionDataList=l)},{default:o(()=>[e.value.batch.enable?(c(),f(p,{key:0,type:"selection",align:"center",fixed:""})):k("",!0),t(p,{prop:"account",sortable:"",label:"帐号"}),t(p,{prop:"name",label:"姓名",width:"100",align:"center"}),t(p,{prop:"sex",label:"性别",width:"100",align:"center"},{default:o(l=>[l.row.sex===1?(c(),f(y,{key:0,type:"success",size:"small"},{default:o(()=>[r(" 男 ")]),_:1})):l.row.sex===0?(c(),f(y,{key:1,type:"warning",size:"small"},{default:o(()=>[r(" 女 ")]),_:1})):(c(),f(y,{key:2,type:"info",size:"small"},{default:o(()=>[r(" 保密 ")]),_:1}))]),_:1}),t(p,{prop:"mobile",label:"手机号",width:"150",align:"center"}),t(p,{label:"状态",width:"100",align:"center"},{default:o(l=>[t(W,{modelValue:l.row.status,"onUpdate:modelValue":v=>l.row.status=v,loading:l.row.statusLoading,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>O(l.row)},null,8,["modelValue","onUpdate:modelValue","loading","before-change"])]),_:1}),t(p,{label:"操作",width:"200",align:"center",fixed:"right"},{default:o(l=>[t(P,null,{default:o(()=>[t(m,{type:"primary",size:"small",plain:"",onClick:v=>j(l.row)},{default:o(()=>[r(" 编辑 ")]),_:2},1032,["onClick"]),t(Y,{onCommand:v=>A(v,l.row)},{dropdown:o(()=>[t(X,null,{default:o(()=>[t(S,{command:"resetPassword"},{default:o(()=>[r(" 重置密码 ")]),_:1}),t(S,{command:"delete",divided:""},{default:o(()=>[r(" 删除 ")]),_:1})]),_:1})]),default:o(()=>[t(m,{size:"small"},{default:o(()=>[r(" 更多操作 "),t(w,{name:"i-ep:arrow-down",class:"el-icon--right"})]),_:1})]),_:2},1032,["onCommand"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[te,e.value.loading]]),t(ee,{"current-page":_(g).page,total:_(g).total,"page-size":_(g).size,"page-sizes":_(g).sizes,layout:_(g).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:d,onSizeChange:K},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e.value.formMode==="dialog"||e.value.formMode==="drawer"?(c(),f(Ee,{key:0,id:e.value.formModeProps.id,modelValue:e.value.formModeProps.visible,"onUpdate:modelValue":a[11]||(a[11]=l=>e.value.formModeProps.visible=l),mode:e.value.formMode,onSuccess:u},null,8,["id","modelValue","mode"])):k("",!0)],2)}}});typeof $=="function"&&$(L);const Se=_e(L,[["__scopeId","data-v-f6d90aa4"]]);export{Se as default};
