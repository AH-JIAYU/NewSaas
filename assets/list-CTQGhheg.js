
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Ve,aH as Se,r as u,c as je,G as ze,a as r,al as Ee,o as d,b as D,f as e,w as l,i as o,am as k,F as B,n as O,e as w,g as p,I as m,p as b,j as Le,R as Pe,N as De,aJ as Ue,aK as Re,s as xe,aF as Ne,aG as Fe,l as $e,aM as V,_ as Te}from"./index-C29iptdf.js";import{_ as Be}from"./index.vue_vue_type_style_index_0_lang-SmvMLd40.js";import{_ as Ae}from"./index.vue_vue_type_script_setup_true_lang-DlFMuO4t.js";import He from"./index-Du1rFcg0.js";import Me from"./index-inn-h1iU.js";import Ge from"./index-oxFk_e6X.js";import{a as Qe}from"./index-381DLN_z.js";import{u as Je}from"./otherFunctions_basicDictionary-BOi-M26g.js";import{u as Ke}from"./user_customer-bFUIgmZc.js";import"./user_supplier-D-7SQ2C1.js";import"./user_supplier-CaJjNO-Z.js";import"./index-Bu8hTXaX.js";import"./index.vue_vue_type_script_setup_true_lang-CDHYs5hc.js";import"./index-D7k_Vn1v.js";import"./index-DFJLODe7.js";import"./apiLoading-DqtAc4mt.js";import"./basicDictionary-CrjET7Gj.js";import"./user_customer-Bnw28do9.js";import"./stagedData-CMAIBnSg.js";import"./index.vue_vue_type_script_setup_true_lang-CoYQwbxp.js";const Oe=S=>(Ne("data-v-80edd5ca"),S=S(),Fe(),S),qe=Oe(()=>$e("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),We=Ve({name:"ProjectManagementListIndex",__name:"list",setup(S){const q=Ke(),W=Je(),{pagination:f,getParams:X,onSizeChange:Y,onCurrentChange:Z,onSortChange:Xe}=Se();f.value.size=5,f.value.sizes=[5,10,20,50];const ee=u(""),U=u(!0),A=u(),R=u(),H=u(),j=u(!0),x=u([]),z=u(!1),C=u(!1),E=u("default"),L=u(!1),N=u([]),n=u({time:[],beginTime:"",endTime:"",projectId:"",name:"",projectIdentification:"",clientId:"",createName:"",allocation:"",allocationStatus:"",status:""}),M=u([]);function G(s){A.value.showEdit(s)}function te(){R.value.showEdit()}function le(s){R.value.showEdit(s)}function oe(s){H.value.showEdit(s)}function ae(){C.value=!C.value}function ne(s){Y(s).then(()=>I())}function F(s=1){Z(s).then(()=>I())}function ie(){n.value={time:[],beginTime:"",endTime:"",projectId:"",name:"",projectIdentification:"",clientId:"",createName:"",allocation:"",allocationStatus:"",status:""},I()}async function I(){U.value=!0;const s={...X(),...n.value};n.value.time&&n.value.time.length&&(s.beginTime=n.value.time[0]||"",s.endTime=n.value.time[1]||"");const{data:a}=await Qe.list(s);M.value=a.getChildrenProjectInfoList,f.value.total=a.total,U.value=!1}const Q=u([]),J=u([]),P=je(()=>s=>Q.value.filter(_=>s.includes(_.id)).map(_=>_.chineseName));return ze(async()=>{Q.value=await W.getCountry(),J.value=await q.getCustomerList(),I()}),(s,a)=>{const _=r("el-input"),g=r("el-form-item"),y=r("el-option"),$=r("el-select"),re=r("el-date-picker"),K=De,T=r("ElButton"),se=r("ElFormItem"),ce=r("el-form"),ue=Ae,pe=r("ElDivider"),h=r("el-button"),de=Be,me=Ue,fe=Re,_e=r("el-row"),c=r("el-table-column"),ge=r("el-link"),ve=r("el-tooltip"),be=r("el-tag"),ye=r("ElSwitch"),he=r("el-empty"),ke=r("el-table"),we=r("ElPagination"),Ce=xe,Ie=Ee("loading");return d(),D("div",{class:Pe({"absolute-container":o(z)})},[e(Ce,{class:"hide-drawer-header"},{default:l(()=>[e(ue,{"show-toggle":!1},{default:l(({fold:t,toggle:v})=>[e(ce,{model:o(n),size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:l(()=>[e(g,{label:""},{default:l(()=>[e(_,{modelValue:o(n).projectId,"onUpdate:modelValue":a[0]||(a[0]=i=>o(n).projectId=i),clearable:"",placeholder:"项目ID"},null,8,["modelValue"])]),_:1}),e(g,{label:""},{default:l(()=>[e(_,{modelValue:o(n).name,"onUpdate:modelValue":a[1]||(a[1]=i=>o(n).name=i),clearable:"",placeholder:"项目名称"},null,8,["modelValue"])]),_:1}),e(g,{label:""},{default:l(()=>[e(_,{clearable:"",modelValue:o(n).projectIdentification,"onUpdate:modelValue":a[2]||(a[2]=i=>o(n).projectIdentification=i),placeholder:"项目标识"},null,8,["modelValue"])]),_:1}),k(e(g,{label:""},{default:l(()=>[e($,{modelValue:o(n).clientId,"onUpdate:modelValue":a[3]||(a[3]=i=>o(n).clientId=i),placeholder:"客户简称"},{default:l(()=>[(d(!0),D(B,null,O(o(J),i=>(d(),w(y,{key:i.tenantCustomerId,value:i.tenantCustomerId,label:i.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:2},1536),[[V,!t]]),k(e(g,{label:""},{default:l(()=>[e($,{modelValue:o(n).allocationStatus,"onUpdate:modelValue":a[4]||(a[4]=i=>o(n).allocationStatus=i),placeholder:"分配类型"},{default:l(()=>[e(y,{label:"自动分配",value:1}),e(y,{label:"供应商",value:2}),e(y,{label:"会员组",value:3})]),_:1},8,["modelValue"])]),_:2},1536),[[V,!t]]),k(e(g,{label:""},{default:l(()=>[e($,{modelValue:o(n).status,"onUpdate:modelValue":a[5]||(a[5]=i=>o(n).status=i),placeholder:"项目状态"},{default:l(()=>[e(y,{label:"已分配",value:1}),e(y,{label:"未分配",value:2})]),_:1},8,["modelValue"])]),_:2},1536),[[V,!t]]),k(e(g,null,{default:l(()=>[e(_,{modelValue:o(n).createName,"onUpdate:modelValue":a[6]||(a[6]=i=>o(n).createName=i),clearable:"",placeholder:"创建人"},null,8,["modelValue"])]),_:2},1536),[[V,!t]]),k(e(g,null,{default:l(()=>[e(re,{modelValue:o(n).time,"onUpdate:modelValue":a[7]||(a[7]=i=>o(n).time=i),type:"daterange","unlink-panels":"","range-separator":"-","start-placeholder":"创建开始日期","end-placeholder":"创建结束日期",size:"default",style:{width:"192px"},"clear-icon":"true"},null,8,["modelValue"])]),_:2},1536),[[V,!t]]),e(se,null,{default:l(()=>[e(T,{type:"primary",onClick:a[8]||(a[8]=i=>F())},{icon:l(()=>[e(K,{name:"i-ep:search"})]),default:l(()=>[p(" 筛选 ")]),_:1}),e(T,{onClick:ie},{icon:l(()=>[qe]),default:l(()=>[p(" 重置 ")]),_:1}),e(T,{link:"",onClick:v},{icon:l(()=>[e(K,{name:t?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:l(()=>[p(" "+m(t?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),e(pe,{"border-style":"dashed"}),e(_e,{gutter:24},{default:l(()=>[e(de,null,{default:l(()=>[e(h,{type:"primary",size:"default",onClick:te},{default:l(()=>[p(" 添加项目 ")]),_:1})]),_:1}),e(fe,null,{default:l(()=>[e(h,{size:"default",onClick:a[9]||(a[9]=()=>{})},{default:l(()=>[p(" 导出 ")]),_:1}),e(me,{border:o(j),"onUpdate:border":a[10]||(a[10]=t=>b(j)?j.value=t:null),tableAutoHeight:o(z),"onUpdate:tableAutoHeight":a[11]||(a[11]=t=>b(z)?z.value=t:null),checkList:o(x),"onUpdate:checkList":a[12]||(a[12]=t=>b(x)?x.value=t:null),columns:o(N),"onUpdate:columns":a[13]||(a[13]=t=>b(N)?N.value=t:null),"is-fullscreen":o(C),"onUpdate:isFullscreen":a[14]||(a[14]=t=>b(C)?C.value=t:null),"line-height":o(E),"onUpdate:lineHeight":a[15]||(a[15]=t=>b(E)?E.value=t:null),stripe:o(L),"onUpdate:stripe":a[16]||(a[16]=t=>b(L)?L.value=t:null),style:{"margin-left":"12px"},onClickFullScreen:ae,onQueryData:F},null,8,["border","tableAutoHeight","checkList","columns","is-fullscreen","line-height","stripe"])]),_:1})]),_:1}),k((d(),w(ke,{ref_key:"tableSortRef",ref:ee,style:{"margin-top":"10px"},"row-key":"projectId",data:o(M),"tree-props":{children:"getChildrenProjectListInfoList"},border:o(j),size:o(E),stripe:o(L)},{empty:l(()=>[e(he,{description:"暂无数据"})]),default:l(()=>[e(c,{type:"selection"}),e(c,{"show-overflow-tooltip":"",prop:"projectId",align:"center",label:"项目ID"}),e(c,{"show-overflow-tooltip":"",prop:"name",align:"center",label:"项目名称"}),e(c,{"show-overflow-tooltip":"",prop:"clientName",align:"center",label:"客户简称/标识"}),e(c,{"show-overflow-tooltip":"",align:"center",label:"参与/完成/配额/限量"},{default:l(({row:t})=>[p(m(t.participation)+"/ "+m(t.complete)+"/ "+m(t.num)+"/ "+m(t.limitedQuantity),1)]),_:1}),e(c,{"show-overflow-tooltip":"",prop:"allocationType",align:"center",label:"分配类型"}),e(c,{"show-overflow-tooltip":"",align:"center",label:"原价"},{default:l(({row:t})=>[p(" $ "+m(t.doMoneyPrice)+" ￥"+m(t.memberPrice),1)]),_:1}),e(c,{"show-overflow-tooltip":"",prop:"f",align:"center",label:"供应商价"}),e(c,{"show-overflow-tooltip":"",prop:"ir",align:"center",label:"IR/NIR"}),e(c,{"show-overflow-tooltip":"",prop:"countryIdList",align:"center",label:"国家地区",width:"200"},{default:l(({row:t})=>[t.countryIdList?(d(),D(B,{key:0},[o(P)(t.countryIdList).length>4?(d(),w(ve,{key:0,class:"box-item",effect:"dark",content:o(P)(t.countryIdList).join(","),placement:"top"},{default:l(()=>[e(ge,{type:"primary"},{default:l(()=>[p(m(o(P)(t.countryIdList).length),1)]),_:2},1024)]),_:2},1032,["content"])):(d(!0),D(B,{key:1},O(o(P)(t.countryIdList),v=>(d(),w(be,{key:v,type:"primary"},{default:l(()=>[p(m(v),1)]),_:2},1024))),128))],64)):Le("",!0)]),_:1}),e(c,{"show-overflow-tooltip":"",prop:"allocationStatus",align:"center",label:"分配状态"}),e(c,{"show-overflow-tooltip":"",prop:"isOnline",align:"center",label:"项目状态"},{default:l(()=>[e(ye,{"inline-prompt":"","active-text":"启用","inactive-text":"禁用"})]),_:1}),e(c,{"show-overflow-tooltip":"",prop:"remark",align:"center",label:"备注"}),e(c,{"show-overflow-tooltip":"",prop:"createName",align:"center",label:"创建人"}),e(c,{"show-overflow-tooltip":"",prop:"createTime",align:"center",label:"创建时间"}),e(c,{align:"center",label:"操作",width:"250"},{default:l(({row:t})=>[t.allocationStatus===1?(d(),w(h,{key:0,plain:"",type:"primary",size:"small",onClick:v=>G(t)},{default:l(()=>[p(" 分配 ")]),_:2},1032,["onClick"])):(d(),w(h,{key:1,plain:"",type:"primary",size:"small",onClick:v=>G(t)},{default:l(()=>[p(" 重新分配 ")]),_:2},1032,["onClick"])),e(h,{type:"primary",plain:"",size:"small",onClick:v=>le(t)},{default:l(()=>[p(" 编辑 ")]),_:2},1032,["onClick"]),e(h,{type:"primary",size:"small",plain:"",onClick:v=>oe(t)},{default:l(()=>[p(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[Ie,o(U)]]),e(we,{"current-page":o(f).page,total:o(f).total,"page-size":o(f).size,"page-sizes":o(f).sizes,layout:o(f).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:ne,onCurrentChange:F},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e(He,{ref_key:"addAllocationEditRef",ref:A},null,512),e(Me,{ref_key:"addProjeckRef",ref:R,onFetchData:I},null,512),e(Ge,{ref_key:"projectDetailsRef",ref:H},null,512)],2)}}}),bt=Te(We,[["__scopeId","data-v-80edd5ca"]]);export{bt as default};
