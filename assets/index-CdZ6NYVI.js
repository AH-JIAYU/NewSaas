
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as V}from"./dictionary-BJCmFq9i.js";import{d as F,m as I,u as U,c as y,r as b,D as R,a as i,o as T,e as q,w as n,f as d,g as C,i as t,ak as k,_ as z}from"./index-s9D_0c9m.js";const S=F({__name:"index",props:I({parentId:{default:""},id:{default:""},tree:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:I(["addNode","editNode"],["update:modelValue"]),setup(E,{emit:x}){const s=E,g=x,v=U(E,"modelValue"),N=y(()=>s.id===""?"新增字典":"编辑字典");function _(o,a,p=!1){const u=[];return o.forEach(f=>{const l={...f};l.id===a||p?(l.disabled=!0,l.children&&(l.children=_(l.children,a,!0))):(l.disabled=!1,l.children&&(l.children=_(l.children,a,p))),u.push(l)}),u}const w=y(()=>_(s.tree,s.id)),c=b(),e=b({parentId:s.parentId,id:s.id,name:"",code:""}),B=b({name:[{required:!0,message:"请输入字典名称"}],code:[{required:!0,message:"请输入字典编码"}]});R(()=>{s.id!==""&&V.detail(s.id).then(o=>{e.value.id=o.data.id,e.value.name=o.data.name,e.value.code=o.data.code})});function D(){e.value.id===""?c.value&&c.value.validate(o=>{o&&V.create(e.value).then(a=>{k.success({message:"模拟新增成功",center:!0}),g("addNode",{id:a.data.data,label:e.value.name,code:e.value.code}),m()})}):c.value&&c.value.validate(o=>{o&&V.edit(e.value).then(()=>{k.success({message:"模拟编辑成功",center:!0}),g("editNode",{id:e.value.id,label:e.value.name,code:e.value.code},e.value.parentId),m()})})}function m(){v.value=!1}return(o,a)=>{const p=i("ElCascader"),u=i("ElFormItem"),f=i("ElInput"),l=i("ElForm"),h=i("ElButton"),M=i("ElDialog");return T(),q(M,{modelValue:v.value,"onUpdate:modelValue":a[3]||(a[3]=r=>v.value=r),title:t(N),width:"400px","close-on-click-modal":!1,"append-to-body":"","destroy-on-close":"",onClosed:m},{footer:n(()=>[d(h,{size:"large",onClick:m},{default:n(()=>[C(" 取消 ")]),_:1}),d(h,{type:"primary",size:"large",onClick:D},{default:n(()=>[C(" 确定 ")]),_:1})]),default:n(()=>[d(l,{ref_key:"formRef",ref:c,model:t(e),rules:t(B),"label-width":"80px"},{default:n(()=>[d(u,{label:"父级字典",prop:"parentId"},{default:n(()=>[d(p,{modelValue:t(e).parentId,"onUpdate:modelValue":a[0]||(a[0]=r=>t(e).parentId=r),options:t(w),props:{value:"id",emitPath:!1,checkStrictly:!0},"show-all-levels":!1,placeholder:"请选择父级字典，默认为根字典",clearable:""},null,8,["modelValue","options"])]),_:1}),d(u,{label:"字典名称",prop:"name"},{default:n(()=>[d(f,{modelValue:t(e).name,"onUpdate:modelValue":a[1]||(a[1]=r=>t(e).name=r),placeholder:"请输入字典名称",clearable:""},null,8,["modelValue"])]),_:1}),d(u,{label:"字典编码",prop:"code"},{default:n(()=>[d(f,{modelValue:t(e).code,"onUpdate:modelValue":a[2]||(a[2]=r=>t(e).code=r),placeholder:"请输入字典编码",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),A=z(S,[["__scopeId","data-v-c4b2809f"]]);export{A as default};
