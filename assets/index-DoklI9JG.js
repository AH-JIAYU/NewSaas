
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as O,ae as $,ac as J,r as C,o as W,a2 as u,a as s,i as k,h as t,c as g,w as o,f as r,g as y,t as m,N as V,b as f,j as p,O as X,a3 as D,aG as w,ak as S,ai as Y,aR as Z,aH as ee,aI as te,y as ae}from"./index-C7IrLSdY.js";import{u as le}from"./projectManagement_list-q_X4L-LY.js";import{u as oe}from"./stagedData-DAgHMaB5.js";import{u as re}from"./user_customer-DMD81TNi.js";import{a as L}from"./projectManagement-Dh1DCvo9.js";import"./user_customer-y55R9sId.js";const ie=_=>(ee("data-v-b7a01ba3"),_=_(),te(),_),ne=ie(()=>f("br",null,null,-1)),se={style:{float:"left"}},ue={style:{float:"right",color:"red","font-size":"13px"}},de=O({name:"ProjeckEdit",__name:"index",emits:["fetch-data"],setup(_,{expose:j,emit:P}){const{t:i}=$(),v=le();oe();const M=J(),x=re(),T=P,q=C(),e=C({dialogTableVisible:!1,title:"",type:"",loading:"",formData:{},customerList:[],rules:{name:[{required:!0,message:"请输入项目名称",trigger:"blur"},{min:2,max:50,message:"内容在2-50个字之间",trigger:"blur"}],projectIdentification:[{max:100,required:!0,message:"请输入项目标识",trigger:"blur"},{min:2,max:100,message:"内容在2-100个字之间",trigger:"blur"}],countryIdList:[{required:!0,message:"请选择所属区域",trigger:"change"}],clientId:[{required:!0,message:"请选择所属客户",trigger:"change"}],doMoneyPrice:[{required:!0,message:"请输入项目价",trigger:"blur"}],num:[{required:!0,message:"请输入配额",trigger:"blur"}],minimumDuration:[{required:!0,message:"请输入最小分长",trigger:"blur"}],ir:[{required:!0,message:"请输入配额",trigger:"blur"}]}}),U={PCNL:"参数",customer:"客户",name:"名称/标识",doMoneyPrice:"项目价",ir:"IR",remark:"备注"};async function N(n,l){e.value.title=U[l],e.value.type=l;try{e.value.loading=!0;const c=await L.detail({projectId:n.projectId});e.value.formData=c.data,e.value.dialogTableVisible=!0,e.value.loading=!1,v.dataBeforeEditing=[S(e.value.formData)]}catch{}finally{e.value.loading=!1}e.value.customerList=await x.getCustomerList()}const I=n=>{n.key==="."&&n.preventDefault()},R=async()=>{const n=S(e.value.formData);return await v.compareProjectData(v.dataBeforeEditing,[n]),n};async function B(){e.value.loading=!0,q.value.validate(async n=>{if(n){const l=await R(),{status:c}=await L.edit(l);c===1&&Y.success({message:"编辑成功",center:!0}),T("fetch-data"),E()}e.value.loading=!1})}function E(){e.value.dialogTableVisible=!1,e.value.formData={}}const A=async()=>{await x.getCustomerList(),await M.getCountry()};return W(async()=>{await A()}),j({showEdit:N}),(n,l)=>{const c=u("el-input-number"),d=u("el-form-item"),Q=u("el-text"),H=u("el-option"),K=u("el-select"),b=u("el-input"),z=Z,F=u("el-form"),h=u("el-button"),G=u("el-dialog");return s(),k("div",null,[t(e).dialogTableVisible?(s(),g(G,{key:0,modelValue:t(e).dialogTableVisible,"onUpdate:modelValue":l[8]||(l[8]=a=>t(e).dialogTableVisible=a),title:t(e).title+t(i)("quickEdit.editor"),draggable:""},{footer:o(()=>[r(h,{onClick:E,disabled:t(e).loading},{default:o(()=>[y(m(t(i)("quickEdit.cancel")),1)]),_:1},8,["disabled"]),r(h,{type:"primary",onClick:B,disabled:t(e).loading},{default:o(()=>[y(m(t(i)("quickEdit.confirm")),1)]),_:1},8,["disabled"])]),default:o(()=>[r(F,{ref_key:"formRef",ref:q,model:t(e).formData,rules:t(e).rules,"label-width":"100","label-position":"right"},{default:o(()=>[t(e).type==="PCNL"?(s(),k(V,{key:0},[r(d,{label:t(i)("quickEdit.quota"),prop:"num"},{default:o(()=>[r(c,{style:{width:"100%"},class:"text-left",modelValue:t(e).formData.num,"onUpdate:modelValue":l[0]||(l[0]=a=>t(e).formData.num=a),step:1,"step-strictly":"",min:1,max:100,"controls-position":"right",onKeydown:I},null,8,["modelValue"])]),_:1},8,["label"]),r(d,{class:"limitedQuantity"},{label:o(()=>[f("span",null,m(t(i)("quickEdit.limited")),1),y(),ne,f("span",null,"("+m(t(i)("quickEdit.hourComplete"))+")",1)]),default:o(()=>[r(c,{style:{width:"100%"},class:"text-left",modelValue:t(e).formData.limitedQuantity,"onUpdate:modelValue":l[1]||(l[1]=a=>t(e).formData.limitedQuantity=a),min:1,step:1,max:999,"step-strictly":"","controls-position":"right",onKeydown:I},null,8,["modelValue"]),r(Q,{type:"info"},{default:o(()=>[y(m(t(i)("quickEdit.hourLimited"))+": 999",1)]),_:1})]),_:1})],64)):p("",!0),t(e).type==="customer"?(s(),g(d,{key:1,label:t(i)("quickEdit.belong"),prop:"clientId"},{default:o(()=>[r(K,{placeholder:"Select",modelValue:t(e).formData.clientId,"onUpdate:modelValue":l[2]||(l[2]=a=>t(e).formData.clientId=a),clearable:""},{default:o(()=>[(s(!0),k(V,null,X(t(e).customerList,a=>(s(),g(H,{key:a.tenantCustomerId,value:a.tenantCustomerId,label:a.customerAccord,disabled:a.isReveal===1},{default:o(()=>[f("span",se,m(a.customerAccord),1),D(f("span",ue,[D(f("span",null,m(t(i)("quickEdit.transfinite")),513),[[w,a.turnover<a.practiceTurover]]),D(f("span",null,m(t(i)("quickEdit.belowStandard")),513),[[w,a.rateAudit>a.practiceRateAudit]])],512),[[w,a.isReveal===1]])]),_:2},1032,["value","label","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):p("",!0),t(e).type==="name"?(s(),k(V,{key:2},[r(d,{label:t(i)("quickEdit.projectName"),prop:"name"},{default:o(()=>[r(b,{modelValue:t(e).formData.name,"onUpdate:modelValue":l[3]||(l[3]=a=>t(e).formData.name=a),clearable:"",maxlength:50},null,8,["modelValue"])]),_:1},8,["label"]),r(d,{label:t(i)("quickEdit.projectIdentification"),prop:"projectIdentification"},{default:o(()=>[r(b,{clearable:"",modelValue:t(e).formData.projectIdentification,"onUpdate:modelValue":l[4]||(l[4]=a=>t(e).formData.projectIdentification=a),maxlength:100},null,8,["modelValue"])]),_:1},8,["label"])],64)):p("",!0),t(e).type==="doMoneyPrice"?(s(),g(d,{key:3,label:t(i)("quickEdit.projectPrice"),prop:"doMoneyPrice"},{default:o(()=>[r(b,{style:{width:"100%"},modelValue:t(e).formData.doMoneyPrice,"onUpdate:modelValue":l[5]||(l[5]=a=>t(e).formData.doMoneyPrice=a),type:"number",min:1,precision:1,step:.1,"controls-position":"right"},{suffix:o(()=>[r(z)]),_:1},8,["modelValue"])]),_:1},8,["label"])):p("",!0),t(e).type==="ir"?(s(),g(d,{key:4,label:"IR",prop:"ir"},{default:o(()=>[r(b,{modelValue:t(e).formData.ir,"onUpdate:modelValue":l[6]||(l[6]=a=>t(e).formData.ir=a),modelModifiers:{number:!0},min:1,max:100,step:"0.01",oninput:"if(value>100)value=100;if(value.length>4)value=value.slice(0,4);if(value<0)value=0;value=Number(value).toFixed(1)"},{append:o(()=>[y(" % ")]),_:1},8,["modelValue"])]),_:1})):p("",!0),t(e).type==="remark"?(s(),g(d,{key:5,label:t(i)("quickEdit.remark")},{default:o(()=>[r(b,{maxlength:"200","show-word-limit":"",style:{width:"100%"},type:"textarea",rows:5,modelValue:t(e).formData.remark,"onUpdate:modelValue":l[7]||(l[7]=a=>t(e).formData.remark=a)},null,8,["modelValue"])]),_:1},8,["label"])):p("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])):p("",!0)])}}}),ye=ae(de,[["__scopeId","data-v-b7a01ba3"]]);export{ye as default};
