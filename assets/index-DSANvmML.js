
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ve,aK as he,r as f,a5 as q,c as we,k as Ie,a as i,p as ke,o as d,b as G,f as t,w as l,i as o,az as L,q as C,F as Ce,t as xe,e as p,g as u,H as I,I as x,aq as V,j as g,S as Se,N as Le,aM as Ve,aN as je,ap as ze,aG as Ne,aH as Re,s as O,R as De}from"./index-ChVS5QWJ.js";import{_ as Ee}from"./index.vue_vue_type_style_index_0_lang-BgDgj7Qm.js";import{_ as $e}from"./index.vue_vue_type_script_setup_true_lang-DIC4rEjr.js";import{_ as Ue,a as A}from"./index.vue_vue_type_script_setup_true_lang-DZ3gbXXQ.js";import{u as Te}from"./user_customer-BKnMMMC9.js";/* empty css                      */import"./user_customer-CaiF_pcY.js";const Q=j=>(Ne("data-v-e228707f"),j=j(),Re(),j),Fe=Q(()=>O("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Me=Q(()=>O("br",null,null,-1)),He=ve({name:"preInvestigationRecords",__name:"index",setup(j){const J=Te(),{getParams:W,pagination:m,onSizeChange:X,onCurrentChange:Y}=he(),z=f(!1),F=f([]);f("");const _=f([]),N=f(!0),R=f(!1),D=f("default"),E=f(!1),$=f([{prop:"projectId",label:"项目ID",sortable:!0,checked:!0},{prop:"projectName",label:"项目名称",sortable:!0,checked:!0},{prop:"allocationType",label:"分配类型",sortable:!0,checked:!0},{prop:"passNumber",label:"通过数/提交数",sortable:!0,checked:!0},{prop:"passRate",label:"通过率",sortable:!0,checked:!0}]),r=q({memberId:"",memberGroupId:"",projectId:"",projectName:"",customerId:"",ip:"",surveyStatus:""}),M=f(),y=q({allocationTypeList:["未分配","供应商","会员组"],surveyStatusList:["完成","被甄别","配额满","安全终止","未完成"],viceStatusList:["待审","免审","过IR","时间果断","超时完成","超量完成","审核成功","审核失败","数据冻结","时间段过载","ip不一致","id重复参与","和解"],customerList:[],vipList:[],vipGroupList:[],tenantSupplierList:[],expandedRows:[]});function Z(){r.pageNo=1,S()}function ee(s){X(s).then(()=>S())}function b(s=1){Y(s).then(()=>S())}async function H(s){const e=y.expandedRows.indexOf(s.id);if(e!==-1?y.expandedRows.splice(e,1):y.expandedRows.push(s.id),!s.children){const v=await A.childList({projectId:s.projectId});s.children=v.data.projectScreenMemberChildInfoList}}function te(s){M.value.showEdit(s)}const le=we(()=>F.value.slice((m.value.page-1)*m.value.size,m.value.page*m.value.size));async function S(){try{z.value=!0;const s={...W(),...r},{data:e}=await A.list(s);F.value=e.projectSurveyScreenInfoList,m.value.total=e.projectSurveyScreenInfoList.length,z.value=!1}catch{}finally{z.value=!1}}function oe(){Object.assign(r,{memberId:"",memberGroupId:"",projectId:"",projectName:"",customerId:"",ip:"",surveyStatus:""}),S()}return Ie(async()=>{y.customerList=await J.getCustomerList(),$.value.forEach(s=>{s.checked&&_.value.push(s.prop)}),S()}),(s,e)=>{const v=i("el-input"),k=i("el-form-item"),ae=i("el-option"),ne=i("el-select"),P=Le,U=i("ElButton"),se=i("ElFormItem"),re=i("ElForm"),ie=$e,ue=i("ElDivider"),de=Ee,B=i("el-button"),pe=Ve,me=je,ce=i("el-row"),h=i("el-table-column"),w=i("el-text"),T=i("ElTableColumn"),K=i("el-table"),fe=i("el-empty"),_e=i("ElPagination"),be=ze,ge=ke("loading");return d(),G("div",{class:Se({"absolute-container":o(E)})},[t(be,null,{default:l(()=>[t(ie,{"show-toggle":!1},{default:l(({fold:a,toggle:c})=>[t(re,{model:o(r),size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:l(()=>[t(k,{label:""},{default:l(()=>[t(v,{modelValue:o(r).memberId,"onUpdate:modelValue":e[0]||(e[0]=n=>o(r).memberId=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"会员ID",onKeydown:e[1]||(e[1]=L(n=>b(),["enter"]))},null,8,["modelValue"])]),_:1}),C(t(k,{label:""},{default:l(()=>[t(v,{modelValue:o(r).memberGroupId,"onUpdate:modelValue":e[2]||(e[2]=n=>o(r).memberGroupId=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"会员ID",onKeydown:e[3]||(e[3]=L(n=>b(),["enter"]))},null,8,["modelValue"])]),_:2},1536),[[V,!a]]),t(k,{label:""},{default:l(()=>[t(v,{modelValue:o(r).projectId,"onUpdate:modelValue":e[4]||(e[4]=n=>o(r).projectId=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"项目ID",onKeydown:e[5]||(e[5]=L(n=>b(),["enter"]))},null,8,["modelValue"])]),_:1}),C(t(k,{label:""},{default:l(()=>[t(v,{modelValue:o(r).name,"onUpdate:modelValue":e[6]||(e[6]=n=>o(r).name=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"项目名称",onKeydown:e[7]||(e[7]=L(n=>b(),["enter"]))},null,8,["modelValue"])]),_:2},1536),[[V,!a]]),C(t(k,{label:""},{default:l(()=>[t(v,{modelValue:o(r).ip,"onUpdate:modelValue":e[8]||(e[8]=n=>o(r).ip=n),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"IP地址",onKeydown:e[9]||(e[9]=L(n=>b(),["enter"]))},null,8,["modelValue"])]),_:2},1536),[[V,!a]]),C(t(k,{label:""},{default:l(()=>[t(ne,{modelValue:o(r).surveyStatus,"onUpdate:modelValue":e[10]||(e[10]=n=>o(r).surveyStatus=n),clearable:"",placeholder:"调查状态",onChange:e[11]||(e[11]=n=>b())},{default:l(()=>[(d(!0),G(Ce,null,xe(o(y).surveyStatusList,(n,ye)=>(d(),p(ae,{label:n,value:ye+1},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:2},1536),[[V,!a]]),t(se,null,{default:l(()=>[t(U,{type:"primary",onClick:e[12]||(e[12]=n=>b())},{icon:l(()=>[t(P,{name:"i-ep:search"})]),default:l(()=>[u(" 筛选 ")]),_:1}),t(U,{onClick:oe},{icon:l(()=>[Fe]),default:l(()=>[u(" 重置 ")]),_:1}),t(U,{link:"",onClick:c},{icon:l(()=>[t(P,{name:a?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:l(()=>[u(" "+I(a?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),t(ue,{"border-style":"dashed"}),t(ce,null,{default:l(()=>[t(de),t(me,null,{default:l(()=>[t(B,{size:"default"},{default:l(()=>[u(" 导出 ")]),_:1}),t(pe,{border:o(N),"onUpdate:border":e[13]||(e[13]=a=>x(N)?N.value=a:null),tableAutoHeight:o(E),"onUpdate:tableAutoHeight":e[14]||(e[14]=a=>x(E)?E.value=a:null),checkList:o(_),"onUpdate:checkList":e[15]||(e[15]=a=>x(_)?_.value=a:null),columns:o($),"onUpdate:columns":e[16]||(e[16]=a=>x($)?$.value=a:null),"line-height":o(D),"onUpdate:lineHeight":e[17]||(e[17]=a=>x(D)?D.value=a:null),stripe:o(R),"onUpdate:stripe":e[18]||(e[18]=a=>x(R)?R.value=a:null),style:{"margin-left":"12px"},onQueryData:Z},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),C((d(),p(K,{border:o(N),data:o(le),size:o(D),stripe:o(R),"row-key":"id","expand-row-keys":o(y).expandedRows,onExpandChange:H},{empty:l(()=>[t(fe,{class:"vab-data-empty",description:"暂无数据"})]),default:l(()=>[t(h,{type:"expand",width:"55"},{default:l(a=>[t(K,{data:a.row.children,"highlight-current-row":"",class:"hide-table-header",border:"",height:"100%"},{default:l(()=>[t(h,{width:"55"}),t(h,{width:"300",prop:"memberChildName",label:"名称+ID",align:"center"},{default:l(c=>[t(w,null,{default:l(()=>[u(I(c.row.memberChildName),1)]),_:2},1024),Me,C(t(w,{type:"danger"},{default:l(()=>[u("随机id:"+I(c.row.randomIdentityId),1)]),_:2},1536),[[V,c.row.randomIdentityId]])]),_:1}),t(T,{prop:"status",label:"状态",align:"center"},{default:l(c=>[c.row.status===1?(d(),p(w,{key:0,type:"success"},{default:l(()=>[u("前置问卷通过")]),_:1})):(d(),p(w,{key:1,type:"danger"},{default:l(()=>[u("前置问卷未通过")]),_:1}))]),_:1}),t(T,{width:"200",align:"center",fixed:"right",label:"操作"},{default:l(c=>[t(U,{type:"primary",size:"small",plain:"",onClick:n=>te(c.row)},{default:l(()=>[u(" 查看问卷详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:2},1032,["data"])]),_:1}),o(_).includes("projectId")?(d(),p(h,{key:0,width:"300",align:"center",prop:"projectId","show-overflow-tooltip":"",label:"项目ID"})):g("",!0),o(_).includes("projectName")?(d(),p(h,{key:1,align:"center",prop:"projectName","show-overflow-tooltip":"",label:"项目名称"})):g("",!0),o(_).includes("allocationType")?(d(),p(h,{key:2,align:"center","show-overflow-tooltip":"",width:"100",label:"分配类型"},{default:l(({row:a})=>[a.allocationType===3?(d(),p(w,{key:0,class:"mx-1",type:"primary"},{default:l(()=>[u("会员组")]),_:1})):g("",!0),a.allocationType===2?(d(),p(w,{key:1,class:"mx-1",type:"success"},{default:l(()=>[u("供应商")]),_:1})):g("",!0),a.allocationType===1?(d(),p(w,{key:2,class:"mx-1",type:"warning"},{default:l(()=>[u("未分配")]),_:1})):g("",!0)]),_:1})):g("",!0),o(_).includes("passNumber")?(d(),p(h,{key:3,align:"center","show-overflow-tooltip":"",label:"通过数/提交数"},{default:l(({row:a})=>[u(I(a.passNumber||0)+"/ "+I(a.submitNumber||0),1)]),_:1})):g("",!0),o(_).includes("passRate")?(d(),p(T,{key:4,align:"center","show-overflow-tooltip":"",prop:"passRate",label:"通过率"},{default:l(({row:a})=>[u(I(a.passRate+"%"),1)]),_:1})):g("",!0),t(T,{align:"center","show-overflow-tooltip":"",prop:"",fixed:"right",label:"操作",width:"200"},{default:l(({row:a})=>[t(B,{plain:"",type:"primary",size:"small",onClick:c=>H(a)},{default:l(()=>[u(I(o(y).expandedRows.includes(a.id)?"收起":"展开"),1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","data","size","stripe","expand-row-keys"])),[[ge,o(z)]]),t(_e,{"current-page":o(m).page,total:o(m).total,"page-size":o(m).size,"page-sizes":o(m).sizes,layout:o(m).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:ee,onCurrentChange:b},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),t(Ue,{ref_key:"questionnaireDetailsRef",ref:M},null,512)],2)}}}),Qe=De(He,[["__scopeId","data-v-e228707f"]]);export{Qe as default};
