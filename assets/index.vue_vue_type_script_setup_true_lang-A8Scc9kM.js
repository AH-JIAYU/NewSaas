
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as B}from"./sub.vue_vue_type_script_setup_true_lang-XkWF3KyO.js";import{r as C,I as E}from"./item-BAqmVK9Q.js";import{d as N,r as c,E as b,K as m,L as z,M as A,a as r,i as y,N as _,O as J,c as g,A as q,h as k,P as j}from"./index-C9fHoe7f.js";const F=N({name:"MainMenu",__name:"index",props:{menu:{},value:{},accordion:{type:Boolean,default:!0},defaultOpeneds:{default:()=>[]},alwaysOpeneds:{default:()=>[]},mode:{default:"vertical"},collapse:{type:Boolean,default:!1},showCollapseName:{type:Boolean,default:!1},rounded:{type:Boolean,default:!1},direction:{default:"ltr"}},setup(I){const l=I,o=c(l.value),i=c({}),t=c({}),s=c(Array.from(new Set([...l.alwaysOpeneds.slice(0),...l.defaultOpeneds.slice(0)]))),M=c(l.alwaysOpeneds.slice(0)),P=c([]),f=b(()=>l.mode==="horizontal"||l.mode==="vertical"&&l.collapse);function O(e,n=[]){e.forEach(a=>{const u=a.path??JSON.stringify(a);if(a.children){const h=[...n,u];t.value[u]={index:u,indexPath:h,active:!1},O(a.children,h)}else i.value[u]={index:u,indexPath:n}})}const d=(e,n)=>{s.value.includes(e)||(l.accordion&&(s.value=s.value.filter(a=>n.includes(a)||M.value.includes(a))),s.value.push(e))},v=e=>{if(Array.isArray(e)){j(()=>{v(e.at(-1)),e.length>1&&v(e.slice(0,-1))});return}Object.keys(t.value).forEach(n=>{t.value[n].indexPath.includes(e)&&(s.value=s.value.filter(a=>a!==e))})};function w(e){var n,a;for(const u in t.value)t.value[u].active=!1;(n=t.value[e])==null||n.indexPath.forEach(u=>{t.value[u].active=!0}),(a=i.value[e])==null||a.indexPath.forEach(u=>{t.value[u].active=!0})}const x=e=>{(l.mode==="horizontal"||l.collapse)&&(s.value=[]),w(e)},S=(e,n)=>{s.value.includes(e)?v(e):d(e,n)};function p(){const e=o.value&&i.value[o.value];w(o.value),!(!e||l.collapse)&&e.indexPath.forEach(n=>{const a=t.value[n];a&&d(n,a.indexPath)})}return m(()=>l.menu,e=>{O(e),p()},{deep:!0,immediate:!0}),m(()=>l.value,e=>{i.value[e]||(o.value="");const n=i.value[e]||o.value&&i.value[o.value]||i.value[l.value];n?o.value=n.index:o.value=e,p()}),m(()=>l.collapse,e=>{e?s.value=[]:s.value=l.alwaysOpeneds.slice(0),p()}),z(C,A({props:l,items:i,subMenus:t,activeIndex:o,openedMenus:s,alwaysOpenedsMenus:M,mouseInMenu:P,isMenuPopup:f,openMenu:d,closeMenu:v,handleMenuItemClick:x,handleSubMenuClick:S})),(e,n)=>(r(),y("div",{class:q(["flex flex-col of-hidden transition-all",{"w-[200px]":!k(f)&&l.mode==="vertical","w-[64px]":k(f)&&l.mode==="vertical","h-[80px]":l.mode==="horizontal","flex-row! w-auto":k(f)&&l.mode==="horizontal"}])},[(r(!0),y(_,null,J(e.menu,a=>{var u;return r(),y(_,{key:a.path??JSON.stringify(a)},[(u=a.children)!=null&&u.length?(r(),g(B,{key:0,menu:a,"unique-key":[a.path??JSON.stringify(a)]},null,8,["menu","unique-key"])):(r(),g(E,{key:1,item:a,"unique-key":[a.path??JSON.stringify(a)],onClick:h=>x(a.path??JSON.stringify(a))},null,8,["item","unique-key","onClick"]))],64)}),128))],2))}});export{F as _};
