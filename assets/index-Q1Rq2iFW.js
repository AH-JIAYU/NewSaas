
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as te,aM as ae,r as s,n as le,a4 as T,a as i,q as ne,o as d,b as oe,f as o,w as l,g as f,i as t,A as p,s as se,e as m,aL as ie,y as E,z as x,j as _,N as re,aN as ue,E as ce,b8 as de,b9 as pe,_ as me,ap as fe,L as _e}from"./index-BusLwhud.js";import{_ as ge}from"./index.vue_vue_type_style_index_0_lang-Yw_QZDm_.js";import{s as be}from"./apiLoading-0Ws03lr4.js";import{S as ve}from"./sortable.esm-C0-Qcoum.js";import{u as ye,v as he,a as Q}from"./index-C266djEo.js";const ke={style:{"font-weight":"700"}},Ce={style:{"font-weight":"700"}},we={style:{display:"inline-block"},class:"tableBig"},ze=te({name:"vipLevel",__name:"index",setup(Le){const P=ye(),{pagination:r,getParams:$,onSizeChange:A,onCurrentChange:B}=ae(),g=s(!1),z=s(),N=s([]),u=s([]),b=s(!1),v=s(!1),y=s("default"),h=s(!1),D=s(),k=s([{label:"等级名称",prop:"levelName",sortable:!0,disableCheck:!1,checked:!0},{label:"价格比例%",prop:"additionRatio",sortable:!0,checked:!0},{label:"成员数量",prop:"memberQuantity",sortable:!0,checked:!0}]);function H(){z.value.showEdit()}function M(n){z.value.showEdit(n)}function U(n){ue.confirm("您确定要删除当前项吗?","确认信息").then(async()=>{const{status:a}=await be(Q.delete({memberLevelId:n.memberLevelId}));a===1&&ce.success({message:"删除成功",center:!0}),P.LevelNameList=null,L()}).catch(()=>{})}function L(){r.value.page=1,C()}function V(n){A(n).then(()=>C())}function I(n=1){B(n).then(()=>C())}async function C(){try{g.value=!0;const n={...$()},{data:a}=await Q.list(n);N.value=a.getMemberLevelInfoList,r.value.total=a.total,g.value=!1}catch{}finally{g.value=!1}}function R(){const n=D.value.$el.querySelector(".el-table__body-wrapper tbody");ve.create(n,{handle:".sortable",animation:300,ghostClass:"ghost",onEnd:({newIndex:a,oldIndex:c})=>{a===void 0||c===void 0||T(()=>R())}})}return le(()=>{k.value.forEach(n=>{n.checked&&u.value.push(n.prop)}),C(),T(()=>{R()})}),(n,a)=>{const c=i("el-button"),q=ge,F=de,j=pe,G=i("el-row"),S=me,J=i("ElTag"),K=i("ElTableColumn"),w=i("el-table-column"),O=i("el-empty"),W=i("el-table"),X=i("ElPagination"),Y=fe,Z=ne("loading");return d(),oe("div",{class:re({"absolute-container":t(h)})},[o(Y,null,{default:l(()=>[o(G,null,{default:l(()=>[o(q,null,{default:l(()=>[o(c,{size:"default",type:"primary",onClick:H},{default:l(()=>[f(" 新增 ")]),_:1})]),_:1}),o(j,null,{default:l(()=>[o(c,{size:"default"},{default:l(()=>[f(" 导出 ")]),_:1}),o(F,{border:t(b),"onUpdate:border":a[0]||(a[0]=e=>p(b)?b.value=e:null),tableAutoHeight:t(h),"onUpdate:tableAutoHeight":a[1]||(a[1]=e=>p(h)?h.value=e:null),checkList:t(u),"onUpdate:checkList":a[2]||(a[2]=e=>p(u)?u.value=e:null),columns:t(k),"onUpdate:columns":a[3]||(a[3]=e=>p(k)?k.value=e:null),"line-height":t(y),"onUpdate:lineHeight":a[4]||(a[4]=e=>p(y)?y.value=e:null),stripe:t(v),"onUpdate:stripe":a[5]||(a[5]=e=>p(v)?v.value=e:null),style:{"margin-left":"12px"},onQueryData:L},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),se((d(),m(W,{ref_key:"elTableRef",ref:D,"row-key":"id",border:t(b),data:t(N),size:t(y),stripe:t(v),fit:""},{empty:l(()=>[o(O,{image:t(ie),"image-size":300},null,8,["image"])]),default:l(()=>[o(K,{width:"80",align:"left",fixed:""},{header:l(()=>[f(" 排序 ")]),default:l(()=>[o(J,{type:"info",class:"w"},{default:l(()=>[o(S,{name:"i-ep:d-caret"})]),_:1})]),_:1}),t(u).includes("levelName")?(d(),m(w,{key:0,align:"left",prop:"levelName","show-overflow-tooltip":"",label:"等级名称"},{default:l(({row:e})=>[E("p",ke,x(e.levelName),1)]),_:1})):_("",!0),t(u).includes("additionRatio")?(d(),m(w,{key:1,align:"left",prop:"additionRatio","show-overflow-tooltip":"",label:"价格比例"},{default:l(({row:e})=>[E("p",Ce,x(e.additionRatio)+"%",1)]),_:1})):_("",!0),t(u).includes("memberQuantity")?(d(),m(w,{key:2,align:"left",prop:"memberQuantity","show-overflow-tooltip":"",label:"成员数量"},{default:l(({row:e})=>[E("span",we,x(e.memberQuantity?e.memberQuantity:0),1),e.memberQuantity?(d(),m(c,{key:0,text:"",type:"primary",size:"small",class:"p-1"},{default:l(()=>[o(S,{name:"mdi:cursor-default-click",size:"16px",color:"#409eff"})]),_:1})):_("",!0)]),_:1})):_("",!0),o(w,{align:"left",fixed:"right","show-overflow-tooltip":"",label:"操作"},{default:l(({row:e})=>[o(c,{size:"small",plain:"",type:"primary",onClick:ee=>M(e)},{default:l(()=>[f(" 编辑 ")]),_:2},1032,["onClick"]),e.isDelete===1?(d(),m(c,{key:0,size:"small",plain:"",type:"danger",onClick:ee=>U(e)},{default:l(()=>[f(" 删除 ")]),_:2},1032,["onClick"])):_("",!0)]),_:1})]),_:1},8,["border","data","size","stripe"])),[[Z,t(g)]]),o(X,{"current-page":t(r).page,total:t(r).total,"page-size":t(r).size,"page-sizes":t(r).sizes,layout:t(r).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:V,onCurrentChange:I},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),o(he,{ref_key:"EditRef",ref:z,onQueryData:L},null,512)],2)}}}),Se=_e(ze,[["__scopeId","data-v-a0f0edaa"]]);export{Se as default};
