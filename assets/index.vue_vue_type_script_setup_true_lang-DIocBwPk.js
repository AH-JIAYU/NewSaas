
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{k as c,d as $,r as s,l as h,a as i,al as q,am as J,o as p,b as _,f as t,w as o,C as P,g as x,F as I,n as U,e as j,E as M,av as z}from"./index-CIvOEn04.js";const T={list:d=>c.post("tenant-invoice/get/getTenantInvoices",d),create:d=>c.post("tenant-invoice/insert/insertTenantInvoice",d),edit:d=>c.post("tenant-invoice/update/updateById",d),delete:d=>c.post("tenant-invoice/delete/deleteById",d)},G={style:{flex:"auto"}},K=$({name:"Edit",__name:"index",emits:["success"],setup(d,{expose:R,emit:Y}){const V=Y,y=s(""),f=s(),E=s(!1),C=s([]),r=s(),m=s(!1),S=[{lable:"未收款",value:1},{lable:"部分收款",value:2},{lable:"已完结",value:3},{lable:"坏账",value:4}],a=s({id:null,tenantCustomerId:"",invoiceCode:"",invoiceAmount:null,invoiceTax:null,actualReceipts:null,invoiceStatus:null,invoiceDate:"",paymentDate:"",remark:""}),B=s({invoiceCode:[{required:!0,trigger:"blur",message:"请输入姓名"}]});function w(){return new Promise(n=>{a.value.id?r.value&&r.value.validate(e=>{if(e){const b=z(a.value);T.edit(b).then(()=>{M.success({message:"编辑成功",center:!0}),V("success"),m.value=!1,n()})}}):r.value&&r.value.validate(e=>{e&&(delete a.value.id,T.create(a.value).then(()=>{M.success({message:"新增成功",center:!0}),V("success"),m.value=!1,n()}))})})}async function A(n,e){n?a.value=JSON.parse(n):a.value={id:null,tenantCustomerId:"",invoiceCode:"",invoiceAmount:null,invoiceTax:null,actualReceipts:null,invoiceStatus:null,invoiceDate:"",paymentDate:"",remark:""},y.value=n!=null&&n.id?"编辑":"新增",C.value=e,m.value=!0}return h(async()=>{f.value=new Date}),R({showEdit:A}),(n,e)=>{const b=i("el-option"),g=i("el-select"),u=i("el-form-item"),v=i("el-input"),N=i("ElOption"),D=i("el-date-picker"),L=i("el-form"),k=i("el-button"),O=i("el-dialog"),F=q("loading");return J((p(),_("div",null,[t(O,{modelValue:m.value,"onUpdate:modelValue":e[10]||(e[10]=l=>m.value=l),title:y.value,width:"700"},{footer:o(()=>[P("div",G,[t(k,{type:"primary",onClick:w},{default:o(()=>[x(" 确定 ")]),_:1}),t(k,{type:"",onClick:e[9]||(e[9]=l=>m.value=!1)},{default:o(()=>[x(" 取消 ")]),_:1})])]),default:o(()=>[t(L,{ref_key:"formRef",ref:r,"label-width":"80px",model:a.value,rules:B.value,inline:!1},{default:o(()=>[t(u,{label:"客户简称"},{default:o(()=>[t(g,{modelValue:a.value.tenantCustomerId,"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.tenantCustomerId=l),placeholder:"请选择客户",clearable:"",filterable:""},{default:o(()=>[(p(!0),_(I,null,U(C.value,l=>(p(),j(b,{key:l.tenantCustomerId,value:l.tenantCustomerId,label:l.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(u,{prop:"invoiceCode",label:"发票编号"},{default:o(()=>[t(v,{modelValue:a.value.invoiceCode,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.invoiceCode=l),placeholder:"请输入发票编号",clearable:""},null,8,["modelValue"])]),_:1}),t(u,{label:"发票金额"},{default:o(()=>[t(v,{modelValue:a.value.invoiceAmount,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.invoiceAmount=l),modelModifiers:{number:!0},placeholder:"请输入发票金额",clearable:""},null,8,["modelValue"])]),_:1}),t(u,{label:"手续费(税)"},{default:o(()=>[t(v,{modelValue:a.value.invoiceTax,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.invoiceTax=l),modelModifiers:{number:!0},placeholder:"请输入手续费",clearable:""},null,8,["modelValue"])]),_:1}),t(u,{label:"实际收款"},{default:o(()=>[t(v,{modelValue:a.value.actualReceipts,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.actualReceipts=l),modelModifiers:{number:!0},placeholder:"请输入实际收款",clearable:""},null,8,["modelValue"])]),_:1}),t(u,{label:"发票状态"},{default:o(()=>[t(g,{modelValue:a.value.invoiceStatus,"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.invoiceStatus=l),placeholder:"请选择发票状态",clearable:"",filterable:""},{default:o(()=>[(p(),_(I,null,U(S,l=>t(N,{label:l.lable,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(u,{style:{width:"100%"},label:"开票日期"},{default:o(()=>[t(D,{modelValue:a.value.invoiceDate,"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.invoiceDate=l),"default-time":f.value,type:"datetime",placeholder:"请选择开票日期","value-format":"YYYY-MM-DD hh:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),t(u,{label:"收款日期"},{default:o(()=>[t(D,{modelValue:a.value.paymentDate,"onUpdate:modelValue":e[7]||(e[7]=l=>a.value.paymentDate=l),"default-time":f.value,type:"datetime",placeholder:"请选择收款日期","value-format":"YYYY-MM-DD hh:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),t(u,{label:"备注"},{default:o(()=>[t(v,{modelValue:a.value.remark,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.remark=l),placeholder:"备注说明",clearable:"",rows:5,type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])),[[F,E.value]])}}});export{K as _,T as a};
