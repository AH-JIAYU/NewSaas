
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as J,am as $,r as S,k as G,a as i,o as s,b as _,i as t,e as p,w as l,f as r,g,F as v,j as m,t as O,s as c,A as W,q as V,aq as D,an as L,E as X,be as Y,aI as Z,aJ as ee,M as te}from"./index-CXflPANZ.js";import{u as ae}from"./projectManagement_list-zFxlASii.js";import{u as oe}from"./stagedData-CuJcFv25.js";import{u as le}from"./user_customer-D2t3DRdH.js";import{a as M}from"./projectManagement-DUjvcpNK.js";import"./user_customer-DlZ82PEf.js";const w=y=>(Z("data-v-13d253a4"),y=y(),ee(),y),re=w(()=>c("span",null,"限量",-1)),ne=w(()=>c("br",null,null,-1)),se=w(()=>c("span",null,"(小时完成量)",-1)),ie={style:{float:"left"}},ue={style:{float:"right",color:"red","font-size":"13px"}},de=J({name:"ProjeckEdit",__name:"index",emits:["fetch-data"],setup(y,{expose:j,emit:P}){const b=ae();oe();const q=$(),x=le(),T=P,k=S(),e=S({dialogTableVisible:!1,title:"",type:"",loading:"",formData:{},customerList:[],rules:{name:[{required:!0,message:"请输入项目名称",trigger:"blur"},{min:2,max:50,message:"内容在2-50个字之间",trigger:"blur"}],projectIdentification:[{max:100,required:!0,message:"请输入项目标识",trigger:"blur"},{min:2,max:100,message:"内容在2-100个字之间",trigger:"blur"}],countryIdList:[{required:!0,message:"请选择所属国家",trigger:"change"}],clientId:[{required:!0,message:"请选择所属客户",trigger:"change"}],doMoneyPrice:[{required:!0,message:"请输入原价",trigger:"blur"}],num:[{required:!0,message:"请输入配额",trigger:"blur"}],minimumDuration:[{required:!0,message:"请输入最小分长",trigger:"blur"}],ir:[{required:!0,message:"请输入配额",trigger:"blur"}]}}),U={PCNL:"参数",customer:"客户",name:"名称/标识",doMoneyPrice:"原价",ir:"IR",remark:"备注"};async function E(n,o){e.value.title=U[o],e.value.type=o;try{e.value.loading=!0;const d=await M.detail({projectId:n.projectId});e.value.formData=d.data,e.value.dialogTableVisible=!0,e.value.loading=!1,b.dataBeforeEditing=[L(e.value.formData)]}catch{}finally{e.value.loading=!1}e.value.customerList=await x.getCustomerList()}const I=n=>{n.key==="."&&n.preventDefault()},B=async()=>{const n=L(e.value.formData);return await b.compareProjectData(b.dataBeforeEditing,[n]),n};async function N(){e.value.loading=!0,k.value.validate(async n=>{if(n){const o=await B(),{status:d}=await M.edit(o);d===1&&X.success({message:"编辑成功",center:!0}),T("fetch-data"),h()}e.value.loading=!1})}function h(){e.value.dialogTableVisible=!1,e.value.formData={}}const R=async()=>{await x.getCustomerList(),await q.getCountry()};return G(async()=>{await R()}),j({showEdit:E}),(n,o)=>{const d=i("el-input-number"),u=i("el-form-item"),A=i("el-text"),Q=i("el-option"),F=i("el-select"),f=i("el-input"),K=Y,z=i("el-form"),C=i("el-button"),H=i("el-dialog");return s(),_("div",null,[t(e).dialogTableVisible?(s(),p(H,{key:0,modelValue:t(e).dialogTableVisible,"onUpdate:modelValue":o[8]||(o[8]=a=>t(e).dialogTableVisible=a),title:t(e).title+"编辑",draggable:""},{footer:l(()=>[r(C,{onClick:h,disabled:t(e).loading},{default:l(()=>[g(" 取消 ")]),_:1},8,["disabled"]),r(C,{type:"primary",onClick:N,disabled:t(e).loading},{default:l(()=>[g(" 确定 ")]),_:1},8,["disabled"])]),default:l(()=>[r(z,{ref_key:"formRef",ref:k,model:t(e).formData,rules:t(e).rules,"label-width":"100","label-position":"right"},{default:l(()=>[t(e).type==="PCNL"?(s(),_(v,{key:0},[r(u,{label:"配额",prop:"num"},{default:l(()=>[r(d,{style:{width:"100%"},class:"text-left",modelValue:t(e).formData.num,"onUpdate:modelValue":o[0]||(o[0]=a=>t(e).formData.num=a),step:1,"step-strictly":"",min:1,max:100,"controls-position":"right",onKeydown:I},null,8,["modelValue"])]),_:1}),r(u,{class:"limitedQuantity"},{label:l(()=>[re,g(),ne,se]),default:l(()=>[r(d,{style:{width:"100%"},class:"text-left",modelValue:t(e).formData.limitedQuantity,"onUpdate:modelValue":o[1]||(o[1]=a=>t(e).formData.limitedQuantity=a),min:1,step:1,max:999,"step-strictly":"","controls-position":"right",onKeydown:I},null,8,["modelValue"]),r(A,{type:"info"},{default:l(()=>[g("每小时限量: 999")]),_:1})]),_:1})],64)):m("",!0),t(e).type==="customer"?(s(),p(u,{key:1,label:"所属客户",prop:"clientId"},{default:l(()=>[r(F,{placeholder:"Select",modelValue:t(e).formData.clientId,"onUpdate:modelValue":o[2]||(o[2]=a=>t(e).formData.clientId=a),clearable:""},{default:l(()=>[(s(!0),_(v,null,O(t(e).customerList,a=>(s(),p(Q,{key:a.tenantCustomerId,value:a.tenantCustomerId,label:a.customerAccord,disabled:a.isReveal===1},{default:l(()=>[c("span",ie,W(a.customerAccord),1),V(c("span",ue,[V(c("span",null," 营业额超限 ",512),[[D,a.turnover<a.practiceTurover]]),V(c("span",null," 审核率不合格 ",512),[[D,a.rateAudit>a.practiceRateAudit]])],512),[[D,a.isReveal===1]])]),_:2},1032,["value","label","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})):m("",!0),t(e).type==="name"?(s(),_(v,{key:2},[r(u,{label:"项目名称",prop:"name"},{default:l(()=>[r(f,{modelValue:t(e).formData.name,"onUpdate:modelValue":o[3]||(o[3]=a=>t(e).formData.name=a),clearable:"",maxlength:50},null,8,["modelValue"])]),_:1}),r(u,{label:"项目标识",prop:"projectIdentification"},{default:l(()=>[r(f,{clearable:"",modelValue:t(e).formData.projectIdentification,"onUpdate:modelValue":o[4]||(o[4]=a=>t(e).formData.projectIdentification=a),maxlength:100},null,8,["modelValue"])]),_:1})],64)):m("",!0),t(e).type==="doMoneyPrice"?(s(),p(u,{key:3,label:"原价",prop:"doMoneyPrice"},{default:l(()=>[r(f,{style:{width:"100%"},modelValue:t(e).formData.doMoneyPrice,"onUpdate:modelValue":o[5]||(o[5]=a=>t(e).formData.doMoneyPrice=a),type:"number",min:1,precision:1,step:.1,"controls-position":"right"},{suffix:l(()=>[r(K)]),_:1},8,["modelValue"])]),_:1})):m("",!0),t(e).type==="ir"?(s(),p(u,{key:4,label:"IR",prop:"ir"},{default:l(()=>[r(f,{modelValue:t(e).formData.ir,"onUpdate:modelValue":o[6]||(o[6]=a=>t(e).formData.ir=a),modelModifiers:{number:!0},min:1,max:100,step:"0.01",oninput:"if(value>100)value=100;if(value.length>4)value=value.slice(0,4);if(value<0)value=0;value=Number(value).toFixed(1)"},{append:l(()=>[g(" % ")]),_:1},8,["modelValue"])]),_:1})):m("",!0),t(e).type==="remark"?(s(),p(u,{key:5,label:"备注"},{default:l(()=>[r(f,{maxlength:"200","show-word-limit":"",style:{width:"100%"},type:"textarea",rows:5,modelValue:t(e).formData.remark,"onUpdate:modelValue":o[7]||(o[7]=a=>t(e).formData.remark=a)},null,8,["modelValue"])]),_:1})):m("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])):m("",!0)])}}}),_e=te(de,[["__scopeId","data-v-13d253a4"]]);export{_e as default};
