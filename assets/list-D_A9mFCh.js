
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as je,aN as Ce,r as p,a3 as Le,n as we,a as k,q as ze,o as s,b as B,f as l,w as t,e as i,j as r,g as n,s as xe,i as _,aM as ie,y as g,z as d,N as x,E as N,aO as V,b9 as Re,ba as De,be as Ue,_ as Ee,ao as Be,L as Te}from"./index-UdTJk9b4.js";import{_ as Ae}from"./index-DHQLEq5j.js";import{_ as Me}from"./index.vue_vue_type_style_index_0_lang-BRf7mCgh.js";import{_ as Pe}from"./index-q5VR0I38.js";import{u as $e,o as He,a as R}from"./index-CvswYLqU.js";import Ve from"./index-DeQYNIJD.js";import Oe from"./index-DH4YPabh.js";import"./index-EvIG84aZ.js";import"./index.vue_vue_type_script_setup_true_lang-ChIIBAu4.js";import"./sortable.esm-C0-Qcoum.js";import"./apiLoading-D2Akom2h.js";import"./projectManagement-Dqqw5X_w.js";import"./user_cooperation-5BCYW126.js";import"./survey_vip_department-rWwPcbwd.js";import"./user_supplier-D1uTz1-z.js";import"./user_supplier-BqIOotE7.js";import"./survey_vipGroup-D87ATJge.js";import"./survey_vipGroup-CfsKaCUT.js";import"./position_manage-Ce3CTp1y.js";import"./index-B5IL54zw.js";import"./department-gmxAhoJ0.js";import"./configuration_role-DrqSjOiW.js";import"./tenant_role-BxqCUmtX.js";import"./configuration_manager-1YrH6WdP.js";const Fe={class:"tableBig"},Qe={class:"tableBig"},qe={class:"copyId tableSmall"},Ge={class:"id oneLine projectId"},Je={class:"tableBig oneLine"},Ke={class:"copyId tableSmall"},We={class:"id oneLine projectId"},Xe={class:"tableBig"},Ye={key:0,class:"tableBig"},Ze={key:1,class:"copyId tableSmall"},et={class:"id oneLine projectId",style:{"font-size":"12px"}},tt={key:0,class:"tableBig"},at={key:1,class:"copyId tableSmall"},lt={class:"id oneLine projectId",style:{"font-size":"12px"}},ot={class:"flex-c"},nt={class:"oneLine",style:{width:"calc(100% - 1.25rem)"}},st={class:"tableBig"},it=je({name:"outsource",__name:"list",setup(rt){const re=$e(),{pagination:h,getParams:ue,onSizeChange:ce,onCurrentChange:pe}=Ce(),de=p(),$=p(),me=p(),m=p(!0),C=p(!1),O=p(),I=p({selectList:[]}),D=p(!1),u=p([]),F=p(),Q=p(),q=p("formSearch-outsource"),L=p("default"),w=p(!1),U=p([{sotrtable:!0,checked:!0,label:"合作商ID",prop:"tenantId"},{sotrtable:!0,checked:!0,label:"接收状态",prop:"receiveStatus"},{sotrtable:!0,checked:!0,label:"PM",prop:"userName"},{sotrtable:!0,checked:!0,label:"合作商名称",prop:"tenantName"},{sotrtable:!0,checked:!0,label:"分配",prop:"allocationType"},{sotrtable:!0,checked:!0,label:"项目价",prop:"doMoneyPrice"},{sotrtable:!0,checked:!0,label:"项目ID",prop:"projectId"},{sotrtable:!0,checked:!0,label:"项目名称",prop:"projectName"},{sotrtable:!0,checked:!0,label:"参与/完成/配额/限量",prop:"participationNumber"},{sotrtable:!0,checked:!0,label:"状态",prop:"projectStatus"}]),S=Le({projectId:"",tenantId:"",tenantName:"",projectStatus:"",receiveStatus:"",type:2}),T=p([]);function G(o){O.value.showEdit(o,S.type===2?1:0)}function J(o){ce(o).then(()=>b())}function z(o=1){pe(o).then(()=>b())}function K(){Object.assign(S,{tenantId:"",tenantName:"",projectStatus:"",type:2}),b()}async function b(){try{m.value=!0;const o={...ue(),...S};if(S.type===1){const a=await R.list(o);T.value=a.data.projectAllocationInfoList,h.value.total=a.data.total}else{const a=await R.meList(o);T.value=a.data.projectMeAllocationInfoList,h.value.total=a.data.total}m.value=!1}catch{}finally{m.value=!1}}we(()=>{U.value.forEach(o=>{o.checked&&u.value.push(o.prop)}),b(),F.value=[{index:1,show:!0,type:"input",modelName:"projectId",placeholder:"项目ID"},{index:2,show:!0,type:"input",modelName:"tenantId",placeholder:"合作商ID"},{index:3,show:!0,type:"input",modelName:"tenantName",placeholder:"合作商名称"},{index:4,show:!0,type:"select",modelName:"projectStatus",placeholder:"项目状态",option:"projectStatus",optionLabel:"label",optionValue:"value"}],Q.value=[{index:1,show:!0,type:"input",modelName:"projectId",placeholder:"项目ID"},{index:2,show:!0,type:"input",modelName:"tenantId",placeholder:"合作商ID"},{index:3,show:!0,type:"input",modelName:"tenantName",placeholder:"合作商名称"},{index:4,show:!0,type:"select",modelName:"projectStatus",placeholder:"项目状态",option:"projectStatus",optionLabel:"label",optionValue:"value"},{index:5,show:!0,type:"select",modelName:"receiveStatus",placeholder:"接收状态",option:"receiveStatus",optionLabel:"label",optionValue:"value"}]});const fe=[{value:1,label:"自动（已接收）"},{value:2,label:"手动（未接收）"}],W={projectStatus:()=>re.projectStatusList.map((o,a)=>({label:o,value:a+1})),receiveStatus:()=>fe},j=p();function X(o){o?j.value=o.projectId:j.value=""}const H=p();function ve(){const o=$.value.getSelectionRows();if(console.log(o.length,"selectList"),o.length==0){N.warning({message:"请选择一个项目",center:!0});return}else{let a=o.length;o.forEach(v=>{v.receiveStatus==1&&a++}),a!=o.length?N.warning({message:"已接收的项目不能再次接收，请重新选择",center:!0}):(I.value.receivingMode="批量接收",I.value.selectList=o,H.value.showEdit("","接收",o))}}function ye(){const o=$.value.getSelectionRows();if(o.length!==0){N.warning({message:"请选择一个项目",center:!0});return}else{let a=o.length;o.forEach(v=>{v.receiveStatus==2&&a++}),a!=o.length?N.warning({message:"未接收的项目不能取消接收，请重新选择",center:!0}):V.confirm("确认取消接收吗？","确认信息").then(()=>{try{m.value=!0;let v=[];o.forEach(M=>{v.push(M.id)});let A={type:2,idList:v};R.updateReceiveStatus(A).then(()=>{m.value=!1,b(),N.success({message:"取消接收成功",center:!0})})}catch{}finally{m.value=!1}}).catch(()=>{})}}function Y(o){I.value.selectList=[o],H.value.showEdit("","接收",[o])}function ge(o){V.confirm("确认取消接收吗？","确认信息").then(()=>{try{m.value=!0;let a={type:2,idList:[o.id]};R.updateReceiveStatus(a).then(()=>{m.value=!1,b(),N.success({message:"取消接收成功",center:!0})})}catch{}finally{m.value=!1}}).catch(()=>{})}function he(o){I.value.chargeUserId=o.chargeUserId,I.value.invitationType=o.invitationType,I.value.chargeUserName=o.chargeUserName;let a=[];I.value.selectList.forEach(v=>{a.push(v.id)});try{m.value=!0;let v={type:1,idList:a,userId:o.chargeUserId,userName:o.chargeUserName,allocationType:o.invitationType};R.updateReceiveStatus(v).then(()=>{m.value=!1,b(),N.success({message:"接收成功",center:!0})})}catch{}finally{m.value=!1}}const _e=o=>{V.confirm("确认拒绝项目吗？","确认信息").then(()=>{try{m.value=!0;let a={type:3,idList:[o.id]};R.updateReceiveStatus(a).then(()=>{m.value=!1,b(),N.success({message:"拒绝成功",center:!0})})}catch{}finally{m.value=!1}}).catch(()=>{})};return(o,a)=>{const v=Pe,A=k("ElDivider"),M=Me,y=k("el-button"),Z=Re,ee=De,te=k("el-row"),c=k("el-table-column"),f=k("el-text"),P=Ae,ae=k("el-tooltip"),le=k("el-empty"),oe=k("el-table"),ne=k("ElPagination"),se=k("el-tab-pane"),be=Ue,ke=Ee,Se=k("el-tabs"),Ne=Be,Ie=ze("loading");return s(),B("div",{class:x({"absolute-container":D.value})},[l(Ne,null,{default:t(()=>[l(Se,{modelValue:S.type,"onUpdate:modelValue":a[14]||(a[14]=e=>S.type=e),onTabChange:b},{default:t(()=>[l(se,{label:"外包项目",name:2},{default:t(()=>[S.type===2?(s(),i(v,{key:0,formSearchList:F.value,formSearchName:q.value,onCurrentChange:z,onOnReset:K,model:S,formOption:W},null,8,["formSearchList","formSearchName","model"])):r("",!0),l(A,{"border-style":"dashed"}),l(te,{gutter:24},{default:t(()=>[l(M),l(ee,null,{default:t(()=>[l(y,{size:"default",onClick:a[0]||(a[0]=()=>{})},{default:t(()=>[n(" 导出 ")]),_:1}),l(Z,{border:C.value,"onUpdate:border":a[1]||(a[1]=e=>C.value=e),tableAutoHeight:D.value,"onUpdate:tableAutoHeight":a[2]||(a[2]=e=>D.value=e),checkList:u.value,"onUpdate:checkList":a[3]||(a[3]=e=>u.value=e),columns:U.value,"onUpdate:columns":a[4]||(a[4]=e=>U.value=e),"line-height":L.value,"onUpdate:lineHeight":a[5]||(a[5]=e=>L.value=e),stripe:w.value,"onUpdate:stripe":a[6]||(a[6]=e=>w.value=e),style:{"margin-left":"12px"},onQueryData:z},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),xe((s(),i(oe,{ref_key:"tableSortRef",ref:de,style:{"margin-top":"10px"},"row-key":"id",data:T.value,border:C.value,size:L.value,stripe:w.value,"highlight-current-row":"",onCurrentChange:X},{empty:t(()=>[l(le,{image:_(ie),"image-size":300},null,8,["image"])]),default:t(()=>[l(c,{align:"left",type:"selection"}),u.value.includes("projectStatus")?(s(),i(c,{key:0,"show-overflow-tooltip":"",prop:"receiveStatus",align:"left",width:"140",label:"状态"},{default:t(({row:e})=>[g("span",Fe,[e.projectStatus===1?(s(),i(f,{key:0,type:"primary"},{default:t(()=>[n(" 进行中(在线)")]),_:1})):e.projectStatus===2?(s(),i(f,{key:1,type:"warning"},{default:t(()=>[n(" 已完成(审核通过)")]),_:1})):e.projectStatus===3?(s(),i(f,{key:2,type:"info"},{default:t(()=>[n(" 离线")]),_:1})):r("",!0)])]),_:1})):r("",!0),u.value.includes("tenantName")?(s(),i(c,{key:1,"show-overflow-tooltip":"",prop:"tenantName",align:"left",label:"合作商名称"},{default:t(({row:e})=>[g("div",Qe,d(e.tenantName),1)]),_:1})):r("",!0),u.value.includes("tenantId")?(s(),i(c,{key:2,"show-overflow-tooltip":"",prop:"tenantId",align:"left",width:"280",label:"合作商ID"},{default:t(({row:e})=>[g("div",qe,[g("div",Ge,d(e.tenantId),1),l(P,{content:e.tenantId,class:x({rowCopy:"rowCopy",current:e.projectId===j.value})},null,8,["content","class"])])]),_:1})):r("",!0),u.value.includes("projectName")?(s(),i(c,{key:3,"show-overflow-tooltip":"",prop:"projectName",align:"left",label:"项目名称"},{default:t(({row:e})=>[g("div",Je,d(e.projectName),1)]),_:1})):r("",!0),u.value.includes("projectId")?(s(),i(c,{key:4,"show-overflow-tooltip":"",prop:"projectId",align:"left",width:"280",label:"项目ID"},{default:t(({row:e})=>[g("div",Ke,[g("div",We,[l(ae,{effect:"dark",content:e.projectId,placement:"top-start"},{default:t(()=>[n(d(e.projectId),1)]),_:2},1032,["content"])]),l(P,{content:e.projectId,class:x({rowCopy:"rowCopy",current:e.projectId===j.value})},null,8,["content","class"])])]),_:1})):r("",!0),u.value.includes("participationNumber")?(s(),i(c,{key:5,"show-overflow-tooltip":"",prop:"participationNumber",align:"left",label:"参数",width:"300"},{default:t(({row:e})=>[l(f,{style:{color:"rgb(251, 104, 104)"},class:"oneLine",type:"danger"},{default:t(()=>[n("参与: "+d(e.participationNumber||0),1)]),_:2},1024),n("   "),l(f,{style:{color:"rgb(3, 194, 57)"},class:"oneLine",type:"success"},{default:t(()=>[n("完成: "+d(e.doneNumber||0),1)]),_:2},1024),n("   "),l(f,{style:{color:"rgb(255, 172, 84)"},class:"oneLine",type:"warning"},{default:t(()=>[n("配额: "+d(e.num||0),1)]),_:2},1024),n("   "),l(f,{style:{color:"rgb(170, 170, 170)"},class:"oneLine",type:"info"},{default:t(()=>[n("限量: "+d(e.limitedQuantity||"-"),1)]),_:2},1024)]),_:1})):r("",!0),l(c,{align:"left",fixed:"right",label:"操作",width:"170"},{default:t(({row:e})=>[l(y,{type:"primary",plain:"",size:"small",onClick:E=>G(e)},{default:t(()=>[n(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[Ie,m.value]]),l(ne,{"current-page":_(h).page,total:_(h).total,"page-size":_(h).size,"page-sizes":_(h).sizes,layout:_(h).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:J,onCurrentChange:z},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),l(se,{label:"接收项目",name:1},{default:t(()=>[S.type===1?(s(),i(v,{key:0,formSearchList:Q.value,formSearchName:q.value,onCurrentChange:z,onOnReset:K,model:S,formOption:W},null,8,["formSearchList","formSearchName","model"])):r("",!0),l(A,{"border-style":"dashed"}),l(te,{gutter:24},{default:t(()=>[l(M,null,{default:t(()=>[l(y,{type:"primary",size:"default",onClick:ve},{default:t(()=>[n(" 接收项目 ")]),_:1}),l(y,{size:"default",onClick:ye},{default:t(()=>[n(" 取消接收 ")]),_:1})]),_:1}),l(ee,null,{default:t(()=>[l(y,{size:"default",onClick:a[7]||(a[7]=()=>{})},{default:t(()=>[n(" 导出 ")]),_:1}),l(Z,{border:C.value,"onUpdate:border":a[8]||(a[8]=e=>C.value=e),tableAutoHeight:D.value,"onUpdate:tableAutoHeight":a[9]||(a[9]=e=>D.value=e),checkList:u.value,"onUpdate:checkList":a[10]||(a[10]=e=>u.value=e),columns:U.value,"onUpdate:columns":a[11]||(a[11]=e=>U.value=e),"line-height":L.value,"onUpdate:lineHeight":a[12]||(a[12]=e=>L.value=e),stripe:w.value,"onUpdate:stripe":a[13]||(a[13]=e=>w.value=e),style:{"margin-left":"12px"},onQueryData:z},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),l(oe,{ref_key:"tableSortRef2",ref:$,style:{"margin-top":"10px"},"row-key":"id",data:T.value,border:C.value,size:L.value,"highlight-current-row":"",stripe:w.value,onCurrentChange:X},{empty:t(()=>[l(le,{image:_(ie),"image-size":300},null,8,["image"])]),default:t(()=>[l(c,{align:"left",type:"selection"}),u.value.includes("projectStatus")?(s(),i(c,{key:0,"show-overflow-tooltip":"",prop:"projectStatus",align:"left",label:"状态",width:"140"},{default:t(({row:e})=>[g("span",Xe,[e.projectStatus===1?(s(),i(f,{key:0,type:"primary"},{default:t(()=>[n(" 进行中(在线)")]),_:1})):e.projectStatus===2?(s(),i(f,{key:1,type:"warning"},{default:t(()=>[n(" 已完成(审核通过)")]),_:1})):e.projectStatus===3?(s(),i(f,{key:2,type:"info"},{default:t(()=>[n(" 离线")]),_:1})):r("",!0)])]),_:1})):r("",!0),u.value.includes("receiveStatus")?(s(),i(c,{key:1,"show-overflow-tooltip":"",prop:"receiveStatus",align:"left",label:"接收状态",width:"140"},{default:t(({row:e})=>[e.receiveStatus==2?(s(),i(f,{key:0,style:{color:"rgb(251, 104, 104)"},class:"oneLine",type:"danger"},{default:t(()=>[n("未接收")]),_:1})):r("",!0),e.receiveStatus==1?(s(),i(f,{key:1,style:{color:"rgb(3, 194, 57)"},class:"oneLine",type:"success"},{default:t(()=>[n("已接收")]),_:1})):r("",!0)]),_:1})):r("",!0),l(c,{"show-overflow-tooltip":"",prop:"tenantName",align:"left",label:"合作商",width:"200"},{default:t(({row:e})=>[u.value.includes("tenantName")?(s(),B("div",Ye,d(e.tenantName),1)):r("",!0),u.value.includes("tenantId")?(s(),B("div",Ze,[g("div",et,d(e.tenantId),1),l(P,{content:e.tenantId,class:x({rowCopy:"rowCopy",current:e.projectId===j.value})},null,8,["content","class"])])):r("",!0)]),_:1}),l(c,{"show-overflow-tooltip":"",prop:"projectName",align:"left",label:"项目",width:"200"},{default:t(({row:e})=>[u.value.includes("projectName")?(s(),B("div",tt,d(e.projectName),1)):r("",!0),u.value.includes("projectId")?(s(),B("div",at,[g("div",lt,[l(ae,{effect:"dark",content:e.projectId,placement:"top-start"},{default:t(()=>[n(d(e.projectId),1)]),_:2},1032,["content"])]),l(P,{content:e.projectId,class:x({rowCopy:"rowCopy",current:e.projectId===j.value})},null,8,["content","class"])])):r("",!0)]),_:1}),u.value.includes("allocationType")?(s(),i(c,{key:2,align:"left",label:"分配",width:"120"},{default:t(({row:e})=>[e.allocationType===1?(s(),i(y,{key:0,class:"tableBut",size:"small",type:"danger",plain:""},{default:t(()=>[n("自动分配")]),_:1})):e.allocationType===2?(s(),i(y,{key:1,class:"tableBut",size:"small",type:"danger"},{default:t(()=>[n("供应商")]),_:1})):e.allocationType===3?(s(),i(y,{key:2,class:"tableBut",size:"small",type:"success"},{default:t(()=>[n("部门")]),_:1})):e.allocationType===4?(s(),i(y,{key:3,class:"tableBut",size:"small",type:"primary"},{default:t(()=>[n("合作商")]),_:1})):(s(),i(y,{key:4,size:"small",class:"tableBut"},{default:t(()=>[n(" 未分配")]),_:1}))]),_:1})):r("",!0),u.value.includes("doMoneyPrice")?(s(),i(c,{key:3,"show-overflow-tooltip":"",align:"left",label:"项目价",width:"120"},{default:t(({row:e})=>[g("div",null,[l(be),n(d(e.doMoneyPrice||0),1)])]),_:1})):r("",!0),u.value.includes("participationNumber")?(s(),i(c,{key:4,"show-overflow-tooltip":"",prop:"participationNumber",align:"left",label:"参数",width:"300"},{default:t(({row:e})=>[l(f,{style:{color:"rgb(251, 104, 104)"},class:"oneLine",type:"danger"},{default:t(()=>[n("参与: "+d(e.participationNumber||0),1)]),_:2},1024),n("   "),l(f,{style:{color:"rgb(3, 194, 57)"},class:"oneLine",type:"success"},{default:t(()=>[n("完成: "+d(e.doneNumber||0),1)]),_:2},1024),n("   "),l(f,{style:{color:"rgb(255, 172, 84)"},class:"oneLine",type:"warning"},{default:t(()=>[n("配额: "+d(e.num||0),1)]),_:2},1024),n("   "),l(f,{style:{color:"rgb(170, 170, 170)"},class:"oneLine",type:"info"},{default:t(()=>[n("限量: "+d(e.limitedQuantity||"-"),1)]),_:2},1024)]),_:1})):r("",!0),u.value.includes("userName")?(s(),i(c,{key:5,"show-overflow-tooltip":"",prop:"userName",align:"left",label:"负责人",width:"140"},{default:t(({row:e})=>[g("div",ot,[g("div",nt,[g("div",st,d(e.userName),1)]),e.receiveStatus==1?(s(),i(ke,{key:0,onClick:E=>Y(e),class:x({edit:"edit",current:e.projectId===j.value}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])):r("",!0)])]),_:1})):r("",!0),l(c,{align:"left",fixed:"right",label:"操作",width:"220"},{default:t(({row:e})=>[e.receiveStatus==2?(s(),i(y,{key:0,plain:"",type:"primary",size:"small",onClick:E=>Y(e)},{default:t(()=>[n(" 接收 ")]),_:2},1032,["onClick"])):r("",!0),e.receiveStatus==1?(s(),i(y,{key:1,plain:"",type:"primary",size:"small",onClick:E=>ge(e)},{default:t(()=>[n(" 取消接收 ")]),_:2},1032,["onClick"])):r("",!0),e.receiveStatus==2?(s(),i(y,{key:2,down:"",plain:"",type:"danger",size:"small",onClick:E=>_e(e)},{default:t(()=>[n(" 拒绝 ")]),_:2},1032,["onClick"])):r("",!0),l(y,{type:"warning",plain:"",size:"small",onClick:E=>G(e)},{default:t(()=>[n(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"]),l(ne,{"current-page":_(h).page,total:_(h).total,"page-size":_(h).size,"page-sizes":_(h).sizes,layout:_(h).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:J,onCurrentChange:z},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1})]),_:1},8,["modelValue"]),l(Ve,{ref_key:"addAllocationEditRef",ref:me,onFetchData:b},null,512),l(He,{ref_key:"editRef",ref:O,onFetchData:b},null,512)]),_:1}),l(Oe,{ref_key:"userRef",ref:H,onUserData:he},null,512)],2)}}}),Ut=Te(it,[["__scopeId","data-v-473c8f87"]]);export{Ut as default};
