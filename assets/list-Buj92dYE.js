
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Se,r as c,aN as De,Z as we,n as Ee,a as u,q as xe,s as B,o as s,b as x,f as t,w as e,F,t as H,e as p,ao as ze,g as i,z as _,i as S,aM as Ve,j as d,N as Ie,aO as $e,E as Ne,_ as Re,bb as Le,bc as Ue,be as Ae,an as Te,aH as Be,aI as Fe,y as He,L as Me}from"./index-Bg-926fH.js";import{_ as Pe}from"./index.vue_vue_type_style_index_0_lang-Cz3-6QKK.js";import{_ as Oe}from"./index.vue_vue_type_script_setup_true_lang-BE0A8OXY.js";import{_ as Ye,a as q}from"./index.vue_vue_type_script_setup_true_lang-W1NakA-C.js";import{u as je}from"./user_customer-JUp9K5GH.js";import"./index-D3UEyhBw.js";import"./index.vue_vue_type_script_setup_true_lang-say7Shku.js";import"./index-DithqPGF.js";import"./index-DiqTcmOh.js";import"./index-BL9AOUER.js";import"./user_customer-CWW4QeDc.js";import"./index-Bkc_aqja.js";import"./department-DXEs2sq6.js";import"./position_manage-poreZe-C.js";import"./configuration_role-3L8Vekyo.js";import"./tenant_role-xhW4ZniK.js";import"./configuration_manager-B_apiz-y.js";import"./configuration_siteSetting-CXkQ6O9m.js";import"./configuration_site_setting-BzHrfgUm.js";import"./apiLoading-7oBmqdmO.js";import"./stagedData-xDmSHnnL.js";const qe=D=>(Be("data-v-0c661bd1"),D=D(),Fe(),D),Je=qe(()=>He("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Qe=Se({name:"invoice",__name:"list",setup(D){const J=je(),M=c([]),{pagination:C,onSizeChange:Q,onCurrentChange:Z,onSortChange:Ze}=De(),G=c(""),P=c([]),b=c(!0),z=c(),V=c(!1),m=c([]),I=c(!1);c(!1);const $=c("default"),N=c(!1),K=c([]),W=[{lable:"未收款",value:1},{lable:"部分收款",value:2},{lable:"已完结",value:3},{lable:"坏账",value:4}],y=c(null),g=c([]),X=[{lable:"开票日期",value:1},{lable:"收款日期",value:2}],R=c([{label:"客户简称",prop:"tenantCustomerShortName",sortable:!0,disableCheck:!1,checked:!0},{label:"发票编号",prop:"invoiceCode",sortable:!0,disableCheck:!1,checked:!0},{label:"金额",prop:"invoiceAmount",sortable:!0,disableCheck:!1,checked:!0},{label:"手续费(税)",prop:"invoiceTax",sortable:!0,disableCheck:!1,checked:!0},{label:"实收款",prop:"actualReceipts",sortable:!0,disableCheck:!1,checked:!0},{label:"开票日期",prop:"invoiceDate",sortable:!0,disableCheck:!1,checked:!0},{label:"收款日期",prop:"paymentDate",sortable:!0,disableCheck:!1,checked:!0},{label:"状态",prop:"invoiceStatus",sortable:!0,disableCheck:!1,checked:!0},{label:"备注",prop:"remark",sortable:!0,disableCheck:!1,checked:!0}]),r=we({page:1,limit:10,tenantCustomerId:"",invoiceStatus:[],invoiceDateStart:"",invoiceDateEnd:"",paymentDateStart:"",paymentDateEnd:""});function ee(){z.value.showEdit("")}function te(o){z.value.showEdit(JSON.stringify(o))}function le(o){$e.confirm(`确认删除「${o.tenantCustomerShortName}」这条数据吗？`,"确认信息").then(()=>{try{b.value=!0,q.delete({id:o.id}).then(()=>{b.value=!1,k(),Ne.success({message:"删除成功",center:!0})})}catch{}finally{b.value=!1}}).catch(()=>{})}function ae(o){K.value=o}function oe(){Object.assign(r,{page:1,limit:10,tenantCustomerId:"",invoiceStatus:[],invoiceDateStart:"",invoiceDateEnd:"",paymentDateStart:"",paymentDateEnd:""}),y.value=null,k()}const ne=o=>{y.value=o,g.value=[],r.invoiceDateStart="",r.invoiceDateEnd="",r.paymentDateStart="",r.paymentDateEnd="",h()},se=()=>{y.value===1?(r.invoiceDateStart=g.value[0],r.invoiceDateEnd=g.value[1]):(r.paymentDateStart=g.value[0],r.paymentDateEnd=g.value[1]),h()};function ie(o){Q(o).then(()=>{r.limit=o,k()})}function h(o=1){Z(o).then(()=>{r.page=o,k()})}async function k(){try{b.value=!0,M.value=await J.getCustomerList();const{data:o}=await q.list(r);P.value=o.data,C.value.total=parseInt(o.total)||0,b.value=!1}catch{}finally{b.value=!1}}return Ee(()=>{R.value.forEach(o=>{o.checked&&m.value.push(o.prop)}),k()}),(o,a)=>{const re=u("el-option"),L=u("el-select"),w=u("el-form-item"),O=u("ElOption"),ue=u("el-date-picker"),Y=Re,U=u("ElButton"),ce=u("ElFormItem"),pe=u("el-form"),de=Oe,me=u("ElDivider"),E=u("el-button"),fe=Pe,ve=Le,_e=Ue,be=u("el-row"),v=u("el-table-column"),f=u("el-text"),A=Ae,ge=u("ElTableColumn"),he=u("el-empty"),Ce=u("el-table"),ye=u("ElPagination"),ke=Te,j=xe("loading");return B((s(),x("div",{class:Ie({"absolute-container":V.value})},[t(ke,null,{default:e(()=>[t(de,{"show-toggle":!1},{default:e(({fold:l,toggle:T})=>[t(pe,{model:r.select,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:e(()=>[t(w,{label:""},{default:e(()=>[t(L,{modelValue:r.tenantCustomerId,"onUpdate:modelValue":a[0]||(a[0]=n=>r.tenantCustomerId=n),placeholder:"客户简称",clearable:"",filterable:"",onChange:a[1]||(a[1]=n=>h())},{default:e(()=>[(s(!0),x(F,null,H(M.value,n=>(s(),p(re,{key:n.tenantCustomerId,value:n.tenantCustomerId,label:n.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(w,{label:""},{default:e(()=>[t(L,{modelValue:r.invoiceStatus,"onUpdate:modelValue":a[2]||(a[2]=n=>r.invoiceStatus=n),placeholder:"发票状态",clearable:"",filterable:"",onChange:a[3]||(a[3]=n=>h()),multiple:!0},{default:e(()=>[(s(),x(F,null,H(W,n=>t(O,{label:n.lable,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(w,{label:""},{default:e(()=>[t(L,{modelValue:y.value,"onUpdate:modelValue":a[4]||(a[4]=n=>y.value=n),placeholder:"时间类型",clearable:"",filterable:"",onChange:ne},{default:e(()=>[(s(),x(F,null,H(X,n=>t(O,{label:n.lable,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),B(t(w,null,{default:e(()=>[t(ue,{modelValue:g.value,"onUpdate:modelValue":a[5]||(a[5]=n=>g.value=n),disabled:!y.value,"value-format":"YYYY-MM-DD hh:mm:ss",type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:"",size:"",onChange:se},null,8,["modelValue","disabled"])]),_:2},1536),[[ze,!l]]),t(ce,null,{default:e(()=>[t(U,{type:"primary",onClick:a[6]||(a[6]=n=>h())},{icon:e(()=>[t(Y,{name:"i-ep:search"})]),default:e(()=>[i(" 筛选 ")]),_:1}),t(U,{onClick:oe},{icon:e(()=>[Je]),default:e(()=>[i(" 重置 ")]),_:1}),t(U,{link:"",onClick:T},{icon:e(()=>[t(Y,{name:l?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:e(()=>[i(" "+_(l?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),t(me,{"border-style":"dashed"}),t(be,{gutter:24},{default:e(()=>[t(fe,null,{default:e(()=>[t(E,{style:{"margin-right":"10px"},type:"primary",size:"default",onClick:ee},{default:e(()=>[i(" 新增发票 ")]),_:1})]),_:1}),t(_e,null,{default:e(()=>[t(E,{size:"default",onClick:a[7]||(a[7]=()=>{})},{default:e(()=>[i(" 导出 ")]),_:1}),t(ve,{border:I.value,"onUpdate:border":a[8]||(a[8]=l=>I.value=l),tableAutoHeight:V.value,"onUpdate:tableAutoHeight":a[9]||(a[9]=l=>V.value=l),checkList:m.value,"onUpdate:checkList":a[10]||(a[10]=l=>m.value=l),columns:R.value,"onUpdate:columns":a[11]||(a[11]=l=>R.value=l),"line-height":$.value,"onUpdate:lineHeight":a[12]||(a[12]=l=>$.value=l),stripe:N.value,"onUpdate:stripe":a[13]||(a[13]=l=>N.value=l),style:{"margin-left":"12px"},onQueryData:h},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),B((s(),p(Ce,{ref_key:"tableSortRef",ref:G,style:{"margin-top":"10px"},"row-key":"id",data:P.value,border:I.value,class:"my-4",size:$.value,stripe:N.value,onSelectionChange:ae},{empty:e(()=>[t(he,{image:S(Ve),"image-size":300},null,8,["image"])]),default:e(()=>[t(v,{align:"left",type:"selection"}),m.value.includes("tenantCustomerShortName")?(s(),p(v,{key:0,prop:"tenantCustomerShortName","show-overflow-tooltip":"",align:"left",width:"100",label:"客户简称"},{default:e(({row:l})=>[t(f,{class:"fontColor tableBig"},{default:e(()=>[i(_(l.tenantCustomerShortName),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceCode")?(s(),p(v,{key:1,prop:"invoiceCode","show-overflow-tooltip":"",align:"left",label:"发票编号"},{default:e(({row:l})=>[t(f,{class:"fontColor"},{default:e(()=>[i(_(l.invoiceCode),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceAmount")?(s(),p(v,{key:2,prop:"invoiceAmount","show-overflow-tooltip":"",align:"left",label:"金额"},{default:e(({row:l})=>[t(A),t(f,{class:"fontColor"},{default:e(()=>[i(_(l.invoiceAmount||0),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceTax")?(s(),p(v,{key:3,prop:"invoiceTax","show-overflow-tooltip":"",align:"left",label:"手续费(税)"},{default:e(({row:l})=>[t(A),t(f,{class:"fontColor"},{default:e(()=>[i(_(l.invoiceTax||0),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("actualReceipts")?(s(),p(v,{key:4,prop:"actualReceipts","show-overflow-tooltip":"",align:"left",label:"实收款"},{default:e(({row:l})=>[t(A),t(f,{class:"fontColor"},{default:e(()=>[i(_(l.actualReceipts||0),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceDate")?(s(),p(v,{key:5,prop:"invoiceDate","show-overflow-tooltip":"",align:"left",width:"180",label:"开票日期"},{default:e(({row:l})=>[t(f,{class:"fontColor"},{default:e(()=>[i(_(l.invoiceDate),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("paymentDate")?(s(),p(v,{key:6,prop:"paymentDate","show-overflow-tooltip":"",align:"left",width:"180",label:"收款日期"},{default:e(({row:l})=>[t(f,{class:"fontColor"},{default:e(()=>[i(_(l.paymentDate),1)]),_:2},1024)]),_:1})):d("",!0),m.value.includes("invoiceStatus")?(s(),p(ge,{key:7,align:"left","show-overflow-tooltip":"",prop:"invoiceStatus",label:"状态"},{default:e(({row:l})=>[l.invoiceStatus===1?(s(),p(f,{key:0,class:"mx-1 color1 fontC-System"},{default:e(()=>[i("未收款")]),_:1})):d("",!0),l.invoiceStatus===2?(s(),p(f,{key:1,class:"mx-1 color2 fontC-System"},{default:e(()=>[i("部分收款")]),_:1})):d("",!0),l.invoiceStatus===3?(s(),p(f,{key:2,class:"mx-1 color3 fontC-System"},{default:e(()=>[i("已完结")]),_:1})):d("",!0),l.invoiceStatus===4?(s(),p(f,{key:3,class:"mx-1 color4 fontC-System"},{default:e(()=>[i("坏账")]),_:1})):d("",!0)]),_:1})):d("",!0),m.value.includes("remark")?(s(),p(v,{key:8,prop:"remark",align:"left",label:"备注"},{default:e(({row:l})=>[t(f,{class:"mx-1 fontC-System"},{default:e(()=>[i(_(l.remark),1)]),_:2},1024)]),_:1})):d("",!0),t(v,{align:"left",fixed:"right",label:"操作",width:"170"},{default:e(({row:l})=>[t(E,{size:"small",plain:"",type:"primary",onClick:T=>te(l)},{default:e(()=>[i(" 编辑 ")]),_:2},1032,["onClick"]),t(E,{size:"small",plain:"",type:"danger",onClick:T=>le(l)},{default:e(()=>[i(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[j,!1]]),t(ye,{"current-page":S(C).page,total:S(C).total,"page-size":S(C).size,"page-sizes":S(C).sizes,layout:S(C).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:h,onSizeChange:ie},null,8,["current-page","total","page-size","page-sizes","layout"]),t(Ye,{onSuccess:k,ref_key:"editRef",ref:z},null,512)]),_:1})],2)),[[j,b.value]])}}}),bt=Me(Qe,[["__scopeId","data-v-0c661bd1"]]);export{bt as default};
