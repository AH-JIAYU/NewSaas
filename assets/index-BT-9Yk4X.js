
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ue,aN as pe,r as s,a3 as de,c as fe,n as _e,a as f,q as me,o as c,b as be,f as l,w as o,g as _,i as t,A as v,s as ge,e as r,aM as ve,y as m,j as p,z as h,N as R,aO as he,E as ye,b9 as ke,ba as Ce,_ as Ie,be as we,ap as Te,L as Se}from"./index-ChQqcNbm.js";import{_ as Ee}from"./index-BCoAbmCK.js";import{_ as ze}from"./index.vue_vue_type_style_index_0_lang-DelBBmAX.js";import Be from"./index-B_kkIX1U.js";import{_ as Re}from"./index.vue_vue_type_script_setup_true_lang-DHDza646.js";import{c as A}from"./user_cooperation-WeC_KTb_.js";import xe from"./index-D7l1x52_.js";import"./index-d1Kj8fIT.js";import"./index.vue_vue_type_script_setup_true_lang-SxHCfjyr.js";import"./department-htT9pOTR.js";const Ne={class:"fontC-System"},Le={class:"copyId tableSmall"},De={class:"id oneLine beInvitationTenantId"},Pe={class:"tableBig"},$e={class:"flex-s"},Ae={class:"fontC-System"},Me={class:"fontC-System"},Ue={class:"fontC-System"},Fe={class:"fontC-System"},He=ue({name:"cooperation",__name:"index",setup(qe){const{pagination:g,getParams:M,onSizeChange:U,onCurrentChange:F}=pe(),k=s(!1),B=s([]),x=s(),N=s(),H=s(),C=s(!1),I=s(!1),w=s(!1),T=s("default"),u=s([]),L=s(),S=s([{label:"租户id",checked:!0,sortable:!0,prop:"beInvitationTenantId"},{label:"租户名称",checked:!0,sortable:!0,prop:"beInvitationTenantName"},{label:"PM",checked:!0,sortable:!0,prop:"userName"},{label:"状态",checked:!0,sortable:!0,prop:"bindStatus"},{label:"价格比例",checked:!0,sortable:!0,prop:"priceRatio"},{label:"待审金额",checked:!0,sortable:!0,prop:"pendBalance"},{label:"可用金额",checked:!0,sortable:!0,prop:"availableBalance"}]),E=s();function q(n){n?E.value=n.id:E.value=""}function Q(){x.value.showEdit()}function V(n){he.prompt("是否确认进行解约?","终止合作",{confirmButtonText:"确认",cancelButtonText:"取消",inputPlaceholder:"说明",inputPattern:/^.{0,500}$/,inputErrorMessage:"不能超过500个字符",type:"warning"}).then(async a=>{const{data:{flag:b}}=await A.updateRescindTenant({beInvitationTenantId:n.beInvitationTenantId,remark:a.value});b&&ye({type:"success",message:"已终止合作"}),y()}).catch(()=>{})}function j(n){N.value.showEdit(n)}const O=de({});function G(n){U(n).then(()=>y())}function J(n=1){F(n).then(()=>y())}function z(){g.value.page=1,y()}async function y(){try{k.value=!0;const n={...M(),...O},{data:a}=await A.list(n);B.value=a.tenantBindInfoList,g.value.total=Number(a.total),k.value=!1}catch{}finally{k.value=!1}}function K(n){H.value=n}const W=fe(()=>{const n=B.value.filter(i=>i.bindStatus===2);let a=B.value.filter(i=>i.bindStatus===4);a=Array.from(new Map(a.map(i=>[i.beInvitationTenantId,i])).values());const b=n.map(i=>i.beInvitationTenantId);return a.forEach(i=>{b.includes(i.beInvitationTenantId)||n.push(i)}),n});function X(n,a){L.value.showEdit(n,a)}return _e(()=>{S.value.forEach(n=>{n.checked&&u.value.push(n.prop)}),z()}),(n,a)=>{const b=f("el-button"),i=ze,Y=ke,Z=Ce,ee=f("el-row"),d=f("el-table-column"),D=f("el-text"),te=f("el-tooltip"),ne=Ee,ae=Ie,P=we,oe=f("ElSpace"),le=f("el-empty"),ie=f("el-table"),se=f("ElPagination"),ce=Te,re=me("loading");return c(),be("div",{class:R({"absolute-container":t(w)})},[l(ce,null,{default:o(()=>[l(ee,null,{default:o(()=>[l(i,null,{default:o(()=>[l(b,{type:"primary",size:"default",onClick:Q},{default:o(()=>[_(" 邀约公司 ")]),_:1})]),_:1}),l(Z,null,{default:o(()=>[l(b,{size:"default"},{default:o(()=>[_(" 导出 ")]),_:1}),l(Y,{border:t(C),"onUpdate:border":a[0]||(a[0]=e=>v(C)?C.value=e:null),tableAutoHeight:t(w),"onUpdate:tableAutoHeight":a[1]||(a[1]=e=>v(w)?w.value=e:null),checkList:t(u),"onUpdate:checkList":a[2]||(a[2]=e=>v(u)?u.value=e:null),columns:t(S),"onUpdate:columns":a[3]||(a[3]=e=>v(S)?S.value=e:null),"line-height":t(T),"onUpdate:lineHeight":a[4]||(a[4]=e=>v(T)?T.value=e:null),stripe:t(I),"onUpdate:stripe":a[5]||(a[5]=e=>v(I)?I.value=e:null),style:{"margin-left":"12px"},onQueryData:z},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),ge((c(),r(ie,{border:t(C),data:t(W),size:t(T),stripe:t(I),onSelectionChange:K,"highlight-current-row":"",onCurrentChange:q},{empty:o(()=>[l(le,{image:t(ve),"image-size":300},null,8,["image"])]),default:o(()=>[l(d,{align:"left",type:"selection"}),t(u).includes("bindStatus")?(c(),r(d,{key:0,align:"left",prop:"bindStatus","show-overflow-tooltip":"",label:"状态",width:"100"},{default:o(({row:e})=>[m("div",Ne,[e.bindStatus===2?(c(),r(D,{key:0,type:"success"},{default:o(()=>[_("合作")]),_:1})):p("",!0),e.bindStatus===4?(c(),r(D,{key:1,type:"danger"},{default:o(()=>[_("解约")]),_:1})):p("",!0)])]),_:1})):p("",!0),t(u).includes("beInvitationTenantId")?(c(),r(d,{key:1,align:"left",prop:"beInvitationTenantId",width:"280",label:"租户ID"},{default:o(({row:e})=>[m("div",Le,[m("div",De,[l(te,{effect:"dark",content:e.beInvitationTenantId,placement:"top-start"},{default:o(()=>[_(h(e.beInvitationTenantId),1)]),_:2},1032,["content"])]),l(ne,{content:e.beInvitationTenantId,class:R({rowCopy:"rowCopy",current:e.id===t(E)})},null,8,["content","class"])])]),_:1})):p("",!0),t(u).includes("beInvitationTenantName")?(c(),r(d,{key:2,align:"left",prop:"beInvitationTenantName","show-overflow-tooltip":"",label:"租户名称"},{default:o(({row:e})=>[m("div",Pe,h(e.beInvitationTenantName),1)]),_:1})):p("",!0),t(u).includes("userName")?(c(),r(d,{key:3,align:"left",prop:"userName","show-overflow-tooltip":"",label:"负责部门/人"},{default:o(({row:e})=>[m("div",$e,[m("div",Ae,h(e.userName),1),e.projectType!==2?(c(),r(ae,{key:0,onClick:$=>X(e,"chargeUserId"),class:R({edit:"edit",current:e.id===t(E)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])):p("",!0)])]),_:1})):p("",!0),t(u).includes("priceRatio")?(c(),r(d,{key:4,align:"left",prop:"priceRatio","show-overflow-tooltip":"",label:"价格比例"},{default:o(({row:e})=>[m("div",Me,h(e.priceRatio)+"%",1)]),_:1})):p("",!0),t(u).includes("pendBalance")?(c(),r(d,{key:5,align:"left",prop:"pendBalance","show-overflow-tooltip":"",label:"待审金额"},{default:o(({row:e})=>[m("div",Ue,[l(P),_(h(e.pendBalance||0),1)])]),_:1})):p("",!0),t(u).includes("availableBalance")?(c(),r(d,{key:6,align:"left",prop:"availableBalance","show-overflow-tooltip":"",label:"可用金额"},{default:o(({row:e})=>[m("div",Fe,[l(P),_(h(e.availableBalance||0),1)])]),_:1})):p("",!0),l(d,{align:"left",fixed:"right",prop:"i",label:"操作",width:"200"},{default:o(({row:e})=>[l(oe,null,{default:o(()=>[e.bindStatus===2?(c(),r(b,{key:0,type:"danger",plain:"",size:"small",onClick:$=>V(e)},{default:o(()=>[_(" 终止合作 ")]),_:2},1032,["onClick"])):p("",!0),l(b,{size:"small",type:"danger",onClick:$=>j(e)},{default:o(()=>[_(" 合作配置 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["border","data","size","stripe"])),[[re,t(k)]]),l(se,{"current-page":t(g).page,total:t(g).total,"page-size":t(g).size,"page-sizes":t(g).sizes,layout:t(g).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:G,onCurrentChange:J},null,8,["current-page","total","page-size","page-sizes","layout"]),l(Be,{ref_key:"editRef",ref:x,onFetchData:z},null,512),l(Re,{ref_key:"proportionRef",ref:N,onFetchData:z},null,512)]),_:1}),l(xe,{ref_key:"QuickEditRef",ref:L,onFetchData:y},null,512)],2)}}}),Ze=Se(He,[["__scopeId","data-v-526c413b"]]);export{Ze as default};
