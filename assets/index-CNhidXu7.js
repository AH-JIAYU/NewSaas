
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as He,aj as Ne,r as g,l as Ie,aM as xe,c as R,n as Ve,X as we,a as u,q as U,o as r,b as H,v as _,f as i,j as v,w as o,i as s,s as C,e as c,g as m,A as p,B as ze,aN as Ee,O as De,p as E,aO as A,E as N,aP as Be,ao as Me,aI as Pe,aJ as $e,M as Re,an as T}from"./index-FOy5HeQJ.js";import{_ as Ue}from"./index-CmkUgVIL.js";import{_ as Ae}from"./index-CyF4BycE.js";import{u as Te}from"./position_manage-Cg8cFvny.js";import Fe from"./index-8hEyA4JS.js";import Oe from"./index-BgwhIXR3.js";import{columns as I,formSearchList as Ze}from"./index-BFibzBXr.js";import"./index-CzPZOUZY.js";import"./clipboard-9lrQotiC.js";import"./index.vue_vue_type_script_setup_true_lang-DXxXvmC5.js";import"./sortable.esm-C0-Qcoum.js";import"./position_manage-CAw6SxoM.js";import"./department-BwZLg-IQ.js";import"./configuration_role-xFxeT32O.js";import"./tenant_role-B_NR__R9.js";import"./configuration_manager-Cl2p8DY4.js";const je=k=>(Pe("data-v-f3035587"),k=k(),$e(),k),qe={class:"absolute-container"},Je={class:"page-main"},Ge={class:"leftTree"},Qe={key:0,class:"leftData",span:3},Xe={class:"copyId tableSmall"},Ke={class:"id oneLine idFont"},We={style:{display:"flex","align-items":"center"}},Ye={key:0,xmlns:"http://www.w3.org/2000/svg",style:{"margin-top":"2px","margin-right":"7px"},width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},et=je(()=>_("g",{id:"Group 18384"},[_("circle",{id:"Ellipse 105",cx:"10",cy:"10",r:"10",fill:"#F8BB4F"}),_("path",{id:"ç®¡",d:"M13.9946 9.3605V12.1892H7.43481V12.9031H14.6277V16.4995H13.3481V16.0146H7.43481V16.486H6.15517V9.3605H13.9946ZM7.43481 14.8831H13.3481V13.9133H7.43481V14.8831ZM7.43481 11.1655H12.7419V10.3842H7.43481V11.1655ZM15.8534 7.67677V10.2495H14.6008V8.75436H5.52209V10.2495H4.2694V7.67677H9.48222C9.37446 7.40738 9.25323 7.16492 9.13201 6.9494L10.2635 6.76083L10.0345 6.61266C10.6541 5.80447 11.1121 4.9424 11.3815 4.01298L12.6072 4.28238C12.5264 4.51136 12.4591 4.72688 12.3782 4.9424H16.1228V6.06039H13.9273C14.1428 6.35673 14.3179 6.65307 14.4661 6.92246L13.3346 7.34003C13.1191 6.90899 12.8631 6.47796 12.5668 6.06039H11.8799C11.6509 6.5049 11.3949 6.92246 11.1121 7.29962L10.4655 6.88206C10.5733 7.12451 10.6676 7.39391 10.7753 7.67677H15.8534ZM6.08782 6.06039C5.79149 6.54531 5.46821 7.00328 5.118 7.42085L4 6.72042C4.78125 5.88529 5.33351 4.96934 5.67026 3.99951L6.89601 4.26891C6.81519 4.4979 6.72091 4.72688 6.64009 4.9424H10.0345V6.06039H8.01401C8.25647 6.39714 8.47198 6.72042 8.63362 7.03022L7.46175 7.47473C7.23276 6.98981 6.97683 6.51837 6.6805 6.06039H6.08782Z",fill:"white"})],-1)),tt=[et],F=He({name:"user",__name:"index",setup(k){const{t:l}=Ne(),x=Te(),O=g(),Z=Ie(),j=g([]),q=g("formSearch-user"),{pagination:b,getParams:at,onSizeChange:J,onCurrentChange:G,onSortChange:Q}=xe(),X=[{label:R(()=>l("common.enable")),value:!0},{label:R(()=>l("common.disable")),value:!1}],K={children:"children",label:"name"},W=g(),D=g(),d=g({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),L=g(),Y=g(),e=g({loading:!1,tableAutoHeight:!1,border:!0,stripe:!0,lineHeight:"default",checkList:[],search:{page:1,limit:10,id:"",userName:"",active:!0,departmentId:null},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}}),ee=g();async function f(){const t={...e.value.search},n=await E.list(t);n.data&&n.status===1&&(e.value.dataList=n.data.data,b.value.total=+n.data.total)}const te={activeList:()=>X};Ve(async()=>{try{d.value.loading=!0,j.value=await Z.getCountry(),O.value=await(x==null?void 0:x.getPositionManage())||[],f(),I.forEach(t=>{t.checked&&e.value.checkList.push(t.prop)}),d.value.loading=!1}catch{}finally{d.value.loading=!1}}),we(()=>d.value.search,t=>{W.value.filter(t)});function ae(t){return new Promise(n=>{A.confirm(`${l("configuration.user.confirmDisable")} ${t.active?l("common.disable"):l("common.enable")}「${t.userName}」${l("configuration.user.question")}`,l("configuration.user.confirmationInformation")).then(()=>{try{d.value.loading=!0,E.edit({id:t.id,email:t.email,phoneNumber:t.phoneNumber,userName:t.userName,country:t.country,role:t.role,positionId:t.positionId,organizationalStructureId:t.organizationalStructureId,active:!t.active}).then(()=>(N.success({message:`${t.active?l("common.disable"):l("common.enable")}${l("common.success")}`,center:!0}),f(),d.value.loading=!1,n(!0))).catch(()=>(d.value.loading=!1,n(!1)))}catch{}finally{d.value.loading=!1}}).catch(()=>n(!1))})}function ne(t){var n;b.value.page=1,(n=t==null?void 0:t.children)!=null&&n.length?(e.value.search.id="",e.value.search.departmentId=t.id,f()):(e.value.search.id=t.id,e.value.search.departmentId="",f())}function le(t){J(t).then(()=>{e.value.search.limit=t,f()})}function B(t=1){G(t).then(()=>{e.value.search.page=t,f()})}function oe({prop:t,order:n}){Q(t,n).then(()=>f())}function ie(t){e.value.dialog.id="",e.value.dialog.visible=!0,e.value.dialog.level=1,t&&(e.value.dialog.parentId=t.id,e.value.dialog.level=Number(t.level)+1)}const se=t=>{L.value=t};function re(){if(L.value.length>1){N.warning({message:"重置密码仅支持单个选择",center:!0});return}if(L.value){const{userName:t,id:n}=L.value[0];A.confirm(`${l("configuration.user.confirm")}${t}${l("configuration.user.reset")}`,l("configuration.user.confirmationInformation")).then(()=>{E.reset({id:n}).then(()=>{N.success({message:l("configuration.user.resetSuccess"),center:!0}),f()})}).catch(()=>{})}else N.warning({message:l("configuration.user.userSelect"),center:!0})}function ue(t){e.value.row=JSON.stringify(t),e.value.dialog.id=t.id,e.value.dialog.parentId=t.parentId,e.value.dialog.visible=!0}function ce(t){D.value.showEdit(t)}function de(){Object.assign(e.value.search,{id:"",userName:"",departmentId:null,active:!0}),f()}const V=g();function me(t){t?V.value=t.id:V.value=""}return(t,n)=>{const M=u("el-tree"),pe=Ae,fe=u("ElDivider"),w=u("el-button"),P=u("el-col"),ge=Be,ve=u("el-row"),h=u("ElTableColumn"),he=u("ElSwitch"),_e=u("el-tooltip"),be=Ue,y=u("el-text"),$=u("ElButton"),ye=u("el-empty"),Ce=u("ElTable"),ke=u("ElPagination"),Le=Me,S=U("auth"),Se=U("loading");return r(),H("div",qe,[_("div",Je,[_("div",Ge,[d.value.tree.length?(r(),H("div",Qe,[i(M,{style:{"max-width":"37.5rem","min-height":"45.4375rem",padding:"10px"},data:d.value.tree,ref_key:"treeRef",ref:ee,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,props:K,onNodeClick:ne},null,8,["data"])])):v("",!0),i(Le,null,{default:o(()=>[i(pe,{formSearchList:s(Ze),onCurrentChange:B,onOnReset:de,model:e.value.search,formOption:te,formSearchName:q.value},null,8,["formSearchList","model","formSearchName"]),i(fe,{"border-style":"dashed"}),C((r(),H("div",null,[i(ve,{style:{"margin-bottom":"0.3125rem"},gutter:24},{default:o(()=>[i(P,{style:{"margin-bottom":"1.5625rem"},span:10},{default:o(()=>[C((r(),c(w,{type:"primary",size:"default",onClick:ie},{default:o(()=>[m(p(s(l)("common.new")),1)]),_:1})),[[S,"user-insert-insertStaff"]]),C((r(),c(w,{type:"primary",size:"default",onClick:re},{default:o(()=>[m(p(s(l)("common.resetPassword")),1)]),_:1})),[[S,"user-get-resetPasswordStaff"]])]),_:1}),i(P,{style:{display:"flex","justify-content":"flex-end"},span:14},{default:o(()=>[i(w,{size:"default",onClick:n[0]||(n[0]=()=>{})},{default:o(()=>[m(p(s(l)("common.export")),1)]),_:1}),i(ge,{border:e.value.border,"onUpdate:border":n[1]||(n[1]=a=>e.value.border=a),tableAutoHeight:e.value.tableAutoHeight,"onUpdate:tableAutoHeight":n[2]||(n[2]=a=>e.value.tableAutoHeight=a),checkList:e.value.checkList,"onUpdate:checkList":n[3]||(n[3]=a=>e.value.checkList=a),columns:s(I),"onUpdate:columns":n[4]||(n[4]=a=>ze(I)?I.value=a:null),"line-height":e.value.lineHeight,"onUpdate:lineHeight":n[5]||(n[5]=a=>e.value.lineHeight=a),stripe:e.value.stripe,"onUpdate:stripe":n[6]||(n[6]=a=>e.value.stripe=a),style:{"margin-left":"0.75rem"},onQueryData:f},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),i(Ce,{ref_key:"userItemRef",ref:Y,data:e.value.dataList,border:e.value.border,size:e.value.lineHeight,stripe:e.value.stripe,"highlight-current-row":"",height:"100%",onSortChange:oe,onCurrentChange:me,onSelectionChange:n[7]||(n[7]=a=>e.value.selectionDataList=a),"row-key":"id","default-expand-all":"",onSelect:se},{empty:o(()=>[i(ye,{image:s(Ee),"image-size":300},null,8,["image"])]),default:o(()=>[i(h,{type:"selection",align:"left",fixed:""}),e.value.checkList.includes("active")?(r(),c(h,{key:0,align:"left",prop:"active",label:s(l)("configuration.user.status"),width:"84"},{default:o(a=>[i(he,{modelValue:a.row.active,"onUpdate:modelValue":z=>a.row.active=z,"inline-prompt":"","active-text":s(l)("common.enable"),"inactive-text":s(l)("common.disable"),"before-change":()=>ae(a.row)},null,8,["modelValue","onUpdate:modelValue","active-text","inactive-text","before-change"])]),_:1},8,["label"])):v("",!0),e.value.checkList.includes("id")?(r(),c(h,{key:1,align:"left",width:"280",prop:"id",label:s(l)("configuration.user.id")},{default:o(({row:a})=>[_("div",Xe,[_("div",Ke,[i(_e,{effect:"dark",content:a.id,placement:"top-start"},{default:o(()=>[m(p(a.id),1)]),_:2},1032,["content"])]),i(be,{content:a.id,class:De([{rowCopy:"rowCopy",current:a.id===V.value},"littleButton"])},null,8,["content","class"])])]),_:1},8,["label"])):v("",!0),e.value.checkList.includes("userName")?(r(),c(h,{key:2,align:"left",prop:"userName",label:s(l)("configuration.user.username")},{default:o(({row:a})=>[i(y,{class:"tableBig"},{default:o(()=>[m(p(a.userName?a.userName:"-"),1)]),_:2},1024)]),_:1},8,["label"])):v("",!0),e.value.checkList.includes("phoneNumber")?(r(),c(h,{key:3,align:"left",width:"170",prop:"phone",label:s(l)("configuration.user.phonenumber")},{default:o(({row:a})=>[i(y,{class:"fontC-System"},{default:o(()=>[m(p(a.phoneNumber?a.phoneNumber:"-"),1)]),_:2},1024)]),_:1},8,["label"])):v("",!0),e.value.checkList.includes("email")?(r(),c(h,{key:4,align:"left",width:"180",prop:"email",label:s(l)("configuration.user.email")},{default:o(({row:a})=>[i(y,{class:"fontC-System"},{default:o(()=>[m(p(a.email?a.email:"-"),1)]),_:2},1024)]),_:1},8,["label"])):v("",!0),e.value.checkList.includes("departmentId")?(r(),c(h,{key:5,align:"left",prop:"departmentId",label:s(l)("configuration.user.department")},{default:o(({row:a})=>[_("div",We,[a.enableChargePerson===1?(r(),H("svg",Ye,tt)):v("",!0),i(y,{class:"fontC-System"},{default:o(()=>[m(p(a.organizationalStructureName?a.organizationalStructureName:"-"),1)]),_:2},1024)])]),_:1},8,["label"])):v("",!0),e.value.checkList.includes("role")?(r(),c(h,{key:6,align:"left",prop:"role",label:s(l)("configuration.user.role")},{default:o(({row:a})=>[i(y,{class:"fontC-System"},{default:o(()=>[m(p(a.role?a.role:"-"),1)]),_:2},1024)]),_:1},8,["label"])):v("",!0),e.value.checkList.includes("positionId")?(r(),c(h,{key:7,align:"left",prop:"positionId",label:s(l)("configuration.user.position")},{default:o(({row:a})=>[i(y,null,{default:o(()=>[m(p(a.positionName?a.positionName:"-"),1)]),_:2},1024)]),_:1},8,["label"])):v("",!0),i(h,{label:s(l)("common.control"),fixed:"right",width:"200",align:"left"},{default:o(a=>[C((r(),c($,{type:"primary",size:"small",plain:"",onClick:z=>ue(a.row)},{default:o(()=>[m(p(s(l)("common.edit")),1)]),_:2},1032,["onClick"])),[[S,"user-update-updateStaff"]]),C((r(),c($,{type:"warning",size:"small",plain:"",onClick:z=>ce(a.row)},{default:o(()=>[m(p(s(l)("common.detail")),1)]),_:2},1032,["onClick"])),[[S,"user-get-getStaffList"]])]),_:1},8,["label"])]),_:1},8,["data","border","size","stripe"]),i(ke,{"current-page":s(b).page,total:s(b).total,"page-size":s(b).size,"page-sizes":s(b).sizes,layout:s(b).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:le,onCurrentChange:B},null,8,["current-page","total","page-size","page-sizes","layout"])])),[[Se,d.value.loading]])]),_:1})]),e.value.dialog.visible?(r(),c(Fe,{key:0,id:e.value.dialog.id,modelValue:e.value.dialog.visible,"onUpdate:modelValue":n[8]||(n[8]=a=>e.value.dialog.visible=a),"catalogue-id":e.value.search.catalogueId,"parent-id":e.value.dialog.parentId,level:e.value.dialog.level,tree:d.value.tree,dataList:e.value.dataList,row:e.value.row,onSuccess:f},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):v("",!0),i(Oe,{ref_key:"detailRef",ref:D},null,512)])])}}});typeof T=="function"&&T(F);const bt=Re(F,[["__scopeId","data-v-f3035587"]]);export{bt as default};
