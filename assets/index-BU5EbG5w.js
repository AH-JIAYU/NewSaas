
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ze,ae as Qe,aN as Pe,r as i,E as m,M as Re,o as De,a2 as p,al as Z,a as c,c as u,w as n,f as a,h as e,b as _,a3 as x,g,t as f,k as S,aM as Ue,j as h,A as w,i as ee,O as Me,N as $e,ai as te,aS as je,aP as Te,aQ as Be,_ as Fe,aR as He,ao as Oe,y as qe}from"./index-CxSXUQRU.js";import{_ as Ge}from"./index-BNC4RpCQ.js";import{_ as Je}from"./index.vue_vue_type_style_index_0_lang-D__ohy0s.js";import{_ as Ke}from"./index-DA4NZtDa.js";import We from"./index-DHsEqk9o.js";import Xe from"./index-CA9F5YrD.js";import Ye from"./index-CRn0MDiF.js";import Ze from"./index-DIE7oicG.js";import{s as oe}from"./apiLoading-ArDFFVvl.js";import{u as et}from"./user_customer-BDqUqZqM.js";import{a as O}from"./user_customer-DEqjJrPk.js";import tt from"./index-B3s4Cpkp.js";import"./index-CrNZ6CW0.js";import"./clipboard-DquYvbb_.js";import"./index.vue_vue_type_script_setup_true_lang-5fUkfTjC.js";import"./sortable.esm-C0-Qcoum.js";import"./index.vue_vue_type_script_setup_true_lang-BgKoGmKp.js";import"./index-Bk2Ekfbx.js";import"./index-BhYlFqc6.js";import"./department-BjjuPcDv.js";import"./position_manage-C2ltHd3e.js";import"./configuration_role-DeiAQ-mf.js";import"./tenant_role-BI7fL2Re.js";import"./configuration_manager-DUYjHYv1.js";import"./configuration_siteSetting-VpOknSW-.js";import"./configuration_site_setting-DQocyua6.js";import"./stagedData-BDZzd_-f.js";import"./index.vue_vue_type_script_setup_true_lang-Cs0mTZ3Y.js";import"./customerDetail-CmH7dMh8.js";import"./member-CB3zcQYN.js";import"./user_cooperation-uV4NSf9I.js";import"./index-mntO0aA0.js";import"./index-DGmSQ9kt.js";import"./index-uY72vzwI.js";import"./index-B2vugyWQ.js";import"./index-UltLypk8.js";import"./index-CA5aL5U8.js";const ot={class:"flex-c tableBig"},nt={class:"oneLine"},at={class:"flex-c tableBig"},lt={class:"oneLine",style:{width:"calc(100% - 20px)"}},st={class:"copyId tableSmall"},rt={class:"oneLine projectId"},ct={class:"flex-c"},ut={class:"oneLine",style:{width:"calc(100% - 20px)"}},it={style:{display:"inline-block"},class:"fontC-System"},mt={key:0,class:"fontC-System"},dt={class:"fontC-System"},pt=ze({name:"customer",__name:"index",setup(ft){const ne=et(),{t:o}=Qe(),{pagination:C,getParams:ae,onSizeChange:le,onCurrentChange:se}=Pe(),re=i([]),N=i(!1),q=i([]),Q=i(),G=i(),J=i(),ce=i(),y=i(),ue=i(),I=i(!1),E=i(!1),A=i(!1),V=i("default"),d=i([]),K=i(),ie=i("formSearch-customer"),L=i([{label:m(()=>o("customer.customerCode")),checked:!0,sortable:!0,prop:"tenantCustomerId"},{label:m(()=>o("customer.customerName")),checked:!0,sortable:!0,prop:"customerAccord"},{label:m(()=>o("customer.customerShortName")),checked:!0,sortable:!0,prop:"customerShortName"},{label:"PM",checked:!0,sortable:!0,prop:"chargeId"},{label:m(()=>o("customer.noAssociatedProject")),checked:!0,sortable:!0,prop:"projectNumber"},{label:m(()=>o("customer.customerStatus")),checked:!0,sortable:!0,prop:"customerStatus"},{label:m(()=>o("customer.antecedentQuestionnaire")),checked:!0,sortable:!0,prop:"antecedentQuestionnaire"},{label:m(()=>o("customer.riskControl")),checked:!0,sortable:!0,prop:"riskControl"},{label:m(()=>o("customer.limit")),checked:!0,sortable:!0,prop:"turnover"},{label:m(()=>o("customer.rateMin")),checked:!0,sortable:!0,prop:"rateAudit"}]);function me(){Q.value.showEdit()}function de(l){Q.value.showEdit(l)}async function P(l,s,$){const j={status:l,operationalType:s,tenantCustomerId:$},{status:k}=await oe(O.changestatus(j));k===1&&te.success({message:o("customer.editSucess")}),ne.customer=null,b()}function pe(l){G.value.showEdit(l)}function fe(l){l?y.value=l.tenantCustomerId:y.value=""}function R(l,s){J.value.showEdit(l,s)}function _e(l){je.confirm(o("customer.delConfirm"),o("customer.delMessage")).then(async()=>{const{status:s}=await oe(O.delete({tenantCustomerId:l.tenantCustomerId}));s===1&&te.success({message:o("customer.delSuccess")}),b()}).catch(()=>{})}const D=Re({customerShortName:"",customerStatus:2,antecedentQuestionnaire:null});function he(l){le(l).then(()=>U())}function W(l=1){se(l).then(()=>U())}function be(){Object.assign(D,{customerShortName:"",customerStatus:2,antecedentQuestionnaire:null}),b()}function b(){C.value.page=1,U()}async function U(){try{N.value=!0;const l={...ae(),...D},{data:s}=await O.list(l);q.value=s.getTenantCustomerInfoList,console.log("客户列表",s),C.value.total=Number(s.total),N.value=!1}catch{}finally{N.value=!1}}function ve(l){ue.value=l}De(async()=>{L.value.forEach(l=>{l.checked&&d.value.push(l.prop)}),b(),K.value=[{index:1,show:!0,type:"input",modelName:"customerShortName",placeholder:m(()=>o("customer.customerShortName"))},{index:2,show:!0,type:"select",modelName:"customerStatus",placeholder:m(()=>o("customer.customerStatus")),option:"customerStatus",optionLabel:"label",optionValue:"value"},{index:3,show:!0,type:"select",modelName:"antecedentQuestionnaire",placeholder:m(()=>o("customer.antecedentQuestionnaire")),option:"antecedentQuestionnaire",optionLabel:"label",optionValue:"value"}]});const ge={customerStatus:()=>[{label:m(()=>o("customer.forbidden")),value:1},{label:m(()=>o("customer.enable")),value:2}],antecedentQuestionnaire:()=>[{label:m(()=>o("customer.forbidden")),value:1},{label:m(()=>o("customer.enable")),value:2}]},M=i("first");return(l,s)=>{const $=Ke,j=p("ElDivider"),k=p("el-button"),Ce=Je,ye=Te,ke=Be,Se=p("el-row"),T=p("ElSwitch"),B=p("ElTableColumn"),X=Ge,F=Fe,v=p("el-table-column"),H=p("el-text"),we=He,xe=p("ElSpace"),Ne=p("el-empty"),Ie=p("el-table"),Ee=p("ElPagination"),Y=p("el-tab-pane"),Ae=p("el-tabs"),Ve=Oe,z=Z("auth"),Le=Z("loading");return c(),u(Ve,null,{default:n(()=>[a(Ae,{modelValue:e(M),"onUpdate:modelValue":s[6]||(s[6]=t=>S(M)?M.value=t:null),class:"demo-tabs"},{default:n(()=>[a(Y,{label:e(o)("customer.myCustomer"),name:"first"},{default:n(()=>[_("div",{class:w({"absolute-container":e(A)})},[a($,{formSearchList:e(K),formSearchName:e(ie),onCurrentChange:W,onOnReset:be,model:e(D),formOption:ge},null,8,["formSearchList","formSearchName","model"]),a(j,{"border-style":"dashed"}),a(Se,null,{default:n(()=>[a(Ce,null,{default:n(()=>[x((c(),u(k,{type:"primary",size:"default",onClick:me},{default:n(()=>[g(f(e(o)("common.new")),1)]),_:1})),[[z,"customer-get-addTenantCustomer"]])]),_:1}),a(ke,null,{default:n(()=>[a(k,{size:"default"},{default:n(()=>[g(f(e(o)("common.export")),1)]),_:1}),a(ye,{border:e(I),"onUpdate:border":s[0]||(s[0]=t=>S(I)?I.value=t:null),tableAutoHeight:e(A),"onUpdate:tableAutoHeight":s[1]||(s[1]=t=>S(A)?A.value=t:null),checkList:e(d),"onUpdate:checkList":s[2]||(s[2]=t=>S(d)?d.value=t:null),columns:e(L),"onUpdate:columns":s[3]||(s[3]=t=>S(L)?L.value=t:null),"line-height":e(V),"onUpdate:lineHeight":s[4]||(s[4]=t=>S(V)?V.value=t:null),stripe:e(E),"onUpdate:stripe":s[5]||(s[5]=t=>S(E)?E.value=t:null),style:{"margin-left":"12px"},onQueryData:b},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),x((c(),u(Ie,{border:e(I),data:e(q),size:e(V),stripe:e(E),onSelectionChange:ve,"highlight-current-row":"",onCurrentChange:fe},{empty:n(()=>[a(Ne,{image:e(Ue),"image-size":300},null,8,["image"])]),default:n(()=>[e(d).includes("customerStatus")?(c(),u(B,{key:0,align:"left","show-overflow-tooltip":"",prop:"customerStatus",label:e(o)("customer.customerStatus"),width:"84"},{default:n(({row:t})=>[a(T,{modelValue:t.customerStatus,"onUpdate:modelValue":r=>t.customerStatus=r,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":e(o)("customer.enable"),"inactive-text":e(o)("customer.forbidden"),onChange:r=>P(r,1,t.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","active-text","inactive-text","onChange"])]),_:1},8,["label"])):h("",!0),e(d).includes("customerAccord")?(c(),u(v,{key:1,align:"left",prop:"customerAccord","show-overflow-tooltip":"",label:e(o)("customer.customerName"),width:"180"},{default:n(({row:t})=>[_("div",ot,[_("div",nt,f(t.customerAccord),1),a(X,{content:t.customerAccord,class:w([{rowCopy:"rowCopy",current:t.tenantCustomerId===e(y)},"copyButton"])},null,8,["content","class"]),a(F,{onClick:r=>R(t,"customerAccord"),class:w([{edit:"edit",current:t.tenantCustomerId===e(y)},"editButton"]),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1},8,["label"])):h("",!0),e(d).includes("customerShortName")?(c(),u(v,{key:2,align:"left",prop:"customerShortName","show-overflow-tooltip":"",label:e(o)("customer.customerShortName"),width:"150"},{default:n(({row:t})=>[_("div",at,[_("div",lt,f(t.customerShortName),1),a(F,{onClick:r=>R(t,"customerShortName"),class:w({edit:"edit",current:t.tenantCustomerId===e(y)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1},8,["label"])):h("",!0),e(d).includes("tenantCustomerId")?(c(),u(v,{key:3,align:"left",prop:"tenantCustomerId","show-overflow-tooltip":"",label:e(o)("customer.customerCode"),width:"150"},{default:n(({row:t})=>[_("div",st,[_("div",rt,f(t.tenantCustomerId),1),a(X,{content:t.tenantCustomerId,class:w([{rowCopy:"rowCopy",current:t.tenantCustomerId===e(y)},"littleButton"])},null,8,["content","class"])])]),_:1},8,["label"])):h("",!0),e(d).includes("chargeId")?(c(),u(v,{key:4,align:"left",prop:"chargeId","show-overflow-tooltip":"",label:"PM"},{default:n(({row:t})=>[_("div",ct,[_("div",ut,[(c(!0),ee($e,null,Me(e(re),r=>(c(),u(H,{key:r.id},{default:n(()=>[r.id===t.chargeId?(c(),u(H,{key:0,class:"fontC-System"},{default:n(()=>[g(f(r.userName),1)]),_:2},1024)):h("",!0)]),_:2},1024))),128))]),a(F,{onClick:r=>R(t,"chargeId"),class:w({edit:"edit",current:t.tenantCustomerId===e(y)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):h("",!0),e(d).includes("projectNumber")?(c(),u(v,{key:5,align:"left",prop:"turnover","show-overflow-tooltip":"",label:e(o)("customer.noAssociatedProject")},{default:n(({row:t})=>[_("span",it,f(t.projectNumber||0),1)]),_:1},8,["label"])):h("",!0),e(d).includes("antecedentQuestionnaire")?(c(),u(B,{key:6,align:"left","show-overflow-tooltip":"",prop:"antecedentQuestionnaire",label:e(o)("customer.antecedentQuestionnaire")},{default:n(({row:t})=>[a(T,{modelValue:t.antecedentQuestionnaire,"onUpdate:modelValue":r=>t.antecedentQuestionnaire=r,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":e(o)("customer.enable"),"inactive-text":e(o)("customer.forbidden"),onChange:r=>P(r,2,t.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","active-text","inactive-text","onChange"])]),_:1},8,["label"])):h("",!0),e(d).includes("riskControl")?(c(),u(B,{key:7,align:"left","show-overflow-tooltip":"",prop:"riskControl",label:e(o)("customer.riskControl")},{default:n(({row:t})=>[a(T,{modelValue:t.riskControl,"onUpdate:modelValue":r=>t.riskControl=r,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":e(o)("customer.enable"),"inactive-text":e(o)("customer.forbidden"),onChange:r=>P(r,3,t.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","active-text","inactive-text","onChange"])]),_:1},8,["label"])):h("",!0),e(d).includes("turnover")?(c(),u(v,{key:8,align:"left",prop:"turnover","show-overflow-tooltip":"",label:e(o)("customer.limit")},{default:n(({row:t})=>[t.turnover>0?(c(),ee("div",mt,[a(we),g(f(t.turnover),1)])):(c(),u(H,{key:1,class:"fontC-System"},{default:n(()=>[g("-")]),_:1}))]),_:1},8,["label"])):h("",!0),e(d).includes("rateAudit")?(c(),u(v,{key:9,align:"left",prop:"rateAudit","show-overflow-tooltip":"",label:e(o)("customer.rateMin")},{default:n(({row:t})=>[_("div",dt,f(t.rateAudit?t.rateAudit:"-"),1)]),_:1},8,["label"])):h("",!0),a(v,{align:"left",fixed:"right",prop:"i",label:e(o)("customer.control"),width:"200"},{default:n(({row:t})=>[a(xe,null,{default:n(()=>[x((c(),u(k,{size:"small",plain:"",type:"primary",onClick:r=>de(t)},{default:n(()=>[g(f(e(o)("common.edit")),1)]),_:2},1032,["onClick"])),[[z,"customer-update-updateTenantCustomer"]]),x((c(),u(k,{type:"warning",plain:"",size:"small",onClick:r=>pe(t)},{default:n(()=>[g(f(e(o)("common.detail")),1)]),_:2},1032,["onClick"])),[[z,"customer-get-getTenantCustomerInfo"]]),x((c(),u(k,{type:"danger",plain:"",size:"small",onClick:r=>_e(t)},{default:n(()=>[g(f(e(o)("common.delete")),1)]),_:2},1032,["onClick"])),[[z,"customer-delete-deleteTenantCustomer"]])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["border","data","size","stripe"])),[[Le,e(N)]]),a(Ee,{"current-page":e(C).page,total:e(C).total,"page-size":e(C).size,"page-sizes":e(C).sizes,layout:e(C).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:he,onCurrentChange:W},null,8,["current-page","total","page-size","page-sizes","layout"]),a(We,{ref_key:"editRef",ref:Q,onFetchData:b},null,512),a(Xe,{ref_key:"QuickEditRef",ref:J,onFetchData:b},null,512),a(Ye,{ref_key:"AssociatedProjectsRef",ref:ce,onFetchData:b},null,512),a(Ze,{ref_key:"checkRef",ref:G,onFetchData:b},null,512)],2)]),_:1},8,["label"]),a(Y,{label:e(o)("customer.cooperativeMerchant"),name:"second"},{default:n(()=>[a(tt)]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1})}}}),Yt=qe(pt,[["__scopeId","data-v-ab0109df"]]);export{Yt as default};
