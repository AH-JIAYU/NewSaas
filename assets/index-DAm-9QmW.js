
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Le,r as p,l as Se,aN as He,n as Ne,W as Ie,a as s,q as U,o,b as L,y as v,f as i,j as m,w as n,i as g,s as b,e as r,g as c,A as xe,aM as Ve,z as _,N as we,p as z,aO as $,E,ba as ze,an as Ee,aH as De,aI as Be,L as Me,am as A}from"./index-imHNa2Ye.js";import{_ as Re}from"./index-DzgH5X_X.js";import{_ as Pe}from"./index-HNdaR80e.js";import{u as Ue}from"./position_manage-C5uUGpiJ.js";import $e from"./index-B53KPHgg.js";import Ae from"./index-BDounecA.js";import{columns as S,formSearchList as Te}from"./index-BFibzBXr.js";import"./index-BrANls0l.js";import"./clipboard-CGsAy0yZ.js";import"./index.vue_vue_type_script_setup_true_lang-D-rbH95I.js";import"./sortable.esm-C0-Qcoum.js";import"./position_manage-8pdqNpAY.js";import"./department-BvK_brAI.js";import"./configuration_role-BkZZHsYx.js";import"./tenant_role-EV2lg5vo.js";import"./configuration_manager-XRqLfEzd.js";const Fe=C=>(De("data-v-690b5307"),C=C(),Be(),C),Oe={class:"absolute-container"},Ze={class:"page-main"},je={class:"leftTree"},qe={key:0,class:"leftData",span:3},Ge={class:"copyId tableSmall"},Je={class:"id oneLine idFont"},Qe={style:{display:"flex","align-items":"center"}},We={key:0,xmlns:"http://www.w3.org/2000/svg",style:{"margin-top":"2px","margin-right":"7px"},width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},Ke=Fe(()=>v("g",{id:"Group 18384"},[v("circle",{id:"Ellipse 105",cx:"10",cy:"10",r:"10",fill:"#F8BB4F"}),v("path",{id:"ç®¡",d:"M13.9946 9.3605V12.1892H7.43481V12.9031H14.6277V16.4995H13.3481V16.0146H7.43481V16.486H6.15517V9.3605H13.9946ZM7.43481 14.8831H13.3481V13.9133H7.43481V14.8831ZM7.43481 11.1655H12.7419V10.3842H7.43481V11.1655ZM15.8534 7.67677V10.2495H14.6008V8.75436H5.52209V10.2495H4.2694V7.67677H9.48222C9.37446 7.40738 9.25323 7.16492 9.13201 6.9494L10.2635 6.76083L10.0345 6.61266C10.6541 5.80447 11.1121 4.9424 11.3815 4.01298L12.6072 4.28238C12.5264 4.51136 12.4591 4.72688 12.3782 4.9424H16.1228V6.06039H13.9273C14.1428 6.35673 14.3179 6.65307 14.4661 6.92246L13.3346 7.34003C13.1191 6.90899 12.8631 6.47796 12.5668 6.06039H11.8799C11.6509 6.5049 11.3949 6.92246 11.1121 7.29962L10.4655 6.88206C10.5733 7.12451 10.6676 7.39391 10.7753 7.67677H15.8534ZM6.08782 6.06039C5.79149 6.54531 5.46821 7.00328 5.118 7.42085L4 6.72042C4.78125 5.88529 5.33351 4.96934 5.67026 3.99951L6.89601 4.26891C6.81519 4.4979 6.72091 4.72688 6.64009 4.9424H10.0345V6.06039H8.01401C8.25647 6.39714 8.47198 6.72042 8.63362 7.03022L7.46175 7.47473C7.23276 6.98981 6.97683 6.51837 6.6805 6.06039H6.08782Z",fill:"white"})],-1)),Xe=[Ke],T=Le({name:"user",__name:"index",setup(C){const H=Ue(),F=p(),O=Se(),Z=p([]),j=p("formSearch-user"),{pagination:h,getParams:Ye,onSizeChange:q,onCurrentChange:G,onSortChange:J}=He(),Q=[{label:"启用",value:!0},{label:"禁用",value:!1}],W={children:"children",label:"name"},K=p(),D=p(),u=p({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),N=p(),I=p(),t=p({loading:!1,tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],search:{page:1,limit:10,id:"",userName:"",active:null,departmentId:null},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}}),X=p();async function d(){const e={...t.value.search},l=await z.list(e);l.data&&l.status===1&&(t.value.dataList=l.data.data,h.value.total=+l.data.total)}const Y={activeList:()=>Q};Ne(async()=>{try{u.value.loading=!0,Z.value=await O.getCountry(),F.value=await(H==null?void 0:H.getPositionManage())||[],d(),S.forEach(e=>{e.checked&&t.value.checkList.push(e.prop)}),u.value.loading=!1}catch{}finally{u.value.loading=!1}}),Ie(()=>u.value.search,e=>{K.value.filter(e)});function ee(e){return new Promise(l=>{$.confirm(`确认${e.active?"禁用":"启用"}「${e.userName}」吗？`,"确认信息").then(()=>{try{u.value.loading=!0,z.edit({id:e.id,email:e.email,phoneNumber:e.phoneNumber,userName:e.userName,country:e.country,role:e.role,positionId:e.positionId,organizationalStructureId:e.organizationalStructureId,active:!e.active}).then(()=>(E.success({message:`${e.active?"禁用":"启用"}成功`,center:!0}),d(),u.value.loading=!1,l(!0))).catch(()=>(u.value.loading=!1,l(!1)))}catch{}finally{u.value.loading=!1}}).catch(()=>l(!1))})}function te(e){var l;h.value.page=1,(l=e==null?void 0:e.children)!=null&&l.length?(t.value.search.id="",t.value.search.departmentId=e.id,d()):(t.value.search.id=e.id,t.value.search.departmentId="",d())}function ae(e){q(e).then(()=>{t.value.search.limit=e,d()})}function B(e=1){G(e).then(()=>{t.value.search.page=e,d()})}function le({prop:e,order:l}){J(e,l).then(()=>d())}function ne(e){t.value.dialog.id="",t.value.dialog.visible=!0,t.value.dialog.level=1,e&&(t.value.dialog.parentId=e.id,t.value.dialog.level=Number(e.level)+1)}const ie=e=>{e.length>1&&(I.value.clearSelection(),I.value.toggleRowSelection(e[e.length-1])),N.value=e[e.length-1]};function oe(){if(N.value){const{userName:e,id:l}=N.value;$.confirm(`确认将「${e}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{z.reset({id:l}).then(()=>{E.success({message:"重置成功",center:!0}),d()})}).catch(()=>{})}else E.warning({message:"请选择用户",center:!0})}function se(e){t.value.row=JSON.stringify(e),t.value.dialog.id=e.id,t.value.dialog.parentId=e.parentId,t.value.dialog.visible=!0}function re(e){D.value.showEdit(e)}function ue(){Object.assign(t.value.search,{id:"",userName:"",departmentId:null,active:null}),d()}const x=p();function ce(e){e?x.value=e.id:x.value=""}return(e,l)=>{const M=s("el-tree"),de=Pe,pe=s("ElDivider"),V=s("el-button"),R=s("el-col"),me=ze,fe=s("el-row"),f=s("ElTableColumn"),ge=s("ElSwitch"),ve=s("el-tooltip"),he=Re,y=s("el-text"),P=s("ElButton"),_e=s("el-empty"),ye=s("ElTable"),be=s("ElPagination"),Ce=Ee,k=U("auth"),ke=U("loading");return o(),L("div",Oe,[v("div",Ze,[v("div",je,[u.value.tree.length?(o(),L("div",qe,[i(M,{style:{"max-width":"37.5rem","min-height":"45.4375rem",padding:"10px"},data:u.value.tree,ref_key:"treeRef",ref:X,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,props:W,onNodeClick:te},null,8,["data"])])):m("",!0),i(Ce,null,{default:n(()=>[i(de,{formSearchList:g(Te),onCurrentChange:B,onOnReset:ue,model:t.value.search,formOption:Y,formSearchName:j.value},null,8,["formSearchList","model","formSearchName"]),i(pe,{"border-style":"dashed"}),b((o(),L("div",null,[i(fe,{style:{"margin-bottom":"0.3125rem"},gutter:24},{default:n(()=>[i(R,{style:{"margin-bottom":"1.5625rem"},span:10},{default:n(()=>[b((o(),r(V,{type:"primary",size:"default",onClick:ne},{default:n(()=>[c(" 新增 ")]),_:1})),[[k,"user-insert-insertStaff"]]),b((o(),r(V,{type:"primary",size:"default",onClick:oe},{default:n(()=>[c(" 重置密码 ")]),_:1})),[[k,"user-get-resetPasswordStaff"]])]),_:1}),i(R,{style:{display:"flex","justify-content":"flex-end"},span:14},{default:n(()=>[i(V,{size:"default",onClick:l[0]||(l[0]=()=>{})},{default:n(()=>[c(" 导出 ")]),_:1}),i(me,{border:t.value.border,"onUpdate:border":l[1]||(l[1]=a=>t.value.border=a),tableAutoHeight:t.value.tableAutoHeight,"onUpdate:tableAutoHeight":l[2]||(l[2]=a=>t.value.tableAutoHeight=a),checkList:t.value.checkList,"onUpdate:checkList":l[3]||(l[3]=a=>t.value.checkList=a),columns:g(S),"onUpdate:columns":l[4]||(l[4]=a=>xe(S)?S.value=a:null),"line-height":t.value.lineHeight,"onUpdate:lineHeight":l[5]||(l[5]=a=>t.value.lineHeight=a),stripe:t.value.stripe,"onUpdate:stripe":l[6]||(l[6]=a=>t.value.stripe=a),style:{"margin-left":"0.75rem"},onQueryData:d},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),i(ye,{ref_key:"userItemRef",ref:I,data:t.value.dataList,border:t.value.border,size:t.value.lineHeight,stripe:t.value.stripe,"highlight-current-row":"",height:"100%",onSortChange:le,onCurrentChange:ce,onSelectionChange:l[7]||(l[7]=a=>t.value.selectionDataList=a),"row-key":"id","default-expand-all":"",onSelect:ie},{empty:n(()=>[i(_e,{image:g(Ve),"image-size":300},null,8,["image"])]),default:n(()=>[i(f,{type:"selection",align:"left",fixed:""}),t.value.checkList.includes("active")?(o(),r(f,{key:0,align:"left",prop:"active",label:"状态",width:"84"},{default:n(a=>[i(ge,{modelValue:a.row.active,"onUpdate:modelValue":w=>a.row.active=w,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>ee(a.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1})):m("",!0),t.value.checkList.includes("id")?(o(),r(f,{key:1,align:"left",width:"280",prop:"id",label:"员工ID"},{default:n(({row:a})=>[v("div",Ge,[v("div",Je,[i(ve,{effect:"dark",content:a.id,placement:"top-start"},{default:n(()=>[c(_(a.id),1)]),_:2},1032,["content"])]),i(he,{content:a.id,class:we({rowCopy:"rowCopy",current:a.id===x.value})},null,8,["content","class"])])]),_:1})):m("",!0),t.value.checkList.includes("userName")?(o(),r(f,{key:2,align:"left",prop:"userName",label:"用户名"},{default:n(({row:a})=>[i(y,{class:"tableBig"},{default:n(()=>[c(_(a.userName?a.userName:"-"),1)]),_:2},1024)]),_:1})):m("",!0),t.value.checkList.includes("phoneNumber")?(o(),r(f,{key:3,align:"left",width:"170",prop:"phone",label:"电话号码"},{default:n(({row:a})=>[i(y,{class:"fontC-System"},{default:n(()=>[c(_(a.phoneNumber?a.phoneNumber:"-"),1)]),_:2},1024)]),_:1})):m("",!0),t.value.checkList.includes("email")?(o(),r(f,{key:4,align:"left",width:"180",prop:"email",label:"邮箱"},{default:n(({row:a})=>[i(y,{class:"fontC-System"},{default:n(()=>[c(_(a.email?a.email:"-"),1)]),_:2},1024)]),_:1})):m("",!0),t.value.checkList.includes("departmentId")?(o(),r(f,{key:5,align:"left",prop:"departmentId",label:"部门"},{default:n(({row:a})=>[v("div",Qe,[a.enableChargePerson===1?(o(),L("svg",We,Xe)):m("",!0),i(y,{class:"fontC-System"},{default:n(()=>[c(_(a.organizationalStructureName?a.organizationalStructureName:"-"),1)]),_:2},1024)])]),_:1})):m("",!0),t.value.checkList.includes("role")?(o(),r(f,{key:6,align:"left",prop:"role",label:"角色"},{default:n(({row:a})=>[i(y,{class:"fontC-System"},{default:n(()=>[c(_(a.role?a.role:"-"),1)]),_:2},1024)]),_:1})):m("",!0),t.value.checkList.includes("positionId")?(o(),r(f,{key:7,align:"left",prop:"positionId",label:"职位"},{default:n(({row:a})=>[i(y,null,{default:n(()=>[c(_(a.positionName?a.positionName:"-"),1)]),_:2},1024)]),_:1})):m("",!0),i(f,{label:"操作",fixed:"right",width:"200",align:"left"},{default:n(a=>[b((o(),r(P,{type:"primary",size:"small",plain:"",onClick:w=>se(a.row)},{default:n(()=>[c(" 编辑 ")]),_:2},1032,["onClick"])),[[k,"user-update-updateStaff"]]),b((o(),r(P,{type:"warning",size:"small",plain:"",onClick:w=>re(a.row)},{default:n(()=>[c(" 详情 ")]),_:2},1032,["onClick"])),[[k,"user-get-getStaffList"]])]),_:1})]),_:1},8,["data","border","size","stripe"]),i(be,{"current-page":g(h).page,total:g(h).total,"page-size":g(h).size,"page-sizes":g(h).sizes,layout:g(h).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:ae,onCurrentChange:B},null,8,["current-page","total","page-size","page-sizes","layout"])])),[[ke,u.value.loading]])]),_:1})]),t.value.dialog.visible?(o(),r($e,{key:0,id:t.value.dialog.id,modelValue:t.value.dialog.visible,"onUpdate:modelValue":l[8]||(l[8]=a=>t.value.dialog.visible=a),"catalogue-id":t.value.search.catalogueId,"parent-id":t.value.dialog.parentId,level:t.value.dialog.level,tree:u.value.tree,dataList:t.value.dataList,row:t.value.row,onSuccess:d},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):m("",!0),i(Ae,{ref_key:"detailRef",ref:D},null,512)])])}}});typeof A=="function"&&A(T);const vt=Me(T,[["__scopeId","data-v-690b5307"]]);export{vt as default};
