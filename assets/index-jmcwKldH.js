
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ae,aO as ne,r as s,l as le,n as S,b as i,q as oe,o as p,e as se,g as o,w as n,h as d,j as t,I as m,s as ie,f,aN as re,t as D,H as L,k as w,S as ue,aP as ce,E as pe,aQ as de,aR as me,N as fe,ap as _e,R as ge}from"./index-ClxkxBuo.js";import{_ as be}from"./index.vue_vue_type_style_index_0_lang-xYOpFn_y.js";import{s as ve}from"./apiLoading-P2Ci3FQj.js";import{S as he}from"./sortable.esm-C0-Qcoum.js";import{u as ye,v as ke,a as T}from"./index-CpdcF_yj.js";const Ce={style:{"font-weight":"700"}},we={style:{"font-weight":"700"}},ze=ae({name:"vipLevel",__name:"index",setup(Ee){const P=ye(),{pagination:r,getParams:Q,onSizeChange:H,onCurrentChange:$}=ne(),_=s(!1),z=s(),x=s([]),u=s([]),g=s(!0),b=s(!1),v=s("default"),h=s(!1),R=s(),y=s([{label:"等级名称",prop:"levelName",sortable:!0,disableCheck:!1,checked:!0},{label:"加成比例%",prop:"additionRatio",sortable:!0,checked:!0},{label:"成员数量",prop:"memberQuantity",sortable:!0,checked:!0}]);function I(){z.value.showEdit()}function U(l){z.value.showEdit(l)}function V(l){ce.confirm("您确定要删除当前项吗?","确认信息").then(async()=>{const{status:a}=await ve(T.delete({memberLevelId:l.memberLevelId}));a===1&&pe.success({message:"删除成功",center:!0}),P.LevelNameList=null,E()}).catch(()=>{})}function E(){r.value.page=1,k()}function A(l){H(l).then(()=>k())}function B(l=1){$(l).then(()=>k())}async function k(){try{_.value=!0;const l={...Q()},{data:a}=await T.list(l);x.value=a.getMemberLevelInfoList,r.value.total=a.total,_.value=!1}catch{}finally{_.value=!1}}function N(){const l=R.value.$el.querySelector(".el-table__body-wrapper tbody");he.create(l,{handle:".sortable",animation:300,ghostClass:"ghost",onEnd:({newIndex:a,oldIndex:c})=>{a===void 0||c===void 0||S(()=>N())}})}return le(()=>{y.value.forEach(l=>{l.checked&&u.value.push(l.prop)}),k(),S(()=>{N()})}),(l,a)=>{const c=i("el-button"),M=be,q=de,F=me,j=i("el-row"),O=fe,G=i("ElTag"),J=i("ElTableColumn"),C=i("el-table-column"),K=i("el-link"),W=i("el-empty"),X=i("el-table"),Y=i("ElPagination"),Z=_e,ee=oe("loading");return p(),se("div",{class:ue({"absolute-container":t(h)})},[o(Z,null,{default:n(()=>[o(j,null,{default:n(()=>[o(M,null,{default:n(()=>[o(c,{size:"default",type:"primary",onClick:I},{default:n(()=>[d(" 新增 ")]),_:1})]),_:1}),o(F,null,{default:n(()=>[o(c,{size:"default"},{default:n(()=>[d(" 导出 ")]),_:1}),o(q,{border:t(g),"onUpdate:border":a[0]||(a[0]=e=>m(g)?g.value=e:null),tableAutoHeight:t(h),"onUpdate:tableAutoHeight":a[1]||(a[1]=e=>m(h)?h.value=e:null),checkList:t(u),"onUpdate:checkList":a[2]||(a[2]=e=>m(u)?u.value=e:null),columns:t(y),"onUpdate:columns":a[3]||(a[3]=e=>m(y)?y.value=e:null),"line-height":t(v),"onUpdate:lineHeight":a[4]||(a[4]=e=>m(v)?v.value=e:null),stripe:t(b),"onUpdate:stripe":a[5]||(a[5]=e=>m(b)?b.value=e:null),style:{"margin-left":"12px"},onQueryData:E},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),ie((p(),f(X,{ref_key:"elTableRef",ref:R,"row-key":"id",border:t(g),data:t(x),size:t(v),stripe:t(b),fit:""},{empty:n(()=>[o(W,{image:t(re),"image-size":300},null,8,["image"])]),default:n(()=>[o(J,{width:"80",align:"center",fixed:""},{header:n(()=>[d(" 排序 ")]),default:n(()=>[o(G,{type:"info",class:"sortable"},{default:n(()=>[o(O,{name:"i-ep:d-caret"})]),_:1})]),_:1}),t(u).includes("levelName")?(p(),f(C,{key:0,align:"center",prop:"levelName","show-overflow-tooltip":"",label:"等级名称"},{default:n(({row:e})=>[D("p",Ce,L(e.levelName),1)]),_:1})):w("",!0),t(u).includes("additionRatio")?(p(),f(C,{key:1,align:"center",prop:"additionRatio","show-overflow-tooltip":"",label:"加成比例(百分比)"},{default:n(({row:e})=>[D("p",we,L(e.additionRatio)+"%",1)]),_:1})):w("",!0),t(u).includes("memberQuantity")?(p(),f(C,{key:2,align:"center",prop:"memberQuantity","show-overflow-tooltip":"",label:"成员数量"},{default:n(({row:e})=>[o(K,{type:"primary"},{default:n(()=>[d(L(e.memberQuantity?e.memberQuantity:0),1)]),_:2},1024)]),_:1})):w("",!0),o(C,{align:"center",fixed:"right","show-overflow-tooltip":"",label:"操作"},{default:n(({row:e})=>[o(c,{size:"small",plain:"",type:"primary",onClick:te=>U(e)},{default:n(()=>[d(" 编辑 ")]),_:2},1032,["onClick"]),e.isDelete===1?(p(),f(c,{key:0,size:"small",plain:"",type:"danger",onClick:te=>V(e)},{default:n(()=>[d(" 删除 ")]),_:2},1032,["onClick"])):w("",!0)]),_:1})]),_:1},8,["border","data","size","stripe"])),[[ee,t(_)]]),o(Y,{"current-page":t(r).page,total:t(r).total,"page-size":t(r).size,"page-sizes":t(r).sizes,layout:t(r).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:A,onCurrentChange:B},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),o(ke,{ref_key:"EditRef",ref:z,onQueryData:E},null,512)],2)}}}),De=ge(ze,[["__scopeId","data-v-22b7b12e"]]);export{De as default};
