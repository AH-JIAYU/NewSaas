
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Ue,aO as Re,r as c,a5 as Be,l as De,b as i,q as Qe,o as r,e as ee,g as t,w as o,j as n,s as R,az as Fe,h as _,H as b,I as S,f as d,aN as Pe,k as m,t as p,S as B,F as je,v as Te,E as te,aP as He,p as Me,N as qe,aQ as Ke,aR as Oe,bc as Je,ap as Ge,aI as We,aJ as Xe,aq as q,R as Ye}from"./index-BsB66SGI.js";import{_ as Ze}from"./index-Du8kc-Gh.js";import{_ as et}from"./index.vue_vue_type_style_index_0_lang-DXbUG3tz.js";import{_ as tt}from"./index.vue_vue_type_script_setup_true_lang-BZmY8XhD.js";import{_ as ot}from"./index.vue_vue_type_script_setup_true_lang-D9P_0mZR.js";import nt from"./index-CQw4MSeo.js";import at from"./index-D2DoY4Zb.js";import lt from"./index--SABsROg.js";import{s as oe}from"./apiLoading-CdB0CUk8.js";import{u as st}from"./user_customer-C1k1xBFM.js";import{a as K}from"./user_customer-Q2RhPuuo.js";import"./index-AnJqlWBp.js";import"./index.vue_vue_type_script_setup_true_lang-CEh89lcF.js";import"./index-BdhlIUdf.js";import"./index-CsoYLy7t.js";import"./department-CogLOuU5.js";import"./position_manage-BNh0L0gF.js";import"./department-KT6gOF8q.js";import"./tenant_role-iGmkS1tQ.js";import"./configuration_role-BKBryJqz.js";import"./configuration_manager-CIkrJnMM.js";import"./stagedData-8REedzd8.js";import"./index.vue_vue_type_script_setup_true_lang-DYZZmtNx.js";const it=V=>(We("data-v-65855369"),V=V(),Xe(),V),rt=it(()=>p("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),ct={class:"flex-c tableBig"},ut={class:"oneLine",style:{width:"calc(100% - 20px)"}},dt={class:"flex-c tableSmall"},mt={class:"oneLine",style:{width:"calc(100% - 20px)"}},pt={class:"flex-c tableBig"},_t={class:"oneLine",style:{width:"calc(100% - 20px)"}},ft={class:"flex-c tableBig"},ht={class:"oneLine",style:{width:"calc(100% - 20px)"}},gt={style:{width:"20px","text-align":"right",display:"inline-block"},class:"tableBig"},vt={class:"tableBig"},bt={class:"tableBig"},kt=Ue({name:"customer",__name:"index",setup(V){const ne=st(),{pagination:k,getParams:ae,onSizeChange:le,onCurrentChange:se}=Re(),O=c([]),N=c(!1),J=c([]),D=c(),G=c(),W=c(),X=c(),x=c(),ie=c(),z=c(!1),A=c(!1),$=c(!1),L=c("default"),u=c([]),U=c([{label:"客户编码",checked:!0,sortable:!0,prop:"tenantCustomerId"},{label:"客户名称",checked:!0,sortable:!0,prop:"customerAccord"},{label:"客户简称",checked:!0,sortable:!0,prop:"customerShortName"},{label:"负责人",checked:!0,sortable:!0,prop:"chargeName"},{label:"关联项目数",checked:!0,sortable:!0,prop:"projectNumber"},{label:"客户状态",checked:!0,sortable:!0,prop:"customerStatus"},{label:"前置问卷",checked:!0,sortable:!0,prop:"antecedentQuestionnaire"},{label:"风险控制",checked:!0,sortable:!0,prop:"riskControl"},{label:"客户营业限额/月",checked:!0,sortable:!0,prop:"turnover"},{label:"审核率Min值",checked:!0,sortable:!0,prop:"rateAudit"}]);function re(){D.value.showEdit()}function ce(l){D.value.showEdit(l)}async function Q(l,a,j){const I={status:l,operationalType:a,tenantCustomerId:j},{status:C}=await oe(K.changestatus(I));C===1&&te.success({message:"修改成功"}),ne.customer=null,h()}function ue(l){G.value.showEdit(l)}function de(l){l?x.value=l.tenantCustomerId:x.value=""}function F(l,a){W.value.showEdit(l,a)}function me(l){X.value.showEdit(l)}function pe(l){He.confirm("您确定要删除当前项吗?","确认信息").then(async()=>{const{status:a}=await oe(K.delete({tenantCustomerId:l.tenantCustomerId}));a===1&&te.success({message:"删除成功"}),h()}).catch(()=>{})}const f=Be({customerShortName:"",customerStatus:null,antecedentQuestionnaire:null}),_e=async()=>{const{data:l}=await Me.getTenantStaffList();O.value=l};function fe(l){le(l).then(()=>P())}function E(l=1){se(l).then(()=>P())}function he(){Object.assign(f,{customerShortName:"",customerStatus:null,antecedentQuestionnaire:null}),h()}function h(){k.value.page=1,P()}async function P(){try{N.value=!0;const l={...ae(),...f},{data:a}=await K.list(l);J.value=a.getTenantCustomerInfoList,k.value.total=Number(a.total),N.value=!1}catch{}finally{N.value=!1}}function ge(l){ie.value=l}return De(async()=>{await _e(),U.value.forEach(l=>{l.checked&&u.value.push(l.prop)}),h()}),(l,a)=>{const j=i("el-input"),I=i("el-form-item"),C=i("el-option"),Y=i("el-select"),y=qe,T=i("ElButton"),ve=i("ElFormItem"),be=i("ElForm"),ke=tt,Ce=i("ElDivider"),w=i("el-button"),ye=et,we=Ke,Se=Oe,xe=i("el-row"),g=i("el-table-column"),H=i("ElSwitch"),M=i("ElTableColumn"),Ee=Ze,Z=i("el-text"),Ie=Je,Ve=i("ElSpace"),Ne=i("el-empty"),ze=i("el-table"),Ae=i("ElPagination"),$e=Ge,Le=Qe("loading");return r(),ee("div",{class:B({"absolute-container":n($)})},[t($e,null,{default:o(()=>[t(ke,{"show-toggle":!1},{default:o(({fold:e,toggle:s})=>[t(be,{model:n(f).select,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:o(()=>[R(t(I,null,{default:o(()=>[t(j,{modelValue:n(f).customerShortName,"onUpdate:modelValue":a[0]||(a[0]=v=>n(f).customerShortName=v),clearable:"",placeholder:"客户简称",onKeydown:a[1]||(a[1]=Fe(v=>E(),["enter"]))},null,8,["modelValue"])]),_:2},1536),[[q,!e]]),R(t(I,null,{default:o(()=>[t(Y,{modelValue:n(f).customerStatus,"onUpdate:modelValue":a[2]||(a[2]=v=>n(f).customerStatus=v),clearable:"",placeholder:"客户状态",onChange:a[3]||(a[3]=v=>E())},{default:o(()=>[t(C,{label:"禁用",value:1}),t(C,{label:"启用",value:2})]),_:1},8,["modelValue"])]),_:2},1536),[[q,!e]]),R(t(I,null,{default:o(()=>[t(Y,{modelValue:n(f).antecedentQuestionnaire,"onUpdate:modelValue":a[4]||(a[4]=v=>n(f).antecedentQuestionnaire=v),clearable:"",placeholder:"前置问卷",onChange:a[5]||(a[5]=v=>E())},{default:o(()=>[t(C,{label:"禁用",value:1}),t(C,{label:"启用",value:2})]),_:1},8,["modelValue"])]),_:2},1536),[[q,!e]]),t(ve,null,{default:o(()=>[t(T,{type:"primary",onClick:a[6]||(a[6]=v=>E())},{icon:o(()=>[t(y,{name:"i-ep:search"})]),default:o(()=>[_(" 筛选 ")]),_:1}),t(T,{onClick:he},{icon:o(()=>[rt]),default:o(()=>[_(" 重置 ")]),_:1}),t(T,{disabled:"",link:"",onClick:s},{icon:o(()=>[t(y,{name:e?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:o(()=>[_(" "+b(e?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),t(Ce,{"border-style":"dashed"}),t(xe,null,{default:o(()=>[t(ye,null,{default:o(()=>[t(w,{type:"primary",size:"default",onClick:re},{default:o(()=>[_(" 新增 ")]),_:1})]),_:1}),t(Se,null,{default:o(()=>[t(w,{size:"default"},{default:o(()=>[_(" 导出 ")]),_:1}),t(we,{border:n(z),"onUpdate:border":a[7]||(a[7]=e=>S(z)?z.value=e:null),tableAutoHeight:n($),"onUpdate:tableAutoHeight":a[8]||(a[8]=e=>S($)?$.value=e:null),checkList:n(u),"onUpdate:checkList":a[9]||(a[9]=e=>S(u)?u.value=e:null),columns:n(U),"onUpdate:columns":a[10]||(a[10]=e=>S(U)?U.value=e:null),"line-height":n(L),"onUpdate:lineHeight":a[11]||(a[11]=e=>S(L)?L.value=e:null),stripe:n(A),"onUpdate:stripe":a[12]||(a[12]=e=>S(A)?A.value=e:null),style:{"margin-left":"12px"},onQueryData:h},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),R((r(),d(ze,{border:n(z),data:n(J),size:n(L),stripe:n(A),onSelectionChange:ge,"highlight-current-row":"",onCurrentChange:de},{empty:o(()=>[t(Ne,{image:n(Pe),"image-size":300},null,8,["image"])]),default:o(()=>[t(g,{align:"center",type:"selection"}),n(u).includes("customerStatus")?(r(),d(M,{key:0,align:"center","show-overflow-tooltip":"",prop:"customerStatus",label:"客户状态"},{default:o(({row:e})=>[t(H,{modelValue:e.customerStatus,"onUpdate:modelValue":s=>e.customerStatus=s,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:s=>Q(s,1,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):m("",!0),n(u).includes("customerAccord")?(r(),d(g,{key:1,align:"center",prop:"customerAccord","show-overflow-tooltip":"",label:"客户名称"},{default:o(({row:e})=>[p("div",ct,[p("div",ut,b(e.customerAccord),1),t(y,{onClick:s=>F(e,"customerAccord"),class:B({edit:"edit",current:e.tenantCustomerId===n(x)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):m("",!0),n(u).includes("tenantCustomerId")?(r(),d(g,{key:2,align:"center",prop:"tenantCustomerId",width:"180","show-overflow-tooltip":"",label:"客户编码"},{default:o(({row:e})=>[p("div",dt,[p("div",mt,b(e.tenantCustomerId),1),t(Ee)])]),_:1})):m("",!0),n(u).includes("customerShortName")?(r(),d(g,{key:3,align:"center",prop:"customerShortName","show-overflow-tooltip":"",label:"客户简称",width:"100"},{default:o(({row:e})=>[p("div",pt,[p("div",_t,b(e.customerShortName),1),t(y,{onClick:s=>F(e,"customerShortName"),class:B({edit:"edit",current:e.tenantCustomerId===n(x)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):m("",!0),n(u).includes("chargeName")?(r(),d(g,{key:4,align:"center",prop:"chargeName","show-overflow-tooltip":"",label:"负责人"},{default:o(({row:e})=>[p("div",ft,[p("div",ht,[(r(!0),ee(je,null,Te(n(O),s=>(r(),d(Z,{key:s.id},{default:o(()=>[s.id===e.chargeId?(r(),d(Z,{key:0},{default:o(()=>[_(b(s.name),1)]),_:2},1024)):m("",!0)]),_:2},1024))),128))]),t(y,{onClick:s=>F(e,"chargeName"),class:B({edit:"edit",current:e.tenantCustomerId===n(x)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):m("",!0),n(u).includes("projectNumber")?(r(),d(g,{key:5,align:"center",prop:"turnover","show-overflow-tooltip":"",label:"关联项目数"},{default:o(({row:e})=>[p("span",gt,b(e.projectNumber||0),1),e.projectNumber?(r(),d(w,{key:0,text:"",type:"primary",size:"small",class:"p-1",onClick:s=>me(e)},{default:o(()=>[t(y,{name:"mdi:cursor-default-click",size:"16px",color:"#409eff"})]),_:2},1032,["onClick"])):m("",!0)]),_:1})):m("",!0),n(u).includes("antecedentQuestionnaire")?(r(),d(M,{key:6,align:"center","show-overflow-tooltip":"",prop:"antecedentQuestionnaire",label:"前置问卷"},{default:o(({row:e})=>[t(H,{modelValue:e.antecedentQuestionnaire,"onUpdate:modelValue":s=>e.antecedentQuestionnaire=s,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:s=>Q(s,2,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):m("",!0),n(u).includes("riskControl")?(r(),d(M,{key:7,align:"center","show-overflow-tooltip":"",prop:"riskControl",label:"风险控制"},{default:o(({row:e})=>[t(H,{modelValue:e.riskControl,"onUpdate:modelValue":s=>e.riskControl=s,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:s=>Q(s,3,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):m("",!0),n(u).includes("turnover")?(r(),d(g,{key:8,align:"center",prop:"turnover","show-overflow-tooltip":"",label:"客户营业限额/月"},{default:o(({row:e})=>[p("div",vt,[t(Ie),_(b(e.turnover||0),1)])]),_:1})):m("",!0),n(u).includes("rateAudit")?(r(),d(g,{key:9,align:"center",prop:"rateAudit","show-overflow-tooltip":"",label:"审核率Min值"},{default:o(({row:e})=>[p("div",bt,b(e.rateAudit?e.rateAudit:"-"),1)]),_:1})):m("",!0),t(g,{align:"center",fixed:"right",prop:"i",label:"操作",width:"200"},{default:o(({row:e})=>[t(Ve,null,{default:o(()=>[t(w,{size:"small",plain:"",type:"primary",onClick:s=>ce(e)},{default:o(()=>[_(" 编辑 ")]),_:2},1032,["onClick"]),t(w,{type:"warning",plain:"",size:"small",onClick:s=>ue(e)},{default:o(()=>[_(" 详情 ")]),_:2},1032,["onClick"]),t(w,{type:"danger",plain:"",size:"small",onClick:s=>pe(e)},{default:o(()=>[_(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["border","data","size","stripe"])),[[Le,n(N)]]),t(Ae,{"current-page":n(k).page,total:n(k).total,"page-size":n(k).size,"page-sizes":n(k).sizes,layout:n(k).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:fe,onCurrentChange:E},null,8,["current-page","total","page-size","page-sizes","layout"]),t(ot,{ref_key:"editRef",ref:D,onFetchData:h},null,512),t(nt,{ref_key:"QuickEditRef",ref:W,onFetchData:h},null,512),t(at,{ref_key:"AssociatedProjectsRef",ref:X,onFetchData:h},null,512),t(lt,{ref_key:"checkRef",ref:G,onFetchData:h},null,512)]),_:1})],2)}}}),Mt=Ye(kt,[["__scopeId","data-v-65855369"]]);export{Mt as default};
