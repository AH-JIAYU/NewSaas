
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as oe,ae as ne,s as le,aN as se,r as f,u as ie,l as re,e as z,o as ce,E as B,a2 as c,al as D,a as r,i as de,f as l,w as s,h as t,a3 as _,c as d,g as M,t as g,aM as ue,j as S,b as p,A as E,aS as me,ai as pe,_ as fe,ao as _e,y as ge}from"./index-CxSXUQRU.js";import{_ as he}from"./index-BNC4RpCQ.js";import{_ as ve}from"./index-DA4NZtDa.js";import be from"./index-CQ2Pfn-y.js";import{a as L}from"./configuration_role-DeiAQ-mf.js";import Ce from"./index-BjRmhMGo.js";import{u as ye}from"./useTabbar-BT2LOkyx.js";import"./index-CrNZ6CW0.js";import"./clipboard-DquYvbb_.js";import"./index.vue_vue_type_script_setup_true_lang-5fUkfTjC.js";import"./sortable.esm-C0-Qcoum.js";import"./index-CU4lqvHT.js";const Me={class:"copyId tableSmall"},Se={class:"id oneLine idFont"},Ee={class:"tableBig"},ke={class:"fontC-System"},xe={class:"flex-s"},Ne={class:"oneLine fontC-System",style:{width:"calc(100% - 20px)"}},Re=oe({name:"role",__name:"list",setup(Pe){const{t:C}=ne(),k=le(),{pagination:u,onSizeChange:T,onCurrentChange:V,onSortChange:$}=se(),x=ye(),N=f(),h=f(),v=ie(),R=f(),I=f("formSearch-role"),e=f({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,id:"",row:{}},search:{id:null,name:""},batch:{enable:!1,selectionDataList:[]},dataList:[]});function F(a){a?h.value=a.id:h.value=""}function j(a,n){N.value.showEdit(a,n)}re(()=>{e.value.formMode==="router"&&z.off("get-data-list")});async function i(){try{e.value.loading=!0;const a={...e.value.search},n=await L.list(a);n.data&&n.status===1&&(e.value.dataList=n.data,u.value.total=+n.data.length),e.value.loading=!1}catch{}finally{e.value.loading=!1}}function A({prop:a,order:n}){$(a,n).then(()=>i())}function O(a){T(a).then(()=>{e.value.search.limit=a,i()})}function P(a=1){V(a).then(()=>{i()})}function Q(){Object.assign(e.value.search,{id:null,name:""}),i()}function H(){e.value.formMode==="router"?v.settings.tabbar.enable&&v.settings.tabbar.mergeTabsBy!=="activeMenu"?x.open({name:"multilevel_menu_exampleRoleCreate"}):k.push({name:"multilevel_menu_exampleRoleCreate"}):(e.value.formModeProps.id="",e.value.formModeProps.visible=!0)}function U(a){e.value.formMode==="router"?v.settings.tabbar.enable&&v.settings.tabbar.mergeTabsBy!=="activeMenu"?x.open({name:"multilevel_menu_exampleRoleEdit",params:{id:a.id}}):k.push({name:"multilevel_menu_exampleRoleEdit",params:{id:a.id}}):(e.value.formModeProps.id=a.id,e.value.formModeProps.row=JSON.stringify(a),e.value.formModeProps.visible=!0)}function q(a){me.confirm(`确认删除「${a.roleName}」吗？`,"确认信息").then(()=>{L.delete({id:a.id}).then(()=>{i(),pe.success({message:"删除成功",center:!0})})}).catch(()=>{})}return ce(()=>{i(),e.value.formMode==="router"&&z.on("get-data-list",()=>{i()}),R.value=[{index:1,show:!0,type:"input",modelName:"id",placeholder:B(()=>C("configuration.role.roleID"))},{index:2,show:!0,type:"input",modelName:"name",placeholder:B(()=>C("configuration.role.roleName"))}]}),(a,n)=>{const J=ve,G=c("ElDivider"),y=c("ElButton"),K=c("ElSpace"),m=c("ElTableColumn"),W=he,X=fe,Y=c("el-empty"),Z=c("ElTable"),ee=c("ElPagination"),te=_e,b=D("auth"),ae=D("loading");return r(),de("div",{class:E({"absolute-container":t(e).tableAutoHeight})},[l(te,null,{default:s(()=>[l(J,{formSearchList:t(R),formSearchName:t(I),onCurrentChange:P,onOnReset:Q,model:t(e).search},null,8,["formSearchList","formSearchName","model"]),l(G,{"border-style":"dashed"}),l(K,{wrap:""},{default:s(()=>[_((r(),d(y,{type:"primary",size:"default",onClick:H},{default:s(()=>[M(g(t(C)("configuration.role.newRole")),1)]),_:1})),[[b,"role-insert-insertRole"]])]),_:1}),_((r(),d(Z,{class:"my-4",data:t(e).dataList,stripe:"","highlight-current-row":"",height:"100%",onSortChange:A,onSelectionChange:n[0]||(n[0]=o=>t(e).batch.selectionDataList=o),onCurrentChange:F},{empty:s(()=>[l(Y,{image:t(ue),"image-size":300},null,8,["image"])]),default:s(()=>[t(e).batch.enable?(r(),d(m,{key:0,type:"selection",align:"left",fixed:""})):S("",!0),l(m,{prop:"id",align:"left",label:"角色ID"},{default:s(({row:o})=>[p("div",Me,[p("div",Se,g(o.id),1),l(W,{content:o.id,class:E([{rowCopy:"rowCopy",current:o.id===t(h)},"littleButton"])},null,8,["content","class"])])]),_:1}),l(m,{prop:"roleName",align:"left",label:"角色名称"},{default:s(({row:o})=>[p("div",Ee,g(o.roleName),1)]),_:1}),l(m,{prop:"count",align:"left",label:"账户数"},{default:s(({row:o})=>[p("div",ke,g(o.count),1)]),_:1}),l(m,{prop:"remark",align:"left",label:"备注"},{default:s(({row:o})=>[p("div",xe,[p("div",Ne,g(o.remark?o.remark:"-"),1),o.projectType!==2?_((r(),d(X,{key:0,onClick:w=>j(o,"remark"),class:E({edit:"edit",current:o.id===t(h)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])),[[b,"role-update-updateRole"]]):S("",!0)])]),_:1}),l(m,{label:"操作",width:"250",align:"left",fixed:"right"},{default:s(o=>[_((r(),d(y,{type:"primary",size:"small",plain:"",onClick:w=>U(o.row)},{default:s(()=>[M(" 编辑 ")]),_:2},1032,["onClick"])),[[b,"role-update-updateRole"]]),_((r(),d(y,{type:"danger",size:"small",plain:"",onClick:w=>q(o.row)},{default:s(()=>[M(" 删除 ")]),_:2},1032,["onClick"])),[[b,"role-delete-deleteRole"]])]),_:1})]),_:1},8,["data"])),[[ae,t(e).loading]]),l(ee,{"current-page":t(u).page,total:t(u).total,"page-size":t(u).size,"page-sizes":t(u).sizes,layout:t(u).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:O,onCurrentChange:P},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),t(e).formMode==="dialog"||t(e).formMode==="drawer"?(r(),d(be,{key:0,id:t(e).formModeProps.id,modelValue:t(e).formModeProps.visible,"onUpdate:modelValue":n[1]||(n[1]=o=>t(e).formModeProps.visible=o),row:t(e).formModeProps.row,mode:t(e).formMode,onSuccess:i},null,8,["id","modelValue","row","mode"])):S("",!0),l(Ce,{ref_key:"QuickEditRef",ref:N,onFetchData:i},null,512)],2)}}}),Oe=ge(Re,[["__scopeId","data-v-222bdcb6"]]);export{Oe as default};
