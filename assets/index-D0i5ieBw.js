
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as G,r as d,c as H,a as s,o as i,b as f,f as a,w as o,g as c,i as r,F as Q,t as W,e as p,y as h,z as b,j as _,A as X,E as C,_ as Y,aE as Z,L as ee}from"./index-SEhFNywK.js";import{c as L}from"./user_cooperation-Q4fl06W2.js";import{u as te}from"./index-BGIUwgbQ.js";import"./index-DmzS4XeY.js";import"./index-AYGCwULo.js";import"./department-DGC_Lmnj.js";const ae={style:{float:"left"}},oe={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"0.8125rem"}},ne={key:0},le={key:1},re={key:3,style:{display:"flex"},class:"inviteDialog"},se=G({__name:"index",emits:["fetch-data"],setup(ie,{expose:E,emit:R}){const D=R,u=d(!1);d("");const T=d(),e=d({form:{},tenantUserList:[],tenantStaffList:[],chargeUserId:null,departmentId:null,chargeUserName:"",rules:{beInvitationTenantId:[{required:!0,message:"请选择租户",trigger:"change"}],priceRatio:[{required:!0,message:"请输入价格比例",trigger:"blur"}],sendProjectType:[{required:!0,message:"请选择发送项目",trigger:"change"}],receiveProjectType:[{required:!0,message:"请选择接收项目",trigger:"change"}]}});async function S(){await q(),u.value=!0}async function q(){const t=await L.getTenantUserList({});e.value.tenantUserList=t.data.tenantUserInfoList}const I=H(()=>{const t=e.value.tenantUserList.find(n=>n.tenantId===e.value.form.beInvitationTenantId);return t?(e.value.form.tenantName=t.name,e.value.form.phoneOrEmail=Z.local.get("account"),[t]):[]});function U(){u.value=!1,e.value.form={},T.value.resetFields()}async function A(){T.value.validate(t=>{if(t){let n=JSON.parse(JSON.stringify(e.value.form));n.sendProjectType=e.value.form.sendProjectType.length!=0?e.value.form.sendProjectType[0]:null,n.receiveProjectType=e.value.form.receiveProjectType.length!=0?e.value.form.receiveProjectType[0]:null,n.receiveProjectType==2&&(e.value.form.chargeUserId=null,e.value.form.chargeUserName="",e.value.form.invitationType="",n.chargeUserId=null,n.chargeUserName="",n.invitationType=""),L.addInvitationBind(n).then(v=>{v.status==-1?C.success({message:v.error,center:!0}):(C.success({message:"发送成功",center:!0}),D("fetch-data"),U())})}})}E({showEdit:S});const k=d();function w(){let t={chargeUserId:e.value.form.chargeUserId,invitationType:e.value.form.invitationType,chargeUserName:e.value.form.chargeUserName};k.value.showEdit(t,"请选择负责部门/人")}function B(t){e.value.form.chargeUserId=t.chargeUserId,e.value.form.invitationType=t.invitationType,e.value.form.chargeUserName=t.chargeUserName}const F=t=>{Array.isArray(t)&&t.length>1&&(e.value.form.sendProjectType=[t[t.length-1]])},O=t=>{Array.isArray(t)&&t.length>1&&(e.value.form.receiveProjectType=[t[t.length-1]])},z=t=>{t.preventDefault()};return(t,n)=>{const v=s("el-option"),J=s("el-select"),m=s("el-form-item"),g=s("el-table-column"),K=s("el-table"),j=s("el-input"),P=Y,N=s("el-tooltip"),y=s("el-checkbox"),x=s("el-checkbox-group"),M=s("ElForm"),V=s("el-button"),$=s("el-dialog");return i(),f("div",null,[a($,{modelValue:r(u),"onUpdate:modelValue":n[5]||(n[5]=l=>X(u)?u.value=l:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:"邀约公司"},{footer:o(()=>[a(V,{onClick:U},{default:o(()=>[c(" 关闭 ")]),_:1}),a(V,{type:"primary",onClick:A},{default:o(()=>[c(" 发送邀约 ")]),_:1})]),default:o(()=>[a(M,{ref_key:"formRef",ref:T,rules:r(e).rules,model:r(e).form,"label-width":"7rem",labelPosition:"left"},{default:o(()=>[a(m,{label:"公司名称",prop:"beInvitationTenantId"},{default:o(()=>[a(J,{modelValue:r(e).form.beInvitationTenantId,"onUpdate:modelValue":n[0]||(n[0]=l=>r(e).form.beInvitationTenantId=l),clearable:""},{default:o(()=>[(i(!0),f(Q,null,W(r(e).tenantUserList,l=>(i(),p(v,{key:l.tenantId,value:l.tenantId,label:l.tenantName},{default:o(()=>[h("span",ae,b(l.tenantName),1),h("span",oe,b(l.tenantId),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(I).length?(i(),p(K,{key:0,data:r(I),border:"",stripe:"",style:{"margin-bottom":"18px"}},{default:o(()=>[a(g,{prop:"name",label:"用户名"}),a(g,{prop:"tenantName",label:"公司名称"}),a(g,{prop:"country",label:"区域"}),a(g,{label:"电子邮箱/手机号"},{default:o(({row:l})=>[l.phone?(i(),f("span",ne,b(l.phone),1)):(i(),f("span",le,b(l.email),1))]),_:1})]),_:1},8,["data"])):_("",!0),r(e).form.beInvitationTenantId?(i(),p(m,{key:1,label:"价格比例",prop:"priceRatio"},{default:o(()=>[a(j,{modelValue:r(e).form.priceRatio,"onUpdate:modelValue":n[1]||(n[1]=l=>r(e).form.priceRatio=l),clearable:""},{append:o(()=>[c("%")]),_:1},8,["modelValue"])]),_:1})):_("",!0),r(e).form.beInvitationTenantId?(i(),p(m,{key:2,label:"项目分配方式","label-width":"7rem"})):_("",!0),r(e).form.beInvitationTenantId?(i(),f("div",re,[a(m,{prop:"sendProjectType","label-width":"7rem"},{label:o(()=>[h("span",null,[a(N,{effect:"dark",content:"1111111",placement:"top-start"},{default:o(()=>[a(P,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1}),c(" 发送项目 ")])]),default:o(()=>[a(x,{modelValue:r(e).form.sendProjectType,"onUpdate:modelValue":n[2]||(n[2]=l=>r(e).form.sendProjectType=l),onChange:F},{default:o(()=>[a(y,{value:1},{default:o(()=>[c(" 自动 ")]),_:1}),a(y,{value:2},{default:o(()=>[c(" 手动 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(m,{prop:"receiveProjectType",style:{"margin-left":"40px"}},{label:o(()=>[h("span",null,[a(N,{effect:"dark",content:"1111111",placement:"top-start"},{default:o(()=>[a(P,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1}),c(" 接收项目 ")])]),default:o(()=>[a(x,{modelValue:r(e).form.receiveProjectType,"onUpdate:modelValue":n[3]||(n[3]=l=>r(e).form.receiveProjectType=l),onChange:O},{default:o(()=>[a(y,{value:1},{default:o(()=>[c(" 自动 ")]),_:1}),a(y,{value:2},{default:o(()=>[c(" 手动 ")]),_:1})]),_:1},8,["modelValue"])]),_:1})])):_("",!0),r(e).form.receiveProjectType&&r(e).form.receiveProjectType[0]==1?(i(),p(j,{key:4,placeholder:"请选择接收项目负责人",onKeydown:z,onClick:w,modelValue:r(e).form.chargeUserName,"onUpdate:modelValue":n[4]||(n[4]=l=>r(e).form.chargeUserName=l)},null,8,["modelValue"])):_("",!0)]),_:1},8,["rules","model"])]),_:1},8,["modelValue"]),a(te,{ref_key:"userRef",ref:k,onUserData:B},null,512)])}}}),_e=ee(se,[["__scopeId","data-v-c0844883"]]);export{_e as default};
