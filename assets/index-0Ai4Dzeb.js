
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as be,aN as ve,r as u,Z as A,c as we,n as ke,a as s,q as Ce,o as r,b as K,f as o,w as e,i as t,az as M,F as Ie,t as xe,e as p,g as i,z as g,A as k,s as O,aM as je,ao as Ne,j as y,y as U,N as Le,_ as Se,bb as ze,bc as Te,an as De,aH as Ee,aI as Re,L as Ve}from"./index-BTGw-NBz.js";import{_ as Ue}from"./index.vue_vue_type_style_index_0_lang-GK_s4T5J.js";import{_ as Fe}from"./index.vue_vue_type_script_setup_true_lang-DjMVK-TS.js";import{q as Be,a as G}from"./index-BLz5Uqv7.js";import{u as qe}from"./user_customer-DE6thAVL.js";/* empty css                      */import"./user_customer-BJhiwIvC.js";const Q=I=>(Ee("data-v-68128979"),I=I(),Re(),I),He=Q(()=>U("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Pe=Q(()=>U("br",null,null,-1)),$e={class:"tableBig"},Ae=be({name:"preInvestigationRecords",__name:"index",setup(I){const Z=qe(),{getParams:J,pagination:d,onSizeChange:W,onCurrentChange:X}=ve(),x=u(!1),F=u([]);u("");const f=u([]),j=u(!1),N=u(!1),L=u("default"),S=u(!1),Y=u();u("formSearch-preInvestigationRecords");const z=u([{prop:"projectId",label:"项目ID",sortable:!0,checked:!0},{prop:"projectName",label:"项目名称",sortable:!0,checked:!0},{prop:"allocationType",label:"分配类型",sortable:!0,checked:!0},{prop:"passNumber",label:"通过数/提交数",sortable:!0,checked:!0},{prop:"passRate",label:"通过率",sortable:!0,checked:!0}]),c=A({projectId:"",projectName:"",allocationType:[]}),B=u(),h=A({allocationTypeList:["未分配","供应商","内部站"],surveyStatusList:["完成","被甄别","配额满","安全终止","未完成"],viceStatusList:["待审","免审","过IR","时间果断","超时完成","超量完成","审核成功","审核失败","数据冻结","时间段过载","ip不一致","id重复参与","和解"],customerList:[],vipList:[],vipGroupList:[],tenantSupplierList:[],expandedRows:[]});function ee(){c.pageNo=1,C()}function te(n){W(n).then(()=>C())}function oe(n=1){X(n).then(()=>C())}async function q(n){const l=h.expandedRows.indexOf(n.id);if(l!==-1?h.expandedRows.splice(l,1):h.expandedRows.push(n.id),!n.children){const w=await G.childList({projectId:n.projectId});n.children=w.data.projectScreenMemberChildInfoList}}function ae(n){B.value.showEdit(n)}const v=we(()=>F.value.filter(l=>!!(l.projectId.includes(c.projectId)||l.projectName.includes(c.projectName)||c.allocationType===l.allocationType)).slice((d.value.page-1)*d.value.size,d.value.page*d.value.size));async function C(){try{x.value=!0;const n={...J(),...c},{data:l,status:w}=await G.list(n);l&&w===1&&(F.value=l.projectSurveyScreenInfoList,d.value.total=l.projectSurveyScreenInfoList.length),x.value=!1}catch{}finally{x.value=!1}}function le(){Object.assign(c,{projectId:"",projectName:"",allocationType:""}),C()}return ke(async()=>{h.customerList=await Z.getCustomerList(),z.value.forEach(n=>{n.checked&&f.value.push(n.prop)}),C(),Y.value=[{index:1,show:!0,type:"input",modelName:"projectId",placeholder:"项目ID"},{index:2,show:!0,type:"input",modelName:"projectName",placeholder:"项目名称"},{index:3,show:!0,type:"select",modelName:"allocationType",placeholder:"分配类型",option:"allocationType",optionLabel:"label",optionValue:"value",multiple:!0}]}),(n,l)=>{const w=s("ElInput"),T=s("ElFormItem"),ne=s("el-option"),se=s("el-select"),H=Se,D=s("ElButton"),ie=s("ElForm"),re=Fe,ce=s("ElDivider"),pe=Ue,P=s("el-button"),ue=ze,de=Te,me=s("el-row"),b=s("el-table-column"),E=s("el-text"),R=s("ElTableColumn"),$=s("el-table"),V=s("el-tag"),fe=s("el-empty"),_e=s("ElPagination"),ye=De,ge=Ce("loading");return r(),K("div",{class:Le({"absolute-container":t(S)})},[o(ye,null,{default:e(()=>[o(re,{"show-toggle":!1},{default:e(({fold:a,toggle:m})=>[o(ie,{model:t(c),size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:e(()=>[o(T,null,{default:e(()=>[o(w,{modelValue:t(c).projectId,"onUpdate:modelValue":l[0]||(l[0]=_=>t(c).projectId=_),placeholder:"项目ID",clearable:"",onKeydown:M(t(v),["enter"]),onClear:t(v)},null,8,["modelValue","onKeydown","onClear"])]),_:1}),o(T,null,{default:e(()=>[o(w,{modelValue:t(c).projectName,"onUpdate:modelValue":l[1]||(l[1]=_=>t(c).projectName=_),placeholder:"项目名称",clearable:"",onKeydown:M(t(v),["enter"]),onClear:t(v)},null,8,["modelValue","onKeydown","onClear"])]),_:1}),o(T,null,{default:e(()=>[o(se,{modelValue:t(c).allocationType,"onUpdate:modelValue":l[2]||(l[2]=_=>t(c).allocationType=_),"value-key":"",placeholder:"分配类型",clearable:"",filterable:""},{default:e(()=>[(r(!0),K(Ie,null,xe(t(h).allocationTypeList,(_,he)=>(r(),p(ne,{key:_,label:_,value:he+1},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(T,null,{default:e(()=>[o(D,{type:"primary",onClick:t(v)},{icon:e(()=>[o(H,{name:"i-ep:search"})]),default:e(()=>[i(" 筛选 ")]),_:1},8,["onClick"]),o(D,{onClick:le},{icon:e(()=>[He]),default:e(()=>[i(" 重置 ")]),_:1}),o(D,{link:"",onClick:m},{icon:e(()=>[o(H,{name:a?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:e(()=>[i(" "+g(a?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),o(ce,{"border-style":"dashed"}),o(me,null,{default:e(()=>[o(pe),o(de,null,{default:e(()=>[o(P,{size:"default"},{default:e(()=>[i(" 导出 ")]),_:1}),o(ue,{border:t(j),"onUpdate:border":l[3]||(l[3]=a=>k(j)?j.value=a:null),tableAutoHeight:t(S),"onUpdate:tableAutoHeight":l[4]||(l[4]=a=>k(S)?S.value=a:null),checkList:t(f),"onUpdate:checkList":l[5]||(l[5]=a=>k(f)?f.value=a:null),columns:t(z),"onUpdate:columns":l[6]||(l[6]=a=>k(z)?z.value=a:null),"line-height":t(L),"onUpdate:lineHeight":l[7]||(l[7]=a=>k(L)?L.value=a:null),stripe:t(N),"onUpdate:stripe":l[8]||(l[8]=a=>k(N)?N.value=a:null),style:{"margin-left":"12px"},onQueryData:ee},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),O((r(),p($,{border:t(j),data:t(v),size:t(L),stripe:t(N),"row-key":"id","expand-row-keys":t(h).expandedRows,onExpandChange:q},{empty:e(()=>[o(fe,{image:t(je),"image-size":300},null,8,["image"])]),default:e(()=>[o(b,{type:"expand",width:"55"},{default:e(a=>[o($,{data:a.row.children,"highlight-current-row":"",class:"hide-table-header",border:"",height:"100%"},{default:e(()=>[o(b,{width:"55"}),o(b,{width:"300",prop:"memberChildName",label:"名称+ID",align:"left"},{default:e(m=>[o(E,{class:"fontC-System"},{default:e(()=>[i(g(m.row.memberChildName),1)]),_:2},1024),Pe,O(o(E,{type:"danger",class:"fontC-System"},{default:e(()=>[i("随机id:"+g(m.row.randomIdentityId),1)]),_:2},1536),[[Ne,m.row.randomIdentityId]])]),_:1}),o(R,{prop:"status",label:"状态",align:"left"},{default:e(m=>[m.row.status===1?(r(),p(E,{key:0,type:"success",class:"fontC-System"},{default:e(()=>[i("前置问卷通过")]),_:1})):(r(),p(E,{key:1,type:"danger",class:"fontC-System"},{default:e(()=>[i("前置问卷未通过")]),_:1}))]),_:1}),o(R,{width:"200",align:"left",fixed:"right",label:"操作"},{default:e(m=>[o(D,{type:"primary",size:"small",plain:"",onClick:_=>ae(m.row)},{default:e(()=>[i(" 查看问卷详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:2},1032,["data"])]),_:1}),t(f).includes("projectId")?(r(),p(b,{key:0,width:"300",align:"left",prop:"projectId","show-overflow-tooltip":"",label:"项目ID"})):y("",!0),t(f).includes("projectName")?(r(),p(b,{key:1,align:"left",prop:"projectName","show-overflow-tooltip":"",label:"项目名称"},{default:e(({row:a})=>[U("div",$e,g(a.projectName),1)]),_:1})):y("",!0),t(f).includes("allocationType")?(r(),p(b,{key:2,align:"left","show-overflow-tooltip":"",width:"100",label:"分配类型"},{default:e(({row:a})=>[a.allocationType===1?(r(),p(V,{key:0,effect:"plain",type:"info",class:"mx-1"},{default:e(()=>[i("未分配")]),_:1})):y("",!0),a.allocationType===2?(r(),p(V,{key:1,effect:"dark",style:{"background-color":"#fb6868",border:"none"},class:"mx-1",type:"primary"},{default:e(()=>[i("供应商")]),_:1})):y("",!0),a.allocationType===3?(r(),p(V,{key:2,effect:"dark",style:{"background-color":"#05c9be",border:"none"},class:"mx-1",type:"warning"},{default:e(()=>[i("内部站")]),_:1})):y("",!0),a.allocationType===4?(r(),p(V,{key:3,effect:"dark",style:{"background-color":"#ffac54",border:"none"},class:"mx-1",type:"warning"},{default:e(()=>[i("合作商")]),_:1})):y("",!0)]),_:1})):y("",!0),t(f).includes("passNumber")?(r(),p(b,{key:3,align:"left","show-overflow-tooltip":"",label:"通过数/提交数"},{default:e(({row:a})=>[i(g(a.passNumber||0)+"/ "+g(a.submitNumber||0),1)]),_:1})):y("",!0),t(f).includes("passRate")?(r(),p(R,{key:4,align:"left","show-overflow-tooltip":"",prop:"passRate",label:"通过率"},{default:e(({row:a})=>[i(g(a.passRate+"%"),1)]),_:1})):y("",!0),o(R,{align:"left","show-overflow-tooltip":"",prop:"",fixed:"right",label:"操作",width:"200"},{default:e(({row:a})=>[o(P,{plain:"",type:"primary",size:"small",onClick:m=>q(a)},{default:e(()=>[i(g(t(h).expandedRows.includes(a.id)?"收起":"展开"),1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","data","size","stripe","expand-row-keys"])),[[ge,t(x)]]),o(_e,{"current-page":t(d).page,total:t(d).total,"page-size":t(d).size,"page-sizes":t(d).sizes,layout:t(d).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:te,onCurrentChange:oe},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),o(Be,{ref_key:"questionnaireDetailsRef",ref:B},null,512)],2)}}}),We=Ve(Ae,[["__scopeId","data-v-68128979"]]);export{We as default};
