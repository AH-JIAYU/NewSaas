
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as Ee}from"./index.vue_vue_type_script_setup_true_lang-CfjT-pvp.js";import{k as W,d as Ce,t as ke,a0 as Re,a1 as Ue,r as d,b7 as U,aO as Te,a2 as Fe,b as X,f as l,w as o,l as u,am as D,aM as K,i as a,v as Ie,a as g,aF as Se,aG as qe,O as Pe,o as h,p as Ae,aB as Le,g as m,I as V,e as E,az as Y,j as O,ay as G,F as Ne,n as $e,ak as T,N as ze,_ as Be,q as ee}from"./index-DqTjMncf.js";import Ze from"./index-CKza1GfS.js";import{o as ae,s as Me}from"./apiLoading-C7qBWM4V.js";import{u as De}from"./otherFunctions_basicDictionary-B5p--0w7.js";import"./basicDictionary-v4IN8fmI.js";const q={sendCode:v=>W.post("user/sendCode",v),register:v=>W.post("user/register",v)},F=v=>(Se("data-v-6ce64dd1"),v=v(),qe(),v),Ke=F(()=>u("div",{class:"bg-banner"},null,-1)),Oe={id:"login-box"},Ge=F(()=>u("div",{class:"login-banner"},[u("h1",{style:{"font-size":"50px","font-weight":"normal"}},"欢迎 !"),u("h3",{h1:"",style:{"font-size":"30px","font-weight":"normal"}}," 来到租户系统 ! 👋🏻 ")],-1)),je={class:"title-container"},He={class:"fx-c"},Je={class:"flex-bar",style:{margin:"0",width:"100%"}},Qe={class:"flex-bar"},We={class:"sub-link"},Xe=F(()=>u("span",{class:"text"},"还不是会员?",-1)),Ye={class:"flex-bar",style:{margin:"0"}},ea={class:"sub-link"},aa=F(()=>u("span",{class:"text"},"已经有帐号?",-1)),la=F(()=>u("div",{class:"title-container"},[u("h3",{class:"title"},"忘记密码了? 🔒")],-1)),oa={class:"sub-link"},le=Ce({name:"Login",__name:"login",setup(v){var J;const oe=De(),te=Ie(),re=Pe(),se=ke(),ne=Re(),{t:f}=Ue();new URL(""+new URL("login-banner-ZfMZACb6.png",import.meta.url).href,import.meta.url).href,new URL(""+new URL("logo-CLz_KCqM.png",import.meta.url).href,import.meta.url).href;const _=d("login"),w=d(!1),ie=d(((J=te.query.redirect)==null?void 0:J.toString())??se.settings.home.fullPath),C=d(),b=d("code"),P=d("获取验证码"),A=d(!1),i=d({account:U.local.get("login_account")||"",remember:U.local.has("login_account")}),j=(r,e,s)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(i.value.account)?s():s(new Error("请输入合法手机号"))},ue=(r,e,s)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(i.value.account)?s():s(new Error("请输入合法邮箱"))},I=d({account:[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}],agreeToTheAgreement:[{validator:(r,e)=>e===!0,message:"请阅读并勾选协议",trigger:"change"}]}),de=()=>{i.value.account.includes("@")?I.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"},{validator:ue,trigger:"blur"}]:I.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"},{validator:j,trigger:"blur"}]};async function pe(){C.value.validateField("account",async r=>{if(r){let e;i.value.account.includes("@")?e={email:i.value.account,type:"login_email"}:e={phone:i.value.account,type:"login_phone_number"};const{status:s}=await q.sendCode(e);s===1&&T.success({message:"已发送"})}}),me()}const me=()=>{A.value=!0;let r=60;y.value=setInterval(()=>{r>0?(r--,P.value=`请在${r}s后重新获取`):(clearInterval(y.value),P.value="获取验证码",y.value=null,A.value=!1)},1e3)};function L(){C.value&&C.value.validate(r=>{if(r){let e={...i.value};b.value==="password"?e.type=1:i.value.account.includes("@")?e.type=3:e.type=2,w.value=!0,ne.login(e).then(()=>{w.value=!1,i.value.remember?U.local.set("login_account",i.value.account):U.local.remove("login_account"),re.push(ie.value)}).catch(()=>{w.value=!1})}})}const y=d(null),N=d("获取验证码"),$=d(!1),z=d(),H=d([]),n=d({account:"",password:"",email:"",phoneNumber:"",code:"",country:"",type:"phone"}),ce=d({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],email:[{required:!0,trigger:"blur",message:"请输入邮箱"},{validator:(r,e,s)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n.value.email)?s():s(new Error("请输入合法邮箱"))},trigger:"blur"}],phoneNumber:[{required:!0,trigger:"blur",message:"请输入手机号码"},{validator:(r,e,s)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(n.value.phoneNumber)?s():s(new Error("请输入合法手机号"))},trigger:"blur"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}],agreeToTheAgreement:[{validator:(r,e)=>e===!0,message:"请阅读并勾选协议",trigger:"change"}]}),ge=async()=>{const r={type:"register_phone_number",email:n.value.email,phone:n.value.phoneNumber};if(n.value.type==="phone"){const{status:e}=await ae(q.sendCode(r));e===1&&T.success({message:"已发送"})}else{r.type="register_email";const{status:e}=await ae(q.sendCode(r));e===1&&T.success({message:"已发送"})}fe()},fe=()=>{$.value=!0;let r=60;y.value=setInterval(()=>{r>0?(r--,N.value=`请在${r}s后重新获取`):(clearInterval(y.value),N.value="获取验证码",y.value=null,$.value=!1)},1e3)};async function ve(){z.value&&z.value.validate(async r=>{if(r){const{status:e}=await Me(q.register(n.value));e===1&&T.success({message:"注册成功"})}})}const B=d(),x=d({account:U.local.get("login_account"),code:"",newPassword:""}),_e=d({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],newPassword:[{required:!0,trigger:"blur",message:"请输入新密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}]});function be(){T({message:"重置密码仅提供界面演示，无实际功能，需开发者自行扩展",type:"info"}),B.value&&B.value.validate(r=>{})}Te(()=>{clearInterval(y.value),y.value=null});const ye=()=>{I.value.account=[{validator:j,trigger:"blur"}],C.value.resetFields()};return Fe(()=>_.value,async r=>{r==="register"&&(H.value=await oe.getCountry())}),(r,e)=>{const s=ze,k=Ee,Q=g("el-radio-button"),he=g("el-radio-group"),xe=g("el-button"),c=g("ElInput"),p=g("ElFormItem"),Z=g("ElCheckbox"),S=g("ElLink"),R=g("ElButton"),M=g("ElForm"),we=g("ElOption"),Ve=g("ElSelect");return h(),X("div",null,[Ke,l(k,{placement:"bottom-end",class:"i18n-selector"},{default:o(()=>[l(s,{name:"i-ri:translate"})]),_:1}),u("div",Oe,[Ge,D(l(M,{ref_key:"loginFormRef",ref:C,model:a(i),rules:a(I),class:"login-form","validate-on-rule-change":!1},{default:o(()=>[u("div",je,[u("div",He,[l(he,{modelValue:a(b),"onUpdate:modelValue":e[0]||(e[0]=t=>Ae(b)?b.value=t:null),size:"large",onChange:ye},{default:o(()=>[l(Q,{label:"验证码登录",value:"code"}),l(Q,{label:"密码登录",value:"password"})]),_:1},8,["modelValue"])])]),u("div",null,[l(p,{prop:"account"},{default:o(()=>[l(c,{modelValue:a(i).account,"onUpdate:modelValue":e[1]||(e[1]=t=>a(i).account=t),placeholder:a(f)("app.account"),type:"text",tabindex:"1",onBlur:de},Le({prefix:o(()=>[l(s,{name:"i-ri:user-3-fill"})]),_:2},[a(b)==="code"?{name:"append",fn:o(()=>[l(xe,{type:"primary",disabled:a(A),onClick:pe},{default:o(()=>[m(V(a(P)),1)]),_:1},8,["disabled"])]),key:"0"}:void 0]),1032,["modelValue","placeholder"])]),_:1}),a(b)==="password"?(h(),E(p,{key:0,prop:"password"},{default:o(()=>[l(c,{modelValue:a(i).password,"onUpdate:modelValue":e[2]||(e[2]=t=>a(i).password=t),type:"password",placeholder:a(f)("app.password"),tabindex:"2",autocomplete:"new-password","show-password":"",onKeyup:Y(L,["enter"])},{prefix:o(()=>[l(s,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1})):O("",!0),a(b)==="code"?(h(),E(p,{key:1,prop:"code"},{default:o(()=>[l(c,{modelValue:a(i).code,"onUpdate:modelValue":e[3]||(e[3]=t=>a(i).code=t),type:"text",placeholder:a(f)("app.captcha"),tabindex:"2",onKeyup:Y(L,["enter"])},{prefix:o(()=>[l(s,{name:"i-ep:message"})]),_:1},8,["modelValue","placeholder"])]),_:1})):O("",!0),l(p,{prop:"agreeToTheAgreement"},{default:o(()=>[u("div",Je,[l(Z,{modelValue:a(i).agreeToTheAgreement,"onUpdate:modelValue":e[4]||(e[4]=t=>a(i).agreeToTheAgreement=t),tabindex:"3"},{default:o(()=>[m("我已阅读并同意《xxxx协议》 ")]),_:1},8,["modelValue"]),a(b)==="password"?(h(),E(S,{key:0,type:"primary",underline:!1,onClick:e[5]||(e[5]=t=>_.value="reset")},{default:o(()=>[m(" 忘记密码了? ")]),_:1})):O("",!0)])]),_:1})]),u("div",Qe,[l(Z,{modelValue:a(i).remember,"onUpdate:modelValue":e[6]||(e[6]=t=>a(i).remember=t),tabindex:"4"},{default:o(()=>[m(" 保持登录 ")]),_:1},8,["modelValue"])]),l(R,{loading:a(w),type:"primary",size:"large",style:{width:"100%"},onClick:G(L,["prevent"]),tabindex:"5"},{default:o(()=>[m(V(a(f)("app.login")),1)]),_:1},8,["loading"]),u("div",We,[Xe,l(S,{type:"primary",underline:!1,onClick:e[7]||(e[7]=t=>_.value="register")},{default:o(()=>[m(" 立即注册 ")]),_:1})])]),_:1},8,["model","rules"]),[[K,a(_)==="login"]]),D(l(M,{ref_key:"registerFormRef",ref:z,model:a(n),rules:a(ce),class:"login-form","auto-complete":"on"},{default:o(()=>[u("div",null,[l(p,{prop:"account"},{default:o(()=>[l(c,{modelValue:a(n).account,"onUpdate:modelValue":e[8]||(e[8]=t=>a(n).account=t),placeholder:"用户名",tabindex:"1"},{prefix:o(()=>[l(s,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue"])]),_:1}),l(p,{prop:"type"},{default:o(()=>[l(Ve,{modelValue:a(n).type,"onUpdate:modelValue":e[9]||(e[9]=t=>a(n).type=t),placeholder:"国家",clearable:"",filterable:"",tabindex:"2"},{prefix:o(()=>[l(s,{name:"i-mdi:format-list-bulleted-type"})]),default:o(()=>[(h(!0),X(Ne,null,$e(a(H),t=>(h(),E(we,{label:t.chineseName,value:t.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),a(n).type==="343"?(h(),E(p,{key:0,prop:"phoneNumber"},{default:o(()=>[l(c,{modelValue:a(n).phoneNumber,"onUpdate:modelValue":e[10]||(e[10]=t=>a(n).phoneNumber=t),placeholder:"手机号",tabindex:"3"},{prefix:o(()=>[l(s,{name:"i-ant-design:phone-outlined"})]),_:1},8,["modelValue"])]),_:1})):(h(),E(p,{key:1,prop:"email"},{default:o(()=>[l(c,{modelValue:a(n).email,"onUpdate:modelValue":e[11]||(e[11]=t=>a(n).email=t),placeholder:"邮箱",tabindex:"3"},{prefix:o(()=>[l(s,{name:"i-mdi:email"})]),_:1},8,["modelValue"])]),_:1})),l(p,{prop:"code"},{default:o(()=>[l(c,{modelValue:a(n).code,"onUpdate:modelValue":e[12]||(e[12]=t=>a(n).code=t),placeholder:"验证码",tabindex:"4"},{prefix:o(()=>[l(s,{name:"i-ic:baseline-verified-user"})]),append:o(()=>[l(R,{disabled:a($),onClick:ge},{default:o(()=>[m(V(a(N)),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),l(p,{prop:"password"},{default:o(()=>[l(c,{modelValue:a(n).password,"onUpdate:modelValue":e[13]||(e[13]=t=>a(n).password=t),type:"password",placeholder:"密码",tabindex:"5","show-password":""},{prefix:o(()=>[l(s,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue"])]),_:1}),l(p,{prop:"agreeToTheAgreement"},{default:o(()=>[u("div",Ye,[l(Z,{modelValue:a(n).agreeToTheAgreement,"onUpdate:modelValue":e[14]||(e[14]=t=>a(n).agreeToTheAgreement=t),tabindex:"6"},{default:o(()=>[m(" 我已阅读并同意《xxxx协议》 ")]),_:1},8,["modelValue"])])]),_:1})]),l(R,{tabindex:"7",loading:a(w),type:"primary",size:"large",style:{width:"100%","margin-top":"20px"},onClick:G(ve,["prevent"])},{default:o(()=>[m(" 注册 ")]),_:1},8,["loading"]),u("div",ea,[aa,l(S,{type:"primary",underline:!1,onClick:e[15]||(e[15]=t=>_.value="login")},{default:o(()=>[m(" 去登录 ")]),_:1})])]),_:1},8,["model","rules"]),[[K,a(_)==="register"]]),D(l(M,{ref_key:"resetFormRef",ref:B,model:a(x),rules:a(_e),class:"login-form"},{default:o(()=>[la,u("div",null,[l(p,{prop:"account"},{default:o(()=>[l(c,{modelValue:a(x).account,"onUpdate:modelValue":e[16]||(e[16]=t=>a(x).account=t),placeholder:a(f)("app.account"),type:"text",tabindex:"1"},{prefix:o(()=>[l(s,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1}),l(p,{prop:"code"},{default:o(()=>[l(c,{modelValue:a(x).code,"onUpdate:modelValue":e[17]||(e[17]=t=>a(x).code=t),placeholder:a(f)("app.code"),type:"text",tabindex:"2"},{prefix:o(()=>[l(s,{name:"i-ic:baseline-verified-user"})]),append:o(()=>[l(R,null,{default:o(()=>[m(V(a(f)("app.sendCaptcha")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),l(p,{prop:"newPassword"},{default:o(()=>[l(c,{modelValue:a(x).newPassword,"onUpdate:modelValue":e[18]||(e[18]=t=>a(x).newPassword=t),type:"password",placeholder:a(f)("app.newPassword"),tabindex:"3","show-password":""},{prefix:o(()=>[l(s,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1})]),l(R,{loading:a(w),type:"primary",size:"large",style:{width:"100%","margin-top":"20px"},onClick:G(be,["prevent"])},{default:o(()=>[m(V(a(f)("app.check")),1)]),_:1},8,["loading"]),u("div",oa,[l(S,{type:"primary",underline:!1,onClick:e[19]||(e[19]=t=>_.value="login")},{default:o(()=>[m(V(a(f)("app.goLogin")),1)]),_:1})])]),_:1},8,["model","rules"]),[[K,a(_)==="reset"]])]),l(Ze)])}}});typeof ee=="function"&&ee(le);const ma=Be(le,[["__scopeId","data-v-6ce64dd1"]]);export{ma as default};
