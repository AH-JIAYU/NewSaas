
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{s as x}from"./apiLoading-BjlhBv-U.js";import{a as u,ag as j,r as d,d as D,a5 as E,b as m,o as T,f as U,w as a,g as i,h as b,j as o,I as h,an as M,E as R,R as B}from"./index-DhOXgAfG.js";const g={list:e=>u.post("memberLevel/getMemberLevelList",e),create:e=>u.post("memberLevel/addMemberLevel",e),edit:e=>u.post("memberLevel/updateMemberLevel",e),delete:e=>u.post("memberLevel/deleteMemberLevel",e),getLevelNameList:e=>u.post("memberLevel/getMemberLevelNameList",e)},O=j("surveyVipLevel",()=>{const e=d(null);return{LevelNameList:e,getLevelNameList:async()=>{if(!e.value){const{data:p}=await g.getLevelNameList({});e.value=p.getMemberLevelNameInfoList}return e.value}}}),$=O,z=D({__name:"index",emits:["queryData"],setup(e,{expose:N,emit:p}){const S=$(),I=p,n=d(!1),f=d(""),l=d(),L=d(),k=E({levelName:[{required:!0,message:"请输入名称",trigger:"blur"}],additionRatio:[{required:!0,message:"请输入比例",trigger:"blur"}]});async function w(s){if(!s)f.value="新增",l.value={};else if(f.value="编辑",s.memberId){const t=M(s),{additionRatio:v,memberLevelId:c,memberLevelName:_}=t;l.value={additionRatio:v,memberLevelId:c,levelName:_}}else l.value=M(s);n.value=!0}function V(){L.value.resetFields(),n.value=!1}function C(){L.value.validate(async s=>{if(s){if(l.value.memberLevelId){const{status:t}=await x(g.edit(l.value));t===1&&R.success({message:"编辑成功",center:!0})}else{const{status:t}=await x(g.create(l.value));t===1&&R.success({message:"新增成功",center:!0})}S.LevelNameList=null,I("queryData"),V()}})}return N({showEdit:w}),(s,t)=>{const v=m("el-input"),c=m("el-form-item"),_=m("el-form"),y=m("el-button"),q=m("el-dialog");return T(),U(q,{modelValue:o(n),"onUpdate:modelValue":t[2]||(t[2]=r=>h(n)?n.value=r:null),title:o(f),width:"600"},{footer:a(()=>[i(y,{onClick:V},{default:a(()=>[b(" 取消 ")]),_:1}),i(y,{type:"primary",onClick:C},{default:a(()=>[b(" 确定 ")]),_:1})]),default:a(()=>[i(_,{ref_key:"formRef",ref:L,model:o(l),rules:o(k),"label-width":"7rem",inline:!1},{default:a(()=>[i(c,{label:"等级名称",prop:"levelName"},{default:a(()=>[i(v,{modelValue:o(l).levelName,"onUpdate:modelValue":t[0]||(t[0]=r=>o(l).levelName=r),maxlength:"100"},null,8,["modelValue"])]),_:1}),i(c,{label:"价格比例",prop:"additionRatio"},{default:a(()=>[i(v,{modelValue:o(l).additionRatio,"onUpdate:modelValue":t[1]||(t[1]=r=>o(l).additionRatio=r),modelModifiers:{number:!0},min:1,max:100,oninput:"if(value>100)value=100;if(value.length>4)value=value.slice(0,4);if(value<0)value=0;",type:"number"},{append:a(()=>[b(" % ")]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),F=B(z,[["__scopeId","data-v-3312d10a"]]),G=Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}));export{g as a,G as i,$ as u,F as v};
