
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as R}from"./department-htT9pOTR.js";import{d as j,r as _,a as s,o as m,b as g,f as p,w as l,g as v,i as n,e as y,F,t as z,z as P,j as q,A as G,p as H}from"./index-ChQqcNbm.js";const Q=j({__name:"index",emits:["userData"],setup(J,{expose:x,emit:C}){const d=_(!1),o=_([]),h=_([]),k=_(),a=_({type:1,tenantStaffList:[],roleList:[]}),L={children:"children",label:"name"};async function N(e){await V(),d.value=!0,o.value=[];const t=await R.list({name:""});t.data&&(h.value=t.data)}const V=async()=>{const e=await H.getTenantStaffList();a.value.tenantStaffList=e.data};function w(){d.value=!1,o.value=k.value.getCheckedKeys(!1)}const S=(e,t)=>{t?(k.value.getCheckedKeys().forEach(c=>{c!==e.id&&k.value.setChecked(c,!1)}),o.value=[e.id]):o.value=o.value.filter(r=>r!==e.id)},D=()=>{},U=e=>{Array.isArray(e)&&e.length>1&&(a.value.roleList=[e[e.length-1]])};x({showEdit:N});const K=C;function T(){let e="",t="";a.value.roleList[0]&&(e=a.value.tenantStaffList.find(i=>i.id===a.value.roleList[0]).userName),o.value[0]&&(t=h.value.find(i=>i.id===o.value[0]).name);let r={chargeUserId:a.value.roleList[0],chargeUserName:e,departmentId:o.value[0],departmentName:t};d.value=!1,K("userData",r)}return(e,t)=>{const r=s("el-tree"),c=s("el-text"),i=s("el-tab-pane"),A=s("el-checkbox"),B=s("el-checkbox-group"),E=s("el-tabs"),b=s("el-button"),I=s("el-dialog");return m(),g("div",null,[p(I,{modelValue:n(d),"onUpdate:modelValue":t[2]||(t[2]=u=>G(d)?d.value=u:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:"请选择负责部门/人"},{footer:l(()=>[p(b,{onClick:w},{default:l(()=>[v(" 关闭 ")]),_:1}),p(b,{type:"primary",onClick:T},{default:l(()=>[v(" 确认 ")]),_:1})]),default:l(()=>[p(E,{modelValue:n(a).type,"onUpdate:modelValue":t[1]||(t[1]=u=>n(a).type=u),onTabChange:D},{default:l(()=>[p(i,{label:"部门",name:1},{default:l(()=>[n(h).length>0?(m(),y(r,{key:0,style:{"max-width":"600px"},ref_key:"treeRef",ref:k,disabled:!0,data:n(h),"show-checkbox":"","check-strictly":"","node-key":"id","default-expanded-keys":[],"default-checked-keys":n(o),"default-expand-all":"",props:L,onCheckChange:S},null,8,["data","default-checked-keys"])):(m(),y(c,{key:1},{default:l(()=>[v("暂无数据")]),_:1}))]),_:1}),p(i,{label:"员工",name:2},{default:l(()=>{var u;return[(u=n(a).tenantStaffList)!=null&&u.length?(m(),y(B,{key:0,onChange:U,modelValue:n(a).roleList,"onUpdate:modelValue":t[0]||(t[0]=f=>n(a).roleList=f)},{default:l(()=>[(m(!0),g(F,null,z(n(a).tenantStaffList,f=>(m(),y(A,{key:f.id,value:f.id,label:f.userName},{default:l(()=>[v(P(f.userName),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])):q("",!0)]}),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}});export{Q as _};
