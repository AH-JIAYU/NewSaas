
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as oe,aN as ne,r as s,n as se,$ as T,a as i,q as $,o as r,b as ie,f as n,w as l,s as L,e as d,g as f,i as t,A as m,aM as re,y as S,z as N,j as w,N as ue,aO as ce,E as de,ba as pe,bb as me,_ as fe,an as _e,L as ge}from"./index-DmuEaMIU.js";import{_ as be}from"./index.vue_vue_type_style_index_0_lang-D6W_S0km.js";import{s as ve}from"./apiLoading-IftGBdUh.js";import{S as he}from"./sortable.esm-C0-Qcoum.js";import ye from"./index-DZqBUSON.js";import{u as ke,a as P}from"./survey_vipLevel-Dx-adTsM.js";const Ce={class:"tableBig"},Le={class:"fontC-System"},we={style:{display:"inline-block"},class:"fontC-System"},ze=oe({name:"vipLevel",__name:"index",setup(Ee){const Q=ke(),{pagination:u,getParams:A,onSizeChange:B,onCurrentChange:H}=ne(),_=s(!1),z=s(),D=s([]),c=s([]),g=s(!1),b=s(!1),v=s("default"),h=s(!1),R=s(),y=s([{label:"等级名称",prop:"levelName",sortable:!0,disableCheck:!1,checked:!0},{label:"价格比例%",prop:"additionRatio",sortable:!0,checked:!0},{label:"成员数量",prop:"memberQuantity",sortable:!0,checked:!0}]);function U(){z.value.showEdit()}function V(o){z.value.showEdit(o)}function I(o){ce.confirm("您确定要删除当前项吗?","确认信息").then(async()=>{const{status:a}=await ve(P.delete({memberLevelId:o.memberLevelId}));a===1&&de.success({message:"删除成功",center:!0}),Q.LevelNameList=null,E()}).catch(()=>{})}function E(){u.value.page=1,k()}function q(o){B(o).then(()=>k())}function F(o=1){H(o).then(()=>k())}async function k(){try{_.value=!0;const o={...A()},{data:a}=await P.list(o);D.value=a.getMemberLevelInfoList,u.value.total=a.total,_.value=!1}catch{}finally{_.value=!1}}function M(){const o=R.value.$el.querySelector(".el-table__body-wrapper tbody");he.create(o,{handle:".sortable",animation:300,ghostClass:"ghost",onEnd:({newIndex:a,oldIndex:p})=>{a===void 0||p===void 0||T(()=>M())}})}return se(()=>{y.value.forEach(o=>{o.checked&&c.value.push(o.prop)}),k(),T(()=>{M()})}),(o,a)=>{const p=i("el-button"),j=be,O=pe,G=me,J=i("el-row"),K=fe,W=i("ElTag"),X=i("ElTableColumn"),C=i("el-table-column"),Y=i("el-empty"),Z=i("el-table"),ee=i("ElPagination"),te=_e,x=$("auth"),ae=$("loading");return r(),ie("div",{class:ue({"absolute-container":t(h)})},[n(te,null,{default:l(()=>[n(J,null,{default:l(()=>[n(j,null,{default:l(()=>[L((r(),d(p,{size:"default",type:"primary",onClick:U},{default:l(()=>[f(" 新增 ")]),_:1})),[[x,"vipLevel-get-addMemberLevel"]])]),_:1}),n(G,null,{default:l(()=>[n(p,{size:"default"},{default:l(()=>[f(" 导出 ")]),_:1}),n(O,{border:t(g),"onUpdate:border":a[0]||(a[0]=e=>m(g)?g.value=e:null),tableAutoHeight:t(h),"onUpdate:tableAutoHeight":a[1]||(a[1]=e=>m(h)?h.value=e:null),checkList:t(c),"onUpdate:checkList":a[2]||(a[2]=e=>m(c)?c.value=e:null),columns:t(y),"onUpdate:columns":a[3]||(a[3]=e=>m(y)?y.value=e:null),"line-height":t(v),"onUpdate:lineHeight":a[4]||(a[4]=e=>m(v)?v.value=e:null),stripe:t(b),"onUpdate:stripe":a[5]||(a[5]=e=>m(b)?b.value=e:null),style:{"margin-left":"12px"},onQueryData:E},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),L((r(),d(Z,{ref_key:"elTableRef",ref:R,"row-key":"id",border:t(g),data:t(D),size:t(v),stripe:t(b),fit:""},{empty:l(()=>[n(Y,{image:t(re),"image-size":300},null,8,["image"])]),default:l(()=>[n(X,{width:"80",align:"left",fixed:""},{header:l(()=>[f(" 排序 ")]),default:l(()=>[n(W,{type:"info",class:"w"},{default:l(()=>[n(K,{name:"i-ep:d-caret"})]),_:1})]),_:1}),t(c).includes("levelName")?(r(),d(C,{key:0,align:"left",prop:"levelName","show-overflow-tooltip":"",label:"等级名称"},{default:l(({row:e})=>[S("p",Ce,N(e.levelName),1)]),_:1})):w("",!0),t(c).includes("additionRatio")?(r(),d(C,{key:1,align:"left",prop:"additionRatio","show-overflow-tooltip":"",label:"价格比例"},{default:l(({row:e})=>[S("p",Le,N(e.additionRatio)+"%",1)]),_:1})):w("",!0),t(c).includes("memberQuantity")?(r(),d(C,{key:2,align:"left",prop:"memberQuantity","show-overflow-tooltip":"",label:"成员数量"},{default:l(({row:e})=>[S("span",we,N(e.memberQuantity?e.memberQuantity:0),1)]),_:1})):w("",!0),n(C,{align:"left",fixed:"right","show-overflow-tooltip":"",label:"操作"},{default:l(({row:e})=>[L((r(),d(p,{size:"small",plain:"",type:"primary",onClick:le=>V(e)},{default:l(()=>[f(" 编辑 ")]),_:2},1032,["onClick"])),[[x,"vipLevel-update-updateMemberLevel"]]),e.isDelete===1?L((r(),d(p,{key:0,size:"small",plain:"",type:"danger",onClick:le=>I(e)},{default:l(()=>[f(" 删除 ")]),_:2},1032,["onClick"])),[[x,"vipLevel-delete-deleteMemberLevel"]]):w("",!0)]),_:1})]),_:1},8,["border","data","size","stripe"])),[[ae,t(_)]]),n(ee,{"current-page":t(u).page,total:t(u).total,"page-size":t(u).size,"page-sizes":t(u).sizes,layout:t(u).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:q,onCurrentChange:F},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),n(ye,{ref_key:"EditRef",ref:z,onQueryData:E},null,512)],2)}}}),Te=ge(ze,[["__scopeId","data-v-5ab66abd"]]);export{Te as default};
