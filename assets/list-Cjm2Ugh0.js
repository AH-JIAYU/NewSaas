
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{ad as C,d as B,r as p,o as R,a2 as u,al as N,a3 as U,a as $,i as D,f as t,w as a,b as I,g as k,c as T,ai as v,_ as z,ao as L,y as W}from"./index-tHSAnviy.js";import"./clipboard-D6WZs60U.js";const M={list:()=>C.post("member-config/getMemberConfig"),create:c=>C.post("member-config/insertMemberConfig",c),edit:c=>C.post("member-config/updateMemberConfig",c)},Z={class:"domainName"},j=B({name:"setting",__name:"list",setup(c){const q=p("基本设置"),n=p(!1),m=p(),e=p({webName:"",keyWords:"",registerOffOrOn:!0,registerExamineOffOrOn:!1,priceProportion:null,taxPointsProportion:null,minimumAmount:null,fixedPrice:null,externalSite:"",phone:"",email:"",qqCode:"",address:""}),_=p({webName:[{required:!0,message:"请输入网站名称",trigger:"blur"}],memberURL:[{required:!0,message:"请输入会员网址",trigger:"blur"}],phone:[{required:!1,trigger:"blur",message:"请输入手机号"},{validator:(s,l,i)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(e.value.phone)?i():i(new Error("请输入合法手机号"))},trigger:"blur"}],email:[{required:!1,trigger:"blur",message:"请输入邮箱"},{validator:(s,l,i)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.value.email)?i():i(new Error("请输入合法邮箱"))},trigger:"blur"}]});R(()=>{g()});async function g(){try{n.value=!0;const{data:s}=await M.list();e.value=s||e.value,e.value.minimumAmount===0&&(e.value.minimumAmount=null),n.value=!1}catch{}finally{n.value=!1}}function S(){if(e.value.email===""&&(_.value.email=[],m.value.clearValidate("email")),e.value.phone===""&&(_.value.phone=[],m.value.clearValidate("phone")),e.value.minimumAmount&&!/^\d*$/.test(e.value.minimumAmount)){v.warning("请输入有效的数字");return}if(e.value.taxPointsProportion&&!/^\d*$/.test(e.value.taxPointsProportion)){v.warning("请输入有效的数字");return}e.value.id?m.value&&m.value.validate(s=>{if(s)try{let{id:l,keyWords:i,registerExamineOffOrOn:r,registerOffOrOn:d,webName:b,priceProportion:x,taxPointsProportion:f,minimumAmount:P,fixedPrice:O,externalSite:V,phone:h,email:w,qqCode:y,address:E}=e.value;const A={id:l,keyWords:i,registerExamineOffOrOn:r,registerOffOrOn:d,webName:b,priceProportion:x,taxPointsProportion:f,minimumAmount:P,fixedPrice:O,externalSite:V,phone:h,email:w,qqCode:y,address:E};n.value=!0,M.edit(A).then(o=>{n.value=!1,o.status===1&&(g(),v.success({message:"修改成功",center:!0}))})}catch{}finally{n.value=!1}}):m.value&&m.value.validate(s=>{if(s)try{n.value=!0,M.create(e.value).then(()=>{n.value=!1,g(),v.success({message:"新增成功",center:!0})})}catch{}finally{n.value=!1}})}return(s,l)=>{const i=u("el-switch"),r=u("el-form-item"),d=u("el-col"),b=z,x=u("el-tooltip"),f=u("el-input"),P=u("el-row"),O=u("el-button"),V=u("el-tab-pane"),h=u("el-form"),w=u("el-tabs"),y=L,E=N("auth"),A=N("loading");return U(($(),D("div",null,[t(y,null,{default:a(()=>[t(w,{modelValue:q.value,"onUpdate:modelValue":l[5]||(l[5]=o=>q.value=o)},{default:a(()=>[t(h,{ref_key:"formRef",ref:m,model:e.value,rules:_.value,"label-position":"right","label-width":"140px",style:{width:"500px"}},{default:a(()=>[t(V,{label:"基础设置",name:"基本设置"},{default:a(()=>[t(P,{gutter:20},{default:a(()=>[t(d,{span:7},{default:a(()=>[t(r,{label:"注册开关"},{default:a(()=>[t(i,{modelValue:e.value.registerOffOrOn,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value.registerOffOrOn=o),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),t(d,{span:6},{default:a(()=>[t(r,{label:"注册审核"},{default:a(()=>[t(i,{modelValue:e.value.registerExamineOffOrOn,"onUpdate:modelValue":l[1]||(l[1]=o=>e.value.registerExamineOffOrOn=o),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),t(d,{span:24},{default:a(()=>[t(r,{label:"最低结算金额",prop:"minimumAmount"},{default:a(()=>[I("div",Z,[t(x,{class:"tooltips",content:"针对会员结算金额的配置",placement:"top"},{default:a(()=>[t(b,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})]),t(f,{modelValue:e.value.minimumAmount,"onUpdate:modelValue":l[2]||(l[2]=o=>e.value.minimumAmount=o),modelModifiers:{number:!0},style:{width:"18rem"},placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),t(d,{span:24},{default:a(()=>[t(r,{label:"会员税点",prop:"taxPointsProportion"},{default:a(()=>[t(f,{modelValue:e.value.taxPointsProportion,"onUpdate:modelValue":l[3]||(l[3]=o=>e.value.taxPointsProportion=o),modelModifiers:{number:!0},style:{width:"18rem"},placeholder:""},{append:a(()=>[k("%")]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(d,{span:24},{default:a(()=>[t(r,{label:"调查限价",prop:"confirmPassword"},{default:a(()=>[t(f,{modelValue:e.value.fixedPrice,"onUpdate:modelValue":l[4]||(l[4]=o=>e.value.fixedPrice=o),modelModifiers:{number:!0},style:{width:"18rem"},placeholder:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(r,null,{default:a(()=>[U(($(),T(O,{type:"primary",onClick:S},{default:a(()=>[k(" 确认 ")]),_:1})),[[E,["setting-insert-insertMemberConfig","setting-update-updateMemberConfig"]]])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]),_:1})])),[[A,n.value]])}}}),K=W(j,[["__scopeId","data-v-a996778e"]]);export{K as default};
