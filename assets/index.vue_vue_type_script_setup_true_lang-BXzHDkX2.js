
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as E}from"./survey_vip-BCb20ln7.js";import{d as N,r as o,a as d,q as S,s as w,o as B,b as M,f as l,w as t,g as s,z as R,y as V,E as C}from"./index-B--K0VXZ.js";const J=N({__name:"index",emits:["fetch-data"],setup(U,{expose:T,emit:x}){const I=x,m=o(!1),p=o(!1),y=o(),_=o(""),b=o(),a=o({memberId:null,operationType:null,type:null,difference:null,remark:""}),$=o({difference:[{required:!0,message:"请输入金额",trigger:"blur"},{pattern:/^(?!0(\.0+)?$)(\d+(\.\d{1,2})?)$/,message:"请输入有效的正数，且最多两位小数",trigger:"blur"}],remark:[{required:!0,message:"请输入说明",trigger:"blur"}],operationType:[{required:!0,message:"请选择加减款",trigger:"change"}],type:[{required:!0,message:"请选择类型",trigger:"change"}]});async function q(r){m.value=!0,r?(_.value="编辑",b.value=JSON.parse(r),a.value.memberId=b.value.memberId):_.value="新增"}async function z(){y.value&&y.value.validate(async r=>{if(r)try{p.value=!0,(await E.getMemberPlusMinusPaymentsList(a.value)).status===1?(p.value=!1,I("fetch-data"),C.success({message:"操作成功",center:!0}),g()):C.warning({message:"出现错误请联系管理人员",center:!0})}catch{}finally{p.value=!1}})}const f=o(null),c=o(null),v=(r,e)=>{e&&(r==="加款"||r==="减款"?(f.value=e,a.value.operationType=e):(r==="待审金额"||r==="可用金额")&&(c.value=e,a.value.type=e))};function g(){Object.assign(a.value,{memberId:null,operationType:null,type:null,difference:null,remark:""}),f.value=null,c.value=null,m.value=!1}return T({showEdit:q}),(r,e)=>{const i=d("el-form-item"),u=d("el-button"),k=d("el-input"),D=d("el-form"),P=d("el-dialog"),j=S("loading");return w((B(),M("div",null,[l(P,{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=n=>m.value=n),title:"加减款","append-to-body":"","close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"35%",onClose:g},{footer:t(()=>[l(u,{onClick:g},{default:t(()=>[s(" 取消 ")]),_:1}),l(u,{type:"primary",onClick:z},{default:t(()=>[s(" 确定 ")]),_:1})]),default:t(()=>[l(D,{model:a.value,rules:$.value,ref_key:"formRef",ref:y,"label-width":"5rem",inline:!1},{default:t(()=>[l(i,{label:"会员ID"},{default:t(()=>[s(R(a.value.memberId),1)]),_:1}),l(i,{label:"加减款",prop:"operationType"},{default:t(()=>[V("div",null,[l(u,{type:f.value===1?"primary":"",size:"small",onClick:e[0]||(e[0]=n=>v("加款",1))},{default:t(()=>[s("加款 ")]),_:1},8,["type"]),l(u,{type:f.value===2?"primary":"",size:"small",onClick:e[1]||(e[1]=n=>v("减款",2))},{default:t(()=>[s("减款")]),_:1},8,["type"])])]),_:1}),l(i,{label:"类型",prop:"type"},{default:t(()=>[V("div",null,[l(u,{type:c.value===1?"primary":"",size:"small",onClick:e[2]||(e[2]=n=>v("待审金额",1))},{default:t(()=>[s("待审金额 ")]),_:1},8,["type"]),l(u,{type:c.value===2?"primary":"",size:"small",onClick:e[3]||(e[3]=n=>v("可用金额",2))},{default:t(()=>[s("可用金额")]),_:1},8,["type"])])]),_:1}),l(i,{label:"金额",prop:"difference"},{default:t(()=>[l(k,{modelValue:a.value.difference,"onUpdate:modelValue":e[4]||(e[4]=n=>a.value.difference=n)},null,8,["modelValue"])]),_:1}),l(i,{label:"说明",prop:"remark"},{default:t(()=>[l(k,{modelValue:a.value.remark,"onUpdate:modelValue":e[5]||(e[5]=n=>a.value.remark=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])),[[j,p.value]])}}});export{J as _};
