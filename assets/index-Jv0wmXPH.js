
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as L,r as d,k as R,n as D,l as M,E as b,a as i,p as B,q as p,i as a,o as g,b as V,f as o,w as s,F as I,t as A,aq as w,g as J,R as O}from"./index-DX1UQaE6.js";import{a as y}from"./department-CUEblEEO.js";const P=L({__name:"index",props:["id","row"],setup(x,{expose:S}){const f=x,k=[{label:"完成计提",value:1},{label:"审核计提",value:2},{label:"收款计提",value:3}],T=d([]),n=d(!1),u=d(),e=d({id:f.id,name:"",remark:"",commissionStatus:null,commission:null,commissionType:null});d(!1);const v=d({name:[{required:!0,message:"请输入部门名称",trigger:"blur"}],director:[{required:!0,message:"请选择部门主管",trigger:"change"}],commission:[{required:!1,message:"请输入提成比例",trigger:"blur"},{validator:(m,l,r)=>{l?/^\d+(\.\d+)?$/.test(l)?r():r(new Error("请输入有效的数字")):r(new Error("请输入数字"))},trigger:"blur"}]});R(()=>{u.value.resetFields(),D(async()=>{const{data:m}=await M.getTenantStaffList();T.value=m}),e.value.commissionStatus!==1&&(v.value.commission=[]),e.value.id!==""&&E()});function E(){n.value=!0,e.value=JSON.parse(f.row),n.value=!1}return S({submit(){return new Promise(m=>{try{e.value.id===""?u.value&&u.value.validate(l=>{if(l)try{delete e.value.memberCount,n.value=!0,y.create(e.value).then(()=>{n.value=!1,b.success({message:"新增成功",center:!0}),m()})}catch{}finally{n.value=!1}}):u.value&&u.value.validate(l=>{if(l)try{n.value=!0,delete e.value.memberCount,y.edit(e.value).then(()=>{n.value=!1,b.success({message:"编辑成功",center:!0}),m()})}catch{}finally{n.value=!1}})}catch{}finally{setTimeout(()=>{n.value=!1},1e3)}})}}),(m,l)=>{const r=i("el-input"),c=i("el-form-item"),h=i("el-switch"),_=i("el-col"),C=i("el-option"),F=i("el-select"),q=i("el-row"),N=i("ElForm"),U=B("loading");return p((g(),V("div",null,[o(N,{ref_key:"formRef",ref:u,model:a(e),rules:a(v),"label-width":"130px"},{default:s(()=>[o(c,{label:"部门名称",prop:"name"},{default:s(()=>[o(r,{modelValue:a(e).name,"onUpdate:modelValue":l[0]||(l[0]=t=>a(e).name=t),placeholder:"请输入部门名称",clearable:"",onChange:l[1]||(l[1]=()=>{})},null,8,["modelValue"])]),_:1}),o(q,{style:{"margin-bottom":"0px"},gutter:20},{default:s(()=>[o(_,{span:8},{default:s(()=>[o(c,{label:"部门提成",prop:"commissionStatus"},{default:s(()=>[o(h,{modelValue:a(e).commissionStatus,"onUpdate:modelValue":l[2]||(l[2]=t=>a(e).commissionStatus=t),"active-text":"启用","inactive-text":"禁用","inline-prompt":"","active-value":1,"inactive-value":2},null,8,["modelValue"])]),_:1})]),_:1}),o(_,{span:16},{default:s(()=>[p(o(c,{label:"提成发放规则",prop:"commissionType"},{default:s(()=>[o(F,{modelValue:a(e).commissionType,"onUpdate:modelValue":l[3]||(l[3]=t=>a(e).commissionType=t),"value-key":"",placeholder:"请选择发放提成方式",clearable:"",filterable:""},{default:s(()=>[(g(),V(I,null,A(k,t=>o(C,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},512),[[w,a(e).commissionStatus===1]])]),_:1})]),_:1}),p(o(c,{label:"提成比例",prop:"commission"},{default:s(()=>[o(r,{modelValue:a(e).commission,"onUpdate:modelValue":l[4]||(l[4]=t=>a(e).commission=t),modelModifiers:{number:!0},placeholder:"请输入提成比例",clearable:""},{append:s(()=>[J("%")]),_:1},8,["modelValue"])]),_:1},512),[[w,a(e).commissionStatus===1]]),o(c,{label:"备注"},{default:s(()=>[o(r,{modelValue:a(e).remark,"onUpdate:modelValue":l[5]||(l[5]=t=>a(e).remark=t),type:"textarea",rows:10,placeholder:"请输入备注",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])),[[U,a(n)]])}}}),G=O(P,[["__scopeId","data-v-4be4d66b"]]);export{G as default};
