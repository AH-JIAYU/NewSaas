
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as Ne}from"./index-DzoAcoNn.js";import{_ as Ee}from"./index-DF98WrSU.js";import{d as He,aN as ze,r as u,l as xe,n as O,W as $,a as f,q as Be,o as s,b as S,y as c,f as i,w as l,g as h,ay as $e,s as H,e as v,z as b,F as J,t as Me,j as m,ax as M,aG as K,i as Te,aM as Ue,N as Fe,aO as T,E as U,p as j,_ as Ge,aH as Pe,aI as Re,L as Ze,am as q}from"./index-DqfN6Hiv.js";import{a as F}from"./department-BkCuPfBf.js";import{u as Ae,D as Oe}from"./index-CRBYLbOg.js";import{u as Je}from"./position_manage-CspGNv4n.js";import Ke from"./index-3b9dWeH9.js";import je from"./index-CgUaeDs0.js";import qe from"./index-BGtLIMxW.js";import We from"./index-DX9KziWE.js";import{columns as Qe}from"./index-CSZAlWE8.js";import"./index-D4MRPrDW.js";import"./clipboard-CVO6W9vT.js";import"./tenant_role-mPZUyBL3.js";import"./configuration_role-DCSGJY9n.js";import"./configuration_manager-mfCmQbcb.js";import"./position_manage-CLv44aAt.js";import"./tenantDictionary-AIDRS9CM.js";const W=V=>(Pe("data-v-39beff1d"),V=V(),Re(),V),Xe={class:"absolute-container"},Ye={class:"page-main"},ea={class:"custom-tree-node"},aa=["title"],ta={class:"code"},la={key:0,style:{"margin-right":"0.3rem"}},ia={class:"actions"},oa={class:"dictionary-container"},na={class:"copyId tableSmall"},sa={class:"id oneLine idFont"},ra={style:{display:"flex","align-items":"center"}},ua={key:0,xmlns:"http://www.w3.org/2000/svg",style:{"margin-top":"2px","margin-right":"7px"},width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},da=W(()=>c("g",{id:"Group 18384"},[c("circle",{id:"Ellipse 105",cx:"10",cy:"10",r:"10",fill:"#F8BB4F"}),c("path",{id:"ç®¡",d:"M13.9946 9.3605V12.1892H7.43481V12.9031H14.6277V16.4995H13.3481V16.0146H7.43481V16.486H6.15517V9.3605H13.9946ZM7.43481 14.8831H13.3481V13.9133H7.43481V14.8831ZM7.43481 11.1655H12.7419V10.3842H7.43481V11.1655ZM15.8534 7.67677V10.2495H14.6008V8.75436H5.52209V10.2495H4.2694V7.67677H9.48222C9.37446 7.40738 9.25323 7.16492 9.13201 6.9494L10.2635 6.76083L10.0345 6.61266C10.6541 5.80447 11.1121 4.9424 11.3815 4.01298L12.6072 4.28238C12.5264 4.51136 12.4591 4.72688 12.3782 4.9424H16.1228V6.06039H13.9273C14.1428 6.35673 14.3179 6.65307 14.4661 6.92246L13.3346 7.34003C13.1191 6.90899 12.8631 6.47796 12.5668 6.06039H11.8799C11.6509 6.5049 11.3949 6.92246 11.1121 7.29962L10.4655 6.88206C10.5733 7.12451 10.6676 7.39391 10.7753 7.67677H15.8534ZM6.08782 6.06039C5.79149 6.54531 5.46821 7.00328 5.118 7.42085L4 6.72042C4.78125 5.88529 5.33351 4.96934 5.67026 3.99951L6.89601 4.26891C6.81519 4.4979 6.72091 4.72688 6.64009 4.9424H10.0345V6.06039H8.01401C8.25647 6.39714 8.47198 6.72042 8.63362 7.03022L7.46175 7.47473C7.23276 6.98981 6.97683 6.51837 6.6805 6.06039H6.08782Z",fill:"white"})],-1)),ca=[da],pa={class:"dictionary-container"},va=W(()=>c("div",{class:"empty"},"请在左侧新增或选择一个部门",-1)),ma=[va],Q=He({name:"department",__name:"list",setup(V){const{pagination:G,getParams:fa,onSizeChange:ga,onCurrentChange:ha,onSortChange:X}=ze(),z=Je(),Y=u(),ee=xe(),ae=u([]),x=Ae(),te=u(),D=u(!1),le=u(),P=u(),_=u({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),N=u(),ie=u(),o=u({loading:!1,tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],search:{page:1,limit:10,id:"",userName:"",active:null,departmentId:null},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}}),R=u(),n=u({search:{name:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:"",isClick:!1},row:"",loading:!1}),p=u({search:{name:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:"",name:""},row:"",loading:!1}),r=u({loading:!1,search:{organizationalStructureId:""},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}});async function C(){try{n.value.loading=!0;const e={...n.value.search},a=await F.list(e);a.data&&(n.value.tree=Z(a.data),n.value.loading=!1)}catch{}finally{n.value.loading=!1}}const Z=e=>(e.sort((a,d)=>{const E=new Date(a.createTime);return new Date(d.createTime)-E}),e.forEach(a=>{a.children&&a.children.length>0&&Z(a.children)}),e);O(()=>{C()}),$(()=>n.value.search,e=>{R.value.filter(e)});function oe(e,a){return e?a.label.includes(e):!0}function ne(e){n.value.currentData=e,n.value.dialog.parentId="",n.value.dialog.id="",n.value.dialog.visible=!0}function se(e){p.value.currentData=e,p.value.dialog.parentId=(e==null?void 0:e.id)??"",p.value.dialog.name=(e==null?void 0:e.name)??"",p.value.dialog.id="",p.value.dialog.visible=!0}function re(e,a){n.value.currentNode=e,n.value.currentData=a,n.value.row=JSON.stringify(a),n.value.dialog.parentId=e.parent.data.id??"",n.value.dialog.id=a.id,n.value.dialog.visible=!0,r.value.search.organizationalStructureId&&(n.value.dialog.isClick=!0)}function ue(e,a){T.confirm(`确认删除「${a.name}」吗？`,"确认信息").then(()=>{F.delete({id:a.id}).then(()=>{U.success({message:"删除成功",center:!0}),C()})})}function de(e){G.value.page=1,e.id&&(o.value.dialog.parentId=e.id),r.value.search.organizationalStructureId=e.id}$(()=>r.value.search.organizationalStructureId,()=>{k()});async function k(){N.value=null;try{D.value=!0;const e={...r.value.search},a=await F.itemlist(e);a.data&&(D.value=!1,o.value.dataList=a.data,r.value.dataList.forEach(d=>{d.enableLoading=!1}),G.value.total=a.data.length?a.data.length:0)}catch{}finally{D.value=!1}}O(async()=>{try{_.value.loading=!0,ae.value=await ee.getCountry(),te.value=await(x==null?void 0:x.getDepartment())||[],Y.value=await(z==null?void 0:z.getPositionManage())||[],Qe.forEach(e=>{e.checked&&o.value.checkList.push(e.prop)}),_.value.loading=!1}catch{}finally{_.value.loading=!1}}),$(()=>_.value.search,e=>{le.value.filter(e)});function ce(e){return new Promise(a=>{T.confirm(`确认${e.active?"禁用":"启用"}「${e.userName}」吗？`,"确认信息").then(()=>{try{_.value.loading=!0,j.edit({id:e.id,email:e.email,phoneNumber:e.phoneNumber,userName:e.userName,country:e.country,role:e.role,positionId:e.positionId,organizationalStructureId:e.organizationalStructureId,active:!e.active}).then(()=>(U.success({message:`${e.active?"禁用":"启用"}成功`,center:!0}),k(),_.value.loading=!1,a(!0))).catch(()=>(_.value.loading=!1,a(!1)))}catch{}finally{_.value.loading=!1}}).catch(()=>a(!1))})}function pe({prop:e,order:a}){X(e,a).then(()=>k())}function ve(e){o.value.dialog.id="",o.value.dialog.visible=!0,o.value.dialog.level=1}const me=e=>{N.value=e[0]};function fe(){if(N.value){const{userName:e,id:a}=N.value;T.confirm(`确认将「${e}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{j.reset({id:a}).then(()=>{U.success({message:"重置成功",center:!0}),k()})}).catch(()=>{})}}function ge(e){o.value.row=JSON.stringify(e),o.value.dialog.id=e.id,o.value.dialog.visible=!0}function he(e){P.value.showEdit(e)}const B=u();function _e(e){e?B.value=e.id:B.value=""}return(e,a)=>{const d=f("ElButton"),E=f("ElButtonGroup"),L=Ge,ye=f("ElInput"),be=f("ElTree"),Ce=f("ElScrollbar"),ke=f("ElSpace"),y=f("ElTableColumn"),Ie=f("ElSwitch"),Le=f("el-tooltip"),we=Ee,w=f("el-text"),Se=f("el-empty"),Ve=f("ElTable"),De=Ne,A=Be("loading");return s(),S("div",Xe,[c("div",Ye,[i(De,{"hide-left-side-toggle":""},{leftSide:l(()=>[i(E,{class:"btns"},{default:l(()=>[i(d,{type:"primary",class:"add",onClick:a[0]||(a[0]=t=>ne())},{default:l(()=>[h(" 新增部门 ")]),_:1})]),_:1}),i(ye,{modelValue:n.value.search.name,"onUpdate:modelValue":a[1]||(a[1]=t=>n.value.search.name=t),placeholder:"请输入关键词筛选",clearable:"",class:"search",onKeydown:$e(C,["enter"])},{append:l(()=>[i(d,{onClick:C},{default:l(()=>[i(L,{name:"i-ep:search"})]),_:1})]),_:1},8,["modelValue"]),i(Ce,{class:"tree"},{default:l(()=>[H((s(),v(be,{ref_key:"dictionaryRef",ref:R,data:n.value.tree,"filter-node-method":oe,"default-expand-all":"",onNodeClick:de},{default:l(({node:t,data:g})=>[c("div",ea,[c("div",{class:"label",title:t.label},b(g.name),9,aa),c("div",ta,[(s(!0),S(J,null,Me(g==null?void 0:g.organizationalStructurePersonList,I=>(s(),S(J,{key:I.userId},[I.enableChargePerson==1?(s(),S("span",la,b(I.userName),1)):m("",!0)],64))),128))]),c("div",ia,[i(E,null,{default:l(()=>[i(d,{type:"primary",plain:"",size:"default",onClick:M(I=>se(g),["stop"])},{icon:l(()=>[i(L,{name:"i-ep:plus"})]),_:2},1032,["onClick"]),i(d,{type:"info",plain:"",size:"default",onClick:M(I=>re(t,g),["stop"])},{icon:l(()=>[i(L,{name:"i-ep:edit"})]),_:2},1032,["onClick"]),i(d,{type:"danger",plain:"",size:"default",onClick:M(I=>ue(t,g),["stop"])},{icon:l(()=>[i(L,{name:"i-ep:delete"})]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])),[[A,n.value.loading]])]),_:1})]),default:l(()=>[H(c("div",oa,[i(ke,{wrap:""},{default:l(()=>[i(d,{type:"primary",onClick:a[2]||(a[2]=t=>ve())},{default:l(()=>[h(" 新增员工 ")]),_:1}),i(d,{onClick:fe},{default:l(()=>[h(" 重置密码 ")]),_:1})]),_:1}),H((s(),v(Ve,{ref_key:"userItemRef",ref:ie,data:o.value.dataList,border:o.value.border,size:o.value.lineHeight,stripe:o.value.stripe,"highlight-current-row":"",height:"100%",onSortChange:pe,onSelectionChange:a[3]||(a[3]=t=>o.value.selectionDataList=t),"row-key":"id","default-expand-all":"",onSelect:me,onCurrentChange:_e},{empty:l(()=>[i(Se,{image:Te(Ue),"image-size":300},null,8,["image"])]),default:l(()=>[i(y,{type:"selection",align:"left",fixed:""}),o.value.checkList.includes("active")?(s(),v(y,{key:0,align:"left",prop:"active",label:"状态"},{default:l(t=>[i(Ie,{modelValue:t.row.active,"onUpdate:modelValue":g=>t.row.active=g,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>ce(t.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1})):m("",!0),o.value.checkList.includes("id")?(s(),v(y,{key:1,align:"left",width:"180",prop:"id",label:"员工ID"},{default:l(({row:t})=>[c("div",na,[c("div",sa,[i(Le,{effect:"dark",content:t.id,placement:"top-start"},{default:l(()=>[h(b(t.id),1)]),_:2},1032,["content"])]),i(we,{content:t.id,class:Fe({rowCopy:"rowCopy",current:t.id===B.value})},null,8,["content","class"])])]),_:1})):m("",!0),o.value.checkList.includes("userName")?(s(),v(y,{key:2,align:"left",width:"160",prop:"userName",label:"用户名"},{default:l(({row:t})=>[c("div",ra,[t.enableChargePerson===1?(s(),S("svg",ua,ca)):m("",!0),i(w,{class:"tableBig"},{default:l(()=>[h(b(t.userName?t.userName:"-"),1)]),_:2},1024)])]),_:1})):m("",!0),o.value.checkList.includes("phoneNumber")?(s(),v(y,{key:3,align:"left",width:"170",prop:"phone",label:"电话号码"},{default:l(({row:t})=>[i(w,{class:"fontC-System"},{default:l(()=>[h(b(t.phoneNumber?t.phoneNumber:"-"),1)]),_:2},1024)]),_:1})):m("",!0),o.value.checkList.includes("email")?(s(),v(y,{key:4,align:"left",width:"180",prop:"email",label:"邮箱"},{default:l(({row:t})=>[i(w,{class:"fontC-System"},{default:l(()=>[h(b(t.email?t.email:"-"),1)]),_:2},1024)]),_:1})):m("",!0),o.value.checkList.includes("departmentId")?(s(),v(y,{key:5,align:"left",prop:"departmentId",label:"部门"},{default:l(({row:t})=>[i(w,{class:"fontC-System"},{default:l(()=>[h(b(t.organizationalStructureName?t.organizationalStructureName:"-"),1)]),_:2},1024)]),_:1})):m("",!0),o.value.checkList.includes("positionId")?(s(),v(y,{key:6,align:"left",prop:"positionId",label:"职位"},{default:l(({row:t})=>[i(w,{class:"fontC-System"},{default:l(()=>[h(b(t.positionName?t.positionName:"-"),1)]),_:2},1024)]),_:1})):m("",!0),i(y,{label:"操作",fixed:"right",width:"200",align:"left"},{default:l(t=>[i(d,{type:"primary",size:"small",plain:"",onClick:g=>ge(t.row)},{default:l(()=>[h(" 编辑 ")]),_:2},1032,["onClick"]),i(d,{type:"warning",size:"small",plain:"",onClick:g=>he(t.row)},{default:l(()=>[h(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[A,D.value]])],512),[[K,r.value.search.organizationalStructureId]]),H(c("div",pa,ma,512),[[K,!r.value.search.organizationalStructureId]])]),_:1}),n.value.dialog.visible?(s(),v(Ke,{key:0,id:n.value.dialog.id,modelValue:n.value.dialog.visible,"onUpdate:modelValue":a[4]||(a[4]=t=>n.value.dialog.visible=t),row:n.value.row,"parent-id":n.value.dialog.parentId,tree:n.value.tree,isClick:n.value.dialog.isClick,onGetList:C,onGetItmelist:k},null,8,["id","modelValue","row","parent-id","tree","isClick"])):m("",!0),p.value.dialog.visible?(s(),v(je,{key:1,id:p.value.dialog.id,modelValue:p.value.dialog.visible,"onUpdate:modelValue":a[5]||(a[5]=t=>p.value.dialog.visible=t),row:p.value.row,"parent-id":p.value.dialog.parentId,name:p.value.dialog.name,tree:p.value.tree,onGetList:C},null,8,["id","modelValue","row","parent-id","name","tree"])):m("",!0),r.value.dialog.visible?(s(),v(qe,{key:2,id:r.value.dialog.id,modelValue:r.value.dialog.visible,"onUpdate:modelValue":a[6]||(a[6]=t=>r.value.dialog.visible=t),"catalogue-id":r.value.search.organizationalStructureId,"parent-id":r.value.dialog.parentId,level:r.value.dialog.level,tree:n.value.tree,dataList:r.value.dataList,row:r.value.row,onSuccess:k},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):m("",!0),o.value.dialog.visible?(s(),v(We,{key:3,id:o.value.dialog.id,modelValue:o.value.dialog.visible,"onUpdate:modelValue":a[7]||(a[7]=t=>o.value.dialog.visible=t),"catalogue-id":o.value.search.catalogueId,"parent-id":o.value.dialog.parentId,level:o.value.dialog.level,tree:_.value.tree,dataList:o.value.dataList,row:o.value.row,onSuccess:k,onGetList:C},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):m("",!0),i(Oe,{ref_key:"detailRef",ref:P},null,512)])])}}});typeof q=="function"&&q(Q);const Ma=Ze(Q,[["__scopeId","data-v-39beff1d"]]);export{Ma as default};
