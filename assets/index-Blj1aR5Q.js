
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as Le}from"./index-uTDN3DOL.js";import{ae as we,r as v,d as Ee,ao as xe,aN as Se,k as Ne,a1 as De,a as s,l as Ve,o as i,b as h,p as E,f as o,w as n,n as T,e as u,D as f,aC as G,F as C,q as I,g,j as c,i as L,an as N,aO as j,E as F,L as ze,aP as Me,P as Ue,ap as K}from"./index-BYPnl6Gi.js";import{u as He,D as Pe}from"./index-DylEYKMx.js";import $e from"./index-Dk2Dzfod.js";import{a as Ae}from"./department-Dgs4OfZx.js";import{u as Be}from"./department-S45DQuuz.js";import{g as Re}from"./group_manage-Bn3ng_Bo.js";import"./tenant_role-Bnf5AGlS.js";import"./configuration_role-4hHiG1t2.js";import"./position_manage-DQ4MImRp.js";const Te=we("groupManage",()=>{const y=v([]);return{groupManage:y,getGroupManage:async()=>{if(y.value.length)return y.value;const{data:k}=await Re.list({page:1,limit:10,id:null,name:"",active:null});return y.value=k.data,k.data}}}),Ge=Te,je={class:"absolute-container"},Fe={class:"page-main"},Ke={class:"custom-tree-node"},Oe=["title"],qe={class:"code"},Je={class:"dictionary-container"},O=Ee({name:"user",__name:"index",setup(y){const D=Ge(),k=v(),q=He(),V=v(),J=xe(),z=v([]),Q=Be(),M=v(),{pagination:_,getParams:Qe,onSizeChange:W,onCurrentChange:X,onSortChange:Y}=Se(),x=v([{label:"员工ID",prop:"id",sortable:!0,checked:!0},{label:"用户名",prop:"userName",sortable:!0,checked:!0},{label:"姓名",prop:"name",sortable:!0,checked:!0},{label:"国家",prop:"country",sortable:!0,checked:!0},{label:"电话号码",prop:"phone",sortable:!0,checked:!0},{label:"邮箱",prop:"email",sortable:!0,checked:!0},{label:"部门",prop:"departmentId",sortable:!0,checked:!0},{label:"职位",prop:"positionId",sortable:!0,checked:!0},{label:"小组",prop:"groupId",sortable:!0,checked:!0},{label:"状态",prop:"active",sortable:!0,checked:!0}]),Z=[{label:"启用",value:!0},{label:"禁用",value:!1}],U=v(),H=v(),m=v({search:{chineseName:""},tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""},row:"",loading:!1}),ee=v(),e=v({loading:!1,tableAutoHeight:!1,border:!0,stripe:!1,lineHeight:"default",checkList:[],search:{id:"",userName:"",active:null,departmentId:null},dataList:[],selectionDataList:[],row:"",dialog:{visible:!1,id:"",parentId:"",level:1}});async function d(){const l={...e.value.search},a=await N.list(l);e.value.dataList=a.data.data,_.value.total=a.data.length}Ne(async()=>{m.value.loading=!0,z.value=await J.getCountry(),M.value=await Q.getDepartment(),V.value=await q.getPositionManage(),k.value=await D.getGroupManage();const l=await Ae.createEvery();m.value.tree=l.data.result,d(),x.value.forEach(a=>{a.checked&&e.value.checkList.push(a.prop)}),m.value.loading=!1}),De(()=>m.value.search,l=>{U.value.filter(l)});function te(l,a){return l?a.label.includes(l):!0}function ae(l){return new Promise(a=>{j.confirm(`确认${l.active?"禁用":"启用"}「${l.name}」吗？`,"确认信息").then(()=>{m.value.loading=!0,N.edit({id:l.id,account:null,name:null,sex:null,phoneNumber:null,active:!l.active}).then(()=>(F.success({message:`${l.active?"禁用":"启用"}成功`,center:!0}),d(),m.value.loading=!1,a(!0))).catch(()=>(m.value.loading=!1,a(!1)))}).catch(()=>a(!1))})}function le(l){var a;_.value.page=1,(a=l==null?void 0:l.children)!=null&&a.length?(e.value.search.id="",e.value.search.departmentId=l.id,d()):(e.value.search.id=l.id,e.value.search.departmentId="",d())}function ne(l){W(l).then(()=>d())}function P(l=1){X(l).then(()=>d())}function oe({prop:l,order:a}){Y(l,a).then(()=>d())}function ie(l){e.value.dialog.id="",e.value.dialog.visible=!0,e.value.dialog.level=1,l&&(e.value.dialog.parentId=l.id,e.value.dialog.level=Number(l.level)+1)}function re(l){j.confirm(`确认将「${l.name}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{N.reset({id:l.id}).then(()=>{F.success({message:"重置成功",center:!0})})}).catch(()=>{})}function ue(l){e.value.row=JSON.stringify(l),e.value.dialog.id=l.id,e.value.dialog.parentId=l.parentId,e.value.dialog.visible=!0}function se(l){H.value.showEdit(l)}function ce(){Object.assign(e.value.search,{id:"",userName:"",active:null}),d()}return(l,a)=>{const de=s("ElTree"),pe=s("ElScrollbar"),$=s("ElInput"),ge=s("el-option"),me=s("el-select"),A=ze,w=s("ElButton"),ve=s("ElSpace"),S=s("el-button"),B=s("el-col"),fe=Me,he=s("el-row"),p=s("ElTableColumn"),b=s("el-text"),_e=s("el-tag"),be=s("ElSwitch"),ye=s("el-empty"),ke=s("ElTable"),Ce=s("ElPagination"),Ie=Le,R=Ve("loading");return i(),h("div",je,[E("div",Fe,[o(Ie,{"hide-left-side-toggle":""},{leftSide:n(()=>[o(pe,{class:"tree"},{default:n(()=>[T((i(),u(de,{ref_key:"dictionaryRef",ref:U,data:m.value.tree,"filter-node-method":te,"default-expand-all":"",onNodeClick:le},{default:n(({node:t,data:r})=>[E("div",Ke,[E("div",{class:"label",title:t.label},f(r.name),9,Oe),E("div",qe,f(r.name),1)])]),_:1},8,["data","filter-node-method"])),[[R,m.value.loading]])]),_:1})]),default:n(()=>[T((i(),h("div",Je,[o(ve,null,{default:n(()=>[o($,{modelValue:e.value.search.id,"onUpdate:modelValue":a[0]||(a[0]=t=>e.value.search.id=t),placeholder:"员工ID",clearable:"",style:{width:"200px"},onKeydown:G(d,["enter"])},null,8,["modelValue"]),o($,{modelValue:e.value.search.userName,"onUpdate:modelValue":a[1]||(a[1]=t=>e.value.search.userName=t),placeholder:"用户名",clearable:"",style:{width:"200px"},onKeydown:G(d,["enter"])},null,8,["modelValue"]),o(me,{modelValue:e.value.search.active,"onUpdate:modelValue":a[2]||(a[2]=t=>e.value.search.active=t),"value-key":"",placeholder:"状态",clearable:"",filterable:"",onChange:a[3]||(a[3]=()=>{})},{default:n(()=>[(i(),h(C,null,I(Z,t=>o(ge,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),o(w,{type:"primary",onClick:d},{icon:n(()=>[o(A,{name:"i-ep:search"})]),_:1}),o(w,{onClick:ce},{icon:n(()=>[o(A,{name:"i-ep:refresh"})]),_:1})]),_:1}),o(he,{style:{"margin-bottom":"5px"},gutter:24},{default:n(()=>[o(B,{span:10},{default:n(()=>[o(S,{type:"primary",size:"default",onClick:ie},{default:n(()=>[g(" 新增 ")]),_:1})]),_:1}),o(B,{style:{display:"flex","justify-content":"flex-end"},span:14},{default:n(()=>[o(S,{size:"default",onClick:a[4]||(a[4]=()=>{})},{default:n(()=>[g(" 导出 ")]),_:1}),o(fe,{border:e.value.border,"onUpdate:border":a[5]||(a[5]=t=>e.value.border=t),tableAutoHeight:e.value.tableAutoHeight,"onUpdate:tableAutoHeight":a[6]||(a[6]=t=>e.value.tableAutoHeight=t),checkList:e.value.checkList,"onUpdate:checkList":a[7]||(a[7]=t=>e.value.checkList=t),columns:x.value,"onUpdate:columns":a[8]||(a[8]=t=>x.value=t),"line-height":e.value.lineHeight,"onUpdate:lineHeight":a[9]||(a[9]=t=>e.value.lineHeight=t),stripe:e.value.stripe,"onUpdate:stripe":a[10]||(a[10]=t=>e.value.stripe=t),style:{"margin-left":"12px"},onQueryData:P},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),o(ke,{ref_key:"dictionaryItemRef",ref:ee,data:e.value.dataList,border:e.value.border,size:e.value.lineHeight,stripe:e.value.stripe,"highlight-current-row":"",height:"100%",onSortChange:oe,onSelectionChange:a[11]||(a[11]=t=>e.value.selectionDataList=t),"row-key":"id","default-expand-all":""},{empty:n(()=>[o(ye,{description:"暂无数据"})]),default:n(()=>[o(p,{type:"selection",align:"center",fixed:""}),e.value.checkList.includes("id")?(i(),u(p,{key:0,align:"center",width:"180",prop:"id",label:"员工ID"})):c("",!0),e.value.checkList.includes("userName")?(i(),u(p,{key:1,align:"center",width:"150",prop:"userName",label:"用户名"},{default:n(({row:t})=>[o(b,null,{default:n(()=>[g(f(t.userName?t.userName:"-"),1)]),_:2},1024)]),_:1})):c("",!0),e.value.checkList.includes("name")?(i(),u(p,{key:2,align:"center",width:"150",prop:"name",label:"姓名"})):c("",!0),e.value.checkList.includes("country")?(i(),u(p,{key:3,prop:"country",label:"国家",width:"150",align:"center"},{default:n(({row:t})=>[(i(!0),h(C,null,I(z.value,r=>(i(),h("div",{key:r.id,class:"mx-1"},[r.code===t.country?(i(),u(_e,{key:0,type:"primary",class:"mx-1"},{default:n(()=>[g(f(r.chineseName),1)]),_:2},1024)):c("",!0)]))),128))]),_:1})):c("",!0),e.value.checkList.includes("phone")?(i(),u(p,{key:4,align:"center",width:"180",prop:"phone",label:"电话号码"},{default:n(({row:t})=>[g(f(t.phone?t.phone:"-"),1)]),_:1})):c("",!0),e.value.checkList.includes("email")?(i(),u(p,{key:5,align:"center",width:"180",prop:"email",label:"邮箱"},{default:n(({row:t})=>[g(f(t.email?t.email:"-"),1)]),_:1})):c("",!0),e.value.checkList.includes("departmentId")?(i(),u(p,{key:6,align:"center",prop:"departmentId",label:"部门"},{default:n(({row:t})=>[(i(!0),h(C,null,I(M.value,r=>(i(),u(b,null,{default:n(()=>[t.departmentId===r.id?(i(),u(b,{key:0},{default:n(()=>[g(f(r.name?r.name:"-"),1)]),_:2},1024)):c("",!0)]),_:2},1024))),256))]),_:1})):c("",!0),e.value.checkList.includes("positionId")?(i(),u(p,{key:7,align:"center",prop:"positionId",label:"职位"},{default:n(({row:t})=>[(i(!0),h(C,null,I(V.value,r=>(i(),u(b,null,{default:n(()=>[t.positionId===r.id?(i(),u(b,{key:0},{default:n(()=>[g(f(r.name?r.name:"-"),1)]),_:2},1024)):c("",!0)]),_:2},1024))),256))]),_:1})):c("",!0),e.value.checkList.includes("groupId")?(i(),u(p,{key:8,align:"center",prop:"groupId",label:"小组"},{default:n(({row:t})=>[(i(!0),h(C,null,I(k.value,r=>(i(),u(b,null,{default:n(()=>[t.groupId===r.id?(i(),u(b,{key:0},{default:n(()=>[g(f(r.name?r.name:"-"),1)]),_:2},1024)):c("",!0)]),_:2},1024))),256))]),_:1})):c("",!0),e.value.checkList.includes("active")?(i(),u(p,{key:9,align:"center",prop:"active",label:"状态"},{default:n(t=>[o(be,{modelValue:t.row.active,"onUpdate:modelValue":r=>t.row.active=r,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>ae(t.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1})):c("",!0),o(p,{label:"操作",fixed:"right",width:"240",align:"center"},{default:n(t=>[o(w,{type:"primary",size:"small",plain:"",onClick:r=>ue(t.row)},{default:n(()=>[g(" 编辑 ")]),_:2},1032,["onClick"]),o(w,{type:"primary",size:"small",plain:"",onClick:r=>se(t.row)},{default:n(()=>[g(" 详情 ")]),_:2},1032,["onClick"]),o(S,{type:"primary",plain:"",size:"small",onClick:r=>re(t.row)},{default:n(()=>[g(" 重置密码 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"]),o(Ce,{"current-page":L(_).page,total:L(_).total,"page-size":L(_).size,"page-sizes":L(_).sizes,layout:L(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:ne,onCurrentChange:P},null,8,["current-page","total","page-size","page-sizes","layout"])])),[[R,m.value.loading]])]),_:1}),e.value.dialog.visible?(i(),u(Pe,{key:0,id:e.value.dialog.id,modelValue:e.value.dialog.visible,"onUpdate:modelValue":a[12]||(a[12]=t=>e.value.dialog.visible=t),"catalogue-id":e.value.search.catalogueId,"parent-id":e.value.dialog.parentId,level:e.value.dialog.level,tree:m.value.tree,dataList:e.value.dataList,row:e.value.row,onSuccess:d},null,8,["id","modelValue","catalogue-id","parent-id","level","tree","dataList","row"])):c("",!0),o($e,{ref_key:"detailRef",ref:H},null,512)])])}}});typeof K=="function"&&K(O);const it=Ue(O,[["__scopeId","data-v-12159ef3"]]);export{it as default};
