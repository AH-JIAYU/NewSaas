
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{c as k}from"./user_cooperation-BQQbH1Qf.js";import{d as j,r as p,c as M,a as r,o as i,b as d,f as n,w as a,g as b,i as o,F as I,t as N,e as h,y as _,z as u,j as T,A as O,p as G,E as H,aE as J,L as K}from"./index-DY9KDIay.js";const P={style:{float:"left"}},Q={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"0.8125rem"}},W={key:0},X={key:1},Y={style:{float:"left"}},Z={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"0.8125rem"}},$=j({__name:"index",emits:["fetch-data"],setup(ee,{expose:x,emit:E}){const w=E,c=p(!1);p("");const g=p(),e=p({form:{},tenantUserList:[],tenantStaffList:[],rules:{beInvitationTenantId:[{required:!0,message:"请选择租户",trigger:"change"}],priceRatio:[{required:!0,message:"请输入价格比例",trigger:"blur"}],chargeUserId:[{required:!0,message:"请选择负责人",trigger:"change"}]}});async function C(){await R(),await S(),c.value=!0}async function R(){const l=await k.getTenantUserList({});e.value.tenantUserList=l.data.tenantUserInfoList}const y=M(()=>{const l=e.value.tenantUserList.find(s=>s.tenantId===e.value.form.beInvitationTenantId);return l?(e.value.form.tenantName=l.name,e.value.form.phoneOrEmail=J.local.get("account"),[l]):[]}),S=async()=>{const l=await G.getTenantStaffList();e.value.tenantStaffList=l.data};function U(){c.value=!1,e.value.form={},g.value.resetFields()}const B=l=>{if(l){const s=e.value.tenantStaffList.find(f=>f.id===e.value.form.chargeUserId);e.value.form.chargeUserName=s.userName}else e.value.form.chargeUserId="",e.value.form.chargeUserName=""};async function F(){g.value.validate(l=>{l&&k.addInvitationBind(e.value.form).then(()=>{H.success({message:"发送成功",center:!0}),w("fetch-data"),U()})})}return x({showEdit:C}),(l,s)=>{const f=r("el-option"),L=r("el-select"),v=r("el-form-item"),m=r("el-table-column"),q=r("el-table"),z=r("el-input"),D=r("ElForm"),V=r("el-button"),A=r("el-dialog");return i(),d("div",null,[n(A,{modelValue:o(c),"onUpdate:modelValue":s[3]||(s[3]=t=>O(c)?c.value=t:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:"邀约公司"},{footer:a(()=>[n(V,{onClick:U},{default:a(()=>[b(" 关闭 ")]),_:1}),n(V,{type:"primary",onClick:F},{default:a(()=>[b(" 发送邀约 ")]),_:1})]),default:a(()=>[n(D,{ref_key:"formRef",ref:g,rules:o(e).rules,model:o(e).form,"label-width":"7rem"},{default:a(()=>[n(v,{label:"公司名称",prop:"beInvitationTenantId"},{default:a(()=>[n(L,{modelValue:o(e).form.beInvitationTenantId,"onUpdate:modelValue":s[0]||(s[0]=t=>o(e).form.beInvitationTenantId=t),clearable:""},{default:a(()=>[(i(!0),d(I,null,N(o(e).tenantUserList,t=>(i(),h(f,{key:t.tenantId,value:t.tenantId,label:t.tenantName},{default:a(()=>[_("span",P,u(t.tenantName),1),_("span",Q,u(t.tenantId),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(y).length?(i(),h(q,{key:0,data:o(y),border:"",stripe:"",style:{"margin-bottom":"18px"}},{default:a(()=>[n(m,{prop:"name",label:"用户名"}),n(m,{prop:"tenantName",label:"公司名称"}),n(m,{prop:"country",label:"国家"}),n(m,{label:"电子邮箱/手机号"},{default:a(({row:t})=>[t.phone?(i(),d("span",W,u(t.phone),1)):(i(),d("span",X,u(t.email),1))]),_:1})]),_:1},8,["data"])):T("",!0),o(e).form.beInvitationTenantId?(i(),d(I,{key:1},[n(v,{label:"价格比例",prop:"priceRatio"},{default:a(()=>[n(z,{modelValue:o(e).form.priceRatio,"onUpdate:modelValue":s[1]||(s[1]=t=>o(e).form.priceRatio=t),clearable:""},{append:a(()=>[b("%")]),_:1},8,["modelValue"])]),_:1}),n(v,{label:"负责人",prop:"chargeUserId"},{default:a(()=>[n(L,{modelValue:o(e).form.chargeUserId,"onUpdate:modelValue":s[2]||(s[2]=t=>o(e).form.chargeUserId=t),clearable:"",onChange:B},{default:a(()=>[(i(!0),d(I,null,N(o(e).tenantStaffList,t=>(i(),h(f,{key:t.id,value:t.id,label:t.userName},{default:a(()=>[_("span",Y,u(t.userName),1),_("span",Z,u(t.id),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})],64)):T("",!0)]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}}}),ne=K($,[["__scopeId","data-v-8129bc93"]]);export{ne as default};
