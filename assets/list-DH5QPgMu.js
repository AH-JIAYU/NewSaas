
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ue,r as y,aM as ce,l as de,B,H as me,au as k,a as s,al as pe,o as r,b as E,f as t,w as a,am as L,aA as fe,F as D,n as N,e as p,g as i,D as _,j as x,i as h,Q as ge,aN as I,E as U,L as _e,ak as ve,aK as he,aL as be,C as Ce,aE as ye,P as Ee,aj as T}from"./index-Dm70kv03.js";import{_ as Me}from"./index.vue_vue_type_script_setup_true_lang-R-nutVCA.js";import{_ as we}from"./index.vue_vue_type_script_setup_true_lang-CbQA76le.js";import{u as Se}from"./otherFunctions_basicDictionary-Bfh7UkIN.js";import{u as ke}from"./index.vue_vue_type_script_setup_true_lang-DIPPvs7a.js";import{u as xe}from"./useTabbar-D7ExB1zT.js";import"./basicDictionary-DHYTm2ZC.js";import"./configuration_role-CdmgzL40.js";const Pe=b=>(he("data-v-3bbc2aae"),b=b(),be(),b),Ve=Pe(()=>Ce("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),F=ue({name:"SettingUserList",__name:"list",setup(b){const j=Se(),P=y([]),A=ke(),V=y(),{pagination:f,onSizeChange:H,onCurrentChange:K,onSortChange:R}=ce(),z=xe(),e=y({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,id:"",row:""},editProps:{visible:!1,id:""},search:{name:"",role:""},batch:{enable:!0,selectionDataList:[]},dataList:[]});y(),de(async()=>{c(),P.value=await j.getCountry(),V.value=await A.getRole,e.value.formMode==="router"&&B.on("get-data-list",()=>{c()})}),me(()=>{e.value.formMode==="router"&&B.off("get-data-list")});function c(){e.value.loading=!0,k.list(e.value.search).then(n=>{var l;e.value.loading=!1,e.value.dataList=n.data,f.value.total=(l=n.data)==null?void 0:l.length,e.value.dataList.forEach(M=>{M.statusLoading=!1})})}function G(){Object.assign(e.value.search,{name:"",role:""}),c()}function O(n){H(n).then(()=>c())}function C(n=1){K(n).then(()=>c())}function J({prop:n,order:l}){R(n,l).then(()=>c())}function Q(){e.value.formMode==="router"?z.open({name:"pagesExampleGeneralManagerCreate"}):(e.value.formModeProps.id="",e.value.formModeProps.row="",e.value.formModeProps.visible=!0)}function q(n){e.value.formMode==="router"?z.open({name:"pagesExampleGeneralManagerEdit",params:{id:n.id}}):(e.value.formModeProps.id=n.id,e.value.formModeProps.row=JSON.stringify(n),e.value.formModeProps.visible=!0)}function W(n){return new Promise(l=>{I.confirm(`确认${n.active?"禁用":"启用"}「${n.name}」吗？`,"确认信息").then(()=>{e.value.loading=!0,k.edit({id:n.id,account:null,name:null,sex:null,phoneNumber:null,active:!n.active}).then(()=>(U.success({message:`${n.active?"禁用":"启用"}成功`,center:!0}),c(),e.value.loading=!1,l(!0))).catch(()=>(e.value.loading=!1,l(!1)))}).catch(()=>l(!1))})}function X(n){I.confirm(`确认删除「${n.name}」用户吗？`,"确认信息").then(()=>{k.delete({id:n.id}).then(()=>{c(),U.success({message:"删除成功",center:!0})})}).catch(()=>{})}return(n,l)=>{const M=s("ElInput"),w=s("ElFormItem"),Y=s("el-option"),Z=s("el-select"),S=_e,g=s("ElButton"),ee=s("ElForm"),ae=Me,te=s("ElDivider"),$=s("ElSpace"),m=s("ElTableColumn"),v=s("el-text"),oe=s("ElSwitch"),le=s("el-empty"),ne=s("ElTable"),se=s("ElPagination"),re=ve,ie=pe("loading");return r(),E("div",{class:ge({"absolute-container":e.value.tableAutoHeight})},[t(re,null,{default:a(()=>[t(ae,{"show-toggle":!1},{default:a(({fold:o,toggle:d})=>[t(ee,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:a(()=>[L(t(w,null,{default:a(()=>[t(M,{modelValue:e.value.search.name,"onUpdate:modelValue":l[0]||(l[0]=u=>e.value.search.name=u),placeholder:"请输入姓名",clearable:"",onKeydown:l[1]||(l[1]=fe(u=>C(),["enter"])),onClear:l[2]||(l[2]=u=>C())},null,8,["modelValue"])]),_:2},1536),[[ye,!o]]),t(w,{prop:"role"},{default:a(()=>[t(Z,{modelValue:e.value.search.role,"onUpdate:modelValue":l[3]||(l[3]=u=>e.value.search.role=u),placeholder:"请选择角色"},{default:a(()=>[(r(!0),E(D,null,N(V.value,u=>(r(),p(Y,{key:u.id,label:u.roleName,value:u.roleName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(w,null,{default:a(()=>[t(g,{type:"primary",onClick:l[4]||(l[4]=u=>C())},{icon:a(()=>[t(S,{name:"i-ep:search"})]),default:a(()=>[i(" 筛选 ")]),_:1}),t(g,{onClick:G},{icon:a(()=>[Ve]),default:a(()=>[i(" 重置 ")]),_:1}),t(g,{link:"",onClick:d},{icon:a(()=>[t(S,{name:o?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:a(()=>[i(" "+_(o?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),t(te,{"border-style":"dashed"}),t($,{wrap:""},{default:a(()=>[t(g,{type:"primary",size:"default",onClick:Q},{icon:a(()=>[t(S,{name:"i-ep:plus"})]),default:a(()=>[i(" 新增用户 ")]),_:1})]),_:1}),L((r(),p(ne,{class:"my-4",data:e.value.dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:J,onSelectionChange:l[5]||(l[5]=o=>e.value.batch.selectionDataList=o)},{empty:a(()=>[t(le,{description:"暂无数据"})]),default:a(()=>[e.value.batch.enable?(r(),p(m,{key:0,type:"selection",align:"center",fixed:""})):x("",!0),t(m,{prop:"account",sortable:"",label:"帐号"},{default:a(({row:o})=>[o.country==="CN"?(r(),p(v,{key:0,class:"mx-1"},{default:a(()=>[i(_(o.phone),1)]),_:2},1024)):(r(),p(v,{key:1,class:"mx-1"},{default:a(()=>[i(_(o.email),1)]),_:2},1024))]),_:1}),t(m,{prop:"name",label:"姓名",width:"100",align:"center"},{default:a(({row:o})=>[t(v,{class:"mx-1"},{default:a(()=>[i(_(o.name?o.name:"暂无数据"),1)]),_:2},1024)]),_:1}),t(m,{prop:"role",align:"center",width:"150",label:"角色"},{default:a(({row:o})=>[t(v,{class:"mx-1"},{default:a(()=>[i(_(o.role?o.role:"暂无数据"),1)]),_:2},1024)]),_:1}),t(m,{prop:"mobile",label:"国家",width:"150",align:"center"},{default:a(({row:o})=>[(r(!0),E(D,null,N(P.value,d=>(r(),E("div",{key:d.id,class:"mx-1"},[d.code===o.country?(r(),p(v,{key:0,class:"mx-1"},{default:a(()=>[i(_(d.chineseName),1)]),_:2},1024)):x("",!0)]))),128))]),_:1}),t(m,{label:"状态",width:"100",align:"center"},{default:a(o=>[t(oe,{modelValue:o.row.active,"onUpdate:modelValue":d=>o.row.active=d,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>W(o.row)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1}),t(m,{label:"操作",width:"200",align:"center",fixed:"right"},{default:a(o=>[t($,null,{default:a(()=>[t(g,{type:"primary",size:"small",plain:"",onClick:d=>q(o.row)},{default:a(()=>[i(" 编辑 ")]),_:2},1032,["onClick"]),t(g,{type:"danger",size:"small",plain:"",onClick:d=>X(o.row)},{default:a(()=>[i(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ie,e.value.loading]]),t(se,{"current-page":h(f).page,total:h(f).total,"page-size":h(f).size,"page-sizes":h(f).sizes,layout:h(f).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:C,onSizeChange:O},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e.value.formMode==="dialog"||e.value.formMode==="drawer"?(r(),p(we,{key:0,id:e.value.formModeProps.id,modelValue:e.value.formModeProps.visible,"onUpdate:modelValue":l[6]||(l[6]=o=>e.value.formModeProps.visible=o),row:e.value.formModeProps.row,mode:e.value.formMode,onSuccess:c},null,8,["id","modelValue","row","mode"])):x("",!0)],2)}}});typeof T=="function"&&T(F);const Te=Ee(F,[["__scopeId","data-v-3bbc2aae"]]);export{Te as default};
