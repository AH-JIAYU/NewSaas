
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as de,r as b,O as ce,aO as pe,y as me,k as fe,G as x,J as ge,a as u,p as ve,o,b as L,f as n,w as t,az as N,q as U,F as V,t as $,e as r,g as d,H as v,j as p,i as C,S as _e,N as he,aQ as be,aR as ke,ao as ye,aJ as Ce,aK as we,s as Le,ap as Ie,R as Ee}from"./index-CzARc10T.js";import{_ as Be}from"./index.vue_vue_type_style_index_0_lang-BWIXmg5F.js";import{_ as Se}from"./index.vue_vue_type_script_setup_true_lang-eRsSgi_q.js";import{a as ze}from"./financial_pm_log-BM6FqFop.js";import{_ as Ne}from"./index.vue_vue_type_script_setup_true_lang-xMazvYID.js";import Ve from"./index-CjTmcwcv.js";import{u as $e}from"./position_manage-vMpNpjly.js";import{u as De}from"./group_manage-BRgQnvGO.js";import{u as He}from"./useTabbar-BlIN9G4h.js";import"./position_manage-bPZ5PgiT.js";import"./group_manage-BXyoJBmP.js";const Me=w=>(Ce("data-v-f7c971e0"),w=w(),we(),w),Pe=Me(()=>Le("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),xe=de({name:"financial_pm_log",__name:"list",setup(w){const I=$e(),E=b(),B=De(),D=b();ce();const{pagination:h,getParams:F,onSizeChange:R,onCurrentChange:A,onSortChange:T}=pe();He(),me();const H=b(),M=b(),S=b([{label:"员工ID",prop:"id",sortable:!0,disableCheck:!1,checked:!0},{label:"用户名",prop:"userName",sortable:!0,disableCheck:!1,checked:!0},{label:"姓名",prop:"name",sortable:!0,disableCheck:!1,checked:!0},{label:"所属组",prop:"groupId",sortable:!0,disableCheck:!1,checked:!0},{label:"职位",prop:"positionId",sortable:!0,disableCheck:!1,checked:!0},{label:"待审提成",prop:"pendingBalance",sortable:!0,disableCheck:!1,checked:!0},{label:"可用提成",prop:"availableBalance",sortable:!0,disableCheck:!1,checked:!0}]),e=b({loading:!1,activeName:"myFinancial",tableAutoHeight:!1,border:!0,stripe:!1,lineHeight:"default",checkList:[],formMode:"drawer",formModeProps:{visible:!1,id:""},search:{page:1,limit:10,id:null,userName:"",name:"",positionId:null},batch:{enable:!1,selectionDataList:[]},dataList:[]});fe(async()=>{E.value=await(I==null?void 0:I.getPositionManage())||[],D.value=await(B==null?void 0:B.getGroupManage())||[],f(),e.value.formMode==="router"&&x.on("get-data-list",()=>{f()}),S.value.forEach(s=>{s.checked&&e.value.checkList.push(s.prop)})}),ge(()=>{e.value.formMode==="router"&&x.off("get-data-list")});function f(){try{e.value.loading=!0;const s={...F(),...e.value.search};ze.list(s).then(a=>{e.value.loading=!1,e.value.dataList=a.data.data,h.value.total=+a.data.total})}catch{}finally{e.value.loading=!1}}function K(s){H.value.showEdit(JSON.stringify(s))}function O(s){M.value.showEdit(s)}function J(){Object.assign(e.value.search,{page:1,limit:10,id:null,userName:"",name:"",positionId:null}),f()}function j(s){R(s).then(()=>{e.value.search.limit=s,f()})}function g(s=1){A(s).then(()=>{e.value.search.page=s,f()})}function G({prop:s,order:a}){T(s,a).then(()=>f())}return(s,a)=>{const z=u("ElInput"),k=u("ElFormItem"),Q=u("el-option"),q=u("el-select"),P=he,y=u("ElButton"),W=u("ElForm"),X=Se,Y=u("ElDivider"),Z=Be,ee=u("el-button"),ae=be,le=ke,te=u("el-row"),ne=u("el-table-column"),m=u("ElTableColumn"),_=u("el-text"),oe=u("el-empty"),se=u("ElTable"),ie=u("ElPagination"),re=ye,ue=ve("loading");return o(),L("div",{class:_e({"absolute-container":e.value.tableAutoHeight})},[n(re,null,{default:t(()=>[n(X,{"show-toggle":!1},{default:t(({fold:l,toggle:c})=>[n(W,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:t(()=>[n(k,null,{default:t(()=>[n(z,{modelValue:e.value.search.id,"onUpdate:modelValue":a[0]||(a[0]=i=>e.value.search.id=i),placeholder:"员工ID",clearable:"",onKeydown:a[1]||(a[1]=N(i=>g(),["enter"])),onClear:a[2]||(a[2]=i=>g())},null,8,["modelValue"])]),_:1}),n(k,null,{default:t(()=>[n(z,{modelValue:e.value.search.userName,"onUpdate:modelValue":a[3]||(a[3]=i=>e.value.search.userName=i),placeholder:"用户名",clearable:"",onKeydown:a[4]||(a[4]=N(i=>g(),["enter"])),onClear:a[5]||(a[5]=i=>g())},null,8,["modelValue"])]),_:1}),n(k,null,{default:t(()=>[n(z,{modelValue:e.value.search.name,"onUpdate:modelValue":a[6]||(a[6]=i=>e.value.search.name=i),placeholder:"姓名",clearable:"",onKeydown:a[7]||(a[7]=N(i=>g(),["enter"])),onClear:a[8]||(a[8]=i=>g())},null,8,["modelValue"])]),_:1}),U(n(k,null,{default:t(()=>[n(q,{modelValue:e.value.search.positionId,"onUpdate:modelValue":a[9]||(a[9]=i=>e.value.search.positionId=i),"value-key":"",placeholder:"职位",clearable:"",filterable:""},{default:t(()=>[(o(!0),L(V,null,$(E.value,i=>(o(),r(Q,{key:i.id,label:i.name,value:i.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:2},1536),[[Ie,!l]]),n(k,null,{default:t(()=>[n(y,{type:"primary",onClick:a[10]||(a[10]=i=>g())},{icon:t(()=>[n(P,{name:"i-ep:search"})]),default:t(()=>[d(" 筛选 ")]),_:1}),n(y,{onClick:J},{icon:t(()=>[Pe]),default:t(()=>[d(" 重置 ")]),_:1}),n(y,{link:"",onClick:c},{icon:t(()=>[n(P,{name:l?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:t(()=>[d(" "+v(l?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),n(Y,{"border-style":"dashed"}),n(te,null,{default:t(()=>[n(Z),n(le,null,{default:t(()=>[n(ee,{size:"default"},{default:t(()=>[d(" 导出 ")]),_:1}),n(ae,{border:e.value.border,"onUpdate:border":a[11]||(a[11]=l=>e.value.border=l),tableAutoHeight:e.value.tableAutoHeight,"onUpdate:tableAutoHeight":a[12]||(a[12]=l=>e.value.tableAutoHeight=l),checkList:e.value.checkList,"onUpdate:checkList":a[13]||(a[13]=l=>e.value.checkList=l),columns:S.value,"onUpdate:columns":a[14]||(a[14]=l=>S.value=l),"line-height":e.value.lineHeight,"onUpdate:lineHeight":a[15]||(a[15]=l=>e.value.lineHeight=l),stripe:e.value.stripe,"onUpdate:stripe":a[16]||(a[16]=l=>e.value.stripe=l),style:{"margin-left":"12px"},onQueryData:f},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),U((o(),r(se,{border:e.value.border,size:e.value.lineHeight,stripe:e.value.stripe,class:"my-4",data:e.value.dataList,"highlight-current-row":"",height:"100%",onSortChange:G,onSelectionChange:a[17]||(a[17]=l=>e.value.batch.selectionDataList=l)},{empty:t(()=>[n(oe,{class:"vab-data-empty",description:"暂无数据"})]),default:t(()=>[n(ne,{align:"center",type:"selection"}),e.value.batch.enable?(o(),r(m,{key:0,type:"selection","show-overflow-tooltip":"",align:"center",fixed:""})):p("",!0),e.value.checkList.includes("id")?(o(),r(m,{key:1,"show-overflow-tooltip":"",align:"center",prop:"id",label:"员工ID"},{default:t(({row:l})=>[n(_,null,{default:t(()=>[d(v(l.id?l.id:"-"),1)]),_:2},1024)]),_:1})):p("",!0),e.value.checkList.includes("userName")?(o(),r(m,{key:2,"show-overflow-tooltip":"",align:"center",prop:"userName",label:"用户名"},{default:t(({row:l})=>[d(v(l.userName?l.userName:"-"),1)]),_:1})):p("",!0),e.value.checkList.includes("name")?(o(),r(m,{key:3,"show-overflow-tooltip":"",align:"center",prop:"name",label:"姓名"},{default:t(({row:l})=>[d(v(l.name?l.name:"-"),1)]),_:1})):p("",!0),e.value.checkList.includes("groupId")?(o(),r(m,{key:4,"show-overflow-tooltip":"",align:"center",prop:"groupId",width:"150",label:"所属组"},{default:t(({row:l})=>[l.groupId?(o(),r(_,{key:0},{default:t(()=>[(o(!0),L(V,null,$(D.value,c=>(o(),r(_,null,{default:t(()=>[l.groupId===c.id?(o(),r(_,{key:0},{default:t(()=>[d(v(c.name?c.name:"-"),1)]),_:2},1024)):p("",!0)]),_:2},1024))),256))]),_:2},1024)):(o(),r(_,{key:1},{default:t(()=>[d("-")]),_:1}))]),_:1})):p("",!0),e.value.checkList.includes("positionId")?(o(),r(m,{key:5,"show-overflow-tooltip":"",align:"center",prop:"positionId",width:"150",label:"职位"},{default:t(({row:l})=>[(o(!0),L(V,null,$(E.value,c=>(o(),r(_,null,{default:t(()=>[l.positionId===c.id?(o(),r(_,{key:0},{default:t(()=>[d(v(c.name?c.name:"-"),1)]),_:2},1024)):p("",!0)]),_:2},1024))),256))]),_:1})):p("",!0),e.value.checkList.includes("pendingBalance")?(o(),r(m,{key:6,"show-overflow-tooltip":"",align:"center",prop:"pendingBalance",label:"待审提成"},{default:t(({row:l})=>[d(v(l.pendingBalance?l.pendingBalance:"-"),1)]),_:1})):p("",!0),e.value.checkList.includes("availableBalance")?(o(),r(m,{key:7,"show-overflow-tooltip":"",align:"center",prop:"availableBalance",label:"可用提成"},{default:t(({row:l})=>[d(v(l.availableBalance?l.availableBalance:"-"),1)]),_:1})):p("",!0),n(m,{fixed:"right",align:"center",width:"200",label:"操作"},{default:t(({row:l})=>[n(y,{type:"primary",size:"small",plain:"",onClick:c=>O(l)},{default:t(()=>[d(" 财务日志 ")]),_:2},1032,["onClick"]),n(y,{type:"primary",size:"small",plain:"",onClick:c=>K(l)},{default:t(()=>[d(" 加减款 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","size","stripe","data"])),[[ue,e.value.loading]]),n(ie,{"current-page":C(h).page,total:C(h).total,"page-size":C(h).size,"page-sizes":C(h).sizes,layout:C(h).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:j,onCurrentChange:g},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),n(Ne,{ref_key:"plusMinusPaymentsRef",ref:H,onFetchData:f},null,512),n(Ve,{ref_key:"financeLogRef",ref:M},null,512)],2)}}}),qe=Ee(xe,[["__scopeId","data-v-f7c971e0"]]);export{qe as default};
