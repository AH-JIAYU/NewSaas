
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as b}from"./department-DV6QWOpC.js";import{g as U}from"./group_manage-CRokxv59.js";import{d as F,r as l,k as A,n as M,l as j,a as s,p as J,q as O,o as v,b as y,f as o,w as n,s as P,g as V,F as $,t as z,e as G,E as w,v as H}from"./index-IH8YLq6l.js";import{u as K}from"./department-2CbS5hEY.js";const Q={style:{flex:"auto"}},ae=F({name:"Edit",__name:"index",emits:["success"],setup(W,{expose:k,emit:x}){K();const f=l(),S=l([]),p=x,_=l(""),h=l(),i=l(!1);l([]);const m=l(),r=l(!1),C=l({page:1,limit:10,id:null,name:"",commissionStatus:null}),a=l({name:"",departmentId:null,remark:"",commissionStatus:null}),E=l({invoiceCode:[{required:!0,trigger:"blur",message:"请输入姓名"}],tenantCustomerId:[{required:!0,trigger:"change",message:"请选择客户"}]});function I(){return new Promise(u=>{a.value.id?m.value&&m.value.validate(e=>{if(e)try{const d=H(a.value);b.edit(d).then(()=>{w.success({message:"编辑成功",center:!0}),p("success"),r.value=!1,u()})}catch{}finally{i.value=!1}}):m.value&&m.value.validate(e=>{if(e)try{delete a.value.id,U.create(a.value).then(()=>{w.success({message:"新增成功",center:!0}),p("success"),r.value=!1,u()})}catch{}finally{i.value=!1}})})}async function T(u){try{i.value=!0;const e=JSON.parse(u);a.value.departmentId=e.id,_.value="新增小组",r.value=!0,i.value=!1}catch{}finally{i.value=!1}}return A(async()=>{M(async()=>{const{data:e}=await j.getTenantStaffList();S.value=e});const{data:u}=await b.list(C.value);f.value=u.data,h.value=new Date}),k({showEdit:T}),(u,e)=>{const d=s("el-input"),c=s("el-form-item"),q=s("el-option"),B=s("el-select"),D=s("el-switch"),L=s("el-form"),g=s("el-button"),N=s("el-dialog"),R=J("loading");return O((v(),y("div",null,[o(N,{modelValue:r.value,"onUpdate:modelValue":e[4]||(e[4]=t=>r.value=t),title:_.value,width:"700"},{footer:n(()=>[P("div",Q,[o(g,{type:"",onClick:e[3]||(e[3]=t=>r.value=!1)},{default:n(()=>[V(" 取消 ")]),_:1}),o(g,{type:"primary",onClick:I},{default:n(()=>[V(" 确定 ")]),_:1})])]),default:n(()=>[o(L,{ref_key:"formRef",ref:m,"label-width":"80px",model:a.value,rules:E.value,inline:!1},{default:n(()=>[o(c,{prop:"name",label:"组名称"},{default:n(()=>[o(d,{modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.name=t),placeholder:"请输入组名称",clearable:""},null,8,["modelValue"])]),_:1}),o(c,{label:"所属部门"},{default:n(()=>[o(B,{modelValue:a.value.departmentId,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.departmentId=t),"value-key":"",placeholder:"请选择部门",clearable:"",filterable:""},{default:n(()=>[(v(!0),y($,null,z(f.value,t=>(v(),G(q,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(c,{label:"组提成"},{default:n(()=>[o(D,{modelValue:a.value.commissionStatus,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.commissionStatus=t),"inline-prompt":"","active-text":"启用","inactive-text":"禁用","active-value":1,"inactive-value":2},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])),[[R,i.value]])}}});export{ae as _};
