
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as R}from"./department-CJePYmqm.js";import{d as j,r as _,a as o,o as m,b,f as p,w as n,g as k,i as s,e as g,F,t as z,z as P,j as q,A as G,p as H}from"./index-CNsz2S3y.js";const Q=j({__name:"index",emits:["userData"],setup(J,{expose:x,emit:L}){const d=_(!1),l=_([]),h=_([]),v=_(),t=_({type:1,tenantStaffList:[],roleList:[]}),C={children:"children",label:"name"};async function N(e){await U(),t.value.type=1,d.value=!0,l.value=[];const a=await R.list({name:""});a.data&&(h.value=a.data),e&&e.chargeUserId&&(t.value.roleList=[e.chargeUserId],t.value.chargeUserName=e.chargeUserName,l.value=[e.departmentId])}const U=async()=>{const e=await H.getTenantStaffList();t.value.tenantStaffList=e.data};function V(){d.value=!1,l.value=v.value.getCheckedKeys(!1)}const S=(e,a)=>{a?(v.value.getCheckedKeys().forEach(c=>{c!==e.id&&v.value.setChecked(c,!1)}),l.value=[e.id]):l.value=l.value.filter(r=>r!==e.id)},D=()=>{},I=e=>{Array.isArray(e)&&e.length>1&&(t.value.roleList=[e[e.length-1]])};x({showEdit:N});const K=L;function T(){let e="",a="";t.value.roleList[0]&&(e=t.value.tenantStaffList.find(i=>i.id===t.value.roleList[0]).userName),l.value[0]&&(a=h.value.find(i=>i.id===l.value[0]).name);let r={chargeUserId:t.value.roleList[0],chargeUserName:e,departmentId:l.value[0],departmentName:a};d.value=!1,K("userData",r)}return(e,a)=>{const r=o("el-tree"),c=o("el-text"),i=o("el-tab-pane"),w=o("el-checkbox"),A=o("el-checkbox-group"),B=o("el-tabs"),y=o("el-button"),E=o("el-dialog");return m(),b("div",null,[p(E,{modelValue:s(d),"onUpdate:modelValue":a[2]||(a[2]=u=>G(d)?d.value=u:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:"请选择负责部门/人"},{footer:n(()=>[p(y,{onClick:V},{default:n(()=>[k(" 关闭 ")]),_:1}),p(y,{type:"primary",onClick:T},{default:n(()=>[k(" 确认 ")]),_:1})]),default:n(()=>[p(B,{modelValue:s(t).type,"onUpdate:modelValue":a[1]||(a[1]=u=>s(t).type=u),onTabChange:D},{default:n(()=>[p(i,{label:"部门",name:1},{default:n(()=>[s(h).length>0?(m(),g(r,{key:0,style:{"max-width":"600px"},ref_key:"treeRef",ref:v,disabled:!0,data:s(h),"show-checkbox":"","check-strictly":"","node-key":"id","default-expanded-keys":[],"default-checked-keys":s(l),"default-expand-all":"",props:C,onCheckChange:S},null,8,["data","default-checked-keys"])):(m(),g(c,{key:1},{default:n(()=>[k("暂无数据")]),_:1}))]),_:1}),p(i,{label:"员工",name:2},{default:n(()=>{var u;return[(u=s(t).tenantStaffList)!=null&&u.length?(m(),g(A,{key:0,onChange:I,modelValue:s(t).roleList,"onUpdate:modelValue":a[0]||(a[0]=f=>s(t).roleList=f)},{default:n(()=>[(m(!0),b(F,null,z(s(t).tenantStaffList,f=>(m(),g(w,{key:f.id,value:f.id,label:f.userName},{default:n(()=>[k(P(f.userName),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])):q("",!0)]}),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}});export{Q as _};
