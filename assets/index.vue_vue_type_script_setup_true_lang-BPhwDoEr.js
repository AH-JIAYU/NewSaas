
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as D}from"./finance_invoice-DCi1-1tT.js";import{d as L,r as d,k as O,a as i,l as h,n as F,o as v,b as f,f as t,w as o,p as J,g as k,F as x,q as U,e as P,E as M,t as $}from"./index-D5mKHCpP.js";const j={style:{flex:"auto"}},K=L({name:"Edit",__name:"index",emits:["success"],setup(z,{expose:I,emit:R}){const b=R,_=d(""),c=d(),Y=d(!1),V=d([]),r=d(),s=d(!1),E=[{lable:"未收款",value:1},{lable:"部分收款",value:2},{lable:"已完结",value:3},{lable:"坏账",value:4}],a=d({id:null,tenantCustomerId:"",invoiceCode:"",invoiceAmount:null,invoiceTax:null,actualReceipts:null,invoiceStatus:null,invoiceDate:"",paymentDate:"",remark:""}),S=d({invoiceCode:[{required:!0,trigger:"blur",message:"请输入姓名"}],tenantCustomerId:[{required:!0,trigger:"change",message:"请选择客户"}]});function T(){return new Promise(u=>{a.value.id?r.value&&r.value.validate(e=>{if(e){const p=$(a.value);D.edit(p).then(()=>{M.success({message:"编辑成功",center:!0}),b("success"),s.value=!1,u()})}}):r.value&&r.value.validate(e=>{e&&(delete a.value.id,D.create(a.value).then(()=>{M.success({message:"新增成功",center:!0}),b("success"),s.value=!1,u()}))})})}async function w(u,e){u?a.value=JSON.parse(u):a.value={id:null,tenantCustomerId:"",invoiceCode:"",invoiceAmount:null,invoiceTax:null,actualReceipts:null,invoiceStatus:null,invoiceDate:"",paymentDate:"",remark:""},_.value=u!=null&&u.id?"编辑":"新增",V.value=e,s.value=!0}return O(async()=>{c.value=new Date}),I({showEdit:w}),(u,e)=>{const p=i("el-option"),C=i("el-select"),n=i("el-form-item"),m=i("el-input"),A=i("ElOption"),g=i("el-date-picker"),B=i("el-form"),y=i("el-button"),N=i("el-dialog"),q=h("loading");return F((v(),f("div",null,[t(N,{modelValue:s.value,"onUpdate:modelValue":e[10]||(e[10]=l=>s.value=l),title:_.value,width:"700"},{footer:o(()=>[J("div",j,[t(y,{type:"",onClick:e[9]||(e[9]=l=>s.value=!1)},{default:o(()=>[k(" 取消 ")]),_:1}),t(y,{type:"primary",onClick:T},{default:o(()=>[k(" 确定 ")]),_:1})])]),default:o(()=>[t(B,{ref_key:"formRef",ref:r,"label-width":"80px",model:a.value,rules:S.value,inline:!1},{default:o(()=>[t(n,{label:"客户简称",prop:"tenantCustomerId"},{default:o(()=>[t(C,{modelValue:a.value.tenantCustomerId,"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.tenantCustomerId=l),placeholder:"请选择客户",clearable:"",filterable:""},{default:o(()=>[(v(!0),f(x,null,U(V.value,l=>(v(),P(p,{key:l.tenantCustomerId,value:l.tenantCustomerId,label:l.customerAccord},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{prop:"invoiceCode",label:"发票编号"},{default:o(()=>[t(m,{modelValue:a.value.invoiceCode,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.invoiceCode=l),placeholder:"请输入发票编号",clearable:""},null,8,["modelValue"])]),_:1}),t(n,{label:"发票金额"},{default:o(()=>[t(m,{modelValue:a.value.invoiceAmount,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.invoiceAmount=l),modelModifiers:{number:!0},placeholder:"请输入发票金额",clearable:""},null,8,["modelValue"])]),_:1}),t(n,{label:"手续费(税)"},{default:o(()=>[t(m,{modelValue:a.value.invoiceTax,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.invoiceTax=l),modelModifiers:{number:!0},placeholder:"请输入手续费",clearable:""},null,8,["modelValue"])]),_:1}),t(n,{label:"实际收款"},{default:o(()=>[t(m,{modelValue:a.value.actualReceipts,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.actualReceipts=l),modelModifiers:{number:!0},placeholder:"请输入实际收款",clearable:""},null,8,["modelValue"])]),_:1}),t(n,{label:"发票状态"},{default:o(()=>[t(C,{modelValue:a.value.invoiceStatus,"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.invoiceStatus=l),placeholder:"请选择发票状态",clearable:"",filterable:""},{default:o(()=>[(v(),f(x,null,U(E,l=>t(A,{label:l.lable,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(n,{style:{width:"100%"},label:"开票日期"},{default:o(()=>[t(g,{modelValue:a.value.invoiceDate,"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.invoiceDate=l),"default-time":c.value,type:"datetime",placeholder:"请选择开票日期","value-format":"YYYY-MM-DD hh:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),t(n,{label:"收款日期"},{default:o(()=>[t(g,{modelValue:a.value.paymentDate,"onUpdate:modelValue":e[7]||(e[7]=l=>a.value.paymentDate=l),"default-time":c.value,type:"datetime",placeholder:"请选择收款日期","value-format":"YYYY-MM-DD hh:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),t(n,{label:"备注"},{default:o(()=>[t(m,{modelValue:a.value.remark,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.remark=l),placeholder:"备注说明",clearable:"",rows:5,type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])),[[q,Y.value]])}}});export{K as _};
