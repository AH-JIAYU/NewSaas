
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as j}from"./department-DMxm4WQF.js";import{d as F,r as h,a as i,o as f,b as L,f as m,w as n,g as k,i as s,e as y,F as z,t as P,z as q,j as w,A as G,p as H}from"./index-CgGiKMhT.js";const Q=F({__name:"index",emits:["userData"],setup(J,{expose:x,emit:C}){const d=h(!1),l=h([]),_=h([]),v=h(),t=h({type:1,tenantStaffList:[],roleList:[]}),U={children:"children",label:"name"};async function N(e){await V(),t.value.type=1,d.value=!0,l.value=[];const a=await j.list({name:""});a.data&&(_.value=a.data),e&&(e.invitationType==1?e.chargeUserId&&(t.value.roleList=[e.chargeUserId],t.value.chargeUserName=e.chargeUserName):e.invitationType==2&&(l.value=[e.chargeUserId],t.value.chargeUserName=e.chargeUserName))}const V=async()=>{const e=await H.getTenantStaffList();t.value.tenantStaffList=e.data};function S(){d.value=!1}const T=(e,a)=>{a?(v.value.getCheckedKeys().forEach(r=>{r!==e.id&&v.value.setChecked(r,!1)}),l.value=[e.id]):l.value=l.value.filter(o=>o!==e.id),l.value.length&&(t.value.roleList=[])},D=()=>{},I=e=>{Array.isArray(e)&&e.length>1&&(t.value.roleList=[e[e.length-1]]),t.value.roleList.length!=0&&(l.value=[],v.value.setCheckedKeys([]))};x({showEdit:N});const K=C;function A(){let e="",a=null,o=null;t.value.roleList[0]&&(e=t.value.tenantStaffList.find(p=>p.id===t.value.roleList[0]).userName,a=t.value.roleList[0],o=1),l.value[0]&&(e=_.value.find(p=>p.id===l.value[0]).name,a=l.value[0],o=2);let r={chargeUserId:a,chargeUserName:e,invitationType:o};d.value=!1,K("userData",r)}return(e,a)=>{const o=i("el-tree"),r=i("el-text"),g=i("el-tab-pane"),p=i("el-checkbox"),B=i("el-checkbox-group"),E=i("el-tabs"),b=i("el-button"),R=i("el-dialog");return f(),L("div",null,[m(R,{modelValue:s(d),"onUpdate:modelValue":a[2]||(a[2]=c=>G(d)?d.value=c:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:"请选择负责部门/人"},{footer:n(()=>[m(b,{onClick:S},{default:n(()=>[k(" 关闭 ")]),_:1}),m(b,{type:"primary",onClick:A},{default:n(()=>[k(" 确认 ")]),_:1})]),default:n(()=>[m(E,{modelValue:s(t).type,"onUpdate:modelValue":a[1]||(a[1]=c=>s(t).type=c),onTabChange:D},{default:n(()=>[m(g,{label:"部门",name:1},{default:n(()=>[s(_).length>0?(f(),y(o,{key:0,style:{"max-width":"600px"},ref_key:"treeRef",ref:v,disabled:!0,data:s(_),"show-checkbox":"","check-strictly":"","node-key":"id","default-expanded-keys":[],"default-checked-keys":s(l),"default-expand-all":"",props:U,onCheckChange:T},null,8,["data","default-checked-keys"])):(f(),y(r,{key:1},{default:n(()=>[k("暂无数据")]),_:1}))]),_:1}),m(g,{label:"员工",name:2},{default:n(()=>{var c;return[(c=s(t).tenantStaffList)!=null&&c.length?(f(),y(B,{key:0,onChange:I,modelValue:s(t).roleList,"onUpdate:modelValue":a[0]||(a[0]=u=>s(t).roleList=u)},{default:n(()=>[(f(!0),L(z,null,P(s(t).tenantStaffList,u=>(f(),y(p,{key:u.id,value:u.id,label:u.userName},{default:n(()=>[k(q(u.userName),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])):w("",!0)]}),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}});export{Q as _};
