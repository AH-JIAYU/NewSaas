
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{g as V}from"./group_manage-DmgAu8Ww.js";import{u as B}from"./department-BKQXja9r.js";import{d as C,r as u,k as L,n as N,l as A,E as k,a as i,p as M,q as J,i as l,o as m,b as p,f as o,w as s,F as w,t as x,e as y,R as O}from"./index-lihZnDlK.js";import"./department-DO9yWr6Y.js";const P=C({__name:"index",props:["id","row"],setup(I,{expose:S}){const D=B(),f=u(),v=I,_=u([]),r=u(!1),d=u(),e=u({id:v.id,name:"",director:null,departmentId:null,remark:"",commissionStatus:null}),h=u({name:[{required:!0,message:"请输入部门名称",trigger:"blur"}],director:[{required:!0,message:"请选择组长",trigger:"change"}]});L(async()=>{r.value=!0,f.value=await D.getDepartment(),N(async()=>{const{data:n}=await A.list({id:"",userName:"",active:"",departmentId:""});_.value=n.data}),e.value.id!==""&&E(),r.value=!1});function E(){const n=JSON.parse(v.row);e.value=n}return S({submit(){try{return new Promise(n=>{delete e.value.count,e.value.id===""?d.value&&d.value.validate(t=>{t&&(delete e.value.id,r.value=!0,V.create(e.value).then(()=>{r.value=!1,k.success({message:"新增成功",center:!0}),n()}))}):d.value&&d.value.validate(t=>{t&&(r.value=!0,V.edit(e.value).then(()=>{r.value=!1,k.success({message:"编辑成功",center:!0}),n()}))})})}catch{}finally{r.value=!1}}}),(n,t)=>{const F=i("el-input"),c=i("el-form-item"),b=i("el-option"),g=i("el-select"),R=i("el-switch"),U=i("ElForm"),q=M("loading");return J((m(),p("div",null,[o(U,{ref_key:"formRef",ref:d,model:l(e),rules:l(h),"label-width":"130px","label-suffix":"："},{default:s(()=>[o(c,{label:"组名称",prop:"name"},{default:s(()=>[o(F,{modelValue:l(e).name,"onUpdate:modelValue":t[0]||(t[0]=a=>l(e).name=a),placeholder:"请输入组名称",clearable:"",disabled:!!l(e).id},null,8,["modelValue","disabled"])]),_:1}),o(c,{label:"所属部门",prop:"departmentId"},{default:s(()=>[o(g,{modelValue:l(e).departmentId,"onUpdate:modelValue":t[1]||(t[1]=a=>l(e).departmentId=a),"value-key":"",placeholder:"请选择所属部门",clearable:"",disabled:!!l(e).id,filterable:""},{default:s(()=>[(m(!0),p(w,null,x(l(f),a=>(m(),y(b,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),o(c,{label:"组长",prop:"director"},{default:s(()=>[o(g,{modelValue:l(e).director,"onUpdate:modelValue":t[2]||(t[2]=a=>l(e).director=a),"value-key":"",placeholder:"请选择组长",clearable:"",filterable:""},{default:s(()=>[(m(!0),p(w,null,x(l(_),a=>(m(),y(b,{key:a.id,label:a.name,value:a.id,disabled:a.distribution!==2},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(c,{label:"组提成",prop:"commissionStatus"},{default:s(()=>[o(R,{modelValue:l(e).commissionStatus,"onUpdate:modelValue":t[3]||(t[3]=a=>l(e).commissionStatus=a),"active-text":"启用","inactive-text":"禁用","inline-prompt":"","active-value":1,"inactive-value":2},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])),[[q,l(r)]])}}}),H=O(P,[["__scopeId","data-v-29a58726"]]);export{H as default};
