
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as F}from"./department-CLTDGeyr.js";import{g as M}from"./group_manage-BFXV487Q.js";import{d as P,r as n,k as $,n as j,l as z,a as s,p as G,q as H,o as d,b as v,f as t,w as o,s as J,g as w,F as y,t as x,e as C,E as S,v as K}from"./index-DQuRfXxB.js";import{u as O}from"./department-C1v4kl3H.js";const Q={style:{flex:"auto"}},le=P({name:"Edit",__name:"index",emits:["success"],setup(W,{expose:D,emit:E}){const I=O(),p=n(),f=n([]),_=E,b=n(""),U=n(),B=n(!1);n([]);const i=n(),u=n(!1),a=n({name:"",director:null,departmentId:null,remark:"",commissionStatus:null}),N=n({invoiceCode:[{required:!0,trigger:"blur",message:"请输入姓名"}],tenantCustomerId:[{required:!0,trigger:"change",message:"请选择客户"}]});function R(){return new Promise(r=>{a.value.id?i.value&&i.value.validate(l=>{if(l){const c=K(a.value);F.edit(c).then(()=>{S.success({message:"编辑成功",center:!0}),_("success"),u.value=!1,r()})}}):i.value&&i.value.validate(l=>{l&&(delete a.value.id,M.create(a.value).then(()=>{S.success({message:"新增成功",center:!0}),_("success"),u.value=!1,r()}))})})}async function T(){b.value="新增小组",u.value=!0}return $(async()=>{j(async()=>{const{data:r}=await z.list({id:"",userName:"",active:"",departmentId:""});f.value=r.data}),p.value=await I.getDepartment(),U.value=new Date}),D({showEdit:T}),(r,l)=>{const c=s("el-input"),m=s("el-form-item"),g=s("el-option"),V=s("el-select"),h=s("el-switch"),q=s("el-form"),k=s("el-button"),L=s("el-dialog"),A=G("loading");return H((d(),v("div",null,[t(L,{modelValue:u.value,"onUpdate:modelValue":l[5]||(l[5]=e=>u.value=e),title:b.value,width:"700"},{footer:o(()=>[J("div",Q,[t(k,{type:"",onClick:l[4]||(l[4]=e=>u.value=!1)},{default:o(()=>[w(" 取消 ")]),_:1}),t(k,{type:"primary",onClick:R},{default:o(()=>[w(" 确定 ")]),_:1})])]),default:o(()=>[t(q,{ref_key:"formRef",ref:i,"label-width":"80px",model:a.value,rules:N.value,inline:!1},{default:o(()=>[t(m,{prop:"name",label:"组名称"},{default:o(()=>[t(c,{modelValue:a.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value.name=e),placeholder:"请输入组名称",clearable:""},null,8,["modelValue"])]),_:1}),t(m,{label:"所属部门"},{default:o(()=>[t(V,{modelValue:a.value.departmentId,"onUpdate:modelValue":l[1]||(l[1]=e=>a.value.departmentId=e),"value-key":"",placeholder:"请选择部门",clearable:"",filterable:""},{default:o(()=>[(d(!0),v(y,null,x(p.value,e=>(d(),C(g,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"组长"},{default:o(()=>[t(V,{modelValue:a.value.director,"onUpdate:modelValue":l[2]||(l[2]=e=>a.value.director=e),"value-key":"",placeholder:"请选择组长",clearable:"",filterable:""},{default:o(()=>[(d(!0),v(y,null,x(f.value,e=>(d(),C(g,{key:e.id,label:e.name,value:e.id,disabled:e.distribution!==2},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"组提成"},{default:o(()=>[t(h,{modelValue:a.value.commissionStatus,"onUpdate:modelValue":l[3]||(l[3]=e=>a.value.commissionStatus=e),"inline-prompt":"","active-text":"启用","inactive-text":"禁用","active-value":1,"inactive-value":2},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])),[[A,B.value]])}}});export{le as _};
