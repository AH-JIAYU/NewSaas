
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ie,r as b,O as re,aN as ue,y as de,k as ce,G as M,J as pe,a as u,p as me,o,b as N,f as n,w as l,aC as S,g as r,H as v,q as fe,e as i,j as p,F as V,t as x,i as y,S as ge,N as ve,aP as he,aQ as _e,aq as be,aJ as ke,aK as ye,s as Ce,R as we}from"./index-BCb3LVAr.js";import{_ as Le}from"./index.vue_vue_type_style_index_0_lang-gsjcPjDc.js";import{_ as Ie}from"./index.vue_vue_type_script_setup_true_lang-DuGgmZIh.js";import{a as Ee}from"./financial_pm_log-TplyEVUE.js";import{_ as Be}from"./index.vue_vue_type_script_setup_true_lang-XDNQoiKd.js";import Ne from"./index-2yhvvMqT.js";import{u as Se}from"./position_manage-DP31xxHO.js";import{u as ze}from"./group_manage-BiaO_5JL.js";import{u as $e}from"./useTabbar-HHG2FLVc.js";import"./index.vue_vue_type_script_setup_true_lang-DsBBUNS6.js";import"./position_manage-DVoOZs2k.js";import"./group_manage-RN4Saixy.js";const De=C=>(ke("data-v-f51156a6"),C=C(),ye(),C),Pe=De(()=>Ce("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),He=ie({name:"financial_pm_log",__name:"list",setup(C){const L=Se(),z=b(),I=ze(),$=b();re();const{pagination:_,getParams:F,onSizeChange:U,onCurrentChange:R,onSortChange:A}=ue();$e(),de();const D=b(),P=b(),E=b([{label:"员工ID",prop:"id",sortable:!0,disableCheck:!1,checked:!0},{label:"用户名",prop:"userName",sortable:!0,disableCheck:!1,checked:!0},{label:"姓名",prop:"name",sortable:!0,disableCheck:!1,checked:!0},{label:"所属组",prop:"groupId",sortable:!0,disableCheck:!1,checked:!0},{label:"职位",prop:"positionId",sortable:!0,disableCheck:!1,checked:!0},{label:"待审提成",prop:"pendingBalance",sortable:!0,disableCheck:!1,checked:!0},{label:"可用提成",prop:"availableBalance",sortable:!0,disableCheck:!1,checked:!0}]),e=b({loading:!1,activeName:"myFinancial",tableAutoHeight:!1,border:!0,stripe:!1,lineHeight:"default",checkList:[],formMode:"drawer",formModeProps:{visible:!1,id:""},search:{page:1,limit:10,id:null,userName:"",name:""},batch:{enable:!1,selectionDataList:[]},dataList:[]});ce(async()=>{z.value=await(L==null?void 0:L.getPositionManage())||[],$.value=await(I==null?void 0:I.getGroupManage())||[],f(),e.value.formMode==="router"&&M.on("get-data-list",()=>{f()}),E.value.forEach(s=>{s.checked&&e.value.checkList.push(s.prop)})}),pe(()=>{e.value.formMode==="router"&&M.off("get-data-list")});function f(){e.value.loading=!0;const s={...F(),...e.value.search};Ee.list(s).then(a=>{e.value.loading=!1,e.value.dataList=a.data.data,_.value.total=+a.data.total})}function T(s){D.value.showEdit(JSON.stringify(s))}function K(s){P.value.showEdit(s)}function J(){Object.assign(e.value.search,{page:1,limit:10,id:null,userName:"",name:""}),f()}function O(s){U(s).then(()=>{e.value.search.limit=s,f()})}function g(s=1){R(s).then(()=>{e.value.search.page=s,f()})}function j({prop:s,order:a}){A(s,a).then(()=>f())}return(s,a)=>{const B=u("ElInput"),w=u("ElFormItem"),H=ve,k=u("ElButton"),q=u("ElForm"),G=Ie,Q=u("ElDivider"),W=Le,X=u("el-button"),Y=he,Z=_e,ee=u("el-row"),ae=u("el-table-column"),m=u("ElTableColumn"),h=u("el-text"),te=u("el-empty"),le=u("ElTable"),ne=u("ElPagination"),oe=be,se=me("loading");return o(),N("div",{class:ge({"absolute-container":e.value.tableAutoHeight})},[n(oe,null,{default:l(()=>[n(G,{"show-toggle":!1},{default:l(({fold:t,toggle:c})=>[n(q,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:l(()=>[n(w,null,{default:l(()=>[n(B,{modelValue:e.value.search.id,"onUpdate:modelValue":a[0]||(a[0]=d=>e.value.search.id=d),placeholder:"员工ID",clearable:"",onKeydown:a[1]||(a[1]=S(d=>g(),["enter"])),onClear:a[2]||(a[2]=d=>g())},null,8,["modelValue"])]),_:1}),n(w,null,{default:l(()=>[n(B,{modelValue:e.value.search.userName,"onUpdate:modelValue":a[3]||(a[3]=d=>e.value.search.userName=d),placeholder:"用户名",clearable:"",onKeydown:a[4]||(a[4]=S(d=>g(),["enter"])),onClear:a[5]||(a[5]=d=>g())},null,8,["modelValue"])]),_:1}),n(w,null,{default:l(()=>[n(B,{modelValue:e.value.search.name,"onUpdate:modelValue":a[6]||(a[6]=d=>e.value.search.name=d),placeholder:"姓名",clearable:"",onKeydown:a[7]||(a[7]=S(d=>g(),["enter"])),onClear:a[8]||(a[8]=d=>g())},null,8,["modelValue"])]),_:1}),n(w,null,{default:l(()=>[n(k,{type:"primary",onClick:a[9]||(a[9]=d=>g())},{icon:l(()=>[n(H,{name:"i-ep:search"})]),default:l(()=>[r(" 筛选 ")]),_:1}),n(k,{onClick:J},{icon:l(()=>[Pe]),default:l(()=>[r(" 重置 ")]),_:1}),n(k,{link:"",disabled:"",onClick:c},{icon:l(()=>[n(H,{name:t?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:l(()=>[r(" "+v(t?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),n(Q,{"border-style":"dashed"}),n(ee,null,{default:l(()=>[n(W),n(Z,null,{default:l(()=>[n(X,{size:"default"},{default:l(()=>[r(" 导出 ")]),_:1}),n(Y,{border:e.value.border,"onUpdate:border":a[10]||(a[10]=t=>e.value.border=t),tableAutoHeight:e.value.tableAutoHeight,"onUpdate:tableAutoHeight":a[11]||(a[11]=t=>e.value.tableAutoHeight=t),checkList:e.value.checkList,"onUpdate:checkList":a[12]||(a[12]=t=>e.value.checkList=t),columns:E.value,"onUpdate:columns":a[13]||(a[13]=t=>E.value=t),"line-height":e.value.lineHeight,"onUpdate:lineHeight":a[14]||(a[14]=t=>e.value.lineHeight=t),stripe:e.value.stripe,"onUpdate:stripe":a[15]||(a[15]=t=>e.value.stripe=t),style:{"margin-left":"12px"},onQueryData:f},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),fe((o(),i(le,{border:e.value.border,size:e.value.lineHeight,stripe:e.value.stripe,class:"my-4",data:e.value.dataList,"highlight-current-row":"",height:"100%",onSortChange:j,onSelectionChange:a[16]||(a[16]=t=>e.value.batch.selectionDataList=t)},{empty:l(()=>[n(te,{class:"vab-data-empty",description:"暂无数据"})]),default:l(()=>[n(ae,{align:"center",type:"selection"}),e.value.batch.enable?(o(),i(m,{key:0,type:"selection","show-overflow-tooltip":"",align:"center",fixed:""})):p("",!0),e.value.checkList.includes("id")?(o(),i(m,{key:1,"show-overflow-tooltip":"",align:"center",prop:"id",label:"员工ID"},{default:l(({row:t})=>[n(h,null,{default:l(()=>[r(v(t.id?t.id:"-"),1)]),_:2},1024)]),_:1})):p("",!0),e.value.checkList.includes("userName")?(o(),i(m,{key:2,"show-overflow-tooltip":"",align:"center",prop:"userName",label:"用户名"},{default:l(({row:t})=>[r(v(t.userName?t.userName:"-"),1)]),_:1})):p("",!0),e.value.checkList.includes("name")?(o(),i(m,{key:3,"show-overflow-tooltip":"",align:"center",prop:"name",label:"姓名"},{default:l(({row:t})=>[r(v(t.name?t.name:"-"),1)]),_:1})):p("",!0),e.value.checkList.includes("groupId")?(o(),i(m,{key:4,"show-overflow-tooltip":"",align:"center",prop:"groupId",width:"150",label:"所属组"},{default:l(({row:t})=>[t.groupId?(o(),i(h,{key:0},{default:l(()=>[(o(!0),N(V,null,x($.value,c=>(o(),i(h,null,{default:l(()=>[t.groupId===c.id?(o(),i(h,{key:0},{default:l(()=>[r(v(c.name?c.name:"-"),1)]),_:2},1024)):p("",!0)]),_:2},1024))),256))]),_:2},1024)):(o(),i(h,{key:1},{default:l(()=>[r("-")]),_:1}))]),_:1})):p("",!0),e.value.checkList.includes("positionId")?(o(),i(m,{key:5,"show-overflow-tooltip":"",align:"center",prop:"positionId",width:"150",label:"职位"},{default:l(({row:t})=>[(o(!0),N(V,null,x(z.value,c=>(o(),i(h,null,{default:l(()=>[t.positionId===c.id?(o(),i(h,{key:0},{default:l(()=>[r(v(c.name?c.name:"-"),1)]),_:2},1024)):p("",!0)]),_:2},1024))),256))]),_:1})):p("",!0),e.value.checkList.includes("pendingBalance")?(o(),i(m,{key:6,"show-overflow-tooltip":"",align:"center",prop:"pendingBalance",label:"待审提成"},{default:l(({row:t})=>[r(v(t.pendingBalance?t.pendingBalance:"-"),1)]),_:1})):p("",!0),e.value.checkList.includes("availableBalance")?(o(),i(m,{key:7,"show-overflow-tooltip":"",align:"center",prop:"availableBalance",label:"可用提成"},{default:l(({row:t})=>[r(v(t.availableBalance?t.availableBalance:"-"),1)]),_:1})):p("",!0),n(m,{fixed:"right",align:"center",width:"200",label:"操作"},{default:l(({row:t})=>[n(k,{type:"primary",size:"small",plain:"",onClick:c=>K(t)},{default:l(()=>[r(" 财务日志 ")]),_:2},1032,["onClick"]),n(k,{type:"primary",size:"small",plain:"",onClick:c=>T(t)},{default:l(()=>[r(" 加减款 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","size","stripe","data"])),[[se,e.value.loading]]),n(ne,{"current-page":y(_).page,total:y(_).total,"page-size":y(_).size,"page-sizes":y(_).sizes,layout:y(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:O,onCurrentChange:g},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),n(Be,{ref_key:"plusMinusPaymentsRef",ref:D,onFetchData:f},null,512),n(Ne,{ref_key:"financeLogRef",ref:P},null,512)],2)}}}),qe=we(He,[["__scopeId","data-v-f51156a6"]]);export{qe as default};
