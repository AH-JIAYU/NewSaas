
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as J,r as d,a as s,o as U,b as K,f as t,w as a,g as c,i as l,y as p,e as O,j as $,A as H,_ as L,aH as M,aI as z,E as G,L as Q}from"./index-CgGiKMhT.js";import{c as b}from"./user_cooperation-DbmetJsM.js";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-CElZmdO1.js";import"./department-DMxm4WQF.js";const k=m=>(M("data-v-b8a7b5c8"),m=m(),z(),m),X={style:{display:"flex"},class:"inviteDialog"},Y={slot:"label",style:{"margin-right":"15px"}},Z=k(()=>p("span",{style:{color:"#f56c6c"}},"*",-1)),w={slot:"label",style:{"margin-right":"15px"}},ee=k(()=>p("span",{style:{color:"#f56c6c"}},"*",-1)),oe=J({__name:"index",emits:["fetch-data"],setup(m,{expose:x,emit:I}){const N=I,i=d(!1),v=d(),e=d({form:{},rules:{priceRatio:[{required:!0,message:"请输入价格比例",trigger:"blur"}],sendProjectType:[{required:!0,message:"请选择发送项目",trigger:"change"}],receiveProjectType:[{required:!0,message:"请选择接收项目",trigger:"change"}]}});d([]);async function C(o){e.value.form.id=o.id,e.value.form.priceRatio=o.priceRatio,e.value.form.sendProjectType=o.sendProjectType?[o.sendProjectType]:null,e.value.form.receiveProjectType=o.receiveProjectType?[o.receiveProjectType]:null,e.value.form.chargeUserName=o.chargeUserName,e.value.form.invitationType=o.invitationType,e.value.form.chargeUserId=o.chargeUserId,i.value=!0}function _(){i.value=!1,e.value.form={},v.value.resetFields()}const y=d();function R(){y.value.showEdit()}async function V(o){await b.updateInvitationBindUser({id:e.value.form.id,chargeUserId:o.chargeUserId,invitationType:o.invitationType,chargeUserName:o.chargeUserName,sendProjectType:o.sendProjectType,receiveProjectType:o.receiveProjectType})}async function S(){await b.updateInvitationBind({id:e.value.form.id,priceRatio:e.value.form.priceRatio}),G.success({message:"修改成功",center:!0})}async function B(){v.value.validate(o=>{if(o){let r=JSON.parse(JSON.stringify(e.value.form));r.sendProjectType=e.value.form.sendProjectType.length!=0?e.value.form.sendProjectType[0]:null,r.receiveProjectType=e.value.form.receiveProjectType.length!=0?e.value.form.receiveProjectType[0]:null,r.receiveProjectType==2&&(e.value.form.chargeUserId=null,e.value.form.chargeUserName="",e.value.form.departmentId="",r.chargeUserId=null,r.chargeUserName="",r.invitationType=""),V(r),S(),N("fetch-data"),_()}})}const E=o=>{Array.isArray(o)&&o.length>1&&(e.value.form.sendProjectType=[o[o.length-1]])},A=o=>{Array.isArray(o)&&o.length>1&&(e.value.form.receiveProjectType=[o[o.length-1]])},q=o=>{o.preventDefault()};return x({showEdit:C}),(o,r)=>{const g=s("el-input"),u=s("el-form-item"),h=L,T=s("el-tooltip"),f=s("el-checkbox"),P=s("el-checkbox-group"),D=s("ElForm"),j=s("el-button"),F=s("el-dialog");return U(),K("div",null,[t(F,{modelValue:l(i),"onUpdate:modelValue":r[4]||(r[4]=n=>H(i)?i.value=n:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"40%",title:"合作配置"},{footer:a(()=>[t(j,{onClick:_},{default:a(()=>[c(" 关闭 ")]),_:1}),t(j,{type:"primary",onClick:B},{default:a(()=>[c(" 确认 ")]),_:1})]),default:a(()=>[t(D,{ref_key:"formRef",ref:v,rules:l(e).rules,model:l(e).form,"label-width":"7rem",labelPosition:"left"},{default:a(()=>[t(u,{label:"价格比例",prop:"priceRatio"},{default:a(()=>[t(g,{modelValue:l(e).form.priceRatio,"onUpdate:modelValue":r[0]||(r[0]=n=>l(e).form.priceRatio=n),clearable:""},{append:a(()=>[c("%")]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"项目分配方式","label-width":"7rem"}),p("div",X,[t(u,{prop:"sendProjectType"},{default:a(()=>[p("span",Y,[t(T,{effect:"dark",content:"1111111",placement:"top-start"},{default:a(()=>[t(h,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1}),Z,c(" 发送项目 ")]),t(P,{modelValue:l(e).form.sendProjectType,"onUpdate:modelValue":r[1]||(r[1]=n=>l(e).form.sendProjectType=n),onChange:E},{default:a(()=>[t(f,{value:1},{default:a(()=>[c(" 自动 ")]),_:1}),t(f,{value:2},{default:a(()=>[c(" 手动 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(u,{prop:"receiveProjectType",style:{"margin-left":"40px"}},{default:a(()=>[p("span",w,[t(T,{effect:"dark",content:"1111111",placement:"top-start"},{default:a(()=>[t(h,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1}),ee,c(" 接收项目 ")]),t(P,{modelValue:l(e).form.receiveProjectType,"onUpdate:modelValue":r[2]||(r[2]=n=>l(e).form.receiveProjectType=n),onChange:A},{default:a(()=>[t(f,{value:1},{default:a(()=>[c(" 自动 ")]),_:1}),t(f,{value:2},{default:a(()=>[c(" 手动 ")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),l(e).form.receiveProjectType&&l(e).form.receiveProjectType[0]==1?(U(),O(g,{key:0,placeholder:"请选择接收项目负责人",onKeydown:q,onClick:R,modelValue:l(e).form.chargeUserName,"onUpdate:modelValue":r[3]||(r[3]=n=>l(e).form.chargeUserName=n)},null,8,["modelValue"])):$("",!0)]),_:1},8,["rules","model"])]),_:1},8,["modelValue"]),t(W,{ref_key:"userRef",ref:y},null,512)])}}}),ne=Q(oe,[["__scopeId","data-v-b8a7b5c8"]]);export{ne as default};
