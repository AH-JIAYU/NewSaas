
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as O}from"./index-D-btMl2l.js";import{a as Q}from"./department-DQERDib2.js";import{d as W,r as v,a as i,o as r,b as g,f as u,w as s,y as f,g as k,i as l,F as S,t as V,z as N,j,e as b,A as X,p as Y,aH as Z,aI as $,L as ee}from"./index-Bn2GMQXG.js";const x=y=>(Z("data-v-23289ab2"),y=y(),$(),y),te={key:0},ae=x(()=>f("span",{class:"project-name"},"项目",-1)),le={class:"project-content"},se={style:{display:"flex"}},ne={style:{"font-weight":"500"}},oe={style:{"margin-left":"10px"}},ce=x(()=>f("span",{class:"custom-tab-label"},"部门",-1)),ie=x(()=>f("div",{style:{color:"#333333","font-weight":"500","font-size":"14px","margin-bottom":"10px"}}," 分配部门 ",-1)),de=x(()=>f("span",{class:"custom-tab-label",style:{"margin-left":"20px"}},"员工",-1)),re={class:"flex-c"},ue=W({__name:"index",emits:["userData"],setup(y,{expose:T,emit:D}){const p=v(!1),c=v([]),L=v([]),m=v(),e=v({type:1,tenantStaffList:[],roleList:[],title:"",project:[]}),B={children:"children",label:"name"};async function K(t,a,n){await w(),e.value.type=1,p.value=!0,c.value=[];const d=await Q.list({name:""});d.data&&(L.value=d.data),t&&(t.invitationType==1?t.chargeUserId&&(e.value.roleList=[t.chargeUserId],e.value.chargeUserName=t.chargeUserName):t.invitationType==2&&(c.value=[t.chargeUserId],e.value.chargeUserName=t.chargeUserName)),e.value.title=a,n&&(e.value.project=n)}const w=async()=>{const t=await Y.getTenantStaffList();e.value.tenantStaffList=t.data};function A(){p.value=!1}const E=(t,a)=>{a?(m.value.getCheckedKeys().forEach(d=>{d!==t.id&&m.value.setChecked(d,!1)}),c.value=[t.id]):c.value=c.value.filter(n=>n!==t.id),c.value.length&&(e.value.roleList=[])},R=()=>{},z=t=>{Array.isArray(t)&&t.length>1&&(e.value.roleList=[t[t.length-1]]),e.value.roleList.length!=0&&(c.value=[],m.value.setCheckedKeys([]))};T({showEdit:K});const F=D;function H(){let t="",a=null,n=null;e.value.roleList[0]&&(t=e.value.tenantStaffList.find(h=>h.id===e.value.roleList[0]).userName,a=e.value.roleList[0],n=1),c.value[0]&&(t=m.value.getCheckedNodes().map(h=>h.name)[0],a=c.value[0],n=2);let d={chargeUserId:a,chargeUserName:t,invitationType:n};p.value=!1,F("userData",d)}return(t,a)=>{const n=i("el-badge"),d=O,C=i("el-divider"),h=i("el-tree"),P=i("el-text"),I=i("el-tab-pane"),q=i("el-checkbox"),G=i("el-checkbox-group"),J=i("el-tabs"),U=i("el-button"),M=i("el-dialog");return r(),g("div",null,[u(M,{modelValue:l(p),"onUpdate:modelValue":a[2]||(a[2]=o=>X(p)?p.value=o:null),"close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"30%",title:l(e).title,class:"userClass"},{footer:s(()=>[f("div",re,[u(U,{onClick:A},{default:s(()=>[k(" 取消 ")]),_:1}),u(U,{type:"primary",onClick:H},{default:s(()=>[k(" 确认 ")]),_:1})])]),default:s(()=>[l(e).project.length!=0?(r(),g("div",te,[u(n,{value:l(e).project.length,max:99,class:"item"},{default:s(()=>[ae]),_:1},8,["value"]),f("div",le,[(r(!0),g(S,null,V(l(e).project,o=>(r(),g("div",{key:o.id},[f("div",se,[f("span",ne,N(o.tenantName),1),f("span",oe,"ID:"+N(o.tenantId),1),u(d,{content:o.tenantId},null,8,["content"])])]))),128))]),u(C)])):j("",!0),u(J,{modelValue:l(e).type,"onUpdate:modelValue":a[1]||(a[1]=o=>l(e).type=o),onTabChange:R},{default:s(()=>[u(I,{label:"部门",name:1},{label:s(()=>[ce]),default:s(()=>[ie,l(L).length>0?(r(),b(h,{key:0,style:{"max-width":"600px"},ref_key:"treeRef",ref:m,disabled:!0,data:l(L),"show-checkbox":"","check-strictly":"","node-key":"id","default-expanded-keys":[],"default-checked-keys":l(c),"default-expand-all":"",props:B,onCheckChange:E,"check-on-click-node":!0,"expand-on-click-node":!1},null,8,["data","default-checked-keys"])):(r(),b(P,{key:1},{default:s(()=>[k("暂无数据")]),_:1}))]),_:1}),u(I,{name:2},{label:s(()=>[de]),default:s(()=>{var o;return[(o=l(e).tenantStaffList)!=null&&o.length?(r(),b(G,{key:0,onChange:z,modelValue:l(e).roleList,"onUpdate:modelValue":a[0]||(a[0]=_=>l(e).roleList=_)},{default:s(()=>[(r(!0),g(S,null,V(l(e).tenantStaffList,_=>(r(),b(q,{key:_.id,value:_.id,label:_.userName},{default:s(()=>[k(N(_.userName),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])):j("",!0)]}),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"])])}}}),me=ee(ue,[["__scopeId","data-v-23289ab2"]]);export{me as u};
