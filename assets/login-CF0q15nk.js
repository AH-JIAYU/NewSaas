
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as ke}from"./index.vue_vue_type_script_setup_true_lang-GlQ72m66.js";import{k as X,d as Ne,t as Ue,a0 as Ie,a1 as Re,r as u,b6 as V,b7 as Y,aN as Pe,a2 as qe,b as ee,f as l,w as o,l as d,am as Z,aA as M,i as e,v as Te,a as c,aF as Fe,aG as Se,O as Le,b8 as Ae,o as v,p as $e,aB as ze,g,I as C,e as h,ay as ae,j as I,ax as G,F as Be,n as De,ak as T,N as Ke,_ as Ze,q as le}from"./index-CnVmOx-r.js";import Me from"./index-BI78Z2rJ.js";import{s as Ge,o as oe}from"./apiLoading-6Uvc37Hd.js";import{u as Oe}from"./otherFunctions_basicDictionary-BQSk-yYe.js";import"./basicDictionary-CjPG3DTv.js";const F={sendCode:y=>X.post("user/sendCode",y),register:y=>X.post("user/register",y)},R=y=>(Fe("data-v-f87161ea"),y=y(),Se(),y),je=R(()=>d("div",{class:"bg-banner"},null,-1)),He={id:"login-box"},Je=R(()=>d("div",{class:"login-banner"},[d("h1",{style:{"font-size":"50px","font-weight":"normal"}},"欢迎 !"),d("h3",{h1:"",style:{"font-size":"30px","font-weight":"normal"}}," 来到租户系统 ! 👋🏻 ")],-1)),Qe={class:"title-container"},We={class:"fx-c"},Xe={class:"flex-bar"},Ye={class:"sub-link"},ea=R(()=>d("span",{class:"text"},"还不是会员?",-1)),aa={class:"sub-link"},la=R(()=>d("span",{class:"text"},"已经有帐号?",-1)),oa=R(()=>d("div",{class:"title-container"},[d("h3",{class:"title"},"忘记密码了? 🔒")],-1)),ta={class:"sub-link"},te=Ne({name:"Login",__name:"login",setup(y){var H;const re=Oe(),ne=Te(),se=Le(),ie=Ue(),ue=Ie(),{t:f}=Re();new URL(""+new URL("login-banner-ZfMZACb6.png",import.meta.url).href,import.meta.url).href,new URL(""+new URL("logo-CLz_KCqM.png",import.meta.url).href,import.meta.url).href;const _=u("login"),E=u(!1),de=u(((H=ne.query.redirect)==null?void 0:H.toString())??ie.settings.home.fullPath),k=u(),w=u("code"),S=u("获取验证码"),L=u(!1),i=u({account:V.local.get("login_account")||"",remember:V.local.has("login_account"),agreeToTheAgreement:!1}),pe=(s,a,n)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(i.value.account)?n():n(new Error("请输入合法手机号"))},me=(s,a,n)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(i.value.account)?n():n(new Error("请输入合法邮箱"))},P=u({account:[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}],agreeToTheAgreement:[{required:!0,validator:(s,a)=>a===!0,message:"请阅读并勾选协议",trigger:"change"}]}),ce=()=>{i.value.account.includes("@")?P.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"},{validator:me,trigger:"blur"}]:P.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"},{validator:pe,trigger:"blur"}]};async function ge(){k.value.validateField("account",async s=>{if(s){let a;i.value.account.includes("@")?a={email:i.value.account,type:"login_email"}:a={phone:i.value.account,type:"login_phone_number"};const{status:n}=await F.sendCode(a);n===1&&T.success({message:"已发送"})}}),fe()}const fe=()=>{L.value=!0;let s=60;b.value=setInterval(()=>{s>0?(s--,S.value=`请在${s}s后重新获取`):(clearInterval(b.value),S.value="获取验证码",b.value=null,L.value=!1)},1e3)},A=Y(()=>{k.value&&k.value.validate(s=>{if(s){let a={...i.value};w.value==="password"?a.type=1:i.value.account.includes("@")?a.type=3:a.type=2,E.value=!0,ue.login(a).then(()=>{E.value=!1,i.value.remember?V.local.set("login_account",i.value.account):V.local.remove("login_account"),se.push(de.value)}).catch(()=>{E.value=!1})}})},3e3),b=u(null),$=u("获取验证码"),z=u(!1),q=u(),O=u([]),r=u({name:"",password:"",email:"",phoneNumber:"",code:"",country:"",type:"phone",agreeToTheAgreement:!1,companyType:"personal",companyName:"",legalPersonName:"",taxID:""}),ve=u({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],email:[{required:!0,trigger:"blur",message:"请输入邮箱"},{validator:(s,a,n)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(r.value.email)?n():n(new Error("请输入合法邮箱"))},trigger:"blur"}],phoneNumber:[{required:!0,trigger:"blur",message:"请输入手机号码"},{validator:(s,a,n)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(r.value.phoneNumber)?n():n(new Error("请输入合法手机号"))},trigger:"blur"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],country:[{required:!0,trigger:"change",message:"请选择国家"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}],agreeToTheAgreement:[{required:!0,validator:(s,a)=>a===!0,message:"请阅读并勾选协议",trigger:"change"}]}),ye=async()=>{const s={type:"register_phone_number",email:r.value.email,phone:r.value.phoneNumber};if(r.value.country==="CN"){const{status:a}=await oe(F.sendCode(s));a===1&&T.success({message:"已发送"})}else{s.type="register_email";const{status:a}=await oe(F.sendCode(s));a===1&&T.success({message:"已发送"})}_e()},_e=()=>{z.value=!0;let s=60;b.value=setInterval(()=>{s>0?(s--,$.value=`请在${s}s后重新获取`):(clearInterval(b.value),$.value="获取验证码",b.value=null,z.value=!1)},1e3)},be=Y(async()=>{q.value&&q.value.validate(async s=>{if(s){r.value.type=r.value.country==="CN"?"phone":"email",r.value.companyName="",r.value.legalPersonName="",r.value.taxID="",delete r.value.agreeToTheAgreement;const{status:a}=await Ge(F.register(r.value));a===1&&Ae({type:"success",dangerouslyUseHTMLString:!0,duration:5e3,message:'<span>注册成功,跳转至<span id="ElNotification-goLogin" style="color:var(--el-color-primary);cursor:pointer;">登录</span></span>',onClick(n){n.target.id&&n.target.id==="ElNotification-goLogin"&&(_.value="login")}})}})},3e3),B=u(),x=u({account:V.local.get("login_account"),code:"",newPassword:""}),he=u({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],newPassword:[{required:!0,trigger:"blur",message:"请输入新密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}]});function we(){T({message:"重置密码仅提供界面演示，无实际功能，需开发者自行扩展",type:"info"}),B.value&&B.value.validate(s=>{})}Pe(()=>{clearInterval(b.value),b.value=null});const j=()=>{P.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"}],k.value.resetFields()};return qe(()=>_.value,async s=>{switch(s){case"login":j(),i.value={account:V.local.get("login_account")||"",remember:V.local.has("login_account")};break;case"register":q.value.resetFields(),r.value={name:"",password:"",email:"",phoneNumber:"",code:"",country:"",type:"phone"};break}s==="register"&&(O.value=await re.getCountry())}),(s,a)=>{const n=Ke,N=ke,J=c("el-radio-button"),Q=c("el-radio-group"),xe=c("el-button"),m=c("ElInput"),p=c("ElFormItem"),Ve=c("ElCheckbox"),U=c("ElButton"),D=c("ElLink"),K=c("ElForm"),W=c("el-radio"),Ee=c("ElOption"),Ce=c("ElSelect");return v(),ee("div",null,[je,l(N,{placement:"bottom-end",class:"i18n-selector"},{default:o(()=>[l(n,{name:"i-ri:translate"})]),_:1}),d("div",He,[Je,Z(l(K,{ref_key:"loginFormRef",ref:k,model:e(i),rules:e(P),class:"login-form","validate-on-rule-change":!1},{default:o(()=>[d("div",Qe,[d("div",We,[l(Q,{modelValue:e(w),"onUpdate:modelValue":a[0]||(a[0]=t=>$e(w)?w.value=t:null),size:"large",onChange:j},{default:o(()=>[l(J,{label:"验证码登录",value:"code"}),l(J,{label:"密码登录",value:"password"})]),_:1},8,["modelValue"])])]),d("div",null,[l(p,{prop:"account"},{default:o(()=>[l(m,{modelValue:e(i).account,"onUpdate:modelValue":a[1]||(a[1]=t=>e(i).account=t),placeholder:e(f)("app.account"),type:"text",tabindex:"1",onBlur:ce},ze({prefix:o(()=>[l(n,{name:"i-ri:user-3-fill"})]),_:2},[e(w)==="code"?{name:"append",fn:o(()=>[l(xe,{type:"primary",disabled:e(L),onClick:ge},{default:o(()=>[g(C(e(S)),1)]),_:1},8,["disabled"])]),key:"0"}:void 0]),1032,["modelValue","placeholder"])]),_:1}),e(w)==="password"?(v(),h(p,{key:0,prop:"password"},{default:o(()=>[l(m,{modelValue:e(i).password,"onUpdate:modelValue":a[2]||(a[2]=t=>e(i).password=t),type:"password",placeholder:e(f)("app.password"),tabindex:"2",autocomplete:"new-password","show-password":"",onKeyup:ae(e(A),["enter"])},{prefix:o(()=>[l(n,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue","placeholder","onKeyup"])]),_:1})):I("",!0),e(w)==="code"?(v(),h(p,{key:1,prop:"code"},{default:o(()=>[l(m,{modelValue:e(i).code,"onUpdate:modelValue":a[3]||(a[3]=t=>e(i).code=t),type:"text",placeholder:e(f)("app.captcha"),tabindex:"2",onKeyup:ae(e(A),["enter"])},{prefix:o(()=>[l(n,{name:"i-ep:message"})]),_:1},8,["modelValue","placeholder","onKeyup"])]),_:1})):I("",!0)]),d("div",Xe,[l(Ve,{modelValue:e(i).remember,"onUpdate:modelValue":a[4]||(a[4]=t=>e(i).remember=t),tabindex:"4"},{default:o(()=>[g(" 保持登录 ")]),_:1},8,["modelValue"])]),l(U,{loading:e(E),type:"primary",size:"large",style:{width:"100%"},onClick:G(e(A),["prevent"]),tabindex:"5"},{default:o(()=>[g(C(e(f)("app.login")),1)]),_:1},8,["loading","onClick"]),d("div",Ye,[ea,l(D,{type:"primary",underline:!1,onClick:a[5]||(a[5]=t=>_.value="register")},{default:o(()=>[g(" 立即注册 ")]),_:1})])]),_:1},8,["model","rules"]),[[M,e(_)==="login"]]),Z(l(K,{ref_key:"registerFormRef",ref:q,model:e(r),rules:e(ve),class:"login-form","auto-complete":"on"},{default:o(()=>[d("div",null,[l(p,{label:"账号类型",prop:""},{default:o(()=>[l(Q,{modelValue:e(r).companyType,"onUpdate:modelValue":a[6]||(a[6]=t=>e(r).companyType=t),class:"ml-4"},{default:o(()=>[l(W,{value:"personal"},{default:o(()=>[g(" 个人 ")]),_:1}),l(W,{value:"company"},{default:o(()=>[g(" 公司 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(r).companyType==="company"?(v(),h(p,{key:0,prop:"companyName"},{default:o(()=>[l(m,{modelValue:e(r).companyName,"onUpdate:modelValue":a[7]||(a[7]=t=>e(r).companyName=t),placeholder:"请输入公司名称"},null,8,["modelValue"])]),_:1})):I("",!0),e(r).companyType==="company"?(v(),h(p,{key:1,prop:"taxID"},{default:o(()=>[l(m,{modelValue:e(r).taxID,"onUpdate:modelValue":a[8]||(a[8]=t=>e(r).taxID=t),placeholder:"请输入公司税号"},null,8,["modelValue"])]),_:1})):I("",!0),e(r).companyType==="company"?(v(),h(p,{key:2,prop:"legalPersonName"},{default:o(()=>[l(m,{modelValue:e(r).legalPersonName,"onUpdate:modelValue":a[9]||(a[9]=t=>e(r).legalPersonName=t),placeholder:"请输入法人姓名"},null,8,["modelValue"])]),_:1})):I("",!0),l(p,{prop:"name"},{default:o(()=>[l(m,{modelValue:e(r).name,"onUpdate:modelValue":a[10]||(a[10]=t=>e(r).name=t),placeholder:"用户名",tabindex:"1"},{prefix:o(()=>[l(n,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue"])]),_:1}),l(p,{prop:"country"},{default:o(()=>[l(Ce,{modelValue:e(r).country,"onUpdate:modelValue":a[11]||(a[11]=t=>e(r).country=t),placeholder:"国家",clearable:"",filterable:"",tabindex:"2"},{prefix:o(()=>[l(n,{name:"i-mdi:format-list-bulleted-type"})]),default:o(()=>[(v(!0),ee(Be,null,De(e(O),t=>(v(),h(Ee,{label:t.chineseName,value:t.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),e(r).country==="CN"?(v(),h(p,{key:3,prop:"phoneNumber"},{default:o(()=>[l(m,{modelValue:e(r).phoneNumber,"onUpdate:modelValue":a[12]||(a[12]=t=>e(r).phoneNumber=t),placeholder:"手机号",tabindex:"3"},{prefix:o(()=>[l(n,{name:"i-ant-design:phone-outlined"})]),_:1},8,["modelValue"])]),_:1})):(v(),h(p,{key:4,prop:"email"},{default:o(()=>[l(m,{modelValue:e(r).email,"onUpdate:modelValue":a[13]||(a[13]=t=>e(r).email=t),placeholder:"邮箱",tabindex:"3"},{prefix:o(()=>[l(n,{name:"i-mdi:email"})]),_:1},8,["modelValue"])]),_:1})),l(p,{prop:"code"},{default:o(()=>[l(m,{modelValue:e(r).code,"onUpdate:modelValue":a[14]||(a[14]=t=>e(r).code=t),placeholder:"验证码",tabindex:"4"},{prefix:o(()=>[l(n,{name:"i-ic:baseline-verified-user"})]),append:o(()=>[l(U,{disabled:e(z),onClick:ye},{default:o(()=>[g(C(e($)),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),l(p,{prop:"password"},{default:o(()=>[l(m,{modelValue:e(r).password,"onUpdate:modelValue":a[15]||(a[15]=t=>e(r).password=t),type:"password",placeholder:"密码",tabindex:"5","show-password":""},{prefix:o(()=>[l(n,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue"])]),_:1})]),l(U,{tabindex:"7",loading:e(E),type:"primary",size:"large",style:{width:"100%","margin-top":"20px"},onClick:G(e(be),["prevent"])},{default:o(()=>[g(" 注册 ")]),_:1},8,["loading","onClick"]),d("div",aa,[la,l(D,{type:"primary",underline:!1,onClick:a[16]||(a[16]=t=>_.value="login")},{default:o(()=>[g(" 去登录 ")]),_:1})])]),_:1},8,["model","rules"]),[[M,e(_)==="register"]]),Z(l(K,{ref_key:"resetFormRef",ref:B,model:e(x),rules:e(he),class:"login-form"},{default:o(()=>[oa,d("div",null,[l(p,{prop:"account"},{default:o(()=>[l(m,{modelValue:e(x).account,"onUpdate:modelValue":a[17]||(a[17]=t=>e(x).account=t),placeholder:e(f)("app.account"),type:"text",tabindex:"1"},{prefix:o(()=>[l(n,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1}),l(p,{prop:"code"},{default:o(()=>[l(m,{modelValue:e(x).code,"onUpdate:modelValue":a[18]||(a[18]=t=>e(x).code=t),placeholder:e(f)("app.code"),type:"text",tabindex:"2"},{prefix:o(()=>[l(n,{name:"i-ic:baseline-verified-user"})]),append:o(()=>[l(U,null,{default:o(()=>[g(C(e(f)("app.sendCaptcha")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),l(p,{prop:"newPassword"},{default:o(()=>[l(m,{modelValue:e(x).newPassword,"onUpdate:modelValue":a[19]||(a[19]=t=>e(x).newPassword=t),type:"password",placeholder:e(f)("app.newPassword"),tabindex:"3","show-password":""},{prefix:o(()=>[l(n,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1})]),l(U,{loading:e(E),type:"primary",size:"large",style:{width:"100%","margin-top":"20px"},onClick:G(we,["prevent"])},{default:o(()=>[g(C(e(f)("app.check")),1)]),_:1},8,["loading"]),d("div",ta,[l(D,{type:"primary",underline:!1,onClick:a[20]||(a[20]=t=>_.value="login")},{default:o(()=>[g(C(e(f)("app.goLogin")),1)]),_:1})])]),_:1},8,["model","rules"]),[[M,e(_)==="reset"]])]),l(Me)])}}});typeof le=="function"&&le(te);const ca=Ze(te,[["__scopeId","data-v-f87161ea"]]);export{ca as default};
