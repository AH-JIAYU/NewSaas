
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ae,r as f,J as te,aO as le,y as oe,n as ne,z as S,C as ie,a as s,q as se,o as i,b as z,f as t,w as l,g as p,s as re,e as r,i as h,aN as ue,j as d,v as I,A as _,F as ce,t as pe,O as de,aQ as me,aR as fe,ap as ge,M as he}from"./index-BL1kLiLm.js";import{_ as _e}from"./index-wvHHnhmk.js";import{_ as be}from"./index.vue_vue_type_style_index_0_lang-hyU7YDMo.js";import{_ as ve}from"./index-CBtDIxyt.js";import{a as ke}from"./financial_pm_log-uDSXJ9Fm.js";import{_ as ye}from"./index.vue_vue_type_script_setup_true_lang-EEMTXXzq.js";import Ce from"./index-CzOIwGMz.js";import{u as Le}from"./position_manage-DcVLVOXD.js";import{u as we}from"./useTabbar-Pufg5_nu.js";import"./index-CQsjDEZM.js";import"./index.vue_vue_type_script_setup_true_lang-CacQXORc.js";import"./sortable.esm-C0-Qcoum.js";import"./position_manage-iX5eTbcz.js";const Be={class:"copyId tableSmall"},Ne={class:"id oneLine"},Se=ae({name:"financial_pm_log",__name:"list",setup(ze){const v=Le(),k=f();te();const{pagination:g,getParams:D,onSizeChange:x,onCurrentChange:E,onSortChange:P}=le();we(),oe();const C=f(),L=f(),w=f(),H=f("formSearch-financial_pm_log"),y=f([{label:"员工ID",prop:"id",sortable:!0,disableCheck:!1,checked:!0},{label:"用户名",prop:"userName",sortable:!0,disableCheck:!1,checked:!0},{label:"姓名",prop:"name",sortable:!0,disableCheck:!1,checked:!0},{label:"所属组",prop:"groupId",sortable:!0,disableCheck:!1,checked:!0},{label:"职位",prop:"positionId",sortable:!0,disableCheck:!1,checked:!0},{label:"待审提成",prop:"pendingBalance",sortable:!0,disableCheck:!1,checked:!0},{label:"可用提成",prop:"availableBalance",sortable:!0,disableCheck:!1,checked:!0}]),e=f({loading:!1,activeName:"myFinancial",tableAutoHeight:!1,border:!1,stripe:!1,lineHeight:"default",checkList:[],formMode:"drawer",formModeProps:{visible:!1,id:""},search:{page:1,limit:10,id:null,userName:"",name:"",positionId:null},batch:{enable:!1,selectionDataList:[]},dataList:[]});function u(){try{e.value.loading=!0;const n={...D(),...e.value.search};ke.list(n).then(o=>{e.value.loading=!1,e.value.dataList=o.data.data,g.value.total=+o.data.total})}catch{}finally{e.value.loading=!1}}function M(n){C.value.showEdit(JSON.stringify(n))}function R(n){L.value.showEdit(n)}function A(){Object.assign(e.value.search,{page:1,limit:10,id:null,userName:"",name:"",positionId:null}),u()}function F(n){x(n).then(()=>{e.value.search.limit=n,u()})}function B(n=1){E(n).then(()=>{e.value.search.page=n,u()})}function T({prop:n,order:o}){P(n,o).then(()=>u())}ne(async()=>{k.value=await(v==null?void 0:v.getPositionManage())||[],u(),e.value.formMode==="router"&&S.on("get-data-list",()=>{u()}),y.value.forEach(n=>{n.checked&&e.value.checkList.push(n.prop)}),w.value=[{index:1,show:!0,type:"input",modelName:"id",placeholder:"员工ID"},{index:2,show:!0,type:"input",modelName:"userName",placeholder:"用户名"},{index:3,show:!0,type:"input",modelName:"name",placeholder:"姓名"},{index:4,show:!0,type:"select",modelName:"positionId",placeholder:"职位",option:"positionId",optionLabel:"name",optionValue:"id"}]});const U={positionId:()=>k.value};return ie(()=>{e.value.formMode==="router"&&S.off("get-data-list")}),(n,o)=>{const O=ve,$=s("ElDivider"),V=be,j=s("el-button"),J=me,Q=fe,q=s("el-row"),G=s("el-table-column"),c=s("ElTableColumn"),K=_e,m=s("el-text"),N=s("ElButton"),W=s("el-empty"),X=s("ElTable"),Y=s("ElPagination"),Z=ge,ee=se("loading");return i(),z("div",{class:de({"absolute-container":e.value.tableAutoHeight})},[t(Z,null,{default:l(()=>[t(O,{formSearchList:w.value,formSearchName:H.value,onCurrentChange:B,onOnReset:A,model:e.value.search,formOption:U},null,8,["formSearchList","formSearchName","model"]),t($,{"border-style":"dashed"}),t(q,null,{default:l(()=>[t(V),t(Q,null,{default:l(()=>[t(j,{size:"default"},{default:l(()=>[p(" 导出 ")]),_:1}),t(J,{border:e.value.border,"onUpdate:border":o[0]||(o[0]=a=>e.value.border=a),tableAutoHeight:e.value.tableAutoHeight,"onUpdate:tableAutoHeight":o[1]||(o[1]=a=>e.value.tableAutoHeight=a),checkList:e.value.checkList,"onUpdate:checkList":o[2]||(o[2]=a=>e.value.checkList=a),columns:y.value,"onUpdate:columns":o[3]||(o[3]=a=>y.value=a),"line-height":e.value.lineHeight,"onUpdate:lineHeight":o[4]||(o[4]=a=>e.value.lineHeight=a),stripe:e.value.stripe,"onUpdate:stripe":o[5]||(o[5]=a=>e.value.stripe=a),style:{"margin-left":"12px"},onQueryData:u},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),re((i(),r(X,{border:e.value.border,size:e.value.lineHeight,stripe:e.value.stripe,class:"my-4",data:e.value.dataList,"highlight-current-row":"",height:"100%",onSortChange:T,onSelectionChange:o[6]||(o[6]=a=>e.value.batch.selectionDataList=a)},{empty:l(()=>[t(W,{image:h(ue),"image-size":300},null,8,["image"])]),default:l(()=>[t(G,{align:"left",type:"selection"}),e.value.batch.enable?(i(),r(c,{key:0,type:"selection","show-overflow-tooltip":"",align:"left",fixed:""})):d("",!0),e.value.checkList.includes("id")?(i(),r(c,{key:1,"show-overflow-tooltip":"",align:"left",prop:"id",label:"员工ID"},{default:l(({row:a})=>[I("div",Be,[I("div",Ne,"ID: "+_(a.id),1),t(K,{class:"copy",content:a.id},null,8,["content"])])]),_:1})):d("",!0),e.value.checkList.includes("userName")?(i(),r(c,{key:2,"show-overflow-tooltip":"",align:"left",prop:"userName",label:"用户名"},{default:l(({row:a})=>[t(m,{class:"tableBig"},{default:l(()=>[p(_(a.userName?a.userName:"-"),1)]),_:2},1024)]),_:1})):d("",!0),e.value.checkList.includes("name")?(i(),r(c,{key:3,"show-overflow-tooltip":"",align:"left",prop:"name",label:"姓名"},{default:l(({row:a})=>[t(m,{class:"tableBig"},{default:l(()=>[p(_(a.name?a.name:"-"),1)]),_:2},1024)]),_:1})):d("",!0),e.value.checkList.includes("positionId")?(i(),r(c,{key:4,"show-overflow-tooltip":"",align:"left",prop:"positionId",width:"150",label:"职位"},{default:l(({row:a})=>[(i(!0),z(ce,null,pe(k.value,b=>(i(),r(m,null,{default:l(()=>[a.positionId===b.id?(i(),r(m,{key:0},{default:l(()=>[t(m,{class:"tableBig"},{default:l(()=>[p(_(b.name?b.name:"-"),1)]),_:2},1024)]),_:2},1024)):d("",!0)]),_:2},1024))),256))]),_:1})):d("",!0),e.value.checkList.includes("pendingBalance")?(i(),r(c,{key:5,"show-overflow-tooltip":"",align:"left",prop:"pendingBalance",label:"待审提成"},{default:l(({row:a})=>[t(m,{class:"tableBig"},{default:l(()=>[p(_(a.pendingBalance?a.pendingBalance:"-"),1)]),_:2},1024)]),_:1})):d("",!0),e.value.checkList.includes("availableBalance")?(i(),r(c,{key:6,"show-overflow-tooltip":"",align:"left",prop:"availableBalance",label:"可用提成"},{default:l(({row:a})=>[t(m,{class:"tableBig"},{default:l(()=>[p(_(a.availableBalance?a.availableBalance:"-"),1)]),_:2},1024)]),_:1})):d("",!0),t(c,{fixed:"right",align:"left",width:"200",label:"操作"},{default:l(({row:a})=>[t(N,{type:"primary",size:"small",plain:"",onClick:b=>R(a)},{default:l(()=>[p(" 财务日志 ")]),_:2},1032,["onClick"]),t(N,{type:"warning",size:"small",plain:"",onClick:b=>M(a)},{default:l(()=>[p(" 加减款 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","size","stripe","data"])),[[ee,e.value.loading]]),t(Y,{"current-page":h(g).page,total:h(g).total,"page-size":h(g).size,"page-sizes":h(g).sizes,layout:h(g).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:F,onCurrentChange:B},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),t(ye,{ref_key:"plusMinusPaymentsRef",ref:C,onFetchData:u},null,512),t(Ce,{ref_key:"financeLogRef",ref:L},null,512)],2)}}}),$e=he(Se,[["__scopeId","data-v-348ca847"]]);export{$e as default};
