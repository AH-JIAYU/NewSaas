
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as W,l as X,$ as Y,r as v,a3 as S,a4 as ee,n as le,a as i,o as b,b as V,f as e,w as l,i as n,ar as ae,F as C,t as E,e as I,y as f,g as A,A as te,_ as oe}from"./index-BUk67_5S.js";import{u as ne,v as re}from"./index-yLARdS_b.js";import{u as de}from"./survey_vipGroup-DL0ojAxJ.js";import{a as se}from"./department-Dg029pmw.js";const ue=f("div",{class:"card-header"},[f("span",null,"基本信息")],-1),ie=f("div",{class:"card-header"},[f("span",null,"权限信息")],-1),me={style:{display:"flex","justify-content":"space-between","align-items":"center",padding:"0 1rem"}},ve=W({__name:"index",props:{leftTab:Object,tabIndex:Number},setup(U){const P=X(),T=ne();de();const B=Y("validateTopTabs"),R=U,_=v("basicSettings"),y=v(),m=S({vipLevelList:[],departmentList:[],countryList:[]}),q={children:"children",label:"name"},p=S({memberNickname:[{required:!0,message:"请输入会员昵称",trigger:"blur"},{min:2,max:50,message:"内容在2-50个字之间",trigger:"blur"}],memberLevelId:[{required:!0,message:"请选择会员等级",trigger:"change"}],subordinateCountryId:[{required:!0,message:"请选择国家",trigger:"change"}]}),$=(s,a,d)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(o.value.memberPhone)?d():d(new Error("请输入合法手机号"))},j=(s,a,d)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(o.value.emailAddress)?d():d(new Error("请输入合法邮箱"))},L=s=>{s&&(o.value.countryType=s==="343"?1:2,s==="343"?(p.emailAddress&&delete p.emailAddress,p.memberPhone=[{required:!0,message:"请输入手机号码",trigger:"blur"},{validator:$,trigger:"blur"}]):(p.memberPhone&&delete p.memberPhone,p.emailAddress=[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:j,trigger:"blur"}]))},z=(s,a)=>{a?(o.value.memberGroupId=s.id,F(s.id)):(o.value.memberGroupId="",G())},F=s=>{const a=d=>{d.forEach(r=>{r.disabled=r.id!==s,r.children&&a(r.children)})};a(m.departmentList)},G=()=>{const s=a=>{a.forEach(d=>{d.disabled=!1,d.children&&s(d.children)})};s(m.departmentList)},x=async()=>{m.vipLevelList=await T.getLevelNameList()},D=async()=>{await x();const s=await se.list({name:""});m.departmentList=s.data,m.countryList=await P.getCountry()},h=v(null),o=v(R.leftTab);ee(()=>{B(h.value)});const O=()=>{y.value.showEdit()};return le(async()=>{await D(),L(o.value.subordinateCountryId)}),(s,a)=>{const d=i("el-input"),r=i("el-form-item"),u=i("el-col"),k=i("el-option"),w=i("el-select"),g=i("el-row"),N=i("el-card"),c=i("el-switch"),Z=i("el-divider"),M=oe,Q=i("el-button"),H=i("el-tree"),J=i("el-tab-pane"),K=i("el-tabs");return b(),V("div",null,[e(K,{modelValue:n(_),"onUpdate:modelValue":a[11]||(a[11]=t=>te(_)?_.value=t:null)},{default:l(()=>[e(J,{label:"会员信息",name:"basicSettings"},{default:l(()=>[e(n(ae),{ref_key:"formRef",ref:h,model:n(o),rules:n(p),"label-width":"100px","validate-on-rule-change":!1},{default:l(()=>[e(N,{class:"box-card"},{header:l(()=>[ue]),default:l(()=>[e(g,{gutter:24},{default:l(()=>[e(u,{span:8},{default:l(()=>[e(r,{label:"会员名称",prop:"memberNickname"},{default:l(()=>[e(d,{modelValue:n(o).memberNickname,"onUpdate:modelValue":a[0]||(a[0]=t=>n(o).memberNickname=t),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:l(()=>[e(r,{label:"所属国家",prop:"subordinateCountryId"},{default:l(()=>[e(w,{clearable:"",filterable:"",modelValue:n(o).subordinateCountryId,"onUpdate:modelValue":a[1]||(a[1]=t=>n(o).subordinateCountryId=t),onChange:L},{default:l(()=>[(b(!0),V(C,null,E(n(m).countryList,t=>(b(),I(k,{key:t.id,value:t.id,label:t.chineseName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:l(()=>[e(r,{label:"会员姓名"},{default:l(()=>[e(d,{clearable:"",modelValue:n(o).memberName,"onUpdate:modelValue":a[2]||(a[2]=t=>n(o).memberName=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:l(()=>[e(r,{label:"手机号码",prop:"memberPhone"},{default:l(()=>[e(d,{clearable:"",modelValue:n(o).memberPhone,"onUpdate:modelValue":a[3]||(a[3]=t=>n(o).memberPhone=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:l(()=>[e(r,{label:"电子邮箱",prop:"emailAddress"},{default:l(()=>[e(d,{clearable:"",modelValue:n(o).emailAddress,"onUpdate:modelValue":a[4]||(a[4]=t=>n(o).emailAddress=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:l(()=>[e(r,{label:"初始密码"},{default:l(()=>[e(d,{clearable:"",value:"123456",disabled:""})]),_:1})]),_:1})]),_:1})]),_:1}),e(N,{class:"box-card"},{header:l(()=>[ie]),default:l(()=>[e(g,{gutter:20},{default:l(()=>[e(u,{span:4},{default:l(()=>[e(r,{label:"会员状态"},{default:l(()=>[e(c,{"active-value":2,"inactive-value":1,modelValue:n(o).memberStatus,"onUpdate:modelValue":a[5]||(a[5]=t=>n(o).memberStatus=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:4},{default:l(()=>[e(r,{label:"B2B"},{default:l(()=>[e(c,{"active-value":2,"inactive-value":1,modelValue:n(o).b2bStatus,"onUpdate:modelValue":a[6]||(a[6]=t=>n(o).b2bStatus=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:4},{default:l(()=>[e(r,{label:"B2C"},{default:l(()=>[e(c,{"active-value":2,"inactive-value":1,modelValue:n(o).b2cStatus,"onUpdate:modelValue":a[7]||(a[7]=t=>n(o).b2cStatus=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:5},{default:l(()=>[e(r,{label:"免审"},{default:l(()=>[e(c,{"active-value":2,"inactive-value":1,modelValue:n(o).exemptionTrial,"onUpdate:modelValue":a[8]||(a[8]=t=>n(o).exemptionTrial=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:4},{default:l(()=>[e(r,{label:"随机身份"},{default:l(()=>[e(c,{"active-value":2,"inactive-value":1,modelValue:n(o).randomStatus,"onUpdate:modelValue":a[9]||(a[9]=t=>n(o).randomStatus=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Z,{"content-position":"center"}),e(g,{gutter:20},{default:l(()=>[e(u,{span:8},{default:l(()=>[e(r,{label:"会员等级",prop:"memberLevelId"},{default:l(()=>[e(w,{clearable:"",filterable:"",modelValue:n(o).memberLevelId,"onUpdate:modelValue":a[10]||(a[10]=t=>n(o).memberLevelId=t)},{empty:l(()=>[f("div",me,[A(" 暂无数据 "),e(Q,{type:"primary",link:"",onClick:O,size:"small"},{default:l(()=>[A(" 快捷新增 "),e(M,{name:"ant-design:plus-outlined",color:"#fff",style:{"background-color":"var(--el-color-primary)","border-radius":"50%",padding:"2px",margin:"0 2px"}})]),_:1})])]),default:l(()=>[(b(!0),V(C,null,E(n(m).vipLevelList,t=>(b(),I(k,{key:t.memberLevelId,value:t.memberLevelId,label:t.levelNameOrAdditionRatio},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:l(()=>[e(r,{label:"部门"},{default:l(()=>[e(H,{style:{"max-width":"600px"},ref:"treeRef",data:n(m).departmentList,"show-checkbox":"","check-strictly":"","node-key":"id","default-expanded-keys":[],"default-expand-all":"",props:q,onCheckChange:z},null,8,["data"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["modelValue"]),e(re,{ref_key:"EditRef",ref:y,onQueryData:x},null,512)])}}});export{ve as _};
