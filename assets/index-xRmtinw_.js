
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ye,aK as he,r as _,X as A,c as ve,v as we,a as r,an as Ie,o as d,b as G,f as e,w as t,i as l,ak as k,Z as ke,$ as Ce,e as p,g as u,z as w,A as C,al as x,j as b,K as xe,F as Se,aN as Le,aO as Ve,aj as je,aH as ze,aI as De,y as O,J as Ee}from"./index-C4R2SyQS.js";import{_ as Ne}from"./index.vue_vue_type_style_index_0_lang-7bk70uGz.js";import{_ as Re}from"./index.vue_vue_type_script_setup_true_lang-CWAhLbfe.js";import{_ as Ue,a as q}from"./index.vue_vue_type_script_setup_true_lang-DqYpGW2I.js";import{u as Te}from"./user_customer-BuM2KjGW.js";/* empty css                      */import"./user_customer-CjDBOYcu.js";const K=S=>(ze("data-v-cfd7be06"),S=S(),De(),S),$e=K(()=>O("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Fe=K(()=>O("br",null,null,-1)),Me=ye({name:"preInvestigationRecords",__name:"index",setup(S){const J=Te(),{getParams:Q,pagination:c,onSizeChange:X,onCurrentChange:Z}=he(),R=_(!1),T=_([]);_("");const f=_([]),L=_(!0),V=_(!1),j=_("default"),z=_(!1),D=_([{prop:"projectId",label:"项目ID",sortable:!0,checked:!0},{prop:"projectName",label:"项目名称",sortable:!0,checked:!0},{prop:"allocationType",label:"分配类型",sortable:!0,checked:!0},{prop:"passNumber",label:"通过数/提交数",sortable:!0,checked:!0},{prop:"passRate",label:"通过率",sortable:!0,checked:!0}]),s=A({memberId:"",memberGroupId:"",projectId:"",projectName:"",customerId:"",ip:"",surveyStatus:""}),$=_(),g=A({allocationTypeList:["未分配","供应商","会员组"],surveyStatusList:["完成","被甄别","配额满","安全终止","未完成"],viceStatusList:["待审","免审","过IR","时间果断","超时完成","超量完成","审核成功","审核失败","数据冻结","时间段过载","ip不一致","id重复参与","和解"],customerList:[],vipList:[],vipGroupList:[],tenantSupplierList:[],expandedRows:[]});function W(){s.pageNo=1,U()}function Y(n){X(n)}function F(n=1){Z(n)}async function M(n){const a=g.expandedRows.indexOf(n.id);if(a!==-1?g.expandedRows.splice(a,1):g.expandedRows.push(n.id),!n.children){const y=await q.childList({projectId:n.projectId});n.children=y.data.projectScreenMemberChildInfoList}}function ee(n){$.value.showEdit(n)}const te=ve(()=>T.value.slice((c.value.page-1)*c.value.size,c.value.page*c.value.size));async function U(){R.value=!0;const n={...Q(),...s},{data:a}=await q.list(n);T.value=a.projectSurveyScreenInfoList,c.value.total=a.projectSurveyScreenInfoList.length,R.value=!1}function le(){Object.assign(s,{memberId:"",memberGroupId:"",projectId:"",projectName:"",customerId:"",ip:"",surveyStatus:""}),U()}return we(async()=>{g.customerList=await J.getCustomerList(),D.value.forEach(n=>{n.checked&&f.value.push(n.prop)}),U()}),(n,a)=>{const y=r("el-input"),I=r("el-form-item"),ae=r("el-option"),oe=r("el-select"),P=Se,E=r("ElButton"),ne=r("ElFormItem"),se=r("ElForm"),re=Re,ie=r("ElDivider"),ue=Ne,B=r("el-button"),de=Le,pe=Ve,ce=r("el-row"),h=r("el-table-column"),v=r("el-text"),N=r("ElTableColumn"),H=r("el-table"),me=r("el-empty"),_e=r("ElPagination"),fe=je,be=Ie("loading");return d(),G("div",{class:xe({"absolute-container":l(z)})},[e(fe,null,{default:t(()=>[e(re,{"show-toggle":!1},{default:t(({fold:o,toggle:m})=>[e(se,{model:l(s),size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:t(()=>[e(I,{label:""},{default:t(()=>[e(y,{modelValue:l(s).memberId,"onUpdate:modelValue":a[0]||(a[0]=i=>l(s).memberId=i),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"会员ID"},null,8,["modelValue"])]),_:1}),k(e(I,{label:""},{default:t(()=>[e(y,{modelValue:l(s).memberGroupId,"onUpdate:modelValue":a[1]||(a[1]=i=>l(s).memberGroupId=i),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"会员ID"},null,8,["modelValue"])]),_:2},1536),[[x,!o]]),e(I,{label:""},{default:t(()=>[e(y,{modelValue:l(s).projectId,"onUpdate:modelValue":a[2]||(a[2]=i=>l(s).projectId=i),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"项目ID"},null,8,["modelValue"])]),_:1}),k(e(I,{label:""},{default:t(()=>[e(y,{modelValue:l(s).name,"onUpdate:modelValue":a[3]||(a[3]=i=>l(s).name=i),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"项目名称"},null,8,["modelValue"])]),_:2},1536),[[x,!o]]),k(e(I,{label:""},{default:t(()=>[e(y,{modelValue:l(s).ip,"onUpdate:modelValue":a[4]||(a[4]=i=>l(s).ip=i),modelModifiers:{trim:!0},clearable:"",inline:!1,placeholder:"IP地址"},null,8,["modelValue"])]),_:2},1536),[[x,!o]]),k(e(I,{label:""},{default:t(()=>[e(oe,{modelValue:l(s).surveyStatus,"onUpdate:modelValue":a[5]||(a[5]=i=>l(s).surveyStatus=i),clearable:"",placeholder:"调查状态"},{default:t(()=>[(d(!0),G(ke,null,Ce(l(g).surveyStatusList,(i,ge)=>(d(),p(ae,{label:i,value:ge+1},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:2},1536),[[x,!o]]),e(ne,null,{default:t(()=>[e(E,{type:"primary",onClick:a[6]||(a[6]=i=>F())},{icon:t(()=>[e(P,{name:"i-ep:search"})]),default:t(()=>[u(" 筛选 ")]),_:1}),e(E,{onClick:le},{icon:t(()=>[$e]),default:t(()=>[u(" 重置 ")]),_:1}),e(E,{link:"",onClick:m},{icon:t(()=>[e(P,{name:o?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:t(()=>[u(" "+w(o?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),e(ie,{"border-style":"dashed"}),e(ce,null,{default:t(()=>[e(ue),e(pe,null,{default:t(()=>[e(B,{size:"default"},{default:t(()=>[u(" 导出 ")]),_:1}),e(de,{border:l(L),"onUpdate:border":a[7]||(a[7]=o=>C(L)?L.value=o:null),tableAutoHeight:l(z),"onUpdate:tableAutoHeight":a[8]||(a[8]=o=>C(z)?z.value=o:null),checkList:l(f),"onUpdate:checkList":a[9]||(a[9]=o=>C(f)?f.value=o:null),columns:l(D),"onUpdate:columns":a[10]||(a[10]=o=>C(D)?D.value=o:null),"line-height":l(j),"onUpdate:lineHeight":a[11]||(a[11]=o=>C(j)?j.value=o:null),stripe:l(V),"onUpdate:stripe":a[12]||(a[12]=o=>C(V)?V.value=o:null),style:{"margin-left":"12px"},onQueryData:W},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),k((d(),p(H,{border:l(L),data:l(te),size:l(j),stripe:l(V),"row-key":"id","expand-row-keys":l(g).expandedRows,onExpandChange:M},{empty:t(()=>[e(me,{class:"vab-data-empty",description:"暂无数据"})]),default:t(()=>[e(h,{type:"expand",width:"55"},{default:t(o=>[e(H,{data:o.row.children,"highlight-current-row":"",class:"hide-table-header",border:"",height:"100%"},{default:t(()=>[e(h,{width:"55"}),e(h,{width:"300",prop:"memberChildName",label:"名称+ID",align:"center"},{default:t(m=>[e(v,null,{default:t(()=>[u(w(m.row.memberChildName),1)]),_:2},1024),Fe,k(e(v,{type:"danger"},{default:t(()=>[u("随机id:"+w(m.row.randomIdentityId),1)]),_:2},1536),[[x,m.row.randomIdentityId]])]),_:1}),e(N,{prop:"status",label:"状态",align:"center"},{default:t(m=>[m.row.status===1?(d(),p(v,{key:0,type:"success"},{default:t(()=>[u("前置问卷通过")]),_:1})):(d(),p(v,{key:1,type:"danger"},{default:t(()=>[u("前置问卷未通过")]),_:1}))]),_:1}),e(N,{width:"200",align:"center",fixed:"right",label:"操作"},{default:t(m=>[e(E,{type:"primary",size:"small",plain:"",onClick:i=>ee(m.row)},{default:t(()=>[u(" 查看问卷详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:2},1032,["data"])]),_:1}),l(f).includes("projectId")?(d(),p(h,{key:0,width:"300",align:"center",prop:"projectId","show-overflow-tooltip":"",label:"项目ID"})):b("",!0),l(f).includes("projectName")?(d(),p(h,{key:1,align:"center",prop:"projectName","show-overflow-tooltip":"",label:"项目名称"})):b("",!0),l(f).includes("allocationType")?(d(),p(h,{key:2,align:"center","show-overflow-tooltip":"",label:"分配类型"},{default:t(({row:o})=>[o.allocationType===3?(d(),p(v,{key:0,class:"mx-1",type:"primary"},{default:t(()=>[u("会员组")]),_:1})):b("",!0),o.allocationType===2?(d(),p(v,{key:1,class:"mx-1",type:"success"},{default:t(()=>[u("供应商")]),_:1})):b("",!0),o.allocationType===1?(d(),p(v,{key:2,class:"mx-1",type:"warning"},{default:t(()=>[u("未分配")]),_:1})):b("",!0)]),_:1})):b("",!0),l(f).includes("passNumber")?(d(),p(h,{key:3,align:"center","show-overflow-tooltip":"",label:"通过数/提交数"},{default:t(({row:o})=>[u(w(o.passNumber||0)+"/ "+w(o.submitNumber||0),1)]),_:1})):b("",!0),l(f).includes("passRate")?(d(),p(N,{key:4,align:"center","show-overflow-tooltip":"",prop:"passRate",label:"通过率"},{default:t(({row:o})=>[u(w(o.passRate+"%"),1)]),_:1})):b("",!0),e(N,{align:"center","show-overflow-tooltip":"",prop:"",fixed:"right",label:"操作",width:"200"},{default:t(({row:o})=>[e(B,{plain:"",type:"primary",size:"small",onClick:m=>M(o)},{default:t(()=>[u(w(l(g).expandedRows.includes(o.id)?"收起":"展开"),1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["border","data","size","stripe","expand-row-keys"])),[[be,l(R)]]),e(_e,{"current-page":l(c).page,total:l(c).total,"page-size":l(c).size,"page-sizes":l(c).sizes,layout:l(c).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:Y,onCurrentChange:F},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e(Ue,{ref_key:"questionnaireDetailsRef",ref:$},null,512)],2)}}}),Ke=Ee(Me,[["__scopeId","data-v-cfd7be06"]]);export{Ke as default};
