
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as pe,K as de,aK as ce,s as me,r as C,l as fe,B as $,F as ve,a as s,n as ge,o as p,b as S,f as a,w as o,aA as U,a2 as be,a3 as _e,g as r,C as _,p as he,e as d,j as f,i as y,O as ye,aL as ke,E as Ce,J as we,aM as Ee,aN as Me,am as Le,aH as Ve,aI as Pe,q as ze,N as $e}from"./index-CHTO5iG0.js";import{_ as Se}from"./index.vue_vue_type_style_index_0_lang-DlHRF-3h.js";import{_ as Ue}from"./index.vue_vue_type_script_setup_true_lang-Dg_mIBWY.js";import{_ as De}from"./index.vue_vue_type_script_setup_true_lang-SSD0_-ss.js";import He from"./index-BpC59JQZ.js";import{a as D}from"./announcement-quHvIMAw.js";import{u as xe}from"./useTabbar-x4HFUdN-.js";import"./index-SYAM7AUm.js";const Be=k=>(Ve("data-v-4f64cdf5"),k=k(),Pe(),k),Ie=Be(()=>ze("div",{class:"i-grommet-icons:power-reset h-1em w-1em"},null,-1)),Te=pe({name:"department",__name:"list",setup(k){const H=de(),{pagination:v,getParams:x,onSizeChange:B,onCurrentChange:I,onSortChange:T}=ce(),M=xe(),L=me(),w=C([{label:"标题",prop:"title",sortable:!0,disableCheck:!1,checked:!0},{label:"类型",prop:"type",sortable:!0,disableCheck:!1,checked:!0},{label:"置顶",prop:"top",sortable:!0,disableCheck:!1,checked:!0},{label:"创建时间",prop:"createTime",sortable:!0,disableCheck:!1,checked:!0}]),V=C();C();const e=C({loading:!1,tableAutoHeight:!1,border:!0,stripe:!1,lineHeight:"default",checkList:[],formMode:"drawer",formModeProps:{visible:!1,id:"",row:""},search:{title:"",type:null},batch:{enable:!1,selectionDataList:[]},dataList:[]}),h=[{label:"公告",value:1},{label:"常见问题",value:2},{label:"帮助",value:3}];function u(){e.value.loading=!0;const n={...x(),...e.value.search};D.list(n).then(t=>{e.value.loading=!1,e.value.dataList=t.data,v.value.total=t.data.length})}function A(){Object.assign(e.value.search,{title:"",type:null}),u()}function F(n){B(n).then(()=>u())}function c(n=1){I(n).then(()=>u())}function N({prop:n,order:t}){T(n,t).then(()=>u())}function K(){e.value.formMode==="router"?M.open({name:"pagesExampleGeneralManagerCreate"}):(e.value.formModeProps.id="",e.value.formModeProps.row="",e.value.formModeProps.visible=!0)}function R(n){e.value.formMode==="router"?L.settings.tabbar.enable&&L.settings.tabbar.mergeTabsBy!=="activeMenu"?M.open({name:"surveyEdit",params:{id:n.id}}):H.push({name:"surveyEdit",params:{id:n.id}}):(e.value.formModeProps.id=n.id,e.value.formModeProps.row=n,e.value.formModeProps.visible=!0)}function j(n){return new Promise(t=>{ke.confirm(`确认${n.top?"开启置顶":"关闭置顶"}「${n.title}」吗？`,"确认信息").then(()=>{e.value.loading=!0,D.edit({id:n.id,top:n.top}).then(()=>(Ce.success({message:`${n.top?"开启置顶":"关闭置顶"}成功`,center:!0}),u(),e.value.loading=!1,t(!0))).catch(()=>(u(),e.value.loading=!1,t(!1)))}).catch(()=>(u(),t(!1)))})}function O(n){V.value.showEdit(n)}return fe(()=>{u(),e.value.formMode==="router"&&$.on("get-data-list",()=>{u()}),w.value.forEach(n=>{n.checked&&e.value.checkList.push(n.prop)})}),ve(()=>{e.value.formMode==="router"&&$.off("get-data-list")}),(n,t)=>{const P=s("ElInput"),E=s("ElFormItem"),q=s("el-option"),G=s("el-select"),J=s("el-form-item"),z=we,g=s("ElButton"),Q=s("ElForm"),W=Ue,X=s("ElDivider"),Y=Se,Z=s("el-button"),ee=Ee,te=Me,le=s("el-row"),ae=s("el-table-column"),m=s("ElTableColumn"),oe=s("el-switch"),ne=s("el-empty"),se=s("ElTable"),ie=s("ElPagination"),re=Le,ue=ge("loading");return p(),S("div",{class:ye({"absolute-container":e.value.tableAutoHeight})},[a(re,null,{default:o(()=>[a(W,{"show-toggle":!1},{default:o(({fold:l,toggle:b})=>[a(Q,{model:e.value.search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:o(()=>[a(E,{label:""},{default:o(()=>[a(P,{modelValue:e.value.search.title,"onUpdate:modelValue":t[0]||(t[0]=i=>e.value.search.title=i),placeholder:"请输入部门ID",clearable:"",onKeydown:t[1]||(t[1]=U(i=>c(),["enter"])),onClear:t[2]||(t[2]=i=>c())},null,8,["modelValue"])]),_:1}),a(E,{label:""},{default:o(()=>[a(P,{modelValue:e.value.search.title,"onUpdate:modelValue":t[3]||(t[3]=i=>e.value.search.title=i),placeholder:"请输入部门名称",clearable:"",onKeydown:t[4]||(t[4]=U(i=>c(),["enter"])),onClear:t[5]||(t[5]=i=>c())},null,8,["modelValue"])]),_:1}),a(J,{label:""},{default:o(()=>[a(G,{modelValue:e.value.search.type,"onUpdate:modelValue":t[6]||(t[6]=i=>e.value.search.type=i),"value-key":"",placeholder:"请选择状态",clearable:"",filterable:""},{default:o(()=>[(p(),S(be,null,_e(h,i=>a(q,{key:i.value,label:i.label,value:i.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(E,null,{default:o(()=>[a(g,{type:"primary",onClick:t[7]||(t[7]=i=>c())},{icon:o(()=>[a(z,{name:"i-ep:search"})]),default:o(()=>[r(" "+_("筛选"))]),_:1}),a(g,{onClick:A},{icon:o(()=>[Ie]),default:o(()=>[r(" 重置 ")]),_:1}),a(g,{disabled:"",link:"",onClick:b},{icon:o(()=>[a(z,{name:l?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:o(()=>[r(" "+_(l?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),a(X,{"border-style":"dashed"}),a(le,{gutter:24},{default:o(()=>[a(Y,null,{default:o(()=>[a(g,{type:"primary",size:"default",onClick:K},{default:o(()=>[r(" 新增 ")]),_:1})]),_:1}),a(te,null,{default:o(()=>[a(Z,{size:"default"},{default:o(()=>[r(" 导出 ")]),_:1}),a(ee,{border:e.value.border,"onUpdate:border":t[8]||(t[8]=l=>e.value.border=l),tableAutoHeight:e.value.tableAutoHeight,"onUpdate:tableAutoHeight":t[9]||(t[9]=l=>e.value.tableAutoHeight=l),checkList:e.value.checkList,"onUpdate:checkList":t[10]||(t[10]=l=>e.value.checkList=l),columns:w.value,"onUpdate:columns":t[11]||(t[11]=l=>w.value=l),"line-height":e.value.lineHeight,"onUpdate:lineHeight":t[12]||(t[12]=l=>e.value.lineHeight=l),stripe:e.value.stripe,"onUpdate:stripe":t[13]||(t[13]=l=>e.value.stripe=l),style:{"margin-left":"12px"},onQueryData:c},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),he((p(),d(se,{stripe:e.value.stripe,"onUpdate:stripe":t[14]||(t[14]=l=>e.value.stripe=l),border:e.value.border,"onUpdate:border":t[15]||(t[15]=l=>e.value.border=l),size:e.value.lineHeight,class:"my-4",data:e.value.dataList,"highlight-current-row":"",height:"100%",onSortChange:N,onSelectionChange:t[16]||(t[16]=l=>e.value.batch.selectionDataList=l)},{empty:o(()=>[a(ne,{description:"暂无数据"})]),default:o(()=>[a(ae,{align:"center",type:"selection"}),e.value.checkList.includes("title")?(p(),d(m,{key:0,align:"center","show-overflow-tooltip":"",prop:"title",label:"部门ID"})):f("",!0),e.value.checkList.includes("type")?(p(),d(m,{key:1,align:"center","show-overflow-tooltip":"",prop:"type",label:"部门名称"},{default:o(({row:l})=>[r(_(h[l.type-1].label),1)]),_:1})):f("",!0),e.value.checkList.includes("type")?(p(),d(m,{key:2,align:"center","show-overflow-tooltip":"",prop:"type",label:"部门主管"},{default:o(({row:l})=>[r(_(h[l.type-1].label),1)]),_:1})):f("",!0),e.value.checkList.includes("type")?(p(),d(m,{key:3,align:"center","show-overflow-tooltip":"",prop:"type",label:"员工数"},{default:o(({row:l})=>[r(_(h[l.type-1].label),1)]),_:1})):f("",!0),e.value.checkList.includes("type")?(p(),d(m,{key:4,align:"center","show-overflow-tooltip":"",prop:"type",label:"备注"},{default:o(({row:l})=>[r(_(h[l.type-1].label),1)]),_:1})):f("",!0),e.value.checkList.includes("top")?(p(),d(m,{key:5,align:"center","show-overflow-tooltip":"",prop:"top",label:"状态"},{default:o(({row:l})=>[a(oe,{modelValue:l.top,"onUpdate:modelValue":b=>l.top=b,"active-value":!0,"inactive-value":!1,"inline-prompt":"","active-text":"开启","inactive-text":"关闭",onChange:b=>j(l)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):f("",!0),a(m,{label:"操作",width:"300",align:"center",fixed:"right"},{default:o(l=>[a(g,{type:"primary",size:"small",plain:"",onClick:b=>R(l.row)},{default:o(()=>[r(" 编辑 ")]),_:2},1032,["onClick"]),a(g,{type:"primary",size:"small",plain:"",onClick:b=>O(l.row)},{default:o(()=>[r(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["stripe","border","size","data"])),[[ue,e.value.loading]]),a(ie,{"current-page":y(v).page,total:y(v).total,"page-size":y(v).size,"page-sizes":y(v).sizes,layout:y(v).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:F,onCurrentChange:c},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),e.value.formMode==="dialog"||e.value.formMode==="drawer"?(p(),d(De,{key:0,id:e.value.formModeProps.id,modelValue:e.value.formModeProps.visible,"onUpdate:modelValue":t[17]||(t[17]=l=>e.value.formModeProps.visible=l),row:e.value.formModeProps.row,mode:e.value.formMode,onSuccess:u},null,8,["id","modelValue","row","mode"])):f("",!0),a(He,{ref_key:"detailRef",ref:V},null,512)],2)}}}),Ge=$e(Te,[["__scopeId","data-v-4f64cdf5"]]);export{Ge as default};
