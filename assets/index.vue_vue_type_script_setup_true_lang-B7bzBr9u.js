
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as z}from"./user_supplier-Co5Ot6rV.js";import{d as N,r as o,a2 as p,al as w,a3 as B,a as E,i as R,f as l,w as t,g as u,t as U,b as V,ai as C}from"./index-u6jofjME.js";const J=N({__name:"index",emits:["fetch-data"],setup(L,{expose:T,emit:x}){const I=x,d=o(!1),f=o(!1),y=o(),_=o(""),b=o(),a=o({supplierId:null,operationType:null,type:null,difference:null,remark:""}),S=o({difference:[{required:!0,message:"请输入金额",trigger:"blur"},{pattern:/^(?!0(\.0+)?$)(\d+(\.\d{1,2})?)$/,message:"请输入有效的正数，且最多两位小数",trigger:"blur"}],remark:[{required:!0,message:"请输入说明",trigger:"blur"}],operationType:[{required:!0,message:"请选择加减款",trigger:"change"}],type:[{required:!0,message:"请选择类型",trigger:"change"}]});async function $(n){d.value=!0,n?(_.value="编辑",b.value=JSON.parse(n),a.value.supplierId=b.value.tenantSupplierId):_.value="新增"}async function D(){y.value&&y.value.validate(async n=>{if(n)try{f.value=!0,(await z.getSupplierPlusMinusPaymentsList(a.value)).status===1?(f.value=!1,I("fetch-data"),C.success({message:"操作成功",center:!0}),g()):C.warning({message:"出现错误请联系管理人员",center:!0})}catch{}finally{f.value=!1}})}const m=o(null),c=o(null),v=(n,e)=>{e&&(n==="加款"||n==="减款"?(m.value=e,a.value.operationType=e):(n==="待审金额"||n==="可用金额")&&(c.value=e,a.value.type=e))};function g(){Object.assign(a.value,{supplierId:null,operationType:null,type:null,difference:null,remark:""}),m.value=null,c.value=null,d.value=!1}return T({showEdit:$}),(n,e)=>{const i=p("el-form-item"),s=p("el-button"),k=p("el-input"),P=p("el-form"),j=p("el-dialog"),q=w("loading");return B((E(),R("div",null,[l(j,{modelValue:d.value,"onUpdate:modelValue":e[6]||(e[6]=r=>d.value=r),title:"加减款","append-to-body":"","close-on-click-modal":!1,"destroy-on-close":"",draggable:"",width:"35%",onClose:g},{footer:t(()=>[l(s,{onClick:g},{default:t(()=>[u(" 取消 ")]),_:1}),l(s,{type:"primary",onClick:D},{default:t(()=>[u(" 确定 ")]),_:1})]),default:t(()=>[l(P,{model:a.value,rules:S.value,ref_key:"formRef",ref:y,"label-width":"5rem",inline:!1},{default:t(()=>[l(i,{label:"供应商ID"},{default:t(()=>[u(U(a.value.supplierId),1)]),_:1}),l(i,{label:"加减款",prop:"operationType"},{default:t(()=>[V("div",null,[l(s,{type:m.value===1?"primary":"",size:"small",onClick:e[0]||(e[0]=r=>v("加款",1))},{default:t(()=>[u("加款 ")]),_:1},8,["type"]),l(s,{type:m.value===2?"primary":"",size:"small",onClick:e[1]||(e[1]=r=>v("减款",2))},{default:t(()=>[u("减款")]),_:1},8,["type"])])]),_:1}),l(i,{label:"类型",prop:"type"},{default:t(()=>[V("div",null,[l(s,{type:c.value===1?"primary":"",size:"small",onClick:e[2]||(e[2]=r=>v("待审金额",1))},{default:t(()=>[u("待审金额 ")]),_:1},8,["type"]),l(s,{type:c.value===2?"primary":"",size:"small",onClick:e[3]||(e[3]=r=>v("可用金额",2))},{default:t(()=>[u("可用金额")]),_:1},8,["type"])])]),_:1}),l(i,{label:"金额",prop:"difference"},{default:t(()=>[l(k,{modelValue:a.value.difference,"onUpdate:modelValue":e[4]||(e[4]=r=>a.value.difference=r)},null,8,["modelValue"])]),_:1}),l(i,{label:"说明",prop:"remark"},{default:t(()=>[l(k,{modelValue:a.value.remark,"onUpdate:modelValue":e[5]||(e[5]=r=>a.value.remark=r)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])),[[q,f.value]])}}});export{J as _};
