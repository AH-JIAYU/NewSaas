
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Q,L as W,aH as X,t as Y,r as Z,B as ee,C as k,G as te,a as s,aj as ae,o as f,b as oe,f as a,w as o,i as t,ax as le,g as c,D as ne,e as g,j as v,ak as ie,O as se,ai as M,aI as re,K as de,q as ue,_ as ce}from"./index-CRsr9m9e.js";import{_ as me}from"./index.vue_vue_type_script_setup_true_lang-XXrSE1xF.js";import{_ as pe}from"./index.vue_vue_type_script_setup_true_lang-DlNkhJJt.js";import{a as C}from"./otherFunctions_screenLibrary-BgdPBx3F.js";import{_ as fe}from"./index.vue_vue_type_script_setup_true_lang-B54jDguT.js";import{u as ge}from"./useTabbar-BXql0KHA.js";import"./index-WBGItsFb.js";const be=Q({name:"OtherFunctionsScreenLibraryList",__name:"list",setup(_e){const S=W(),{pagination:m,getParams:V,onSizeChange:z,onCurrentChange:D,onSortChange:I}=X(),L=ge(),y=Y(),e=Z({loading:!1,tableAutoHeight:!1,formMode:"drawer",formModeProps:{visible:!1,id:"",details:""},editProps:{id:"",visible:!1,row:""},search:{title:""},batch:{enable:!1,selectionDataList:[]},dataList:[]});ee(()=>{d(),e.value.formMode==="router"&&k.on("get-data-list",()=>{d()})}),te(()=>{e.value.formMode==="router"&&k.off("get-data-list")});function d(){e.value.loading=!0;const l={...V(),...e.value.search.title&&{title:e.value.search.title}};C.list(l).then(n=>{e.value.loading=!1,e.value.dataList=n.data.getProjectProblemCategoryInfoList,m.value.total=n.data.total})}function $(l){z(l).then(()=>d())}function b(l=1){D(l).then(()=>d())}function B({prop:l,order:n}){I(l,n).then(()=>d())}function x(){e.value.editProps.id="",e.value.editProps.row="",e.value.editProps.visible=!0}function j(l){e.value.editProps.id=l.projectProblemCategoryId,e.value.editProps.row=JSON.stringify(l),e.value.editProps.visible=!0}async function P(l){const{status:n}=await C.edit(l);n===1&&M.success({message:"编辑成功",center:!0}),d()}function U(l){e.value.formMode==="router"?y.settings.tabbar.enable&&y.settings.tabbar.mergeTabsBy!=="activeMenu"?L.open({name:"screenLibraryEdit",params:{id:l.projectProblemCategoryId}}):S.push({name:"screenLibraryEdit",params:{id:l.projectProblemCategoryId}}):(e.value.formModeProps.id=l.projectProblemCategoryId,e.value.formModeProps.details=l.details,e.value.formModeProps.visible=!0)}function T(l){re.confirm(`确认删除「${l.title}」吗？`,"确认信息").then(()=>{C.delete(l.projectProblemCategoryId).then(()=>{d(),M.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}return(l,n)=>{const F=s("ElInput"),E=s("ElFormItem"),h=de,u=s("ElButton"),N=s("ElForm"),G=me,H=s("ElDivider"),K=s("ElButtonGroup"),O=s("ElSpace"),p=s("ElTableColumn"),w=s("ElSwitch"),A=s("ElTable"),q=s("ElPagination"),J=ue,R=ae("loading");return f(),oe("div",{class:se({"absolute-container":t(e).tableAutoHeight})},[a(J,null,{default:o(()=>[a(G,{"show-toggle":!1},{default:o(({fold:i,toggle:r})=>[a(N,{model:t(e).search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:o(()=>[a(E,{label:"标题"},{default:o(()=>[a(F,{modelValue:t(e).search.title,"onUpdate:modelValue":n[0]||(n[0]=_=>t(e).search.title=_),placeholder:"请输入标题，支持模糊查询",clearable:"",onKeydown:n[1]||(n[1]=le(_=>b(),["enter"])),onClear:n[2]||(n[2]=_=>b())},null,8,["modelValue"])]),_:1}),a(E,null,{default:o(()=>[a(u,{type:"primary",onClick:n[3]||(n[3]=_=>b())},{icon:o(()=>[a(h,{name:"i-ep:search"})]),default:o(()=>[c(" 筛选 ")]),_:1}),a(u,{link:"",disabled:"",onClick:r},{icon:o(()=>[a(h,{name:i?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:o(()=>[c(" "+ne(i?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),a(H,{"border-style":"dashed"}),a(O,{wrap:""},{default:o(()=>[a(u,{type:"primary",size:"default",onClick:x},{icon:o(()=>[a(h,{name:"i-ep:plus"})]),default:o(()=>[c(" 新增前置问卷库 ")]),_:1}),t(e).batch.enable?(f(),g(u,{key:0,size:"default",disabled:!t(e).batch.selectionDataList.length},{default:o(()=>[c(" 单个批量操作按钮 ")]),_:1},8,["disabled"])):v("",!0),t(e).batch.enable?(f(),g(K,{key:1},{default:o(()=>[a(u,{size:"default",disabled:!t(e).batch.selectionDataList.length},{default:o(()=>[c(" 批量操作按钮组1 ")]),_:1},8,["disabled"]),a(u,{size:"default",disabled:!t(e).batch.selectionDataList.length},{default:o(()=>[c(" 批量操作按钮组2 ")]),_:1},8,["disabled"])]),_:1})):v("",!0)]),_:1}),ie((f(),g(A,{class:"my-4",data:t(e).dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:B,onSelectionChange:n[4]||(n[4]=i=>t(e).batch.selectionDataList=i)},{default:o(()=>[t(e).batch.enable?(f(),g(p,{key:0,type:"selection",align:"center",fixed:""})):v("",!0),a(p,{prop:"categoryName",label:"标题"}),a(p,{prop:"countryId",label:"国家"}),a(p,{prop:"isDefault",label:"默认"},{default:o(i=>[a(w,{onChange:r=>P(i.row),modelValue:i.row.isDefault,"onUpdate:modelValue":r=>i.row.isDefault=r,"active-value":1,"inactive-value":2},null,8,["onChange","modelValue","onUpdate:modelValue"])]),_:1}),a(p,{prop:"status",label:"状态"},{default:o(i=>[a(w,{onChange:r=>P(i.row),modelValue:i.row.status,"onUpdate:modelValue":r=>i.row.status=r,"active-value":1,"inactive-value":2},null,8,["onChange","modelValue","onUpdate:modelValue"])]),_:1}),a(p,{label:"操作",width:"250",align:"center",fixed:"right"},{default:o(i=>[a(u,{type:"primary",size:"small",plain:"",onClick:r=>j(i.row)},{default:o(()=>[c(" 编辑 ")]),_:2},1032,["onClick"]),a(u,{type:"primary",size:"small",plain:"",onClick:r=>U(i.row)},{default:o(()=>[c(" 设计问卷 ")]),_:2},1032,["onClick"]),a(u,{type:"danger",size:"small",plain:"",onClick:r=>T(i.row)},{default:o(()=>[c(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[R,t(e).loading]]),a(q,{"current-page":t(m).page,total:t(m).total,"page-size":t(m).size,"page-sizes":t(m).sizes,layout:t(m).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:$,onCurrentChange:b},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),a(fe,{id:t(e).editProps.id,modelValue:t(e).editProps.visible,"onUpdate:modelValue":n[5]||(n[5]=i=>t(e).editProps.visible=i),row:t(e).editProps.row,onSuccess:d},null,8,["id","modelValue","row"]),t(e).formMode==="dialog"||t(e).formMode==="drawer"?(f(),g(pe,{key:0,id:t(e).formModeProps.id,modelValue:t(e).formModeProps.visible,"onUpdate:modelValue":n[6]||(n[6]=i=>t(e).formModeProps.visible=i),mode:t(e).formMode,details:t(e).formModeProps.details,onSuccess:d},null,8,["id","modelValue","mode","details"])):v("",!0)],2)}}}),ke=ce(be,[["__scopeId","data-v-7055e702"]]);export{ke as default};
