
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{a as A}from"./department-BJRxgAzo.js";import{g as P}from"./group_manage-DSgYUDR2.js";import{u as $}from"./configuration_manager-pDVzYmo9.js";import{u as j}from"./department-Cs_Nr-kr.js";import{d as z,r as n,k as G,a as s,l as H,n as J,o as i,b as f,f as a,w as o,p as K,g as k,F as y,q as x,e as S,E as C,t as O}from"./index-CsSreFXq.js";const Q={style:{flex:"auto"}},te=z({name:"Edit",__name:"index",emits:["success"],setup(W,{expose:E,emit:U}){const B=j(),v=n(),D=$(),p=n([]),_=U,b=n(""),I=n(),R=n(!1);n([]);const r=n(),u=n(!1),t=n({name:"",director:null,departmentId:null,remark:"",commissionStatus:null}),T=n({invoiceCode:[{required:!0,trigger:"blur",message:"请输入姓名"}],tenantCustomerId:[{required:!0,trigger:"change",message:"请选择客户"}]});function h(){return new Promise(m=>{t.value.id?r.value&&r.value.validate(l=>{if(l){const c=O(t.value);A.edit(c).then(()=>{C.success({message:"编辑成功",center:!0}),_("success"),u.value=!1,m()})}}):r.value&&r.value.validate(l=>{l&&(delete t.value.id,P.create(t.value).then(()=>{C.success({message:"新增成功",center:!0}),_("success"),u.value=!1,m()}))})})}async function q(){b.value="新增小组",u.value=!0}return G(async()=>{p.value=await D.staff,v.value=await B.department,I.value=new Date}),E({showEdit:q}),(m,l)=>{const c=s("el-input"),d=s("el-form-item"),g=s("el-option"),V=s("el-select"),L=s("el-switch"),N=s("el-form"),w=s("el-button"),F=s("el-dialog"),M=H("loading");return J((i(),f("div",null,[a(F,{modelValue:u.value,"onUpdate:modelValue":l[5]||(l[5]=e=>u.value=e),title:b.value,width:"700"},{footer:o(()=>[K("div",Q,[a(w,{type:"",onClick:l[4]||(l[4]=e=>u.value=!1)},{default:o(()=>[k(" 取消 ")]),_:1}),a(w,{type:"primary",onClick:h},{default:o(()=>[k(" 确定 ")]),_:1})])]),default:o(()=>[a(N,{ref_key:"formRef",ref:r,"label-width":"80px",model:t.value,rules:T.value,inline:!1},{default:o(()=>[a(d,{prop:"name",label:"组名称"},{default:o(()=>[a(c,{modelValue:t.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>t.value.name=e),placeholder:"请输入组名称",clearable:""},null,8,["modelValue"])]),_:1}),a(d,{label:"所属部门"},{default:o(()=>[a(V,{modelValue:t.value.departmentId,"onUpdate:modelValue":l[1]||(l[1]=e=>t.value.departmentId=e),"value-key":"",placeholder:"请选择部门",clearable:"",filterable:""},{default:o(()=>[(i(!0),f(y,null,x(v.value,e=>(i(),S(g,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"组长"},{default:o(()=>[a(V,{modelValue:t.value.director,"onUpdate:modelValue":l[2]||(l[2]=e=>t.value.director=e),"value-key":"",placeholder:"请选择组长",clearable:"",filterable:""},{default:o(()=>[(i(!0),f(y,null,x(p.value,e=>(i(),S(g,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"组提成"},{default:o(()=>[a(L,{modelValue:t.value.commissionStatus,"onUpdate:modelValue":l[3]||(l[3]=e=>t.value.commissionStatus=e),"inline-prompt":"","active-text":"启用","inactive-text":"禁用","active-value":1,"inactive-value":2},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])),[[M,R.value]])}}});export{te as _};
