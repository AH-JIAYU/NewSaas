
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as ne,aO as oe,r as s,a4 as le,c as ie,k as se,a as m,p as re,o as r,b as ce,f as l,w as a,g as p,i as t,B as v,q as ue,e as d,aN as pe,s as g,j as f,A as h,O as de,aP as fe,E as _e,aQ as me,aR as be,be as ge,ap as ve,M as he}from"./index--d-k_wOm.js";import{_ as ye}from"./index-BGc1Brbu.js";import{_ as ke}from"./index.vue_vue_type_style_index_0_lang-MX2mnWlA.js";import Ie from"./index-sN9iasrk.js";import{_ as we}from"./index.vue_vue_type_script_setup_true_lang-BjJ3GixK.js";import{c as N}from"./user_cooperation-DGSot8au.js";import"./index-BOB1LWa3.js";const Be={class:"tableBig"},Ce={class:"copyId tableSmall"},Te={class:"id oneLine"},ze={class:"tableBig"},Se={class:"tableBig"},Re={class:"tableBig"},xe={class:"tableBig"},Ee=ne({name:"cooperation",__name:"index",setup(Le){const{pagination:b,getParams:P,onSizeChange:D,onCurrentChange:A}=oe(),y=s(!1),S=s([]),R=s(),x=s(),$=s(),k=s(!1),I=s(!1),w=s(!1),B=s("default"),c=s([]),C=s([{label:"租户id",checked:!0,sortable:!0,prop:"beInvitationTenantId"},{label:"租户名称",checked:!0,sortable:!0,prop:"beInvitationTenantName"},{label:"状态",checked:!0,sortable:!0,prop:"bindStatus"},{label:"价格比例",checked:!0,sortable:!0,prop:"priceRatio"},{label:"待审金额",checked:!0,sortable:!0,prop:"pendBalance"},{label:"可用金额",checked:!0,sortable:!0,prop:"availableBalance"}]);function M(){R.value.showEdit()}function H(o){fe.prompt("是否确认进行解约?","终止合作",{confirmButtonText:"确认",cancelButtonText:"取消",inputPlaceholder:"说明",inputPattern:/^.{0,500}$/,inputErrorMessage:"不能超过500个字符",type:"warning"}).then(async n=>{const{data:{flag:u}}=await N.updateRescindTenant({beInvitationTenantId:o.beInvitationTenantId,remark:n.value});u&&_e({type:"success",message:"已终止合作"}),z()}).catch(()=>{})}function U(o){x.value.showEdit(o)}const F=le({});function V(o){D(o).then(()=>z())}function q(o=1){A(o).then(()=>z())}function T(){b.value.page=1,z()}async function z(){try{y.value=!0;const o={...P(),...F},{data:n}=await N.list(o);S.value=n.tenantBindInfoList,b.value.total=Number(n.total),y.value=!1}catch{}finally{y.value=!1}}function O(o){$.value=o}const Q=ie(()=>{const o=S.value.filter(i=>i.bindStatus===2);let n=S.value.filter(i=>i.bindStatus===4);n=Array.from(new Map(n.map(i=>[i.beInvitationTenantId,i])).values());const u=o.map(i=>i.beInvitationTenantId);return n.forEach(i=>{u.includes(i.beInvitationTenantId)||o.push(i)}),o});return se(()=>{C.value.forEach(o=>{o.checked&&c.value.push(o.prop)}),T()}),(o,n)=>{const u=m("el-button"),i=ke,j=me,G=be,J=m("el-row"),_=m("el-table-column"),E=m("el-text"),K=ye,L=ge,W=m("ElSpace"),X=m("el-empty"),Y=m("el-table"),Z=m("ElPagination"),ee=ve,te=re("loading");return r(),ce("div",{class:de({"absolute-container":t(w)})},[l(ee,null,{default:a(()=>[l(J,null,{default:a(()=>[l(i,null,{default:a(()=>[l(u,{type:"primary",size:"default",onClick:M},{default:a(()=>[p(" 邀约公司 ")]),_:1})]),_:1}),l(G,null,{default:a(()=>[l(u,{size:"default"},{default:a(()=>[p(" 导出 ")]),_:1}),l(j,{border:t(k),"onUpdate:border":n[0]||(n[0]=e=>v(k)?k.value=e:null),tableAutoHeight:t(w),"onUpdate:tableAutoHeight":n[1]||(n[1]=e=>v(w)?w.value=e:null),checkList:t(c),"onUpdate:checkList":n[2]||(n[2]=e=>v(c)?c.value=e:null),columns:t(C),"onUpdate:columns":n[3]||(n[3]=e=>v(C)?C.value=e:null),"line-height":t(B),"onUpdate:lineHeight":n[4]||(n[4]=e=>v(B)?B.value=e:null),stripe:t(I),"onUpdate:stripe":n[5]||(n[5]=e=>v(I)?I.value=e:null),style:{"margin-left":"12px"},onQueryData:T},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),ue((r(),d(Y,{border:t(k),data:t(Q),size:t(B),stripe:t(I),onSelectionChange:O},{empty:a(()=>[l(X,{image:t(pe),"image-size":300},null,8,["image"])]),default:a(()=>[l(_,{align:"left",type:"selection"}),t(c).includes("bindStatus")?(r(),d(_,{key:0,align:"left",prop:"bindStatus","show-overflow-tooltip":"",label:"状态",width:"100"},{default:a(({row:e})=>[g("div",Be,[e.bindStatus===2?(r(),d(E,{key:0,type:"success"},{default:a(()=>[p("合作")]),_:1})):f("",!0),e.bindStatus===4?(r(),d(E,{key:1,type:"danger"},{default:a(()=>[p("解约")]),_:1})):f("",!0)])]),_:1})):f("",!0),t(c).includes("beInvitationTenantId")?(r(),d(_,{key:1,align:"left",prop:"beInvitationTenantId",width:"180","show-overflow-tooltip":"",label:"租户id"},{default:a(({row:e})=>[g("div",Ce,[g("div",Te,"ID: "+h(e.beInvitationTenantId),1),l(K,{class:"copy",content:e.beInvitationTenantId},null,8,["content"])])]),_:1})):f("",!0),t(c).includes("beInvitationTenantName")?(r(),d(_,{key:2,align:"left",prop:"beInvitationTenantName","show-overflow-tooltip":"",label:"租户名称"},{default:a(({row:e})=>[g("div",ze,h(e.beInvitationTenantName),1)]),_:1})):f("",!0),t(c).includes("priceRatio")?(r(),d(_,{key:3,align:"left",prop:"priceRatio","show-overflow-tooltip":"",label:"价格比例"},{default:a(({row:e})=>[g("div",Se,h(e.priceRatio)+" % ",1)]),_:1})):f("",!0),t(c).includes("pendBalance")?(r(),d(_,{key:4,align:"left",prop:"pendBalance","show-overflow-tooltip":"",label:"待审金额"},{default:a(({row:e})=>[g("div",Re,[l(L),p(h(e.pendBalance||0),1)])]),_:1})):f("",!0),t(c).includes("availableBalance")?(r(),d(_,{key:5,align:"left",prop:"availableBalance","show-overflow-tooltip":"",label:"可用金额"},{default:a(({row:e})=>[g("div",xe,[l(L),p(h(e.availableBalance||0),1)])]),_:1})):f("",!0),l(_,{align:"left",fixed:"right",prop:"i",label:"操作",width:"350"},{default:a(({row:e})=>[l(W,null,{default:a(()=>[e.bindStatus===2?(r(),d(u,{key:0,type:"danger",plain:"",size:"small",onClick:ae=>H(e)},{default:a(()=>[p(" 终止合作 ")]),_:2},1032,["onClick"])):f("",!0),l(u,{size:"small",plain:"",type:"primary",onClick:ae=>U(e)},{default:a(()=>[p(" 价格比例 ")]),_:2},1032,["onClick"]),l(u,{type:"warning",plain:"",size:"small"},{default:a(()=>[p(" 财务日志 ")]),_:1}),l(u,{type:"danger",plain:"",size:"small"},{default:a(()=>[p(" 加减款 ")]),_:1})]),_:2},1024)]),_:1})]),_:1},8,["border","data","size","stripe"])),[[te,t(y)]]),l(Z,{"current-page":t(b).page,total:t(b).total,"page-size":t(b).size,"page-sizes":t(b).sizes,layout:t(b).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:V,onCurrentChange:q},null,8,["current-page","total","page-size","page-sizes","layout"]),l(Ie,{ref_key:"editRef",ref:R,onFetchData:T},null,512),l(we,{ref_key:"proportionRef",ref:x,onFetchData:T},null,512)]),_:1})],2)}}}),Ue=he(Ee,[["__scopeId","data-v-33fde787"]]);export{Ue as default};
