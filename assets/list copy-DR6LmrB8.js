
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as j,J as q,aM as F,r as C,n as K,z as M,C as Q,a as r,q as W,o as d,b as X,f as l,w as n,g as c,i as t,e as m,j as p,s as Y,aN as Z,O as ee,E as z,aO as te,_ as ae,ao as oe,aI as ne,aJ as le,v as se,M as ie}from"./index-FOy5HeQJ.js";import{_ as re}from"./index.vue_vue_type_script_setup_true_lang-DH9s4Z-S.js";import{_ as de}from"./index.vue_vue_type_script_setup_true_lang-DO6KJgAk.js";import{a as b}from"./configuration_homepageSetting-BQH9STfw.js";import"./index-CmQyzn1A.js";const ce=g=>(ne("data-v-27713cd3"),g=g(),le(),g),ue=ce(()=>se("div",{style:{"font-size":"1.5rem"}},"官网首页模版库",-1)),me=j({name:"TenantTenantHomepageSettingList",__name:"list copy",setup(g){q();const{pagination:f,getParams:E,onSizeChange:P,onCurrentChange:k,onSortChange:w}=F(),y=C(),e=C({loading:!1,tableAutoHeight:!1,formMode:"dialog",formModeProps:{visible:!1,row:"",id:""},search:{title:""},batch:{enable:!1,selectionDataList:[]},dataList:[],controlDataList:[]});function i(){try{e.value.loading=!0;const a={...E(),...e.value.search.title&&{title:e.value.search.title}};b.list(a).then(o=>{e.value.loading=!1,o.data&&o.status===1&&(e.value.controlDataList=o.data.controlData,e.value.controlDataList.forEach(h=>{h.isCommon=!0}),e.value.dataList=o.data.data,e.value.dataList=[...e.value.dataList,...e.value.controlDataList],f.value.total=Number(o.data.total))})}catch{}finally{e.value.loading=!1}}function D(a){P(a).then(()=>i())}function S(a=1){k(a).then(()=>i())}function L({prop:a,order:o}){w(a,o).then(()=>i())}function B(){e.value.formModeProps.id="",e.value.formModeProps.row="",e.value.formModeProps.visible=!0}function $(a){e.value.formModeProps.id=a.id,e.value.formModeProps.row=JSON.stringify(a),e.value.formModeProps.visible=!0}function x(a,o="编辑"){y.value.showEdit(a,o)}async function T(a){(await b.setHomePageTemplate({templateId:a.id})).status===1&&z.success({message:"设置成功",center:!0}),i()}function I(a){te.confirm(`确认删除「${a.title}」吗？`,"确认信息").then(()=>{b.del({id:a.id}).then(o=>{o.status===1&&z.success({message:"删除成功",center:!0}),i()})}).catch(()=>{})}return K(()=>{i(),e.value.formMode==="router"&&M.on("get-data-list",()=>{i()})}),Q(()=>{e.value.formMode==="router"&&M.off("get-data-list")}),(a,o)=>{const h=r("ElDivider"),N=ae,u=r("ElButton"),V=r("ElButtonGroup"),H=r("ElSpace"),_=r("ElTableColumn"),J=r("el-button"),O=r("el-empty"),R=r("ElTable"),A=r("ElPagination"),G=oe,U=W("loading");return d(),X("div",{class:ee({"absolute-container":t(e).tableAutoHeight})},[l(G,null,{default:n(()=>[ue,l(h,{"border-style":"dashed"}),l(H,{wrap:""},{default:n(()=>[l(u,{type:"primary",size:"default",onClick:B},{icon:n(()=>[l(N,{name:"i-ep:plus"})]),default:n(()=>[c(" 新增首页设置 ")]),_:1}),t(e).batch.enable?(d(),m(u,{key:0,size:"default",disabled:!t(e).batch.selectionDataList.length},{default:n(()=>[c(" 单个批量操作按钮 ")]),_:1},8,["disabled"])):p("",!0),t(e).batch.enable?(d(),m(V,{key:1},{default:n(()=>[l(u,{size:"default",disabled:!t(e).batch.selectionDataList.length},{default:n(()=>[c(" 批量操作按钮组1 ")]),_:1},8,["disabled"]),l(u,{size:"default",disabled:!t(e).batch.selectionDataList.length},{default:n(()=>[c(" 批量操作按钮组2 ")]),_:1},8,["disabled"])]),_:1})):p("",!0)]),_:1}),Y((d(),m(R,{class:"my-4",data:t(e).dataList,stripe:"","highlight-current-row":"",height:"100%",onSortChange:L,onSelectionChange:o[0]||(o[0]=s=>t(e).batch.selectionDataList=s)},{empty:n(()=>[l(O,{image:t(Z),"image-size":300},null,8,["image"])]),default:n(()=>[t(e).batch.enable?(d(),m(_,{key:0,type:"selection",align:"left",fixed:""})):p("",!0),l(_,{prop:"title",label:"标题"}),l(_,{prop:"isSet",align:"left",label:"是否使用"},{default:n(({row:s})=>[l(J,{type:s.isSet?"primary":"",size:"small",onClick:v=>T(s)},{default:n(()=>[c("使用 ")]),_:2},1032,["type","onClick"])]),_:1}),l(_,{label:"操作",width:"350",align:"left",fixed:"right"},{default:n(s=>[l(u,{type:"primary",size:"small",plain:"",onClick:v=>x(s.row)},{default:n(()=>[c(" 设计模板 ")]),_:2},1032,["onClick"]),s.row.isCommon?p("",!0):(d(),m(u,{key:0,type:"primary",size:"small",plain:"",onClick:v=>$(s.row)},{default:n(()=>[c(" 编辑标题 ")]),_:2},1032,["onClick"])),!s.row.isSet&&!s.row.isCommon?(d(),m(u,{key:1,type:"danger",size:"small",plain:"",onClick:v=>I(s.row)},{default:n(()=>[c(" 删除 ")]),_:2},1032,["onClick"])):p("",!0)]),_:1})]),_:1},8,["data"])),[[U,t(e).loading]]),l(A,{"current-page":t(f).page,total:t(f).total,"page-size":t(f).size,"page-sizes":t(f).sizes,layout:t(f).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:D,onCurrentChange:S},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),t(e).formMode==="dialog"||t(e).formMode==="drawer"?(d(),m(re,{key:0,id:t(e).formModeProps.id,row:t(e).formModeProps.row,modelValue:t(e).formModeProps.visible,"onUpdate:modelValue":o[1]||(o[1]=s=>t(e).formModeProps.visible=s),mode:t(e).formMode,onSuccess:i},null,8,["id","row","modelValue","mode"])):p("",!0),l(de,{ref_key:"homePageRef",ref:y,onFetchData:i},null,512)],2)}}}),ve=ie(me,[["__scopeId","data-v-27713cd3"]]);export{ve as default};
