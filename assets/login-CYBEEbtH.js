
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{_ as Ce}from"./index.vue_vue_type_script_setup_true_lang-8yHEW3R1.js";import{k as X,d as ke,t as Ue,a0 as Re,a1 as Te,r as d,b7 as w,b8 as Y,aO as Se,a2 as Fe,b as ee,f as o,w as l,l as u,am as M,aB as D,i as e,v as Ie,a as g,aG as qe,aH as Le,O as Ne,b9 as Pe,o as h,p as Ae,aC as $e,g as c,I as E,e as C,az as ae,j as O,ay as G,F as ze,n as Be,ak as q,N as Ke,_ as Ze,q as oe}from"./index-CQB6STMM.js";import Me from"./index-MV9b97iz.js";import{s as De,o as le}from"./apiLoading-BepKMI6_.js";import{u as Oe}from"./otherFunctions_basicDictionary-BIhBb0-b.js";import"./basicDictionary-C9eEDUiV.js";const L={sendCode:_=>X.post("user/sendCode",_),register:_=>X.post("user/register",_)},T=_=>(qe("data-v-8a10c7b7"),_=_(),Le(),_),Ge=T(()=>u("div",{class:"bg-banner"},null,-1)),He={id:"login-box"},je=T(()=>u("div",{class:"login-banner"},[u("h1",{style:{"font-size":"50px","font-weight":"normal"}},"欢迎 !"),u("h3",{h1:"",style:{"font-size":"30px","font-weight":"normal"}}," 来到租户系统 ! 👋🏻 ")],-1)),Je={class:"title-container"},Qe={class:"fx-c"},We={class:"flex-bar",style:{margin:"0",width:"100%"}},Xe={class:"flex-bar"},Ye={class:"sub-link"},ea=T(()=>u("span",{class:"text"},"还不是会员?",-1)),aa={class:"flex-bar",style:{margin:"0"}},oa={class:"sub-link"},la=T(()=>u("span",{class:"text"},"已经有帐号?",-1)),ta=T(()=>u("div",{class:"title-container"},[u("h3",{class:"title"},"忘记密码了? 🔒")],-1)),ra={class:"sub-link"},te=ke({name:"Login",__name:"login",setup(_){var Q;const re=Oe(),ne=Ie(),se=Ne(),ie=Ue(),ue=Re(),{t:f}=Te();new URL(""+new URL("login-banner-ZfMZACb6.png",import.meta.url).href,import.meta.url).href,new URL(""+new URL("logo-CLz_KCqM.png",import.meta.url).href,import.meta.url).href;const v=d("login"),V=d(!1),de=d(((Q=ne.query.redirect)==null?void 0:Q.toString())??ie.settings.home.fullPath),k=d(),b=d("code"),N=d("获取验证码"),P=d(!1),i=d({account:w.local.get("login_account")||"",remember:w.local.has("login_account")}),H=(n,a,r)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(i.value.account)?r():r(new Error("请输入合法手机号"))},pe=(n,a,r)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(i.value.account)?r():r(new Error("请输入合法邮箱"))},S=d({account:[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}],agreeToTheAgreement:[{validator:(n,a)=>a===!0,message:"请阅读并勾选协议",trigger:"change"}]}),ce=()=>{i.value.account.includes("@")?S.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"},{validator:pe,trigger:"blur"}]:S.value.account=[{required:!0,trigger:"blur",message:"请输入手机号/邮箱"},{validator:H,trigger:"blur"}]};async function me(){k.value.validateField("account",async n=>{if(n){let a;i.value.account.includes("@")?a={email:i.value.account,type:"login_email"}:a={phone:i.value.account,type:"login_phone_number"};const{status:r}=await L.sendCode(a);r===1&&q.success({message:"已发送"})}}),ge()}const ge=()=>{P.value=!0;let n=60;y.value=setInterval(()=>{n>0?(n--,N.value=`请在${n}s后重新获取`):(clearInterval(y.value),N.value="获取验证码",y.value=null,P.value=!1)},1e3)},A=Y(()=>{k.value&&k.value.validate(n=>{if(n){let a={...i.value};b.value==="password"?a.type=1:i.value.account.includes("@")?a.type=3:a.type=2,V.value=!0,ue.login(a).then(()=>{V.value=!1,i.value.remember?w.local.set("login_account",i.value.account):w.local.remove("login_account"),se.push(de.value)}).catch(()=>{V.value=!1})}})},3e3),y=d(null),$=d("获取验证码"),z=d(!1),F=d(),j=d([]),s=d({account:"",password:"",email:"",phoneNumber:"",code:"",country:"",type:"phone"}),fe=d({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],email:[{required:!0,trigger:"blur",message:"请输入邮箱"},{validator:(n,a,r)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(s.value.email)?r():r(new Error("请输入合法邮箱"))},trigger:"blur"}],phoneNumber:[{required:!0,trigger:"blur",message:"请输入手机号码"},{validator:(n,a,r)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(s.value.phoneNumber)?r():r(new Error("请输入合法手机号"))},trigger:"blur"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],country:[{required:!0,trigger:"change",message:"请选择国家"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}],agreeToTheAgreement:[{validator:(n,a)=>a===!0,message:"请阅读并勾选协议",trigger:"change"}]}),ve=async()=>{const n={type:"register_phone_number",email:s.value.email,phone:s.value.phoneNumber};if(s.value.country==="343"){const{status:a}=await le(L.sendCode(n));a===1&&q.success({message:"已发送"})}else{n.type="register_email";const{status:a}=await le(L.sendCode(n));a===1&&q.success({message:"已发送"})}_e()},_e=()=>{z.value=!0;let n=60;y.value=setInterval(()=>{n>0?(n--,$.value=`请在${n}s后重新获取`):(clearInterval(y.value),$.value="获取验证码",y.value=null,z.value=!1)},1e3)},be=Y(async()=>{F.value&&F.value.validate(async n=>{if(n){s.value.type=s.value.country==="343"?"phone":"email";const{status:a}=await De(L.register(s.value));a===1&&Pe({type:"success",dangerouslyUseHTMLString:!0,duration:5e3,message:'<span>注册成功,跳转至<span id="ElNotification-goLogin" style="color:var(--el-color-primary);cursor:pointer;">登录</span></span>',onClick(r){r.target.id&&r.target.id==="ElNotification-goLogin"&&(v.value="login")}})}})},3e3),B=d(),x=d({account:w.local.get("login_account"),code:"",newPassword:""}),ye=d({account:[{required:!0,trigger:"blur",message:"请输入用户名"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}],newPassword:[{required:!0,trigger:"blur",message:"请输入新密码"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}]});function he(){q({message:"重置密码仅提供界面演示，无实际功能，需开发者自行扩展",type:"info"}),B.value&&B.value.validate(n=>{})}Se(()=>{clearInterval(y.value),y.value=null});const J=()=>{S.value.account=[{validator:H,trigger:"blur"}],k.value.resetFields()};return Fe(()=>v.value,async n=>{switch(n){case"login":J(),i.value={account:w.local.get("login_account")||"",remember:w.local.has("login_account")};break;case"register":F.value.resetFields(),s.value={account:"",password:"",email:"",phoneNumber:"",code:"",country:"",type:"phone"};break}n==="register"&&(j.value=await re.getCountry())}),(n,a)=>{const r=Ke,U=Ce,W=g("el-radio-button"),xe=g("el-radio-group"),we=g("el-button"),m=g("ElInput"),p=g("ElFormItem"),K=g("ElCheckbox"),I=g("ElLink"),R=g("ElButton"),Z=g("ElForm"),Ve=g("ElOption"),Ee=g("ElSelect");return h(),ee("div",null,[Ge,o(U,{placement:"bottom-end",class:"i18n-selector"},{default:l(()=>[o(r,{name:"i-ri:translate"})]),_:1}),u("div",He,[je,M(o(Z,{ref_key:"loginFormRef",ref:k,model:e(i),rules:e(S),class:"login-form","validate-on-rule-change":!1},{default:l(()=>[u("div",Je,[u("div",Qe,[o(xe,{modelValue:e(b),"onUpdate:modelValue":a[0]||(a[0]=t=>Ae(b)?b.value=t:null),size:"large",onChange:J},{default:l(()=>[o(W,{label:"验证码登录",value:"code"}),o(W,{label:"密码登录",value:"password"})]),_:1},8,["modelValue"])])]),u("div",null,[o(p,{prop:"account"},{default:l(()=>[o(m,{modelValue:e(i).account,"onUpdate:modelValue":a[1]||(a[1]=t=>e(i).account=t),placeholder:e(f)("app.account"),type:"text",tabindex:"1",onBlur:ce},$e({prefix:l(()=>[o(r,{name:"i-ri:user-3-fill"})]),_:2},[e(b)==="code"?{name:"append",fn:l(()=>[o(we,{type:"primary",disabled:e(P),onClick:me},{default:l(()=>[c(E(e(N)),1)]),_:1},8,["disabled"])]),key:"0"}:void 0]),1032,["modelValue","placeholder"])]),_:1}),e(b)==="password"?(h(),C(p,{key:0,prop:"password"},{default:l(()=>[o(m,{modelValue:e(i).password,"onUpdate:modelValue":a[2]||(a[2]=t=>e(i).password=t),type:"password",placeholder:e(f)("app.password"),tabindex:"2",autocomplete:"new-password","show-password":"",onKeyup:ae(e(A),["enter"])},{prefix:l(()=>[o(r,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue","placeholder","onKeyup"])]),_:1})):O("",!0),e(b)==="code"?(h(),C(p,{key:1,prop:"code"},{default:l(()=>[o(m,{modelValue:e(i).code,"onUpdate:modelValue":a[3]||(a[3]=t=>e(i).code=t),type:"text",placeholder:e(f)("app.captcha"),tabindex:"2",onKeyup:ae(e(A),["enter"])},{prefix:l(()=>[o(r,{name:"i-ep:message"})]),_:1},8,["modelValue","placeholder","onKeyup"])]),_:1})):O("",!0),o(p,{prop:"agreeToTheAgreement"},{default:l(()=>[u("div",We,[o(K,{modelValue:e(i).agreeToTheAgreement,"onUpdate:modelValue":a[4]||(a[4]=t=>e(i).agreeToTheAgreement=t),tabindex:"3"},{default:l(()=>[c("我已阅读并同意《xxxx协议》 ")]),_:1},8,["modelValue"]),e(b)==="password"?(h(),C(I,{key:0,type:"primary",underline:!1,onClick:a[5]||(a[5]=t=>v.value="reset")},{default:l(()=>[c(" 忘记密码了? ")]),_:1})):O("",!0)])]),_:1})]),u("div",Xe,[o(K,{modelValue:e(i).remember,"onUpdate:modelValue":a[6]||(a[6]=t=>e(i).remember=t),tabindex:"4"},{default:l(()=>[c(" 保持登录 ")]),_:1},8,["modelValue"])]),o(R,{loading:e(V),type:"primary",size:"large",style:{width:"100%"},onClick:G(e(A),["prevent"]),tabindex:"5"},{default:l(()=>[c(E(e(f)("app.login")),1)]),_:1},8,["loading","onClick"]),u("div",Ye,[ea,o(I,{type:"primary",underline:!1,onClick:a[7]||(a[7]=t=>v.value="register")},{default:l(()=>[c(" 立即注册 ")]),_:1})])]),_:1},8,["model","rules"]),[[D,e(v)==="login"]]),M(o(Z,{ref_key:"registerFormRef",ref:F,model:e(s),rules:e(fe),class:"login-form","auto-complete":"on"},{default:l(()=>[u("div",null,[o(p,{prop:"account"},{default:l(()=>[o(m,{modelValue:e(s).account,"onUpdate:modelValue":a[8]||(a[8]=t=>e(s).account=t),placeholder:"用户名",tabindex:"1"},{prefix:l(()=>[o(r,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue"])]),_:1}),o(p,{prop:"country"},{default:l(()=>[o(Ee,{modelValue:e(s).country,"onUpdate:modelValue":a[9]||(a[9]=t=>e(s).country=t),placeholder:"国家",clearable:"",filterable:"",tabindex:"2"},{prefix:l(()=>[o(r,{name:"i-mdi:format-list-bulleted-type"})]),default:l(()=>[(h(!0),ee(ze,null,Be(e(j),t=>(h(),C(Ve,{label:t.chineseName,value:t.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),e(s).country==="343"?(h(),C(p,{key:0,prop:"phoneNumber"},{default:l(()=>[o(m,{modelValue:e(s).phoneNumber,"onUpdate:modelValue":a[10]||(a[10]=t=>e(s).phoneNumber=t),placeholder:"手机号",tabindex:"3"},{prefix:l(()=>[o(r,{name:"i-ant-design:phone-outlined"})]),_:1},8,["modelValue"])]),_:1})):(h(),C(p,{key:1,prop:"email"},{default:l(()=>[o(m,{modelValue:e(s).email,"onUpdate:modelValue":a[11]||(a[11]=t=>e(s).email=t),placeholder:"邮箱",tabindex:"3"},{prefix:l(()=>[o(r,{name:"i-mdi:email"})]),_:1},8,["modelValue"])]),_:1})),o(p,{prop:"code"},{default:l(()=>[o(m,{modelValue:e(s).code,"onUpdate:modelValue":a[12]||(a[12]=t=>e(s).code=t),placeholder:"验证码",tabindex:"4"},{prefix:l(()=>[o(r,{name:"i-ic:baseline-verified-user"})]),append:l(()=>[o(R,{disabled:e(z),onClick:ve},{default:l(()=>[c(E(e($)),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),o(p,{prop:"password"},{default:l(()=>[o(m,{modelValue:e(s).password,"onUpdate:modelValue":a[13]||(a[13]=t=>e(s).password=t),type:"password",placeholder:"密码",tabindex:"5","show-password":""},{prefix:l(()=>[o(r,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue"])]),_:1}),o(p,{prop:"agreeToTheAgreement"},{default:l(()=>[u("div",aa,[o(K,{modelValue:e(s).agreeToTheAgreement,"onUpdate:modelValue":a[14]||(a[14]=t=>e(s).agreeToTheAgreement=t),tabindex:"6"},{default:l(()=>[c(" 我已阅读并同意《xxxx协议》 ")]),_:1},8,["modelValue"])])]),_:1})]),o(R,{tabindex:"7",loading:e(V),type:"primary",size:"large",style:{width:"100%","margin-top":"20px"},onClick:G(e(be),["prevent"])},{default:l(()=>[c(" 注册 ")]),_:1},8,["loading","onClick"]),u("div",oa,[la,o(I,{type:"primary",underline:!1,onClick:a[15]||(a[15]=t=>v.value="login")},{default:l(()=>[c(" 去登录 ")]),_:1})])]),_:1},8,["model","rules"]),[[D,e(v)==="register"]]),M(o(Z,{ref_key:"resetFormRef",ref:B,model:e(x),rules:e(ye),class:"login-form"},{default:l(()=>[ta,u("div",null,[o(p,{prop:"account"},{default:l(()=>[o(m,{modelValue:e(x).account,"onUpdate:modelValue":a[16]||(a[16]=t=>e(x).account=t),placeholder:e(f)("app.account"),type:"text",tabindex:"1"},{prefix:l(()=>[o(r,{name:"i-ri:user-3-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1}),o(p,{prop:"code"},{default:l(()=>[o(m,{modelValue:e(x).code,"onUpdate:modelValue":a[17]||(a[17]=t=>e(x).code=t),placeholder:e(f)("app.code"),type:"text",tabindex:"2"},{prefix:l(()=>[o(r,{name:"i-ic:baseline-verified-user"})]),append:l(()=>[o(R,null,{default:l(()=>[c(E(e(f)("app.sendCaptcha")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),o(p,{prop:"newPassword"},{default:l(()=>[o(m,{modelValue:e(x).newPassword,"onUpdate:modelValue":a[18]||(a[18]=t=>e(x).newPassword=t),type:"password",placeholder:e(f)("app.newPassword"),tabindex:"3","show-password":""},{prefix:l(()=>[o(r,{name:"i-ri:lock-2-fill"})]),_:1},8,["modelValue","placeholder"])]),_:1})]),o(R,{loading:e(V),type:"primary",size:"large",style:{width:"100%","margin-top":"20px"},onClick:G(he,["prevent"])},{default:l(()=>[c(E(e(f)("app.check")),1)]),_:1},8,["loading"]),u("div",ra,[o(I,{type:"primary",underline:!1,onClick:a[19]||(a[19]=t=>v.value="login")},{default:l(()=>[c(E(e(f)("app.goLogin")),1)]),_:1})])]),_:1},8,["model","rules"]),[[D,e(v)==="reset"]])]),o(Me)])}}});typeof oe=="function"&&oe(te);const ga=Ze(te,[["__scopeId","data-v-8a10c7b7"]]);export{ga as default};
