
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{k as H,d as ye,r as m,aD as he,n as be,a as d,q as Ve,s as xe,o as _,b,f as e,w as a,y as s,e as M,g as f,z as B,j as w,N as we,F as Ce,t as Ne,E as L,$ as De,U as Le,au as qe,_ as Ee,an as Ue,aH as ke,aI as Re,L as Se}from"./index-Bz44aVie.js";import{a as T}from"./configuration_site_setting-uH8JoGsn.js";import{u as Oe}from"./index-CCHf-PPm.js";import Te from"./index-D8YGFARx.js";import{u as ze}from"./configuration_siteSetting-Da6f-FHe.js";import"./clipboard-KvLcivaI.js";import"./index-BaFk21_1.js";import"./index-Dpr25wFL.js";import"./index-BAX224p4.js";const Ae={getTenantLogo:h=>H.post("tenant-logo/getTenantLogo",h),uploadLogo:h=>H.post("tenant-logo/upload",h)},g=h=>(ke("data-v-2b7bd2b1"),h=h(),Re(),h),Ie={class:"domainNamess"},Pe={class:"domainNames"},Qe={class:"domainName"},$e={key:1},Fe={key:0},je=g(()=>s("span",{class:"green"},null,-1)),He=g(()=>s("span",{style:{"margin-right":"10px"}},"已生效",-1)),Me=[je,He],Be={key:1},We=g(()=>s("span",{class:"red"},null,-1)),Ze=g(()=>s("span",{style:{"margin-right":"10px"}},"未生效",-1)),Ye=[We,Ze],Ge=g(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"80",height:"80",viewBox:"0 0 80 80",fill:"none"},[s("g",{id:"Frame"},[s("path",{id:"Vector",d:"M64.2018 37.4596C64.2018 37.4596 63.7118 21.3346 50.5768 18.1296C37.4418 14.9246 31.1118 28.7646 30.9818 29.1596C30.8518 29.5546 30.2068 29.3746 30.2068 29.3746C29.1568 28.3796 24.5268 26.0946 19.6618 29.0246C14.8018 31.9546 16.5618 37.5196 16.5618 37.5196C16.5618 37.5196 9.35676 36.9346 5.66176 48.0596C1.97176 59.1946 14.9168 62.3496 14.9168 62.3496H36.6468V50.5046H32.2968H31.9168H31.6218V50.4846C31.3718 50.4846 31.1718 50.2846 31.1718 50.0296C31.1718 49.8796 31.2518 49.7496 31.3718 49.6646L40.2768 40.2996C40.4018 40.1596 40.5768 40.0646 40.7818 40.0646C40.9918 40.0646 41.1768 40.1696 41.3018 40.3246L50.1418 49.6146C50.1568 49.6246 50.1718 49.6396 50.1868 49.6546L50.2718 49.7446H50.2418C50.2868 49.8246 50.3168 49.8946 50.3168 49.9896C50.3168 50.2696 50.0918 50.4996 49.8068 50.4996C49.7968 50.4996 49.7968 50.4896 49.7868 50.4896V50.5096H44.9968V62.3546H64.7218C64.7218 62.3546 74.1268 59.9996 74.9568 50.2896C75.7968 40.5796 64.2018 37.4596 64.2018 37.4596Z",fill:"#409EFF"})])],-1)),Je=g(()=>s("div",{class:"el-upload__text"}," 支持点击拖拽上传 ",-1)),Ke=g(()=>s("div",{style:{color:"#47a2ff"},class:"el-upload__text"}," 支持上传JPG/JPEG/PNG图片，小于10MB ",-1)),Xe=["src"],el={key:0,style:{"margin-bottom":"10px"},class:"exchangeRate"},ll=g(()=>s("div",{class:"left"},[s("div",{style:{width:"119.86px"},class:"top"},"1 美元 (USD)      =")],-1)),al={class:"right"},tl={class:"bottom"},ol={key:1,class:"exchangeRate"},nl=g(()=>s("div",{class:"left"},[s("div",{class:"top"},"1 人民币 (CNY)   =")],-1)),sl={class:"right"},ul={class:"bottom"},il={key:2,class:"tips"},rl=g(()=>s("div",{style:{color:"orange","margin-right":"5px"},class:"i-ic:round-warning w-1.3em h-1.3em"},null,-1)),dl=ye({name:"site_setting",__name:"list",setup(h){const W=[{label:"美元",value:"USD"},{label:"人民币",value:"CNY"}],C=m(),Z=ze(),c=he(),z=m(),Y="https://saas-api.surveysaas.com/api/tenant-logo/upload",{toClipboard:G}=Oe(),A=m("基本设置"),V=m(!1),x=m(),I=m(!1),q=m(),l=m({id:"",registerOffOrOn:!0,registerExamineOffOrOn:!1,keyWords:"",description:"",webName:"",topLevelDomainName:"",defaultPriceRatio:null,taxRate:null,minimumAmount:null,phone:"",email:"",qqCode:"",address:"",projectOutAlias:""}),N=m({webName:[{required:!0,message:"请输入网站名称",trigger:"blur"}],topLevelDomainName:[{required:!1,message:"请输入顶级域名",trigger:"blur"},{validator:(n,t,i)=>{new RegExp("^(?!-)[A-Za-z0-9-]{1,63}(?<!-)(?:\\.[A-Za-z0-9-]{1,63}(?<!-))*\\.[A-Za-z]{2,}$").test(t)?i():i(new Error("请输入合法的域名"))},trigger:"submit"}],phone:[{required:!1,trigger:"blur",message:"请输入手机号"},{validator:(n,t,i)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(l.value.phone)?i():i(new Error("请输入合法手机号"))},trigger:"blur"}],email:[{required:!1,trigger:"blur",message:"请输入邮箱"},{validator:(n,t,i)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(l.value.email)?i():i(new Error("请输入合法邮箱"))},trigger:"blur"}],qqCode:[{required:!1,trigger:"blur",message:"请输入QQ号码"},{validator:(n,t,i)=>{/^[1-9][0-9]{4,14}$/.test(t)?i():i(new Error("请输入合法QQ号（5到15位数字，不能以0开头）"))},trigger:"blur"}],address:[{required:!1,message:"请输入内容",trigger:"blur"},{max:50,message:"最多输入 50 字",trigger:"blur"}],exchangeRate:[{required:!1,message:"请输入美元汇率",trigger:"blur"},{pattern:/^(?!0(\.0+)?$)(\d+(\.\d{1,2})?)$/,message:"请输入一个有效的数字，不能小于0，最多保留两位小数",trigger:"blur"}]});be(()=>{V.value=!0,c.logo&&(v.value=[{name:"logo",url:c.logo}]),E(),V.value=!1});async function E(){try{const{data:n}=await T.list();if(Z.setSiteConfig(n),n&&(l.value=n||l.value,C.value=n.currencyType,l.value.minimumAmount===0&&(l.value.minimumAmount=null),q.value=l.value,c.originalExchangeRate=l.value.exchangeRate,c.setWebName(n.webName),c.setDescription(n.description),c.setkeyWords(n.keyWords)),l.value.topLevelDomainName!==""&&l.value.topLevelDomainName!==null){const t=await T.getTenantWebConfigQueryAnalysis({url:l.value.topLevelDomainName});I.value=t.data.success,l.value.isAnalysis=t.data.success}}catch{}finally{V.value=!1}}const J=async()=>{var t;v.value=[];const n=await Ae.getTenantLogo();n.data&&(c.setLogo(n.data.logoUrl),v.value.push({name:"file",url:(t=n==null?void 0:n.data)==null?void 0:t.logoUrl}))},K=()=>{z.value.showEdit(q.value)},X=()=>{const n=l.value.personalizedDomainName;G(n),L({type:"success",message:"复制成功"})},ee=c.token,le=m({Token:ee}),P=m(""),U=m(!1),Q=m(),v=m([]),ae=async()=>{L.success({message:"删除成功",center:!0}),c.delLogo()},te=(n,t)=>(t.value=t.filter(i=>i.uid!==n.uid),!0),oe=(n,t)=>{const i=[".jpg",".jpeg",".png"],y=n.name.slice((n.name.lastIndexOf(".")-1>>>0)+2).toLowerCase();if(!i.includes(`.${y}`))return v.value=[],De(()=>{v.value=[]}),L({type:"warning",message:"上传文件类型不正确，仅支持 jpg、jpeg 和 png 格式。"})},ne=(n,t)=>{n.status===-1?(Le.error(n.error,{zIndex:2e3}),v.value=v.value.filter(i=>i.name!==t.name)):J()},se=async()=>{L.warning({message:"只能上传一个,删除原文件后重新上传",center:!0})},ue=n=>{P.value=n.url,U.value=!0},ie=n=>{n&&(C.value=n,l.value.exchangeRate="")};function k(){(l.value.email===""||l.value.email===null)&&(N.value.email=[],x.value.clearValidate("email")),(l.value.phone===""||l.value.phone===null)&&(N.value.phone=[],x.value.clearValidate("phone")),(l.value.qqCode===""||l.value.qqCode===null)&&(N.value.qqCode=[],x.value.clearValidate("qqCode")),(l.value.topLevelDomainName===""||l.value.topLevelDomainName===null)&&(N.value.topLevelDomainName=[],x.value.clearValidate("topLevelDomainName")),x.value&&x.value.validate(async n=>{if(n)try{V.value=!0,l.value.topLevelDomainName&&(l.value.topLevelDomainName=l.value.topLevelDomainName.replace(/^https?:\/\//,"")),v.value.length&&Q.value.submit(),l.value.currencyType==="USD"?c.currencyType=1:c.currencyType=2;const t=await T.edit(l.value);V.value=!1,t.status===1&&(E(),L.success({message:"修改成功",center:!0}))}catch(t){console.log("error",t)}finally{V.value=!1}})}return(n,t)=>{var j;const i=qe,y=Ee,R=d("el-tooltip"),$=d("el-switch"),r=d("el-form-item"),u=d("el-col"),p=d("el-input"),F=d("el-text"),D=d("el-button"),re=d("el-upload"),de=d("el-dialog"),me=d("ElFormItem"),S=d("el-row"),O=d("el-tab-pane"),pe=d("el-option"),ce=d("el-select"),ve=d("el-form"),fe=d("el-tabs"),_e=Ue,ge=Ve("loading");return xe((_(),b("div",null,[e(i,{title:"站点设置管理"}),e(_e,null,{default:a(()=>[e(fe,{modelValue:A.value,"onUpdate:modelValue":t[17]||(t[17]=o=>A.value=o)},{default:a(()=>[e(ve,{ref_key:"formRef",ref:x,model:l.value,rules:N.value,"label-width":"100px","label-position":"right",inline:!1},{default:a(()=>[e(O,{label:"基础设置",name:"基本设置"},{default:a(()=>[e(S,{gutter:20},{default:a(()=>[e(u,{span:3},{default:a(()=>[e(r,{label:"注册开关"},{default:a(()=>[s("div",Ie,[e(R,{class:"tooltips",content:"注册开关、注册审核，进行变更后，需要点击【确认】才可生效",placement:"top"},{default:a(()=>[e(y,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})]),e($,{modelValue:l.value.registerOffOrOn,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.registerOffOrOn=o),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:6},{default:a(()=>[e(r,{label:"注册审核"},{default:a(()=>[e($,{modelValue:l.value.registerExamineOffOrOn,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.registerExamineOffOrOn=o),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,{label:"网站名称",prop:"webName"},{default:a(()=>[e(p,{modelValue:l.value.webName,"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.webName=o),style:{width:"22.4375rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,{label:"网站关键字"},{default:a(()=>[s("div",Pe,[e(R,{class:"tooltips",content:"设定网站关键字，在浏览器中输入该关键字即可搜索到该网站",placement:"top"},{default:a(()=>[e(y,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})]),e(p,{modelValue:l.value.keyWords,"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.keyWords=o),style:{width:"22.4375rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,{label:"网站描述"},{default:a(()=>[s("div",Qe,[e(R,{class:"tooltips",content:"描述该网址功能及意义，可对外宣传使用",placement:"top"},{default:a(()=>[e(y,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})]),e(p,{modelValue:l.value.description,"onUpdate:modelValue":t[4]||(t[4]=o=>l.value.description=o),style:{width:"22.4375rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,{label:"默认官网域名",prop:""},{default:a(()=>[l.value.personalizedDomainName?(_(),M(F,{key:0,class:"mx-1"},{default:a(()=>[f(B(l.value.personalizedDomainName),1)]),_:1})):w("",!0),e(D,{class:"copy",type:"primary",plain:"",size:"small",onClick:X},{default:a(()=>[f("复制")]),_:1})]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,{label:"域名配置",prop:"topLevelDomainName"},{default:a(()=>[l.value.topLevelDomainName?(_(),M(F,{key:0,class:"mx-1"},{default:a(()=>[f(B(l.value.topLevelDomainName),1)]),_:1})):w("",!0),l.value.topLevelDomainName?(_(),b("div",$e,[I.value?(_(),b("div",Fe,Me)):(_(),b("div",Be,Ye))])):w("",!0),e(D,{class:"copy",onClick:K,type:"primary",size:"small",plain:""},{default:a(()=>[f("CNAME配置")]),_:1})]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(me,{style:{display:"flex","justify-content":"center"},label:"网址Logo"},{default:a(()=>[e(re,{class:we({hide_box:v.value.length}),ref_key:"uploadRef",ref:Q,drag:"","file-list":v.value,"onUpdate:fileList":t[5]||(t[5]=o=>v.value=o),headers:le.value,action:Y,"auto-upload":!1,"list-type":"picture-card",limit:1,"on-preview":ue,"on-remove":ae,"on-success":ne,"on-change":oe,"on-exceed":se,"before-remove":te},{default:a(()=>[Ge,Je,Ke]),_:1},8,["class","file-list","headers"]),e(de,{modelValue:U.value,"onUpdate:modelValue":t[6]||(t[6]=o=>U.value=o),style:{"z-index":"1000",transform:"translate(0)",position:"relative"}},{default:a(()=>[s("img",{"w-full":"",src:P.value,alt:"Preview Image"},null,8,Xe)]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,{label:"外包项目别名"},{default:a(()=>[e(p,{modelValue:l.value.projectOutAlias,"onUpdate:modelValue":t[7]||(t[7]=o=>l.value.projectOutAlias=o),style:{width:"22.4375rem"}},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,null,{default:a(()=>[e(D,{type:"primary",onClick:k},{default:a(()=>[f(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{label:"高级设置",name:"高级设置"},{default:a(()=>[e(S,{gutter:20},{default:a(()=>[e(u,{span:24},{default:a(()=>[e(r,{label:"默认币种",prop:""},{default:a(()=>[e(ce,{modelValue:l.value.currencyType,"onUpdate:modelValue":t[8]||(t[8]=o=>l.value.currencyType=o),"value-key":"",style:{width:"22.4375rem"},placeholder:"请选择币种",clearable:"",filterable:"",onChange:ie},{default:a(()=>[(_(),b(Ce,null,Ne(W,o=>e(pe,{key:o.value,label:o.label,value:o.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,{style:{display:"flex"},label:"汇率",prop:"exchangeRate"},{default:a(()=>[s("div",null,[C.value==="USD"?(_(),b("div",el,[ll,s("div",al,[s("div",tl,[e(p,{modelValue:l.value.exchangeRate,"onUpdate:modelValue":t[9]||(t[9]=o=>l.value.exchangeRate=o),style:{width:"7.4375rem"},placeholder:"请输入数值",clearable:""},null,8,["modelValue"]),f(" 人民币 (CNY) ")])])])):w("",!0),C.value==="CNY"?(_(),b("div",ol,[nl,s("div",sl,[s("div",ul,[e(p,{modelValue:l.value.exchangeRate,"onUpdate:modelValue":t[10]||(t[10]=o=>l.value.exchangeRate=o),style:{width:"7.4375rem"},placeholder:"请输入数值",clearable:""},null,8,["modelValue"]),f(" 美元 (USD) ")])])])):w("",!0),C.value==="CNY"&&l.value.exchangeRate>=1?(_(),b("div",il,[rl,f(" 请再三确认,当前市场1人民币对美元的汇率 ")])):w("",!0)])]),_:1})]),_:1}),e(u,{span:24}),e(u,{span:24},{default:a(()=>[e(r,{label:"最低结算金额",prop:""},{default:a(()=>[e(p,{modelValue:l.value.minimumAmount,"onUpdate:modelValue":t[11]||(t[11]=o=>l.value.minimumAmount=o),modelModifiers:{number:!0},style:{width:"22.4375rem"},placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,{label:"供应商税点",prop:""},{default:a(()=>[e(p,{modelValue:l.value.taxRate,"onUpdate:modelValue":t[12]||(t[12]=o=>l.value.taxRate=o),modelModifiers:{number:!0},style:{width:"22.4375rem"},placeholder:""},{append:a(()=>[f("%")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,null,{default:a(()=>[e(D,{type:"primary",onClick:k},{default:a(()=>[f(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{label:"联系我们",name:"联系我们"},{default:a(()=>[e(S,{gutter:20},{default:a(()=>[e(u,{span:24},{default:a(()=>[e(r,{label:"电子邮箱",prop:"email"},{default:a(()=>[e(p,{style:{width:"22.4375rem"},modelValue:l.value.email,"onUpdate:modelValue":t[13]||(t[13]=o=>l.value.email=o),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,{label:"手机号码",prop:"phone"},{default:a(()=>[e(p,{style:{width:"22.4375rem"},modelValue:l.value.phone,"onUpdate:modelValue":t[14]||(t[14]=o=>l.value.phone=o),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,{label:"QQ号码",prop:"qqCode"},{default:a(()=>[e(p,{style:{width:"22.4375rem"},modelValue:l.value.qqCode,"onUpdate:modelValue":t[15]||(t[15]=o=>l.value.qqCode=o),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,{label:"公司地址",prop:"address"},{default:a(()=>[e(p,{style:{width:"22.4375rem"},modelValue:l.value.address,"onUpdate:modelValue":t[16]||(t[16]=o=>l.value.address=o),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,null,{default:a(()=>[e(D,{type:"primary",onClick:k},{default:a(()=>[f("确认")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]),_:1}),e(Te,{ref_key:"recordRef",ref:z,onFetchData:E,personalizedDomainName:(j=q.value)==null?void 0:j.personalizedDomainName},null,8,["personalizedDomainName"])])),[[ge,V.value]])}}}),Cl=Se(dl,[["__scopeId","data-v-2b7bd2b1"]]);export{Cl as default};
