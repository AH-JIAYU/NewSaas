
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Se,aN as we,r as d,a3 as Ie,n as Ne,a as b,q as je,o as s,b as Ce,f as l,w as t,e as r,j as i,g as n,s as Le,i as h,aM as ne,y as m,z as p,N as R,E as I,aO as se,b9 as ze,ba as De,be as xe,ap as Re,L as Ue}from"./index-Bn2GMQXG.js";import{_ as Ee}from"./index-D-btMl2l.js";import{_ as Be}from"./index.vue_vue_type_style_index_0_lang-CnJYSCR6.js";import{_ as Me}from"./index-SWkBnv_z.js";import{u as Te,o as Ae,a as U}from"./index-zBdNqRdS.js";import Pe from"./index-DkL_xEMf.js";import{u as He}from"./index-CJpx5TKK.js";import"./index-BAH3-LM4.js";import"./index.vue_vue_type_script_setup_true_lang-D9N82jRP.js";import"./sortable.esm-C0-Qcoum.js";import"./apiLoading-BHozReCc.js";import"./projectManagement-C7bbPTCs.js";import"./user_cooperation-DqVUItJS.js";import"./survey_vip_department-DxRcONRj.js";import"./user_supplier-BOpaajtb.js";import"./user_supplier-CxvMMLSO.js";import"./survey_vipGroup-UpsFdzDB.js";import"./survey_vipGroup-D5GcGdza.js";import"./department-DQERDib2.js";const Ve={class:"tableBig"},$e={class:"tableBig"},Oe={class:"copyId tableSmall"},Fe={class:"id oneLine projectId"},Qe={class:"tableBig oneLine"},qe={class:"copyId tableSmall"},Ge={class:"id oneLine projectId"},Je={class:"tableBig"},Ke={class:"tableBig"},We={class:"copyId tableSmall"},Xe={class:"id oneLine projectId"},Ye={class:"tableBig"},Ze={class:"copyId tableSmall"},et={class:"id oneLine projectId"},tt={class:"tableBig"},at=Se({name:"outsource",__name:"list",setup(lt){const V=Te(),{pagination:_,getParams:re,onSizeChange:ie,onCurrentChange:ue}=we(),ce=d(),A=d(),pe=d(),v=d(!0),N=d(!1),$=d(),w=d(),D=d(!1),u=d([]),O=d(),F=d(),Q=d("formSearch-outsource"),j=d("default"),C=d(!1),x=d([{sotrtable:!0,checked:!0,label:"租户ID",prop:"tenantId"},{sotrtable:!0,checked:!0,label:"接收状态",prop:"receiveStatus"},{sotrtable:!0,checked:!0,label:"负责部门/PM",prop:"userName"},{sotrtable:!0,checked:!0,label:"租户名称",prop:"tenantName"},{sotrtable:!0,checked:!0,label:"分配",prop:"allocationType"},{sotrtable:!0,checked:!0,label:"项目价",prop:"doMoneyPrice"},{sotrtable:!0,checked:!0,label:"项目ID",prop:"projectId"},{sotrtable:!0,checked:!0,label:"项目名称",prop:"projectName"},{sotrtable:!0,checked:!0,label:"参与/完成/配额/限量",prop:"participationNumber"},{sotrtable:!0,checked:!0,label:"状态",prop:"projectStatus"}]),k=Ie({projectId:"",tenantId:"",tenantName:"",projectStatus:"",type:2}),E=d([]);function q(o){$.value.showEdit(o,k.type===2?1:0)}function G(o){ie(o).then(()=>S())}function L(o=1){ue(o).then(()=>S())}function J(){Object.assign(k,{tenantId:"",tenantName:"",projectStatus:"",type:2}),S()}async function S(){try{v.value=!0;const o={...re(),...k};if(k.type===1){const a=await U.list(o);E.value=a.data.projectAllocationInfoList,_.value.total=a.data.total}else{const a=await U.meList(o);E.value=a.data.projectMeAllocationInfoList,_.value.total=a.data.total}v.value=!1}catch{}finally{v.value=!1}}Ne(()=>{x.value.forEach(o=>{o.checked&&u.value.push(o.prop)}),S(),O.value=[{index:1,show:!0,type:"input",modelName:"projectId",placeholder:"项目ID"},{index:2,show:!0,type:"input",modelName:"tenantId",placeholder:"租户ID"},{index:3,show:!0,type:"input",modelName:"tenantName",placeholder:"租户名称"},{index:4,show:!0,type:"select",modelName:"projectStatus",placeholder:"项目状态",option:"projectStatus",optionLabel:"label",optionValue:"value"}],F.value=[{index:1,show:!0,type:"input",modelName:"projectId",placeholder:"项目ID"},{index:2,show:!0,type:"input",modelName:"tenantId",placeholder:"租户ID"},{index:3,show:!0,type:"input",modelName:"tenantName",placeholder:"租户名称"},{index:4,show:!0,type:"select",modelName:"projectStatus",placeholder:"项目状态",option:"projectStatus",optionLabel:"label",optionValue:"value"},{index:5,show:!0,type:"select",modelName:"receiveStatus",placeholder:"接收状态",option:"receiveStatus",optionLabel:"label",optionValue:"value"}]});const de=[{value:1,label:"自动（已接收）"},{value:2,label:"手动（未接收）"}],K={projectStatus:()=>V.projectStatusList.map((o,a)=>({label:o,value:a+1})),receiveStatus:()=>de},z=d();function W(o){o?z.value=o.projectId:z.value=""}const P=d();function me(){const o=A.value.getSelectionRows();if(o.length!==1)I.warning({message:"请选择一个项目",center:!0});else{let a=o.length;o.forEach(f=>{f.receiveStatus==1&&a++}),a!=o.length?I.warning({message:"已接收的项目不能再次接收，请重新选择",center:!0}):(w.value.receivingMode="批量接收",w.value.selectList=o,P.value.showEdit("","接收",o))}}function fe(){const o=A.value.getSelectionRows();if(o.length!==1){I.warning({message:"请选择一个项目",center:!0});return}else{let a=o.length;o.forEach(f=>{f.receiveStatus==2&&a++}),a!=o.length?I.warning({message:"未接收的项目不能取消接收，请重新选择",center:!0}):se.confirm("确认取消接收吗？","确认信息").then(()=>{try{v.value=!0;let f=[];o.forEach(M=>{f.push(M.id)});let B={type:2,idList:f};U.updateReceiveStatus(B).then(()=>{v.value=!1,S(),I.success({message:"取消接收成功",center:!0})})}catch{}finally{v.value=!1}}).catch(()=>{})}}function ve(o){w.value.selectList=[o],P.value.showEdit("","接收",[o])}function ge(o){se.confirm("确认取消接收吗？","确认信息").then(()=>{try{v.value=!0;let a={type:2,idList:[o.id]};U.updateReceiveStatus(a).then(()=>{v.value=!1,S(),I.success({message:"取消接收成功",center:!0})})}catch{}finally{v.value=!1}}).catch(()=>{})}function ye(o){w.value.chargeUserId=o.chargeUserId,w.value.invitationType=o.invitationType,w.value.chargeUserName=o.chargeUserName;let a=[];w.value.selectList.forEach(f=>{a.push(f.id)});try{v.value=!0;let f={type:1,idList:a,userId:o.chargeUserId,userName:o.chargeUserName,allocationType:o.invitationType};U.updateReceiveStatus(f).then(()=>{v.value=!1,S(),I.success({message:"接收成功",center:!0})})}catch{}finally{v.value=!1}}return(o,a)=>{const f=Me,B=b("ElDivider"),M=Be,g=b("el-button"),X=ze,Y=De,Z=b("el-row"),c=b("el-table-column"),y=b("el-text"),T=Ee,ee=b("el-tooltip"),te=b("el-empty"),ae=b("el-table"),le=b("ElPagination"),oe=b("el-tab-pane"),he=xe,_e=b("el-tabs"),be=Re,ke=je("loading");return s(),Ce("div",{class:R({"absolute-container":D.value})},[l(be,null,{default:t(()=>[l(_e,{modelValue:k.type,"onUpdate:modelValue":a[14]||(a[14]=e=>k.type=e),onTabChange:S},{default:t(()=>[l(oe,{label:"外包项目",name:2},{default:t(()=>[k.type===2?(s(),r(f,{key:0,formSearchList:O.value,formSearchName:Q.value,onCurrentChange:L,onOnReset:J,model:k,formOption:K},null,8,["formSearchList","formSearchName","model"])):i("",!0),l(B,{"border-style":"dashed"}),l(Z,{gutter:24},{default:t(()=>[l(M),l(Y,null,{default:t(()=>[l(g,{size:"default",onClick:a[0]||(a[0]=()=>{})},{default:t(()=>[n(" 导出 ")]),_:1}),l(X,{border:N.value,"onUpdate:border":a[1]||(a[1]=e=>N.value=e),tableAutoHeight:D.value,"onUpdate:tableAutoHeight":a[2]||(a[2]=e=>D.value=e),checkList:u.value,"onUpdate:checkList":a[3]||(a[3]=e=>u.value=e),columns:x.value,"onUpdate:columns":a[4]||(a[4]=e=>x.value=e),"line-height":j.value,"onUpdate:lineHeight":a[5]||(a[5]=e=>j.value=e),stripe:C.value,"onUpdate:stripe":a[6]||(a[6]=e=>C.value=e),style:{"margin-left":"12px"},onQueryData:L},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),Le((s(),r(ae,{ref_key:"tableSortRef",ref:ce,style:{"margin-top":"10px"},"row-key":"id",data:E.value,border:N.value,size:j.value,stripe:C.value,"highlight-current-row":"",onCurrentChange:W},{empty:t(()=>[l(te,{image:h(ne),"image-size":300},null,8,["image"])]),default:t(()=>[l(c,{align:"left",type:"selection"}),u.value.includes("projectStatus")?(s(),r(c,{key:0,"show-overflow-tooltip":"",prop:"receiveStatus",align:"left",width:"140",label:"状态"},{default:t(({row:e})=>[m("span",Ve,[e.projectStatus===1?(s(),r(y,{key:0,type:"primary"},{default:t(()=>[n(" 进行中(在线)")]),_:1})):e.projectStatus===2?(s(),r(y,{key:1,type:"warning"},{default:t(()=>[n(" 已完成(审核通过)")]),_:1})):e.projectStatus===3?(s(),r(y,{key:2,type:"info"},{default:t(()=>[n(" 离线")]),_:1})):i("",!0)])]),_:1})):i("",!0),u.value.includes("tenantName")?(s(),r(c,{key:1,"show-overflow-tooltip":"",prop:"tenantName",align:"left",label:"租户名称"},{default:t(({row:e})=>[m("div",$e,p(e.tenantName),1)]),_:1})):i("",!0),u.value.includes("tenantId")?(s(),r(c,{key:2,"show-overflow-tooltip":"",prop:"tenantId",align:"left",width:"280",label:"租户ID"},{default:t(({row:e})=>[m("div",Oe,[m("div",Fe,p(e.tenantId),1),l(T,{content:e.tenantId,class:R({rowCopy:"rowCopy",current:e.projectId===z.value})},null,8,["content","class"])])]),_:1})):i("",!0),u.value.includes("projectName")?(s(),r(c,{key:3,"show-overflow-tooltip":"",prop:"projectName",align:"left",label:"项目名称"},{default:t(({row:e})=>[m("div",Qe,p(e.projectName),1)]),_:1})):i("",!0),u.value.includes("projectId")?(s(),r(c,{key:4,"show-overflow-tooltip":"",prop:"projectId",align:"left",width:"280",label:"项目ID"},{default:t(({row:e})=>[m("div",qe,[m("div",Ge,[l(ee,{effect:"dark",content:e.projectId,placement:"top-start"},{default:t(()=>[n(p(e.projectId),1)]),_:2},1032,["content"])]),l(T,{content:e.projectId,class:R({rowCopy:"rowCopy",current:e.projectId===z.value})},null,8,["content","class"])])]),_:1})):i("",!0),u.value.includes("participationNumber")?(s(),r(c,{key:5,"show-overflow-tooltip":"",prop:"participationNumber",align:"left",label:"参数",width:"300"},{default:t(({row:e})=>[l(y,{style:{color:"rgb(251, 104, 104)"},class:"oneLine",type:"danger"},{default:t(()=>[n("参与: "+p(e.participationNumber||0),1)]),_:2},1024),n("   "),l(y,{style:{color:"rgb(3, 194, 57)"},class:"oneLine",type:"success"},{default:t(()=>[n("完成: "+p(e.doneNumber||0),1)]),_:2},1024),n("   "),l(y,{style:{color:"rgb(255, 172, 84)"},class:"oneLine",type:"warning"},{default:t(()=>[n("配额: "+p(e.num||0),1)]),_:2},1024),n("   "),l(y,{style:{color:"rgb(170, 170, 170)"},class:"oneLine",type:"info"},{default:t(()=>[n("限量: "+p(e.limitedQuantity||"-"),1)]),_:2},1024)]),_:1})):i("",!0),l(c,{align:"left",fixed:"right",label:"操作",width:"170"},{default:t(({row:e})=>[l(g,{type:"primary",plain:"",size:"small",onClick:H=>q(e)},{default:t(()=>[n(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"])),[[ke,v.value]]),l(le,{"current-page":h(_).page,total:h(_).total,"page-size":h(_).size,"page-sizes":h(_).sizes,layout:h(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:G,onCurrentChange:L},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),l(oe,{label:"接收项目",name:1},{default:t(()=>[k.type===1?(s(),r(f,{key:0,formSearchList:F.value,formSearchName:Q.value,onCurrentChange:L,onOnReset:J,model:k,formOption:K},null,8,["formSearchList","formSearchName","model"])):i("",!0),l(B,{"border-style":"dashed"}),l(Z,{gutter:24},{default:t(()=>[l(M,null,{default:t(()=>[l(g,{type:"primary",size:"default",onClick:me},{default:t(()=>[n(" 接收项目 ")]),_:1}),l(g,{size:"default",onClick:fe},{default:t(()=>[n(" 取消接收 ")]),_:1})]),_:1}),l(Y,null,{default:t(()=>[l(g,{size:"default",onClick:a[7]||(a[7]=()=>{})},{default:t(()=>[n(" 导出 ")]),_:1}),l(X,{border:N.value,"onUpdate:border":a[8]||(a[8]=e=>N.value=e),tableAutoHeight:D.value,"onUpdate:tableAutoHeight":a[9]||(a[9]=e=>D.value=e),checkList:u.value,"onUpdate:checkList":a[10]||(a[10]=e=>u.value=e),columns:x.value,"onUpdate:columns":a[11]||(a[11]=e=>x.value=e),"line-height":j.value,"onUpdate:lineHeight":a[12]||(a[12]=e=>j.value=e),stripe:C.value,"onUpdate:stripe":a[13]||(a[13]=e=>C.value=e),style:{"margin-left":"12px"},onQueryData:L},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),l(ae,{ref_key:"tableSortRef2",ref:A,style:{"margin-top":"10px"},"row-key":"id",data:E.value,border:N.value,size:j.value,"highlight-current-row":"",stripe:C.value,onCurrentChange:W},{empty:t(()=>[l(te,{image:h(ne),"image-size":300},null,8,["image"])]),default:t(()=>[l(c,{align:"left",type:"selection"}),u.value.includes("projectStatus")?(s(),r(c,{key:0,"show-overflow-tooltip":"",prop:"projectStatus",align:"left",label:"状态",width:"140"},{default:t(({row:e})=>[m("span",Je,p(h(V).projectStatusList[e.projectStatus-1]),1)]),_:1})):i("",!0),u.value.includes("receiveStatus")?(s(),r(c,{key:1,"show-overflow-tooltip":"",prop:"receiveStatus",align:"left",label:"接收状态",width:"140"},{default:t(({row:e})=>[e.receiveStatus==2?(s(),r(y,{key:0,style:{color:"rgb(251, 104, 104)"},class:"oneLine",type:"danger"},{default:t(()=>[n("手动（未接收）")]),_:1})):i("",!0),n("   "),e.receiveStatus==1?(s(),r(y,{key:1,style:{color:"rgb(3, 194, 57)"},class:"oneLine",type:"success"},{default:t(()=>[n("自动（已接收）")]),_:1})):i("",!0)]),_:1})):i("",!0),u.value.includes("tenantName")?(s(),r(c,{key:2,"show-overflow-tooltip":"",prop:"tenantName",align:"left",label:"租户名称",width:"200"},{default:t(({row:e})=>[m("div",Ke,p(e.tenantName),1)]),_:1})):i("",!0),u.value.includes("tenantId")?(s(),r(c,{key:3,"show-overflow-tooltip":"",prop:"tenantId",align:"left",label:"租户ID",width:"280"},{default:t(({row:e})=>[m("div",We,[m("div",Xe,p(e.tenantId),1),l(T,{content:e.tenantId,class:R({rowCopy:"rowCopy",current:e.projectId===z.value})},null,8,["content","class"])])]),_:1})):i("",!0),u.value.includes("allocationType")?(s(),r(c,{key:4,align:"left",label:"分配",width:"120"},{default:t(({row:e})=>[e.allocationType===1?(s(),r(g,{key:0,class:"tableBut",size:"small",type:"danger",plain:""},{default:t(()=>[n("自动分配")]),_:1})):e.allocationType===2?(s(),r(g,{key:1,class:"tableBut",size:"small",type:"danger"},{default:t(()=>[n("供应商")]),_:1})):e.allocationType===3?(s(),r(g,{key:2,class:"tableBut",size:"small",type:"success"},{default:t(()=>[n("部门")]),_:1})):e.allocationType===4?(s(),r(g,{key:3,class:"tableBut",size:"small",type:"primary"},{default:t(()=>[n("租户")]),_:1})):(s(),r(g,{key:4,size:"small",class:"tableBut"},{default:t(()=>[n(" 未分配")]),_:1}))]),_:1})):i("",!0),u.value.includes("doMoneyPrice")?(s(),r(c,{key:5,"show-overflow-tooltip":"",align:"left",label:"项目价",width:"120"},{default:t(({row:e})=>[m("div",null,[l(he),n(p(e.doMoneyPrice||0),1)])]),_:1})):i("",!0),u.value.includes("projectName")?(s(),r(c,{key:6,"show-overflow-tooltip":"",prop:"projectName",align:"left",label:"项目名称",width:"200"},{default:t(({row:e})=>[m("div",Ye,p(e.projectName),1)]),_:1})):i("",!0),u.value.includes("projectId")?(s(),r(c,{key:7,"show-overflow-tooltip":"",prop:"projectId",align:"left",width:"280",label:"项目ID"},{default:t(({row:e})=>[m("div",Ze,[m("div",et,[l(ee,{effect:"dark",content:e.projectId,placement:"top-start"},{default:t(()=>[n(p(e.projectId),1)]),_:2},1032,["content"])]),l(T,{content:e.projectId,class:R({rowCopy:"rowCopy",current:e.projectId===z.value})},null,8,["content","class"])])]),_:1})):i("",!0),u.value.includes("participationNumber")?(s(),r(c,{key:8,"show-overflow-tooltip":"",prop:"participationNumber",align:"left",label:"参数",width:"300"},{default:t(({row:e})=>[l(y,{style:{color:"rgb(251, 104, 104)"},class:"oneLine",type:"danger"},{default:t(()=>[n("参与: "+p(e.participationNumber||0),1)]),_:2},1024),n("   "),l(y,{style:{color:"rgb(3, 194, 57)"},class:"oneLine",type:"success"},{default:t(()=>[n("完成: "+p(e.doneNumber||0),1)]),_:2},1024),n("   "),l(y,{style:{color:"rgb(255, 172, 84)"},class:"oneLine",type:"warning"},{default:t(()=>[n("配额: "+p(e.num||0),1)]),_:2},1024),n("   "),l(y,{style:{color:"rgb(170, 170, 170)"},class:"oneLine",type:"info"},{default:t(()=>[n("限量: "+p(e.limitedQuantity||"-"),1)]),_:2},1024)]),_:1})):i("",!0),u.value.includes("userName")?(s(),r(c,{key:9,"show-overflow-tooltip":"",prop:"userName",align:"left",label:"负责部门/PM",width:"140"},{default:t(({row:e})=>[m("div",tt,p(e.userName),1)]),_:1})):i("",!0),l(c,{align:"left",fixed:"right",label:"操作",width:"160"},{default:t(({row:e})=>[e.receiveStatus==2?(s(),r(g,{key:0,plain:"",type:"primary",size:"small",onClick:H=>ve(e)},{default:t(()=>[n(" 接收 ")]),_:2},1032,["onClick"])):i("",!0),e.receiveStatus==1?(s(),r(g,{key:1,plain:"",type:"danger",size:"small",onClick:H=>ge(e)},{default:t(()=>[n(" 取消接收 ")]),_:2},1032,["onClick"])):i("",!0),l(g,{type:"primary",plain:"",size:"small",onClick:H=>q(e)},{default:t(()=>[n(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","border","size","stripe"]),l(le,{"current-page":h(_).page,total:h(_).total,"page-size":h(_).size,"page-sizes":h(_).sizes,layout:h(_).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:G,onCurrentChange:L},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1})]),_:1},8,["modelValue"]),l(Pe,{ref_key:"addAllocationEditRef",ref:pe,onFetchData:S},null,512),l(Ae,{ref_key:"editRef",ref:$,onFetchData:S},null,512)]),_:1}),l(He,{ref_key:"userRef",ref:P,onUserData:ye},null,512)],2)}}}),wt=Ue(at,[["__scopeId","data-v-7c15c712"]]);export{wt as default};
