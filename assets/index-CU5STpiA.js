
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{d as Le,aN as ze,r,Z as Ve,n as Ae,a as d,q as Ue,o as i,e as c,w as n,f as o,y as p,i as t,g as v,A as b,s as De,aM as Qe,j as m,z as C,N as k,b as W,t as Re,F as Pe,E as X,aO as je,p as $e,bb as Fe,bc as Me,_ as Te,be as Be,an as He,L as qe}from"./index-D2v_Je4T.js";import{_ as Oe}from"./index-DJJLAsS2.js";import{_ as Ze}from"./index.vue_vue_type_style_index_0_lang-BnSBk1DB.js";import{_ as Ge}from"./index-5gF2I0cM.js";import Je from"./index-Tu10ebGh.js";import Ke from"./index-CO7DBjwu.js";import We from"./index-DSDN8IRb.js";import Xe from"./index-DTuJMMKW.js";import{s as Y}from"./apiLoading-CZQ6QRKu.js";import{u as Ye}from"./user_customer-fqJSXOcq.js";import{a as F}from"./user_customer-s-VqFyms.js";import et from"./index-B8nC9kMv.js";import"./index-6GSUS3zI.js";import"./clipboard-DJj1x3Y7.js";import"./index.vue_vue_type_script_setup_true_lang-CUV9wkWC.js";import"./sortable.esm-C0-Qcoum.js";import"./index.vue_vue_type_script_setup_true_lang-B2i_6cl3.js";import"./index-BZpmIZuh.js";import"./index-DYVEzeKJ.js";import"./department-cbV5Vyf0.js";import"./position_manage-CKy5vdIB.js";import"./configuration_role-WC0gh83m.js";import"./tenant_role-ecP46Bn5.js";import"./configuration_manager-Bp2CAib-.js";import"./configuration_siteSetting-CpylN0Yh.js";import"./configuration_site_setting-Ckr_s-gR.js";import"./stagedData-DkU0Z9C2.js";import"./index.vue_vue_type_script_setup_true_lang-J2ljGSw_.js";import"./index-YMLXtfd9.js";import"./user_cooperation-DwmCL85T.js";import"./index-D7XF6L5q.js";import"./index-CxFS2kQN.js";import"./index-Dnni5Xk-.js";import"./index-r2TfSYZt.js";import"./index-C7777F6B.js";const tt={class:"flex-c tableBig"},ot={class:"oneLine"},nt={class:"flex-c tableBig"},at={class:"oneLine",style:{width:"calc(100% - 20px)"}},lt={class:"copyId tableSmall"},st={class:"oneLine projectId"},rt={class:"flex-c"},it={class:"oneLine",style:{width:"calc(100% - 20px)"}},ct={style:{display:"inline-block"},class:"fontC-System"},ut={key:0,class:"fontC-System"},dt={class:"fontC-System"},mt=Le({name:"customer",__name:"index",setup(pt){const ee=Ye(),{pagination:g,getParams:te,onSizeChange:oe,onCurrentChange:ne}=ze(),M=r([]),S=r(!1),T=r([]),L=r(),B=r(),H=r(),q=r(),y=r(),ae=r(),w=r(!1),x=r(!1),N=r(!1),E=r("default"),u=r([]),O=r(),le=r("formSearch-customer"),I=r([{label:"客户编码",checked:!0,sortable:!0,prop:"tenantCustomerId"},{label:"客户名称",checked:!0,sortable:!0,prop:"customerAccord"},{label:"客户简称",checked:!0,sortable:!0,prop:"customerShortName"},{label:"PM",checked:!0,sortable:!0,prop:"chargeId"},{label:"关联项目数",checked:!0,sortable:!0,prop:"projectNumber"},{label:"客户状态",checked:!0,sortable:!0,prop:"customerStatus"},{label:"前置问卷",checked:!0,sortable:!0,prop:"antecedentQuestionnaire"},{label:"风险控制",checked:!0,sortable:!0,prop:"riskControl"},{label:"客户营业限额/月",checked:!0,sortable:!0,prop:"turnover"},{label:"审核率Min值",checked:!0,sortable:!0,prop:"rateAudit"}]);function se(){L.value.showEdit()}function re(a){L.value.showEdit(a)}async function z(a,l,D){const Q={status:a,operationalType:l,tenantCustomerId:D},{status:_}=await Y(F.changestatus(Q));_===1&&X.success({message:"修改成功"}),ee.customer=null,f()}function ie(a){B.value.showEdit(a)}function ce(a){a?y.value=a.tenantCustomerId:y.value=""}function Z(a,l){H.value.showEdit(a,l)}function ue(a){q.value.showEdit(a)}function de(a){je.confirm("您确定要删除当前项吗?","确认信息").then(async()=>{const{status:l}=await Y(F.delete({tenantCustomerId:a.tenantCustomerId}));l===1&&X.success({message:"删除成功"}),f()}).catch(()=>{})}const V=Ve({customerShortName:"",customerStatus:null,antecedentQuestionnaire:null}),me=async()=>{const{data:a}=await $e.getTenantStaffList();M.value=a};function pe(a){oe(a).then(()=>A())}function G(a=1){ne(a).then(()=>A())}function fe(){Object.assign(V,{customerShortName:"",customerStatus:null,antecedentQuestionnaire:null}),f()}function f(){g.value.page=1,A()}async function A(){try{S.value=!0;const a={...te(),...V},{data:l}=await F.list(a);T.value=l.getTenantCustomerInfoList,g.value.total=Number(l.total),S.value=!1}catch{}finally{S.value=!1}}function _e(a){ae.value=a}Ae(async()=>{await me(),I.value.forEach(a=>{a.checked&&u.value.push(a.prop)}),f(),O.value=[{index:1,show:!0,type:"input",modelName:"customerShortName",placeholder:"客户简称"},{index:2,show:!0,type:"select",modelName:"customerStatus",placeholder:"客户状态",option:"customerStatus",optionLabel:"label",optionValue:"value"},{index:3,show:!0,type:"select",modelName:"antecedentQuestionnaire",placeholder:"前置问卷",option:"antecedentQuestionnaire",optionLabel:"label",optionValue:"value"}]});const he={customerStatus:()=>[{label:"禁用",value:1},{label:"启用",value:2}],antecedentQuestionnaire:()=>[{label:"禁用",value:1},{label:"启用",value:2}]},U=r("first");return(a,l)=>{const D=Ge,Q=d("ElDivider"),_=d("el-button"),ve=Ze,ge=Fe,be=Me,Ce=d("el-row"),R=d("ElSwitch"),P=d("ElTableColumn"),J=Oe,h=d("el-table-column"),j=Te,$=d("el-text"),ye=Be,ke=d("ElSpace"),Se=d("el-empty"),we=d("el-table"),xe=d("ElPagination"),K=d("el-tab-pane"),Ne=d("el-tabs"),Ee=He,Ie=Ue("loading");return i(),c(Ee,null,{default:n(()=>[o(Ne,{modelValue:t(U),"onUpdate:modelValue":l[6]||(l[6]=e=>b(U)?U.value=e:null),class:"demo-tabs"},{default:n(()=>[o(K,{label:"我的客户",name:"first"},{default:n(()=>[p("div",{class:k({"absolute-container":t(N)})},[o(D,{formSearchList:t(O),formSearchName:t(le),onCurrentChange:G,onOnReset:fe,model:t(V),formOption:he},null,8,["formSearchList","formSearchName","model"]),o(Q,{"border-style":"dashed"}),o(Ce,null,{default:n(()=>[o(ve,null,{default:n(()=>[o(_,{type:"primary",size:"default",onClick:se},{default:n(()=>[v(" 新增 ")]),_:1})]),_:1}),o(be,null,{default:n(()=>[o(_,{size:"default"},{default:n(()=>[v(" 导出 ")]),_:1}),o(ge,{border:t(w),"onUpdate:border":l[0]||(l[0]=e=>b(w)?w.value=e:null),tableAutoHeight:t(N),"onUpdate:tableAutoHeight":l[1]||(l[1]=e=>b(N)?N.value=e:null),checkList:t(u),"onUpdate:checkList":l[2]||(l[2]=e=>b(u)?u.value=e:null),columns:t(I),"onUpdate:columns":l[3]||(l[3]=e=>b(I)?I.value=e:null),"line-height":t(E),"onUpdate:lineHeight":l[4]||(l[4]=e=>b(E)?E.value=e:null),stripe:t(x),"onUpdate:stripe":l[5]||(l[5]=e=>b(x)?x.value=e:null),style:{"margin-left":"12px"},onQueryData:f},null,8,["border","tableAutoHeight","checkList","columns","line-height","stripe"])]),_:1})]),_:1}),De((i(),c(we,{border:t(w),data:t(T),size:t(E),stripe:t(x),onSelectionChange:_e,"highlight-current-row":"",onCurrentChange:ce},{empty:n(()=>[o(Se,{image:t(Qe),"image-size":300},null,8,["image"])]),default:n(()=>[t(u).includes("customerStatus")?(i(),c(P,{key:0,align:"left","show-overflow-tooltip":"",prop:"customerStatus",label:"客户状态",width:"84"},{default:n(({row:e})=>[o(R,{modelValue:e.customerStatus,"onUpdate:modelValue":s=>e.customerStatus=s,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:s=>z(s,1,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):m("",!0),t(u).includes("customerAccord")?(i(),c(h,{key:1,align:"left",prop:"customerAccord","show-overflow-tooltip":"",label:"客户名称",width:"150"},{default:n(({row:e})=>[p("div",tt,[p("div",ot,C(e.customerAccord),1),o(J,{content:e.customerAccord,class:k({rowCopy:"rowCopy",current:e.tenantCustomerId===t(y)})},null,8,["content","class"])])]),_:1})):m("",!0),t(u).includes("customerShortName")?(i(),c(h,{key:2,align:"left",prop:"customerShortName","show-overflow-tooltip":"",label:"客户简称",width:"150"},{default:n(({row:e})=>[p("div",nt,[p("div",at,C(e.customerShortName),1),o(j,{onClick:s=>Z(e,"customerShortName"),class:k({edit:"edit",current:e.tenantCustomerId===t(y)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):m("",!0),t(u).includes("tenantCustomerId")?(i(),c(h,{key:3,align:"left",prop:"tenantCustomerId","show-overflow-tooltip":"",label:"客户编码",width:"150"},{default:n(({row:e})=>[p("div",lt,[p("div",st,C(e.tenantCustomerId),1),o(J,{content:e.tenantCustomerId,class:k({rowCopy:"rowCopy",current:e.tenantCustomerId===t(y)})},null,8,["content","class"])])]),_:1})):m("",!0),t(u).includes("chargeId")?(i(),c(h,{key:4,align:"left",prop:"chargeId","show-overflow-tooltip":"",label:"PM"},{default:n(({row:e})=>[p("div",rt,[p("div",it,[(i(!0),W(Pe,null,Re(t(M),s=>(i(),c($,{key:s.id},{default:n(()=>[s.id===e.chargeId?(i(),c($,{key:0,class:"fontC-System"},{default:n(()=>[v(C(s.userName),1)]),_:2},1024)):m("",!0)]),_:2},1024))),128))]),o(j,{onClick:s=>Z(e,"chargeId"),class:k({edit:"edit",current:e.tenantCustomerId===t(y)}),name:"i-ep:edit",color:"#409eff"},null,8,["onClick","class"])])]),_:1})):m("",!0),t(u).includes("projectNumber")?(i(),c(h,{key:5,align:"left",prop:"turnover","show-overflow-tooltip":"",label:"关联项目数"},{default:n(({row:e})=>[p("span",ct,C(e.projectNumber||0),1),e.projectNumber?(i(),c(_,{key:0,text:"",type:"primary",size:"small",class:"p-1",onClick:s=>ue(e)},{default:n(()=>[o(j,{name:"mdi:cursor-default-click",size:"16px",color:"#409eff"})]),_:2},1032,["onClick"])):m("",!0)]),_:1})):m("",!0),t(u).includes("antecedentQuestionnaire")?(i(),c(P,{key:6,align:"left","show-overflow-tooltip":"",prop:"antecedentQuestionnaire",label:"前置问卷"},{default:n(({row:e})=>[o(R,{modelValue:e.antecedentQuestionnaire,"onUpdate:modelValue":s=>e.antecedentQuestionnaire=s,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:s=>z(s,2,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):m("",!0),t(u).includes("riskControl")?(i(),c(P,{key:7,align:"left","show-overflow-tooltip":"",prop:"riskControl",label:"风险控制"},{default:n(({row:e})=>[o(R,{modelValue:e.riskControl,"onUpdate:modelValue":s=>e.riskControl=s,"inline-prompt":"","inactive-value":1,"active-value":2,"active-text":"启用","inactive-text":"禁用",onChange:s=>z(s,3,e.tenantCustomerId)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):m("",!0),t(u).includes("turnover")?(i(),c(h,{key:8,align:"left",prop:"turnover","show-overflow-tooltip":"",label:"客户营业限额/月"},{default:n(({row:e})=>[e.turnover>0?(i(),W("div",ut,[o(ye),v(C(e.turnover),1)])):(i(),c($,{key:1,class:"fontC-System"},{default:n(()=>[v("-")]),_:1}))]),_:1})):m("",!0),t(u).includes("rateAudit")?(i(),c(h,{key:9,align:"left",prop:"rateAudit","show-overflow-tooltip":"",label:"审核率Min值"},{default:n(({row:e})=>[p("div",dt,C(e.rateAudit?e.rateAudit:"-"),1)]),_:1})):m("",!0),o(h,{align:"left",fixed:"right",prop:"i",label:"操作",width:"200"},{default:n(({row:e})=>[o(ke,null,{default:n(()=>[o(_,{size:"small",plain:"",type:"primary",onClick:s=>re(e)},{default:n(()=>[v(" 编辑 ")]),_:2},1032,["onClick"]),o(_,{type:"warning",plain:"",size:"small",onClick:s=>ie(e)},{default:n(()=>[v(" 详情 ")]),_:2},1032,["onClick"]),o(_,{type:"danger",plain:"",size:"small",onClick:s=>de(e)},{default:n(()=>[v(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["border","data","size","stripe"])),[[Ie,t(S)]]),o(xe,{"current-page":t(g).page,total:t(g).total,"page-size":t(g).size,"page-sizes":t(g).sizes,layout:t(g).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:pe,onCurrentChange:G},null,8,["current-page","total","page-size","page-sizes","layout"]),o(Je,{ref_key:"editRef",ref:L,onFetchData:f},null,512),o(Ke,{ref_key:"QuickEditRef",ref:H,onFetchData:f},null,512),o(We,{ref_key:"AssociatedProjectsRef",ref:q,onFetchData:f},null,512),o(Xe,{ref_key:"checkRef",ref:B,onFetchData:f},null,512)],2)]),_:1}),o(K,{label:"合作商户",name:"second"},{default:n(()=>[o(et)]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Jt=qe(mt,[["__scopeId","data-v-5eaa3065"]]);export{Jt as default};
