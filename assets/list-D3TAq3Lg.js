
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */

import{k as E,d as k,r as p,n as S,a as s,q as $,s as R,o as B,b as D,f as e,w as t,y as I,g as M,E as A,_ as L,an as T,L as z}from"./index-DaALCnOY.js";import"./clipboard-5N8iHd6K.js";const q={list:()=>E.post("member-config/getMemberConfig"),create:c=>E.post("member-config/insertMemberConfig",c),edit:c=>E.post("member-config/updateMemberConfig",c)},W={class:"domainName"},Z=k({name:"setting",__name:"list",setup(c){const C=p("基本设置"),n=p(!1),m=p(),l=p({webName:"",keyWords:"",registerOffOrOn:!0,registerExamineOffOrOn:!1,priceProportion:null,taxPointsProportion:null,minimumAmount:null,fixedPrice:null,externalSite:"",phone:"",email:"",qqCode:"",address:""}),v=p({webName:[{required:!0,message:"请输入网站名称",trigger:"blur"}],memberURL:[{required:!0,message:"请输入会员网址",trigger:"blur"}],phone:[{required:!1,trigger:"blur",message:"请输入手机号"},{validator:(u,a,r)=>{/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/.test(l.value.phone)?r():r(new Error("请输入合法手机号"))},trigger:"blur"}],email:[{required:!1,trigger:"blur",message:"请输入邮箱"},{validator:(u,a,r)=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(l.value.email)?r():r(new Error("请输入合法邮箱"))},trigger:"blur"}]});S(()=>{_()});async function _(){try{n.value=!0;const{data:u}=await q.list();l.value=u||l.value,l.value.minimumAmount===0&&(l.value.minimumAmount=null),n.value=!1}catch{}finally{n.value=!1}}function N(){l.value.email===""&&(v.value.email=[],m.value.clearValidate("email")),l.value.phone===""&&(v.value.phone=[],m.value.clearValidate("phone")),l.value.id?m.value&&m.value.validate(u=>{if(u)try{let{id:a,keyWords:r,registerExamineOffOrOn:i,registerOffOrOn:d,webName:g,priceProportion:b,taxPointsProportion:f,minimumAmount:x,fixedPrice:O,externalSite:V,phone:P,email:w,qqCode:h,address:y}=l.value;const o={id:a,keyWords:r,registerExamineOffOrOn:i,registerOffOrOn:d,webName:g,priceProportion:b,taxPointsProportion:f,minimumAmount:x,fixedPrice:O,externalSite:V,phone:P,email:w,qqCode:h,address:y};n.value=!0,q.edit(o).then(U=>{n.value=!1,U.status===1&&(_(),A.success({message:"修改成功",center:!0}))})}catch{}finally{n.value=!1}}):m.value&&m.value.validate(u=>{if(u)try{n.value=!0,q.create(l.value).then(()=>{n.value=!1,_(),A.success({message:"新增成功",center:!0})})}catch{}finally{n.value=!1}})}return(u,a)=>{const r=s("el-switch"),i=s("el-form-item"),d=s("el-col"),g=L,b=s("el-tooltip"),f=s("el-input"),x=s("el-row"),O=s("el-button"),V=s("el-tab-pane"),P=s("el-form"),w=s("el-tabs"),h=T,y=$("loading");return R((B(),D("div",null,[e(h,null,{default:t(()=>[e(w,{modelValue:C.value,"onUpdate:modelValue":a[5]||(a[5]=o=>C.value=o)},{default:t(()=>[e(P,{ref_key:"formRef",ref:m,model:l.value,rules:v.value,"label-position":"right","label-width":"140px",style:{width:"500px"}},{default:t(()=>[e(V,{label:"基础设置",name:"基本设置"},{default:t(()=>[e(x,{gutter:20},{default:t(()=>[e(d,{span:7},{default:t(()=>[e(i,{label:"注册开关"},{default:t(()=>[e(r,{modelValue:l.value.registerOffOrOn,"onUpdate:modelValue":a[0]||(a[0]=o=>l.value.registerOffOrOn=o),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:6},{default:t(()=>[e(i,{label:"注册审核"},{default:t(()=>[e(r,{modelValue:l.value.registerExamineOffOrOn,"onUpdate:modelValue":a[1]||(a[1]=o=>l.value.registerExamineOffOrOn=o),"active-text":"开启","inline-prompt":"","inactive-text":"关闭","active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:24},{default:t(()=>[e(i,{label:"最低结算金额",prop:"confirmPassword"},{default:t(()=>[I("div",W,[e(b,{class:"tooltips",content:"针对会员结算金额的配置",placement:"top"},{default:t(()=>[e(g,{class:"SvgIcon1",name:"i-ri:question-line"})]),_:1})]),e(f,{modelValue:l.value.minimumAmount,"onUpdate:modelValue":a[2]||(a[2]=o=>l.value.minimumAmount=o),modelModifiers:{number:!0},style:{width:"18rem"},placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:24},{default:t(()=>[e(i,{label:"会员税点",prop:"confirmPassword"},{default:t(()=>[e(f,{modelValue:l.value.taxPointsProportion,"onUpdate:modelValue":a[3]||(a[3]=o=>l.value.taxPointsProportion=o),modelModifiers:{number:!0},style:{width:"18rem"},placeholder:""},{append:t(()=>[M("%")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(d,{span:24},{default:t(()=>[e(i,{label:"调查限价",prop:"confirmPassword"},{default:t(()=>[e(f,{modelValue:l.value.fixedPrice,"onUpdate:modelValue":a[4]||(a[4]=o=>l.value.fixedPrice=o),modelModifiers:{number:!0},style:{width:"18rem"},placeholder:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(i,null,{default:t(()=>[e(O,{type:"primary",onClick:N},{default:t(()=>[M(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]),_:1})])),[[y,n.value]])}}}),J=z(Z,[["__scopeId","data-v-c787c0d5"]]);export{J as default};
